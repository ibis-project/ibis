r0 := DatabaseTable: test2
  key   string
  value float64

r1 := DatabaseTable: test1
  c int32
  f float64
  g string

r2 := Filter[r1]
  r1.f > 0

r3 := SelfReference[r2]

r4 := JoinChain[r0]
  JoinLink[inner, r3]
    r3.g == r0.key
  values:
    key:   r0.key
    value: r0.value
    c:     r3.c
    f:     r3.f
    g:     r3.g

Aggregate[r4]
  groups:
    g:   r4.g
    key: r4.key
  metrics:
    foo: Mean(r4.f - r4.value)
    bar: Sum(r4.f)