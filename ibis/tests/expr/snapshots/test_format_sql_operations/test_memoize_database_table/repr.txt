r0 := DatabaseTable: test2
  key   string
  value float64

r1 := DatabaseTable: test1
  c int32
  f float64
  g string

r2 := SelfReference[r0]

r3 := Filter[r1]
  r1.f > 0

r4 := SelfReference[r3]

r5 := JoinChain[r2]
  JoinLink[inner, r4]
    r4.g == r2.key
  values:
    key:   r2.key
    value: r2.value
    c:     r4.c
    f:     r4.f
    g:     r4.g

Aggregate[r5]
  groups:
    g:   r5.g
    key: r5.key
  metrics:
    foo: Mean(r5.f - r5.value)
    bar: Sum(r5.f)