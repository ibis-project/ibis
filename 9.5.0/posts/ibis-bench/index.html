<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Cody Peterson">
<meta name="dcterms.date" content="2024-06-24">

<title>Ibis benchmarking: DuckDB, DataFusion, Polars – Ibis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<script src="../../site_libs/quarto-search/autocomplete-preset-algolia.umd.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../logo.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e67ff5f79a98c6389aa7c0b9e6712459.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-14475e581903c9a7e5ed069634c08d5c.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-12c8c4cf821d2fd1848e951be45237d8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "algolia": {
    "application-id": "TNU9HG3L41",
    "search-only-api-key": "26350948d1961209df16d9717a7e01d6",
    "index-name": "prod_ibis",
    "analytics-events": true,
    "show-logo": true,
    "libDir": "site_libs"
  },
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.5.1/dist/algoliasearch-lite.umd.js"></script>


<script type="text/javascript">
var ALGOLIA_INSIGHTS_SRC = "https://cdn.jsdelivr.net/npm/search-insights/dist/search-insights.iife.min.js";
!function(e,a,t,n,s,i,c){e.AlgoliaAnalyticsObject=s,e[s]=e[s]||function(){
(e[s].queue=e[s].queue||[]).push(arguments)},i=a.createElement(t),c=a.getElementsByTagName(t)[0],
i.async=1,i.src=n,c.parentNode.insertBefore(i,c)
}(window,document,"script",ALGOLIA_INSIGHTS_SRC,"aa");
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-algolia-insights">

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.32.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>

<script data-goatcounter="https://ibis.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Ibis benchmarking: DuckDB, DataFusion, Polars – Ibis">
<meta property="og:description" content="the portable Python dataframe library">
<meta property="og:image" content="https://ibis-project.org/posts/ibis-bench/figure1.png">
<meta property="og:site_name" content="Ibis">
<meta property="og:image:height" content="894">
<meta property="og:image:width" content="1154">
<meta name="twitter:title" content="Ibis benchmarking: DuckDB, DataFusion, Polars – Ibis">
<meta name="twitter:description" content="the portable Python dataframe library">
<meta name="twitter:image" content="https://ibis-project.org/posts/ibis-bench/figure1.png">
<meta name="twitter:image-height" content="894">
<meta name="twitter:image-width" content="1154">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Ibis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-getting-started" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Getting started</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-getting-started">    
        <li>
    <a class="dropdown-item" href="../../install.html">
 <span class="dropdown-text">Installation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/getting_started.html">
 <span class="dropdown-text">Tutorial: getting started</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/ibis-for-dplyr-users.html">
 <span class="dropdown-text">Tutorial: Ibis for dplyr users</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/ibis-for-pandas-users.html">
 <span class="dropdown-text">Tutorial: Ibis for pandas users</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/ibis-for-sql-users.html">
 <span class="dropdown-text">Tutorial: Ibis for SQL users</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Browser</li>
        <li>
    <a class="dropdown-item" href="../../tutorials/browser/repl.html">
 <span class="dropdown-text">JupyterLite console</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Cloud Data Platforms</li>
        <li>
    <a class="dropdown-item" href="../../tutorials/cloud-data-platforms/clickhouse.html">
 <span class="dropdown-text">ClickHouse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/cloud-data-platforms/starburst-galaxy/0_setup.html">
 <span class="dropdown-text">Starburst Galaxy</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Open Source Software</li>
        <li>
    <a class="dropdown-item" href="../../tutorials/open-source-software/apache-flink/0_setup.html">
 <span class="dropdown-text">Apache Flink</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-concepts" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Concepts</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-concepts">    
        <li>
    <a class="dropdown-item" href="../../why.html">
 <span class="dropdown-text">Why Ibis?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/composable-ecosystem.html">
 <span class="dropdown-text">Composable data ecosystem</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/datatypes.html">
 <span class="dropdown-text">Datatypes and Datashapes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/internals.html">
 <span class="dropdown-text">Internals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/user-testimonials.html">
 <span class="dropdown-text">User testimonials</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/versioning.html">
 <span class="dropdown-text">Versioning policy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/who.html">
 <span class="dropdown-text">Who supports Ibis?</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-backends" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Backends</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-backends">    
        <li>
    <a class="dropdown-item" href="../../backends/bigquery.html">
 <span class="dropdown-text">BigQuery</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/clickhouse.html">
 <span class="dropdown-text">ClickHouse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/dask.html">
 <span class="dropdown-text">Dask</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/datafusion.html">
 <span class="dropdown-text">DataFusion</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/druid.html">
 <span class="dropdown-text">Druid</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/duckdb.html">
 <span class="dropdown-text">DuckDB</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/exasol.html">
 <span class="dropdown-text">Exasol</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/flink.html">
 <span class="dropdown-text">Flink</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/impala.html">
 <span class="dropdown-text">Impala</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/mssql.html">
 <span class="dropdown-text">MSSQL</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/mysql.html">
 <span class="dropdown-text">MySQL</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/oracle.html">
 <span class="dropdown-text">Oracle</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/pandas.html">
 <span class="dropdown-text">pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/polars.html">
 <span class="dropdown-text">Polars</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/postgresql.html">
 <span class="dropdown-text">PostgreSQL</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/pyspark.html">
 <span class="dropdown-text">PySpark</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/risingwave.html">
 <span class="dropdown-text">RisingWave</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/snowflake.html">
 <span class="dropdown-text">Snowflake</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/sqlite.html">
 <span class="dropdown-text">SQLite</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/trino.html">
 <span class="dropdown-text">Trino</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Support</li>
        <li>
    <a class="dropdown-item" href="../../backends/support/matrix.html">
 <span class="dropdown-text">Operation support matrix</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/support/operations.html">
 <span class="dropdown-text">Operations</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-how-to" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">How-to</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-how-to">    
        <li class="dropdown-header">Configure</li>
        <li>
    <a class="dropdown-item" href="../../how-to/configure/basics.html">
 <span class="dropdown-text">Basic configuration</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Input Output</li>
        <li>
    <a class="dropdown-item" href="../../how-to/input-output/basics.html">
 <span class="dropdown-text">Basic input/output</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/input-output/duckdb-parquet.html">
 <span class="dropdown-text">Read parquet files with Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/input-output/gcs_duckdb.html">
 <span class="dropdown-text">Loading Google Cloud Storage files with DuckDB</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/input-output/multiple-backends.html">
 <span class="dropdown-text">Work with multiple backends</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Analytics</li>
        <li>
    <a class="dropdown-item" href="../../how-to/analytics/basics.html">
 <span class="dropdown-text">Basic analytics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/analytics/chain_expressions.html">
 <span class="dropdown-text">Chaining expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/analytics/imdb.html">
 <span class="dropdown-text">Analyze IMDB data using Ibis</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Visualization</li>
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/altair.html">
 <span class="dropdown-text">Altair + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/graphs.html">
 <span class="dropdown-text">GraphViz + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/matplotlib.html">
 <span class="dropdown-text">matplotlib + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/plotly.html">
 <span class="dropdown-text">Plotly + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/plotnine.html">
 <span class="dropdown-text">plotnine + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/seaborn.html">
 <span class="dropdown-text">seaborn + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/streamlit.html">
 <span class="dropdown-text">Streamlit + Ibis</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Extending</li>
        <li>
    <a class="dropdown-item" href="../../how-to/extending/builtin.html">
 <span class="dropdown-text">Reference built-in functions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/extending/sql.html">
 <span class="dropdown-text">Using SQL strings with Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/extending/streaming.html">
 <span class="dropdown-text">Ibis for streaming</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/extending/unbound_expression.html">
 <span class="dropdown-text">Write and execute unbound expressions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-reference" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Reference</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-reference">    
        <li class="dropdown-header">Expression API</li>
        <li>
    <a class="dropdown-item" href="../../reference/expression-tables.html">
 <span class="dropdown-text">Table expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/selectors.html">
 <span class="dropdown-text">Column selectors</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-generic.html">
 <span class="dropdown-text">Generic expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-numeric.html">
 <span class="dropdown-text">Numeric and Boolean expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-strings.html">
 <span class="dropdown-text">String expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-temporal.html">
 <span class="dropdown-text">Temporal expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-collections.html">
 <span class="dropdown-text">Collection expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-geospatial.html">
 <span class="dropdown-text">Geospatial expressions</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Type system</li>
        <li>
    <a class="dropdown-item" href="../../reference/datatypes.html">
 <span class="dropdown-text">Data types</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/schemas.html">
 <span class="dropdown-text">Schemas</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">UDFs</li>
        <li>
    <a class="dropdown-item" href="../../reference/scalar-udfs.html">
 <span class="dropdown-text">Scalar UDFs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/aggregate-udfs.html">
 <span class="dropdown-text">Aggregate UDFs (experimental)</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Connection APIs</li>
        <li>
    <a class="dropdown-item" href="../../reference/connection.html">
 <span class="dropdown-text">Top-level connection APIs</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Configuration</li>
        <li>
    <a class="dropdown-item" href="../../reference/Interactive.html">
 <span class="dropdown-text">Interactive</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/Options.html">
 <span class="dropdown-text">Options</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/Repr.html">
 <span class="dropdown-text">Repr</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/SQL.html">
 <span class="dropdown-text">SQL</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Cursed Knowledge</li>
        <li>
    <a class="dropdown-item" href="../../reference/cursed_knowledge.html">
 <span class="dropdown-text">Cursed Knowledge</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../presentations.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../release_notes.html"> 
<span class="menu-text">Release notes</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-contribute" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Contribute</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-contribute">    
        <li class="dropdown-header">Contribute</li>
        <li>
    <a class="dropdown-item" href="../../contribute/01_environment.html">
 <span class="dropdown-text">Setting up a development environment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../contribute/02_workflow.html">
 <span class="dropdown-text">Contribute to the Ibis codebase</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../contribute/03_style.html">
 <span class="dropdown-text">Style and formatting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../contribute/04_maintainers_guide.html">
 <span class="dropdown-text">Maintaining the codebase</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../contribute/05_reference.html">
 <span class="dropdown-text">Test class reference</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis">
            Source code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/issues/new?assignees=&amp;labels=bug&amp;projects=&amp;template=bug-report.yml&amp;title=bug">
            Report a bug
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/issues/new?assignees=&amp;labels=docs&amp;projects=&amp;template=docs-issue.yml&amp;title=docs">
            Report a documentation issue
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/issues/new?assignees=&amp;labels=feature&amp;projects=&amp;template=feature-request.yml&amp;title=feat">
            Submit a feature request
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/discussions/new?category=q-a">
            Ask the community for help
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Ibis benchmarking: DuckDB, DataFusion, Polars</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">benchmark</div>
                <div class="quarto-category">duckdb</div>
                <div class="quarto-category">datafusion</div>
                <div class="quarto-category">polars</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Cody Peterson </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 24, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#key-considerations" id="toc-key-considerations" class="nav-link active" data-scroll-target="#key-considerations">Key considerations</a>
  <ul class="collapse">
  <li><a href="#the-benchmark" id="toc-the-benchmark" class="nav-link" data-scroll-target="#the-benchmark">The benchmark</a></li>
  <li><a href="#the-engines-the-api-the-code" id="toc-the-engines-the-api-the-code" class="nav-link" data-scroll-target="#the-engines-the-api-the-code">The engines, the API, the code</a></li>
  <li><a href="#how-queries-are-written" id="toc-how-queries-are-written" class="nav-link" data-scroll-target="#how-queries-are-written">How queries are written</a></li>
  <li><a href="#how-queries-are-run" id="toc-how-queries-are-run" class="nav-link" data-scroll-target="#how-queries-are-run">How queries are run</a></li>
  <li><a href="#biases" id="toc-biases" class="nav-link" data-scroll-target="#biases">Biases</a></li>
  </ul></li>
  <li><a href="#results-and-analysis" id="toc-results-and-analysis" class="nav-link" data-scroll-target="#results-and-analysis">Results and analysis</a>
  <ul class="collapse">
  <li><a href="#reading-the-data" id="toc-reading-the-data" class="nav-link" data-scroll-target="#reading-the-data">Reading the data</a></li>
  <li><a href="#whats-in-the-data" id="toc-whats-in-the-data" class="nav-link" data-scroll-target="#whats-in-the-data">What’s in the data?</a></li>
  <li><a href="#execution-time-by-system-scale-factor-instance-type-and-query" id="toc-execution-time-by-system-scale-factor-instance-type-and-query" class="nav-link" data-scroll-target="#execution-time-by-system-scale-factor-instance-type-and-query">Execution time by system, scale factor, instance type, and query</a></li>
  <li><a href="#failing-queries-due-to-memory-pressure" id="toc-failing-queries-due-to-memory-pressure" class="nav-link" data-scroll-target="#failing-queries-due-to-memory-pressure">Failing queries due to memory pressure</a></li>
  </ul></li>
  <li><a href="#discussion-and-reproducibility" id="toc-discussion-and-reproducibility" class="nav-link" data-scroll-target="#discussion-and-reproducibility">Discussion and reproducibility</a>
  <ul class="collapse">
  <li><a href="#which-system-is-best" id="toc-which-system-is-best" class="nav-link" data-scroll-target="#which-system-is-best">Which system is best?</a></li>
  <li><a href="#performance-converges-over-time" id="toc-performance-converges-over-time" class="nav-link" data-scroll-target="#performance-converges-over-time">Performance converges over time</a></li>
  <li><a href="#reproducing-the-benchmark" id="toc-reproducing-the-benchmark" class="nav-link" data-scroll-target="#reproducing-the-benchmark">Reproducing the benchmark</a></li>
  </ul></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps">Next steps</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ibis-project/ibis/edit/main/docs/posts/ibis-bench/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ibis-project/ibis/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><em>The best benchmark is your own workload on your own data</em>.</p>
<section id="key-considerations" class="level2">
<h2 class="anchored" data-anchor-id="key-considerations">Key considerations</h2>
<p>The purpose of this post is to explore some benchmarking data with Ibis. We’ll compare three modern single-node query engines, explore the Ibis API as a great choice for each of them, and discuss the results.</p>
<section id="the-benchmark" class="level3">
<h3 class="anchored" data-anchor-id="the-benchmark">The benchmark</h3>
<div class="callout callout-style-default callout-important callout-titled" title="Not an official TPC-H benchmark">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Not an official TPC-H benchmark
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is not an <a href="https://www.tpc.org/tpch">official TPC-H benchmark</a>. We ran a derivate of the TPC-H benchmark.</p>
</div>
</div>
<p><a href="https://www.tpc.org/tpch">The TPC-H benchmark</a> is a benchmark for databases and, <a href="https://docs.coiled.io/blog/tpch">increasingly</a>, <a href="https://pola.rs/posts/benchmarks">dataframes</a>! It consists of 22 queries across 8 tables. The SQL (or dataframe) code representing the queries is designed to test the performance of a query engine on a variety of tasks including filtering, aggregation, and joins. SQL queries are defined by the TPC-H benchmark. We run the SQL queries and equivalent dataframe code via Ibis and Polars APIs.</p>
<p>The data for the benchmark can be generated at any scale factor, which roughly corresponds to the size of the data in memory in gigabytes. For instance, a scale factor of 10 would be about 10GB of data in memory.</p>
</section>
<section id="the-engines-the-api-the-code" class="level3">
<h3 class="anchored" data-anchor-id="the-engines-the-api-the-code">The engines, the API, the code</h3>
<p>We’ll use three modern single-node OLAP engines (<a href="https://github.com/duckdb/duckdb">DuckDB</a>, <a href="https://github.com/apache/datafusion">DataFusion</a>, <a href="https://github.com/pola-rs/polars">Polars</a>) with the Ibis API via two coding paradigms (dataframe and SQL). Ibis provides a consistent API across 20+ backends, including these three. We run <a href="https://github.com/lostmygithubaccount/ibis-bench/blob/v2.0.0/src/ibis_bench/queries/sql.py">SQL code</a> through Ibis in addition to <a href="https://github.com/lostmygithubaccount/ibis-bench/blob/v2.0.0/src/ibis_bench/queries/ibis.py">dataframe code</a> to get a sense of any overhead in Ibis dataframe code.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ibis dataframe code generates SQL for the DuckDB and DataFusion backends and generates Polars API dataframe code for the Polars backend.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Honorable mention: chDB">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Honorable mention: chDB
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="https://github.com/chdb-io/chdb">chDB</a> would be another great single-node OLAP engine to benchmark. We don’t because it’s not currently a backend for Ibis, though <a href="https://github.com/ibis-project/ibis/pull/8497">there has been work done to make it one</a>.</p>
<p>If you’re interested in contributing to Ibis, a new backend like chDB could be a great project for you!</p>
</div>
</div>
</div>
<p>9/22 queries for Ibis with the Polars backend fail from <a href="#failing-polars-queries">lack of scalar subquery support</a>. Due to this and relatively experimental SQL support in Polars, we’ve opted to run on <a href="https://github.com/lostmygithubaccount/ibis-bench/blob/v2.0.0/src/ibis_bench/queries/polars.py">the Polars API directly</a> in this iteration of the benchmark. This is done with the LazyFrames API <strong>and no streaming engine</strong> (<a href="https://github.com/pola-rs/polars/issues/16694#issuecomment-2146668559">per the Polars team’s recommendation</a>). This also allows us to compare the performance of the Polars backend through Ibis with the Polars API directly for the queries that do succeed.</p>
<section id="failing-queries" class="level4">
<h4 class="anchored" data-anchor-id="failing-queries">Failing queries</h4>
<p>Queries fail for one of two reasons:</p>
<ol type="1">
<li>The query doesn’t work in the given system</li>
<li>The query otherwise failed on a given run</li>
</ol>
<p>We’ll note the cases of the first below. The second is usually due to memory pressure and <a href="#failing-queries-due-to-memory-pressure">will be seen at higher scale factors</a> throughout the data.</p>
</section>
<section id="failing-datafusion-queries" class="level4">
<h4 class="anchored" data-anchor-id="failing-datafusion-queries">Failing DataFusion queries</h4>
<p>Queries 16, 21, and 22 fail for the DataFusion backend via Ibis dataframe code, and query 16 fails through SQL. Note that <a href="https://github.com/apache/datafusion-benchmarks">all TPC-H SQL queries successfully run through DataFusion directly</a> – Ibis generates SQL that <a href="https://github.com/apache/datafusion/issues/10830">hits a bug with DataFusion that has already been fixed</a>. We expect these queries to work in the next iteration of this benchmark coming soon.</p>
</section>
<section id="failing-polars-queries" class="level4">
<h4 class="anchored" data-anchor-id="failing-polars-queries">Failing Polars queries</h4>
<p>Queries 11, 13-17, and 20-22 fail for the Polars backend via Ibis dataframe code. These all fail due to lack of scalar subquery support in the backend. I’ve <a href="https://github.com/ibis-project/ibis/issues/9422">opened an issue</a> for tracking and discussion.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Interested in contributing?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interested in contributing?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Increasing coverage of operations for a backend is a great place to start!</p>
</div>
</div>
</section>
</section>
<section id="how-queries-are-written" class="level3">
<h3 class="anchored" data-anchor-id="how-queries-are-written">How queries are written</h3>
<p>See <a href="https://github.com/lostmygithubaccount/ibis-bench/tree/v2.0.0/src/ibis_bench/queries">the source code</a> for the exact queries used in this iteration of the benchmark. Polars recently updated their TPC-H queries, so the next iteration of this benchmark would use those.</p>
<p>Queries were adapted from <a href="https://github.com/ibis-project/ibis/tree/main/ibis/backends/tests/tpch">Ibis TPC-H queries</a> and <a href="https://github.com/pola-rs/tpch">Polars TPC-H queries</a>. The first 10 Ibis dataframe queries were translated from the Polars dataframe queries, while the rest were directly adapted from the Ibis repository. The SQL strings were adapted from the Ibis repository.</p>
</section>
<section id="how-queries-are-run" class="level3">
<h3 class="anchored" data-anchor-id="how-queries-are-run">How queries are run</h3>
<p>See <a href="https://github.com/lostmygithubaccount/ibis-bench/tree/v2.0.0">the source code</a> and <a href="https://ibis-bench.streamlit.app/methodology">methodology</a> for more details. In short:</p>
<ul>
<li>data is generated as a Parquet file per table
<ul>
<li>standard DuckDB Parquet writer is used</li>
<li>data is always downloaded onto a compute instance (no cloud storage reads)</li>
</ul></li>
<li>decimal types are converted to floats after reading
<ul>
<li>works around several issues</li>
<li>in the next iteration of this benchmark, we’ll use the <code>decimal</code> type</li>
</ul></li>
<li>each query is run three times per configuration (system, scale factor, instance type)</li>
<li>we measure the time to write the results of the query to a Parquet file
<ul>
<li>this includes reading the Parquet file(s) and executing the query</li>
</ul></li>
</ul>
</section>
<section id="biases" class="level3">
<h3 class="anchored" data-anchor-id="biases">Biases</h3>
<p>My name is Cody and I’m a Senior Technical Product Manager at <a href="https://voltrondata.com">Voltron Data</a>. I am a contributor to the Ibis project and employed to work on it – I’m biased in favor of Ibis and the composable data ecosystem.</p>
<p>Ibis is <a href="https://github.com/ibis-project/governance">an independently governed open source project</a> that <strong>is not owned by Voltron Data</strong>, though several steering committee members are employed by Voltron Data. You can <a href="../../posts/why-voda-supports-ibis/index.html">read more about why Voltron Data supports Ibis</a>, in addition to open source projects like <a href="https://github.com/apache/arrow">Apache Arrow</a> and <a href="https://github.com/substrait-io/substrait">Substrait</a>.</p>
<p>Voltron Data is a <a href="https://duckdb.org/foundation">Gold Supporter of the DuckDB Foundation</a> and <a href="https://duckdblabs.com">has a commercial relationship with DuckDB Labs</a> with regular syncs I tend to attend. I also use <a href="https://motherduck.com">MotherDuck</a> to host our <a href="https://ibis-analytics.streamlit.app">Ibis analytics dashboard data</a>.</p>
</section>
</section>
<section id="results-and-analysis" class="level2">
<h2 class="anchored" data-anchor-id="results-and-analysis">Results and analysis</h2>
<p>We’ll use Ibis to analyze some of the benchmarking data.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll only look at a small subset of the data in this post.</p>
<p>All the data is public, so you can follow along with the code and explore the data yourself. You can also see the <a href="https://ibis-bench.streamlit.app">Ibis benchmarking Streamlit app</a> for further analysis.</p>
</div>
</div>
<section id="reading-the-data" class="level3">
<h3 class="anchored" data-anchor-id="reading-the-data">Reading the data</h3>
<p>To follow along, install the required Python packages:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install gcsfs <span class="st">'ibis-framework[duckdb]'</span> plotly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The data is stored in a public Google Cloud Storage (GCS) bucket:</p>
<div id="c340210d" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1">1</button><span id="annotated-cell-2-1" class="code-annotation-target"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="annotated-cell-2-2"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gcsfs</span>
<span id="annotated-cell-2-3"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2">2</button><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a>BUCKET <span class="op">=</span> <span class="st">"ibis-bench"</span></span>
<span id="annotated-cell-2-5"><a href="#annotated-cell-2-5" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="3">3</button><span id="annotated-cell-2-6" class="code-annotation-target"><a href="#annotated-cell-2-6" aria-hidden="true" tabindex="-1"></a>dir_name <span class="op">=</span> os.path.join(BUCKET, <span class="st">"bench_logs_v2"</span>, <span class="st">"cache"</span>)</span>
<span id="annotated-cell-2-7"><a href="#annotated-cell-2-7" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="4">4</button><span id="annotated-cell-2-8" class="code-annotation-target"><a href="#annotated-cell-2-8" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> gcsfs.GCSFileSystem()</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="5">5</button><span id="annotated-cell-2-9" class="code-annotation-target"><a href="#annotated-cell-2-9" aria-hidden="true" tabindex="-1"></a>fs.ls(dir_name)[<span class="op">-</span><span class="dv">5</span>:]</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="1,2" data-code-annotation="1">Imports</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="4" data-code-annotation="2">The public GCS bucket name</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="6" data-code-annotation="3">The directory in the bucket where the data is stored</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="8" data-code-annotation="4">Create a GCS filesystem object</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="9" data-code-annotation="5">List the last 5 files in the directory</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>['ibis-bench/bench_logs_v2/cache/file_id=b6236086-7fff-4569-8731-b97a635243bd.parquet',
 'ibis-bench/bench_logs_v2/cache/file_id=cbc0c7b1-e659-4adb-8c80-4077cd4d39ab.parquet',
 'ibis-bench/bench_logs_v2/cache/file_id=d91454ad-2ddd-408a-bbfd-6b159dd2132b.parquet',
 'ibis-bench/bench_logs_v2/cache/file_id=debc7203-f366-44d2-94f1-2518e6f7425f.parquet',
 'ibis-bench/bench_logs_v2/cache/file_id=e875d852-f7e7-473c-9440-92b8f2445f3a.parquet']</code></pre>
</div>
</div>
<p>To start exploring the data, let’s import Ibis and Plotly, set some options, and register the GCS filesystem with the default (DuckDB) backend:</p>
<div id="d19e0ac4" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1">1</button><span id="annotated-cell-3-1" class="code-annotation-target"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ibis</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2">2</button><span id="annotated-cell-3-2" class="code-annotation-target"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="annotated-cell-3-3"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="3">3</button><span id="annotated-cell-3-4" class="code-annotation-target"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a>px.defaults.template <span class="op">=</span> <span class="st">"plotly_dark"</span></span>
<span id="annotated-cell-3-5"><a href="#annotated-cell-3-5" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="4">4</button><span id="annotated-cell-3-6" class="code-annotation-target"><a href="#annotated-cell-3-6" aria-hidden="true" tabindex="-1"></a>ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="5">5</button><span id="annotated-cell-3-7" class="code-annotation-target"><a href="#annotated-cell-3-7" aria-hidden="true" tabindex="-1"></a>ibis.options.<span class="bu">repr</span>.interactive.max_rows <span class="op">=</span> <span class="dv">22</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="6">6</button><span id="annotated-cell-3-8" class="code-annotation-target"><a href="#annotated-cell-3-8" aria-hidden="true" tabindex="-1"></a>ibis.options.<span class="bu">repr</span>.interactive.max_length <span class="op">=</span> <span class="dv">22</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="7">7</button><span id="annotated-cell-3-9" class="code-annotation-target"><a href="#annotated-cell-3-9" aria-hidden="true" tabindex="-1"></a>ibis.options.<span class="bu">repr</span>.interactive.max_columns <span class="op">=</span> <span class="va">None</span></span>
<span id="annotated-cell-3-10"><a href="#annotated-cell-3-10" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="8">8</button><span id="annotated-cell-3-11" class="code-annotation-target"><a href="#annotated-cell-3-11" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> ibis.get_backend()</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="9">9</button><span id="annotated-cell-3-12" class="code-annotation-target"><a href="#annotated-cell-3-12" aria-hidden="true" tabindex="-1"></a>con.register_filesystem(fs)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="1" data-code-annotation="1">Import Ibis</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="2" data-code-annotation="2">Import Plotly</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="4" data-code-annotation="3">Set the Plotly template to dark</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="6" data-code-annotation="4">Enable interactive mode for Ibis</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="7" data-code-annotation="5">Set the maximum number of rows to display in interactive mode</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="8" data-code-annotation="6">Set the maximum length of nested types to display in interactive mode</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="9" data-code-annotation="7">Set the maximum number of columns to display in interactive mode</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="11" data-code-annotation="8">Get the default (DuckDB) backend</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="12" data-code-annotation="9">Register the GCS filesystem with the default backend</span>
</dd>
</dl>
</div>
</div>
<p>Now read the data and take a look at the first few rows:</p>
<div id="a7724589" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-1" class="code-annotation-target"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> (</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a>    ibis.read_parquet(<span class="ss">f"gs://</span><span class="sc">{</span>dir_name<span class="sc">}</span><span class="ss">/file_id=*.parquet"</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="3">3</button><span id="annotated-cell-4-3" class="code-annotation-target"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a>    .mutate(</span>
<span id="annotated-cell-4-4"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a>        timestamp<span class="op">=</span>ibis._[<span class="st">"timestamp"</span>].cast(<span class="st">"timestamp"</span>),</span>
<span id="annotated-cell-4-5"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="4">4</button><span id="annotated-cell-4-6" class="code-annotation-target"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a>    .relocate(</span>
<span id="annotated-cell-4-7"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"instance_type"</span>,</span>
<span id="annotated-cell-4-8"><a href="#annotated-cell-4-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"system"</span>,</span>
<span id="annotated-cell-4-9"><a href="#annotated-cell-4-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"sf"</span>,</span>
<span id="annotated-cell-4-10"><a href="#annotated-cell-4-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"query_number"</span>,</span>
<span id="annotated-cell-4-11"><a href="#annotated-cell-4-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"execution_seconds"</span>,</span>
<span id="annotated-cell-4-12"><a href="#annotated-cell-4-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"timestamp"</span>,</span>
<span id="annotated-cell-4-13"><a href="#annotated-cell-4-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="5">5</button><span id="annotated-cell-4-14" class="code-annotation-target"><a href="#annotated-cell-4-14" aria-hidden="true" tabindex="-1"></a>    .cache()</span>
<span id="annotated-cell-4-15"><a href="#annotated-cell-4-15" aria-hidden="true" tabindex="-1"></a>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="6">6</button><span id="annotated-cell-4-16" class="code-annotation-target"><a href="#annotated-cell-4-16" aria-hidden="true" tabindex="-1"></a>t.head()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="1" data-code-annotation="1">Assign the table to a variable</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="2">Read the Parquet files from GCS</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="3,5" data-code-annotation="3">Cast the <code>timestamp</code> column to a timestamp type</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="6,13" data-code-annotation="4">Reorder the columns</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="14" data-code-annotation="5">Cache the table to avoid re-reading cloud data</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="16" data-code-annotation="6">Display the first few rows</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> instance_type </span>┃<span style="font-weight: bold"> system          </span>┃<span style="font-weight: bold"> sf    </span>┃<span style="font-weight: bold"> query_number </span>┃<span style="font-weight: bold"> execution_seconds </span>┃<span style="font-weight: bold"> timestamp                  </span>┃<span style="font-weight: bold"> session_id                           </span>┃<span style="font-weight: bold"> n_partitions </span>┃<span style="font-weight: bold"> file_type </span>┃<span style="font-weight: bold"> file_id                                      </span>┃
┡━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(6)</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">uuid</span>                                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                                       │
├───────────────┼─────────────────┼───────┼──────────────┼───────────────────┼────────────────────────────┼──────────────────────────────────────┼──────────────┼───────────┼──────────────────────────────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-4</span> │ <span style="color: #008000; text-decoration-color: #008000">polars-lazy    </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">128</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.503613</span> │ <span style="color: #800080; text-decoration-color: #800080">2024-06-10 08:04:31.233704</span> │ 6708e5d3-2b8c-4ce0-adf8-65ce94e0bff1 │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">parquet  </span> │ <span style="color: #008000; text-decoration-color: #008000">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-4</span> │ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb    </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.826295</span> │ <span style="color: #800080; text-decoration-color: #800080">2024-06-10 21:05:18.423375</span> │ 9a00385f-22b4-42df-ab3d-c63ed1a33a2e │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">parquet  </span> │ <span style="color: #008000; text-decoration-color: #008000">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-4</span> │ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb    </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">128</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.376196</span> │ <span style="color: #800080; text-decoration-color: #800080">2024-06-11 03:44:22.901852</span> │ acb56c6b-b0d5-4bbc-8791-3542b62bd193 │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">parquet  </span> │ <span style="color: #008000; text-decoration-color: #008000">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-4</span> │ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.655290</span> │ <span style="color: #800080; text-decoration-color: #800080">2024-06-09 20:29:31.833510</span> │ a07fe07d-7a08-4802-b8ae-918e66e2d868 │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">parquet  </span> │ <span style="color: #008000; text-decoration-color: #008000">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-4</span> │ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb-sql</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.447325</span> │ <span style="color: #800080; text-decoration-color: #800080">2024-06-10 08:11:31.244609</span> │ d523eec6-d2de-491d-b541-348c6b5bfc65 │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">parquet  </span> │ <span style="color: #008000; text-decoration-color: #008000">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │
└───────────────┴─────────────────┴───────┴──────────────┴───────────────────┴────────────────────────────┴──────────────────────────────────────┴──────────────┴───────────┴──────────────────────────────────────────────┘
</pre>
</div>
</div>
<p>We’ll also create a table with details on each instance type including the CPU type, number of cores, and memory in gigabytes:</p>
<div id="0ac835d9" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Show code to get instance details</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>cpu_type_cases <span class="op">=</span> (</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    ibis.case()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    .when(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"instance_type"</span>].startswith(<span class="st">"n2d"</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"AMD EPYC"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    .when(</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"instance_type"</span>].startswith(<span class="st">"n2"</span>),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Intel Cascade and Ice Lake"</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    .when(</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"instance_type"</span>].startswith(<span class="st">"c3"</span>),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Intel Sapphire Rapids"</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    .when(</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"instance_type"</span>] <span class="op">==</span> <span class="st">"work laptop"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Apple M1 Max"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    .when(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"instance_type"</span>] <span class="op">==</span> <span class="st">"personal laptop"</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Apple M2 Max"</span>,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    .else_(<span class="st">"unknown"</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    .end()</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>cpu_num_cases <span class="op">=</span> (</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    ibis.case()</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    .when(</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"instance_type"</span>].contains(<span class="st">"-"</span>),</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"instance_type"</span>].split(<span class="st">"-"</span>)[<span class="op">-</span><span class="dv">1</span>].cast(<span class="st">"int"</span>),</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    .when(ibis._[<span class="st">"instance_type"</span>].contains(<span class="st">"laptop"</span>), <span class="dv">12</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    .else_(<span class="dv">0</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    .end()</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>memory_gb_cases <span class="op">=</span> (</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    ibis.case()</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    .when(</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"instance_type"</span>].contains(<span class="st">"-"</span>),</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"instance_type"</span>].split(<span class="st">"-"</span>)[<span class="op">-</span><span class="dv">1</span>].cast(<span class="st">"int"</span>) <span class="op">*</span> <span class="dv">4</span>,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    .when(ibis._[<span class="st">"instance_type"</span>] <span class="op">==</span> <span class="st">"work laptop"</span>, <span class="dv">32</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    .when(ibis._[<span class="st">"instance_type"</span>] <span class="op">==</span> <span class="st">"personal laptop"</span>, <span class="dv">96</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    .else_(<span class="dv">0</span>)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    .end()</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>instance_details <span class="op">=</span> (</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    t.group_by(<span class="st">"instance_type"</span>)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    .agg()</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    .mutate(</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        cpu_type<span class="op">=</span>cpu_type_cases, cpu_cores<span class="op">=</span>cpu_num_cases, memory_gbs<span class="op">=</span>memory_gb_cases</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>).order_by(<span class="st">"memory_gbs"</span>, <span class="st">"cpu_cores"</span>, <span class="st">"instance_type"</span>)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>cpu_types <span class="op">=</span> <span class="bu">sorted</span>(</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    instance_details.distinct(on<span class="op">=</span><span class="st">"cpu_type"</span>)[<span class="st">"cpu_type"</span>].to_pyarrow().to_pylist()</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>instance_details</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> instance_type   </span>┃<span style="font-weight: bold"> cpu_type                   </span>┃<span style="font-weight: bold"> cpu_cores </span>┃<span style="font-weight: bold"> memory_gbs </span>┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │
├─────────────────┼────────────────────────────┼───────────┼────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-2  </span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Cascade and Ice Lake</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2d-standard-2 </span> │ <span style="color: #008000; text-decoration-color: #008000">AMD EPYC                  </span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │
│ <span style="color: #008000; text-decoration-color: #008000">c3-standard-4  </span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Sapphire Rapids     </span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-4  </span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Cascade and Ice Lake</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2d-standard-4 </span> │ <span style="color: #008000; text-decoration-color: #008000">AMD EPYC                  </span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
│ <span style="color: #008000; text-decoration-color: #008000">c3-standard-8  </span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Sapphire Rapids     </span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-8  </span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Cascade and Ice Lake</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2d-standard-8 </span> │ <span style="color: #008000; text-decoration-color: #008000">AMD EPYC                  </span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span> │
│ <span style="color: #008000; text-decoration-color: #008000">work laptop    </span> │ <span style="color: #008000; text-decoration-color: #008000">Apple M1 Max              </span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-16 </span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Cascade and Ice Lake</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2d-standard-16</span> │ <span style="color: #008000; text-decoration-color: #008000">AMD EPYC                  </span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span> │
│ <span style="color: #008000; text-decoration-color: #008000">c3-standard-22 </span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Sapphire Rapids     </span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">88</span> │
│ <span style="color: #008000; text-decoration-color: #008000">personal laptop</span> │ <span style="color: #008000; text-decoration-color: #008000">Apple M2 Max              </span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-32 </span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Cascade and Ice Lake</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">128</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2d-standard-32</span> │ <span style="color: #008000; text-decoration-color: #008000">AMD EPYC                  </span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">128</span> │
│ <span style="color: #008000; text-decoration-color: #008000">c3-standard-44 </span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Sapphire Rapids     </span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">176</span> │
└─────────────────┴────────────────────────────┴───────────┴────────────┘
</pre>
</div>
</div>
</section>
<section id="whats-in-the-data" class="level3">
<h3 class="anchored" data-anchor-id="whats-in-the-data">What’s in the data?</h3>
<p>With the data, we can see we ran the benchmark on scale factors:</p>
<div id="08b389fe" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sfs <span class="op">=</span> <span class="bu">sorted</span>(t.distinct(on<span class="op">=</span><span class="st">"sf"</span>)[<span class="st">"sf"</span>].to_pyarrow().to_pylist())</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sfs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>[1, 8, 16, 32, 64, 128]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="What is a scale factor?">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is a scale factor?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A scale factor is roughly the size of the data in memory in gigabytes. For example, a scale factor of 1 means the data is roughly 1GB in memory.</p>
<p>Stored on disk in (compressed) Parquet format, the data is smaller – about 0.38GB for scale factor 1 with the compression settings used in this benchmark.</p>
</div>
</div>
</div>
<p>We can look at the total execution time by scale factor:</p>
<div id="f6efea9d" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Show bar plot code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> px.bar(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    t.group_by(<span class="st">"sf"</span>).agg(total_seconds<span class="op">=</span>t[<span class="st">"execution_seconds"</span>].<span class="bu">sum</span>()),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"sf"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"total_seconds"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    category_orders<span class="op">=</span>{<span class="st">"sf"</span>: sfs},</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"total execution time by scale factor"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="288d4514-11ea-4463-b6e6-b5a381a37841" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("288d4514-11ea-4463-b6e6-b5a381a37841")) {                    Plotly.newPlot(                        "288d4514-11ea-4463-b6e6-b5a381a37841",                        [{"alignmentgroup":"True","hovertemplate":"sf=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","offsetgroup":"","orientation":"v","showlegend":false,"textposition":"auto","x":[1,8,16,32,64,128],"xaxis":"x","y":[1600.579779624939,10426.681049823761,19846.17095041275,38021.40961122513,74784.94995188713,164025.98512744904],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"sf"},"categoryorder":"array","categoryarray":[1,8,16,32,64,128]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"total_seconds"}},"legend":{"tracegroupgap":0},"title":{"text":"total execution time by scale factor"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('288d4514-11ea-4463-b6e6-b5a381a37841');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>You can see this is roughly linear as expected.</p>
<p>We ran on the following queries:</p>
<div id="030280cb" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>query_numbers <span class="op">=</span> <span class="bu">sorted</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    t.distinct(on<span class="op">=</span><span class="st">"query_number"</span>)[<span class="st">"query_number"</span>].to_pyarrow().to_pylist()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>query_numbers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="What is a query number?">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is a query number?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The TPC-H benchmark defines 22 queries. See the <a href="https://www.tpc.org/TPC_Documents_Current_Versions/pdf/TPC-H_v3.0.1.pdf">TPC-H benchmark specification</a> for more information.</p>
</div>
</div>
</div>
<p>We can look at the total execution time by query number:</p>
<div id="4d9d3cb4" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Show bar plot code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> px.bar(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    t.group_by(<span class="st">"query_number"</span>).agg(total_seconds<span class="op">=</span>t[<span class="st">"execution_seconds"</span>].<span class="bu">sum</span>()),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"query_number"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"total_seconds"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    category_orders<span class="op">=</span>{<span class="st">"query_number"</span>: query_numbers},</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"total execution time by query number"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="f349a1b0-78b1-4527-aed6-d30e3c80003d" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f349a1b0-78b1-4527-aed6-d30e3c80003d")) {                    Plotly.newPlot(                        "f349a1b0-78b1-4527-aed6-d30e3c80003d",                        [{"alignmentgroup":"True","hovertemplate":"query_number=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","offsetgroup":"","orientation":"v","showlegend":false,"textposition":"auto","x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],"xaxis":"x","y":[21056.510046720505,3685.074945449829,12819.760807991028,8480.374274730682,11834.102046251297,10688.606204509735,18887.29731631279,14052.494454860687,22051.161331176758,15887.331687450409,2990.691949367523,12739.110704421997,11047.851179599762,10706.916375398636,15876.686168670654,1247.1440830230713,18959.44294857979,37246.088896751404,18845.170838832855,12007.838083028793,25422.41154885292,2173.71057844162],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"query_number"},"categoryorder":"array","categoryarray":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"total_seconds"}},"legend":{"tracegroupgap":0},"title":{"text":"total execution time by query number"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f349a1b0-78b1-4527-aed6-d30e3c80003d');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>This gives us a sense of the relative complexity of the queries.</p>
<p>We ran on the following instance types:</p>
<div id="9329b1d8" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="annotated-cell-10"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1" aria-hidden="true" tabindex="-1"></a>instance_types <span class="op">=</span> <span class="bu">sorted</span>(</span>
<span id="annotated-cell-10-2"><a href="#annotated-cell-10-2" aria-hidden="true" tabindex="-1"></a>    t.distinct(on<span class="op">=</span><span class="st">"instance_type"</span>)[<span class="st">"instance_type"</span>].to_pyarrow().to_pylist(),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="1">1</button><span id="annotated-cell-10-3" class="code-annotation-target"><a href="#annotated-cell-10-3" aria-hidden="true" tabindex="-1"></a>    key<span class="op">=</span><span class="kw">lambda</span> x: (x.split(<span class="st">"-"</span>)[<span class="dv">0</span>], <span class="bu">int</span>(x.split(<span class="st">"-"</span>)[<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="annotated-cell-10-4"><a href="#annotated-cell-10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"-"</span> <span class="kw">in</span> x</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="2">2</button><span id="annotated-cell-10-5" class="code-annotation-target"><a href="#annotated-cell-10-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> (<span class="st">"z"</span> <span class="op">+</span> x[<span class="dv">3</span>], <span class="dv">0</span>),</span>
<span id="annotated-cell-10-6"><a href="#annotated-cell-10-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="annotated-cell-10-7"><a href="#annotated-cell-10-7" aria-hidden="true" tabindex="-1"></a>instance_types</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="3,4" data-code-annotation="1">This is to sort the instance types by CPU architecture and number of cores</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="5" data-code-annotation="2">This is to sort “personal laptop” after “work laptop”</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>['c3-standard-4',
 'c3-standard-8',
 'c3-standard-22',
 'c3-standard-44',
 'n2-standard-2',
 'n2-standard-4',
 'n2-standard-8',
 'n2-standard-16',
 'n2-standard-32',
 'n2d-standard-2',
 'n2d-standard-4',
 'n2d-standard-8',
 'n2d-standard-16',
 'n2d-standard-32',
 'work laptop',
 'personal laptop']</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="What is an instance type?">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is an instance type?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>An instance type is the compute the benchmark was run on. This consists of two MacBook Pro laptops (one work and one personal) and a number of Google Cloud Compute Engine instances.</p>
<p>For cloud VMs, the instance type is in the form of <code>&lt;family&gt;-&lt;type&gt;-&lt;cores&gt;</code>, where:</p>
<ul>
<li><code>&lt;family&gt;</code> specifies the CPU architecture (Intel X, AMD Y)</li>
<li><code>&lt;type&gt;</code> modifies the CPU to memory ratio (only <code>standard</code> is used with a 1:4)</li>
<li><code>&lt;cores&gt;</code> is the number of vCPUs</li>
</ul>
<p>For example, <code>n2d-standard-2</code> is a Google Cloud Compute Engine instance with an AMD EPYC processor, 2 vCPUs, and 8GB of memory.</p>
</div>
</div>
</div>
<p>We can look at the total execution time by instance type:</p>
<div id="6e4b3589" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Show bar plot code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> px.bar(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    t.group_by(<span class="st">"instance_type"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    .agg(total_seconds<span class="op">=</span>t[<span class="st">"execution_seconds"</span>].<span class="bu">sum</span>())</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    .join(instance_details, <span class="st">"instance_type"</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"instance_type"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"total_seconds"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"cpu_type"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    hover_data<span class="op">=</span>[<span class="st">"cpu_cores"</span>, <span class="st">"memory_gbs"</span>],</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    category_orders<span class="op">=</span>{</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"instance_type"</span>: instance_types,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cpu_type"</span>: cpu_types,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"total execution time by instance type"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="d244475b-f426-4489-bcd5-5f7039a9a060" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d244475b-f426-4489-bcd5-5f7039a9a060")) {                    Plotly.newPlot(                        "d244475b-f426-4489-bcd5-5f7039a9a060",                        [{"alignmentgroup":"True","customdata":[[8,32],[16,64],[32,128],[2,8],[4,16]],"hovertemplate":"cpu_type=AMD EPYC\u003cbr\u003einstance_type=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cbr\u003ememory_gbs=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"AMD EPYC","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"AMD EPYC","offsetgroup":"AMD EPYC","orientation":"v","showlegend":true,"textposition":"auto","x":["n2d-standard-8","n2d-standard-16","n2d-standard-32","n2d-standard-2","n2d-standard-4"],"xaxis":"x","y":[12713.746816158295,8826.589931488037,7692.161742925644,44865.29464507103,27287.013442993164],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[12,32]],"hovertemplate":"cpu_type=Apple M1 Max\u003cbr\u003einstance_type=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cbr\u003ememory_gbs=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Apple M1 Max","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"Apple M1 Max","offsetgroup":"Apple M1 Max","orientation":"v","showlegend":true,"textposition":"auto","x":["work laptop"],"xaxis":"x","y":[18826.837838172913],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[12,96]],"hovertemplate":"cpu_type=Apple M2 Max\u003cbr\u003einstance_type=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cbr\u003ememory_gbs=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Apple M2 Max","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"Apple M2 Max","offsetgroup":"Apple M2 Max","orientation":"v","showlegend":true,"textposition":"auto","x":["personal laptop"],"xaxis":"x","y":[7762.792654275894],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[8,32],[16,64],[32,128],[2,8],[4,16]],"hovertemplate":"cpu_type=Intel Cascade and Ice Lake\u003cbr\u003einstance_type=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cbr\u003ememory_gbs=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Intel Cascade and Ice Lake","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"Intel Cascade and Ice Lake","offsetgroup":"Intel Cascade and Ice Lake","orientation":"v","showlegend":true,"textposition":"auto","x":["n2-standard-8","n2-standard-16","n2-standard-32","n2-standard-2","n2-standard-4"],"xaxis":"x","y":[16631.65527653694,11164.923608541489,9977.536410570145,54309.10380792618,32758.409986257553],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[22,88],[44,176],[4,16],[8,32]],"hovertemplate":"cpu_type=Intel Sapphire Rapids\u003cbr\u003einstance_type=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cbr\u003ememory_gbs=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Intel Sapphire Rapids","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"Intel Sapphire Rapids","offsetgroup":"Intel Sapphire Rapids","orientation":"v","showlegend":true,"textposition":"auto","x":["c3-standard-22","c3-standard-44","c3-standard-4","c3-standard-8"],"xaxis":"x","y":[7200.489403009415,6403.986677646637,26386.615517616272,15898.618711233139],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"instance_type"},"categoryorder":"array","categoryarray":["c3-standard-4","c3-standard-8","c3-standard-22","c3-standard-44","n2-standard-2","n2-standard-4","n2-standard-8","n2-standard-16","n2-standard-32","n2d-standard-2","n2d-standard-4","n2d-standard-8","n2d-standard-16","n2d-standard-32","work laptop","personal laptop"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"total_seconds"}},"legend":{"title":{"text":"cpu_type"},"tracegroupgap":0},"title":{"text":"total execution time by instance type"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d244475b-f426-4489-bcd5-5f7039a9a060');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Unsurprisingly, this is inversely correlated with the number of CPU cores and (crucially) memory:</p>
<div id="3ce1f8a5" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Show bar plot code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> px.bar(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    instance_details,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"instance_type"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"memory_gbs"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"cpu_type"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    hover_data<span class="op">=</span>[<span class="st">"cpu_cores"</span>, <span class="st">"memory_gbs"</span>],</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    category_orders<span class="op">=</span>{</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"instance_type"</span>: instance_types,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cpu_type"</span>: cpu_types,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"memory by instance type"</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="24f0519b-1c8a-44ff-9ecb-a14d0d0869fe" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("24f0519b-1c8a-44ff-9ecb-a14d0d0869fe")) {                    Plotly.newPlot(                        "24f0519b-1c8a-44ff-9ecb-a14d0d0869fe",                        [{"alignmentgroup":"True","customdata":[[2],[4],[8],[16],[32]],"hovertemplate":"cpu_type=AMD EPYC\u003cbr\u003einstance_type=%{x}\u003cbr\u003ememory_gbs=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"AMD EPYC","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"AMD EPYC","offsetgroup":"AMD EPYC","orientation":"v","showlegend":true,"textposition":"auto","x":["n2d-standard-2","n2d-standard-4","n2d-standard-8","n2d-standard-16","n2d-standard-32"],"xaxis":"x","y":[8,16,32,64,128],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[12]],"hovertemplate":"cpu_type=Apple M1 Max\u003cbr\u003einstance_type=%{x}\u003cbr\u003ememory_gbs=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Apple M1 Max","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"Apple M1 Max","offsetgroup":"Apple M1 Max","orientation":"v","showlegend":true,"textposition":"auto","x":["work laptop"],"xaxis":"x","y":[32],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[12]],"hovertemplate":"cpu_type=Apple M2 Max\u003cbr\u003einstance_type=%{x}\u003cbr\u003ememory_gbs=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Apple M2 Max","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"Apple M2 Max","offsetgroup":"Apple M2 Max","orientation":"v","showlegend":true,"textposition":"auto","x":["personal laptop"],"xaxis":"x","y":[96],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[2],[4],[8],[16],[32]],"hovertemplate":"cpu_type=Intel Cascade and Ice Lake\u003cbr\u003einstance_type=%{x}\u003cbr\u003ememory_gbs=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Intel Cascade and Ice Lake","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"Intel Cascade and Ice Lake","offsetgroup":"Intel Cascade and Ice Lake","orientation":"v","showlegend":true,"textposition":"auto","x":["n2-standard-2","n2-standard-4","n2-standard-8","n2-standard-16","n2-standard-32"],"xaxis":"x","y":[8,16,32,64,128],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[4],[8],[22],[44]],"hovertemplate":"cpu_type=Intel Sapphire Rapids\u003cbr\u003einstance_type=%{x}\u003cbr\u003ememory_gbs=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Intel Sapphire Rapids","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"Intel Sapphire Rapids","offsetgroup":"Intel Sapphire Rapids","orientation":"v","showlegend":true,"textposition":"auto","x":["c3-standard-4","c3-standard-8","c3-standard-22","c3-standard-44"],"xaxis":"x","y":[16,32,88,176],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"instance_type"},"categoryorder":"array","categoryarray":["c3-standard-4","c3-standard-8","c3-standard-22","c3-standard-44","n2-standard-2","n2-standard-4","n2-standard-8","n2-standard-16","n2-standard-32","n2d-standard-2","n2d-standard-4","n2d-standard-8","n2d-standard-16","n2d-standard-32","work laptop","personal laptop"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"memory_gbs"}},"legend":{"title":{"text":"cpu_type"},"tracegroupgap":0},"title":{"text":"memory by instance type"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('24f0519b-1c8a-44ff-9ecb-a14d0d0869fe');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>We ran on the following systems:</p>
<div id="44a6d0d4" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>systems <span class="op">=</span> <span class="bu">sorted</span>(t.distinct(on<span class="op">=</span><span class="st">"system"</span>)[<span class="st">"system"</span>].to_pyarrow().to_pylist())</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>systems</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>['ibis-datafusion',
 'ibis-datafusion-sql',
 'ibis-duckdb',
 'ibis-duckdb-sql',
 'ibis-polars',
 'polars-lazy']</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="What is a system?">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is a system?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For convenience in this benchmark, a ‘system’ is defined as a hyphen-separated naming convention where:</p>
<ul>
<li><code>ibis-*</code>: Ibis API was used
<ul>
<li><code>ibis-&lt;backend&gt;</code>: Ibis dataframe code was used with the given backend</li>
<li><code>ibis-&lt;backend&gt;-sql</code>: SQL code was used via Ibis on the given backend</li>
</ul></li>
<li><code>polars-*</code>: Polars API was used
<ul>
<li><code>polars-lazy</code>: Polars was used with the LazyFrames API</li>
</ul></li>
</ul>
</div>
</div>
</div>
<p>We can look at the total execution time by system:</p>
<div id="bc71358f" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Show bar plot code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> px.bar(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    t.group_by(<span class="st">"system"</span>).agg(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        total_seconds<span class="op">=</span>t[<span class="st">"execution_seconds"</span>].<span class="bu">sum</span>(),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        seconds_per_query<span class="op">=</span>t[<span class="st">"execution_seconds"</span>].mean(),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"system"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"total_seconds"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"system"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    category_orders<span class="op">=</span>{<span class="st">"system"</span>: systems},</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"total execution time by system"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="e780956d-98e3-4574-bb8a-8a7984ac620d" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e780956d-98e3-4574-bb8a-8a7984ac620d")) {                    Plotly.newPlot(                        "e780956d-98e3-4574-bb8a-8a7984ac620d",                        [{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"ibis-datafusion","offsetgroup":"ibis-datafusion","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-datafusion"],"xaxis":"x","y":[58838.82606935501],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion-sql","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"ibis-datafusion-sql","offsetgroup":"ibis-datafusion-sql","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-datafusion-sql"],"xaxis":"x","y":[60297.199028253555],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"ibis-duckdb","offsetgroup":"ibis-duckdb","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-duckdb"],"xaxis":"x","y":[57484.52195310593],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"ibis-duckdb-sql","offsetgroup":"ibis-duckdb-sql","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-duckdb-sql"],"xaxis":"x","y":[57534.97966146469],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"ibis-polars","offsetgroup":"ibis-polars","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-polars"],"xaxis":"x","y":[30922.509821414948],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003etotal_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"polars-lazy","offsetgroup":"polars-lazy","orientation":"v","showlegend":true,"textposition":"auto","x":["polars-lazy"],"xaxis":"x","y":[43627.73993682861],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"system"},"categoryorder":"array","categoryarray":["ibis-datafusion","ibis-datafusion-sql","ibis-duckdb","ibis-duckdb-sql","ibis-polars","polars-lazy"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"total_seconds"}},"legend":{"title":{"text":"system"},"tracegroupgap":0},"title":{"text":"total execution time by system"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e780956d-98e3-4574-bb8a-8a7984ac620d');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="This can be misleading!">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
This can be misleading!
</div>
</div>
<div class="callout-body-container callout-body">
<p>At this point, we have to dig deeper into the data to understand the takeaways. You might look at the above and think <code>ibis-polars</code> is the fastest all-around, but it’s not! Recall <a href="#failing-polars-queries">9/22 queries for the Polars backend are failing</a>, and at larger scale factors we start to see several systems fail queries due to memory pressure.</p>
</div>
</div>
</section>
<section id="execution-time-by-system-scale-factor-instance-type-and-query" class="level3">
<h3 class="anchored" data-anchor-id="execution-time-by-system-scale-factor-instance-type-and-query">Execution time by system, scale factor, instance type, and query</h3>
<p>We’ll aggregate the data over the dimensions we care about:</p>
<div id="fd4c21d3" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>agg <span class="op">=</span> (</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    t.group_by(<span class="st">"instance_type"</span>, <span class="st">"system"</span>, <span class="st">"sf"</span>, <span class="st">"n_partitions"</span>, <span class="st">"query_number"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        mean_execution_seconds<span class="op">=</span>t[<span class="st">"execution_seconds"</span>].mean(),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    .join(instance_details, <span class="st">"instance_type"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>agg.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> instance_type </span>┃<span style="font-weight: bold"> system              </span>┃<span style="font-weight: bold"> sf    </span>┃<span style="font-weight: bold"> n_partitions </span>┃<span style="font-weight: bold"> query_number </span>┃<span style="font-weight: bold"> mean_execution_seconds </span>┃<span style="font-weight: bold"> cpu_type                   </span>┃<span style="font-weight: bold"> cpu_cores </span>┃<span style="font-weight: bold"> memory_gbs </span>┃
┡━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │
├───────────────┼─────────────────────┼───────┼──────────────┼──────────────┼────────────────────────┼────────────────────────────┼───────────┼────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-4</span> │ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb-sql    </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.730084</span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Cascade and Ice Lake</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-4</span> │ <span style="color: #008000; text-decoration-color: #008000">polars-lazy        </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.062605</span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Cascade and Ice Lake</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
│ <span style="color: #008000; text-decoration-color: #008000">n2-standard-4</span> │ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion-sql</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">128</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.188349</span> │ <span style="color: #008000; text-decoration-color: #008000">Intel Cascade and Ice Lake</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
└───────────────┴─────────────────────┴───────┴──────────────┴──────────────┴────────────────────────┴────────────────────────────┴───────────┴────────────┘
</pre>
</div>
</div>
<p>There’s a lot of data and it’s difficult to visualize all at once. We’ll build up our understanding with a few plots.</p>
<div id="3ac6b5b0" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Show code for timings_plot</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> timings_plot(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    agg,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    sf_filter<span class="op">=</span><span class="dv">128</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    systems_filter<span class="op">=</span>systems,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    instances_filter<span class="op">=</span>[instance <span class="cf">for</span> instance <span class="kw">in</span> instance_types <span class="cf">if</span> <span class="st">"laptop"</span> <span class="kw">in</span> instance],</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    queries_filter<span class="op">=</span>query_numbers,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    log_y<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> (</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        agg.<span class="bu">filter</span>(agg[<span class="st">"sf"</span>] <span class="op">==</span> sf_filter)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">filter</span>(agg[<span class="st">"system"</span>].isin(systems_filter))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">filter</span>(agg[<span class="st">"instance_type"</span>].isin(instances_filter))</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">filter</span>(agg[<span class="st">"query_number"</span>].isin(queries_filter))</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> px.bar(</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>        data,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"query_number"</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"mean_execution_seconds"</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        log_y<span class="op">=</span>log_y,</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"system"</span>,</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        barmode<span class="op">=</span><span class="st">"group"</span>,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>        pattern_shape<span class="op">=</span><span class="st">"instance_type"</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>        category_orders<span class="op">=</span>{</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">"system"</span>: systems,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">"instance_type"</span>: instance_types,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>        hover_data<span class="op">=</span>[<span class="st">"cpu_type"</span>, <span class="st">"cpu_cores"</span>, <span class="st">"memory_gbs"</span>],</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="ss">f"sf: </span><span class="sc">{</span>sf_filter<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>First, let’s visualize execution time for a given scale factor, system, query, and family of instance types:</p>
<div id="500bfedc" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sf_filter <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>systems_filter <span class="op">=</span> [<span class="st">"ibis-duckdb"</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>instances_filter <span class="op">=</span> [</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    instance <span class="cf">for</span> instance <span class="kw">in</span> instance_types <span class="cf">if</span> instance.startswith(<span class="st">"n2d"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>queries_filter <span class="op">=</span> [<span class="dv">1</span>]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>log_y <span class="op">=</span> <span class="va">False</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>timings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="5540e1a0-bf17-47f8-8632-3b60d79cdf8a" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5540e1a0-bf17-47f8-8632-3b60d79cdf8a")) {                    Plotly.newPlot(                        "5540e1a0-bf17-47f8-8632-3b60d79cdf8a",                        [{"alignmentgroup":"True","customdata":[["AMD EPYC",2,8]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-2\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-2","marker":{"color":"#00cc96","pattern":{"shape":"x"}},"name":"ibis-duckdb, n2d-standard-2","offsetgroup":"ibis-duckdb, n2d-standard-2","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[111.81634593009949],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",4,16]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-4\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-4","marker":{"color":"#00cc96","pattern":{"shape":"+"}},"name":"ibis-duckdb, n2d-standard-4","offsetgroup":"ibis-duckdb, n2d-standard-4","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[52.48048988978068],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",8,32]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-8\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-8","marker":{"color":"#00cc96","pattern":{"shape":"."}},"name":"ibis-duckdb, n2d-standard-8","offsetgroup":"ibis-duckdb, n2d-standard-8","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[23.785067558288574],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",16,64]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-16\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-16","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"ibis-duckdb, n2d-standard-16","offsetgroup":"ibis-duckdb, n2d-standard-16","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[11.582529067993164],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-32","marker":{"color":"#00cc96","pattern":{"shape":"\u002f"}},"name":"ibis-duckdb, n2d-standard-32","offsetgroup":"ibis-duckdb, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[5.938729286193848],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"query_number"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mean_execution_seconds"}},"legend":{"title":{"text":"system, instance_type"},"tracegroupgap":0},"title":{"text":"sf: 128"},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('5540e1a0-bf17-47f8-8632-3b60d79cdf8a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>From left to right, we have increasing instance resources (CPU cores and memory – you can hover over the data to see the details). You can also zoom and select specific labels to focus on. We notice that, as expected, queries execute faster when given more resources.</p>
<p>Now let’s add a second system:</p>
<div id="ada0fc97" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>systems_filter <span class="op">=</span> [<span class="st">"ibis-duckdb"</span>, <span class="st">"ibis-duckdb-sql"</span>]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>timings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="7e977938-be45-48df-add5-308d949629a6" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("7e977938-be45-48df-add5-308d949629a6")) {                    Plotly.newPlot(                        "7e977938-be45-48df-add5-308d949629a6",                        [{"alignmentgroup":"True","customdata":[["AMD EPYC",2,8]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-2\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-2","marker":{"color":"#00cc96","pattern":{"shape":"x"}},"name":"ibis-duckdb, n2d-standard-2","offsetgroup":"ibis-duckdb, n2d-standard-2","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[111.81634593009949],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",4,16]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-4\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-4","marker":{"color":"#00cc96","pattern":{"shape":"+"}},"name":"ibis-duckdb, n2d-standard-4","offsetgroup":"ibis-duckdb, n2d-standard-4","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[52.48048988978068],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",8,32]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-8\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-8","marker":{"color":"#00cc96","pattern":{"shape":"."}},"name":"ibis-duckdb, n2d-standard-8","offsetgroup":"ibis-duckdb, n2d-standard-8","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[23.785067558288574],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",16,64]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-16\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-16","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"ibis-duckdb, n2d-standard-16","offsetgroup":"ibis-duckdb, n2d-standard-16","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[11.582529067993164],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-32","marker":{"color":"#00cc96","pattern":{"shape":"\u002f"}},"name":"ibis-duckdb, n2d-standard-32","offsetgroup":"ibis-duckdb, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[5.938729286193848],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",2,8]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-2\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-2","marker":{"color":"#ab63fa","pattern":{"shape":"x"}},"name":"ibis-duckdb-sql, n2d-standard-2","offsetgroup":"ibis-duckdb-sql, n2d-standard-2","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[93.9455053806305],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",4,16]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-4\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-4","marker":{"color":"#ab63fa","pattern":{"shape":"+"}},"name":"ibis-duckdb-sql, n2d-standard-4","offsetgroup":"ibis-duckdb-sql, n2d-standard-4","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[50.23033595085144],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",8,32]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-8\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-8","marker":{"color":"#ab63fa","pattern":{"shape":"."}},"name":"ibis-duckdb-sql, n2d-standard-8","offsetgroup":"ibis-duckdb-sql, n2d-standard-8","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[20.659324566523235],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",16,64]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-16\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-16","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"ibis-duckdb-sql, n2d-standard-16","offsetgroup":"ibis-duckdb-sql, n2d-standard-16","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[9.83419426282247],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-32","marker":{"color":"#ab63fa","pattern":{"shape":"\u002f"}},"name":"ibis-duckdb-sql, n2d-standard-32","offsetgroup":"ibis-duckdb-sql, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[5.2171577612559],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"query_number"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mean_execution_seconds"}},"legend":{"title":{"text":"system, instance_type"},"tracegroupgap":0},"title":{"text":"sf: 128"},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('7e977938-be45-48df-add5-308d949629a6');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Ibis dataframe code vs Ibis SQL code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ibis dataframe code vs Ibis SQL code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>ibis-duckdb</code> is running the TPC-H queries written as Ibis dataframe code. The <code>ibis-duckdb-sql</code> system is running the same queries but written as SQL code passed into <code>.sql()</code> in Ibis as strings. The intent is to see if Ibis dataframe code is introducing any significant overhead. While ideally we’d run on the backend’s Python client without Ibis in the mix, this keeps the benchmarking process simple and should serve as a decent proxy.</p>
</div>
</div>
</div>
<p>In this case, we do see that Ibis dataframe code is adding some overhead. But, this is a single data point – let’s expand to the first 7 queries:</p>
<div class="callout callout-style-default callout-note callout-titled" title="Logging the y-axis">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Logging the y-axis
</div>
</div>
<div class="callout-body-container callout-body">
<p>From here, we’ll set <code>log_y=True</code> due to the wide range of execution times.</p>
<p>We also look at the first 7 queries due to limited horizontal space on this website. Analyze and visualize the data yourself for all 22 queries! Or <a href="https://ibis-bench.streamlit.app">see the Ibis benchmarking Streamlit app</a>.</p>
</div>
</div>
<div id="e6a2c602" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>log_y <span class="op">=</span> <span class="va">True</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>queries_filter <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">7</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>timings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="d9a828c8-e422-4272-b41f-75bb6dd64c2f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d9a828c8-e422-4272-b41f-75bb6dd64c2f")) {                    Plotly.newPlot(                        "d9a828c8-e422-4272-b41f-75bb6dd64c2f",                        [{"alignmentgroup":"True","customdata":[["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-2\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-2","marker":{"color":"#00cc96","pattern":{"shape":"x"}},"name":"ibis-duckdb, n2d-standard-2","offsetgroup":"ibis-duckdb, n2d-standard-2","orientation":"v","showlegend":true,"textposition":"auto","x":[6,1,5,7,4,3,2],"xaxis":"x","y":[49.7428944905599,111.81634593009949,79.99639010429382,167.6698002020518,53.14470879236857,76.22619962692261,9.01880407333374],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-4\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-4","marker":{"color":"#00cc96","pattern":{"shape":"+"}},"name":"ibis-duckdb, n2d-standard-4","offsetgroup":"ibis-duckdb, n2d-standard-4","orientation":"v","showlegend":true,"textposition":"auto","x":[3,1,6,7,4,5,2],"xaxis":"x","y":[57.629031817118324,52.48048988978068,45.321753899256386,82.24646361668904,29.308464288711548,53.63263535499573,6.6205854415893555],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-8\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-8","marker":{"color":"#00cc96","pattern":{"shape":"."}},"name":"ibis-duckdb, n2d-standard-8","offsetgroup":"ibis-duckdb, n2d-standard-8","orientation":"v","showlegend":true,"textposition":"auto","x":[7,4,5,1,6,2,3],"xaxis":"x","y":[26.38829843203227,9.234363794326782,13.609139839808146,23.785067558288574,8.34712823232015,1.9450260798136394,13.816275278727213],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-16\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-16","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"ibis-duckdb, n2d-standard-16","offsetgroup":"ibis-duckdb, n2d-standard-16","orientation":"v","showlegend":true,"textposition":"auto","x":[5,2,3,1,7,4,6],"xaxis":"x","y":[7.192176500956218,1.038861910502116,6.893320242563884,11.582529067993164,13.814172585805258,4.962450901667277,4.339909315109253],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-32","marker":{"color":"#00cc96","pattern":{"shape":"\u002f"}},"name":"ibis-duckdb, n2d-standard-32","offsetgroup":"ibis-duckdb, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[5,2,3,1,4,7,6],"xaxis":"x","y":[3.9903443654378257,0.6979877154032389,3.935547669728597,5.938729286193848,2.8200621604919434,7.479643742243449,2.341557025909424],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-2\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-2","marker":{"color":"#ab63fa","pattern":{"shape":"x"}},"name":"ibis-duckdb-sql, n2d-standard-2","offsetgroup":"ibis-duckdb-sql, n2d-standard-2","orientation":"v","showlegend":true,"textposition":"auto","x":[1,3,2,5,6,7,4],"xaxis":"x","y":[93.9455053806305,73.71186025937398,15.153176069259644,74.46631360054016,55.65792457262675,269.1292410691579,55.44052871068319],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-4\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-4","marker":{"color":"#ab63fa","pattern":{"shape":"+"}},"name":"ibis-duckdb-sql, n2d-standard-4","offsetgroup":"ibis-duckdb-sql, n2d-standard-4","orientation":"v","showlegend":true,"textposition":"auto","x":[4,7,2,3,6,5,1],"xaxis":"x","y":[31.415818214416504,121.47943234443665,11.380781571070353,54.54566089312235,39.74296442667643,52.16614373524984,50.23033595085144],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-8\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-8","marker":{"color":"#ab63fa","pattern":{"shape":"."}},"name":"ibis-duckdb-sql, n2d-standard-8","offsetgroup":"ibis-duckdb-sql, n2d-standard-8","orientation":"v","showlegend":true,"textposition":"auto","x":[6,1,5,7,4,3,2],"xaxis":"x","y":[9.49041755994161,20.659324566523235,11.995146989822388,34.449400901794434,9.439269463221232,13.072817166646322,3.2307483355204263],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-16\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-16","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"ibis-duckdb-sql, n2d-standard-16","offsetgroup":"ibis-duckdb-sql, n2d-standard-16","orientation":"v","showlegend":true,"textposition":"auto","x":[4,7,5,1,6,2,3],"xaxis":"x","y":[5.0534547964731855,15.544215122858683,6.304445346196492,9.83419426282247,4.930152336756389,1.6244436105092366,6.493680874506633],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-32","marker":{"color":"#ab63fa","pattern":{"shape":"\u002f"}},"name":"ibis-duckdb-sql, n2d-standard-32","offsetgroup":"ibis-duckdb-sql, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[5,2,3,1,7,4,6],"xaxis":"x","y":[3.694347699483236,1.0186904271443684,3.7939114570617676,5.2171577612559,10.273284514745077,3.0171448389689126,2.716411034266154],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"query_number"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mean_execution_seconds"},"type":"log"},"legend":{"title":{"text":"system, instance_type"},"tracegroupgap":0},"title":{"text":"sf: 128"},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d9a828c8-e422-4272-b41f-75bb6dd64c2f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>This tells a different story. Sometimes Ibis dataframe code is a bit faster, sometimes a bit slower. Let’s compute the totals:</p>
<div id="22489703" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    agg.<span class="bu">filter</span>(agg[<span class="st">"sf"</span>] <span class="op">==</span> sf_filter)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(agg[<span class="st">"system"</span>].isin(systems_filter))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(agg[<span class="st">"instance_type"</span>].isin(instances_filter))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(agg[<span class="st">"query_number"</span>].isin(queries_filter))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    .group_by(<span class="st">"system"</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        total_execution_seconds<span class="op">=</span>agg[<span class="st">"mean_execution_seconds"</span>].<span class="bu">sum</span>(),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        total_queries<span class="op">=</span>ibis._.count(),</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    .mutate(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        seconds_per_query<span class="op">=</span>ibis._[<span class="st">"total_execution_seconds"</span>] <span class="op">/</span> ibis._[<span class="st">"total_queries"</span>]</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> system          </span>┃<span style="font-weight: bold"> total_execution_seconds </span>┃<span style="font-weight: bold"> total_queries </span>┃<span style="font-weight: bold"> seconds_per_query </span>┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │
├─────────────────┼─────────────────────────┼───────────────┼───────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb    </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1049.007159</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.971633</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb-sql</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1180.318346</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.723381</span> │
└─────────────────┴─────────────────────────┴───────────────┴───────────────────┘
</pre>
</div>
</div>
<p>Ibis dataframe code is a little faster overall, but this is on a subset of queries and scale factors and instance types. More analysis and profiling would be needed to make a definitive statement, but in general we can be happy that DuckDB does a great job optimizing the SQL Ibis generates and that Ibis dataframe code isn’t adding significant overhead.</p>
<p>Let’s repeat this for DataFusion:</p>
<div id="e50a97ce" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>systems_filter <span class="op">=</span> [<span class="st">"ibis-datafusion"</span>, <span class="st">"ibis-datafusion-sql"</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>timings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="72b6748e-95f5-4ec6-877c-aeaedb0206fe" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("72b6748e-95f5-4ec6-877c-aeaedb0206fe")) {                    Plotly.newPlot(                        "72b6748e-95f5-4ec6-877c-aeaedb0206fe",                        [{"alignmentgroup":"True","customdata":[["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8]],"hovertemplate":"system=ibis-datafusion\u003cbr\u003einstance_type=n2d-standard-2\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion, n2d-standard-2","marker":{"color":"#636efa","pattern":{"shape":"x"}},"name":"ibis-datafusion, n2d-standard-2","offsetgroup":"ibis-datafusion, n2d-standard-2","orientation":"v","showlegend":true,"textposition":"auto","x":[2,7,4,1,5,3,6],"xaxis":"x","y":[11.363901694615683,146.63673464457193,60.15771754582723,141.34012492497763,103.98395832379659,93.7709014415741,73.55492202440898],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16]],"hovertemplate":"system=ibis-datafusion\u003cbr\u003einstance_type=n2d-standard-4\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion, n2d-standard-4","marker":{"color":"#636efa","pattern":{"shape":"+"}},"name":"ibis-datafusion, n2d-standard-4","offsetgroup":"ibis-datafusion, n2d-standard-4","orientation":"v","showlegend":true,"textposition":"auto","x":[7,4,2,1,5,6,3],"xaxis":"x","y":[64.4235285917918,25.11102867126465,7.114913145701091,66.99990622202556,54.826802810033165,29.97126046816508,63.446453332901],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32]],"hovertemplate":"system=ibis-datafusion\u003cbr\u003einstance_type=n2d-standard-8\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion, n2d-standard-8","marker":{"color":"#636efa","pattern":{"shape":"."}},"name":"ibis-datafusion, n2d-standard-8","offsetgroup":"ibis-datafusion, n2d-standard-8","orientation":"v","showlegend":true,"textposition":"auto","x":[6,3,5,1,7,4,2],"xaxis":"x","y":[15.808083295822144,17.678866863250732,19.327382644017536,33.89225927988688,28.73931161562602,10.578797340393066,3.1191936333974204],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64]],"hovertemplate":"system=ibis-datafusion\u003cbr\u003einstance_type=n2d-standard-16\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion, n2d-standard-16","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"ibis-datafusion, n2d-standard-16","offsetgroup":"ibis-datafusion, n2d-standard-16","orientation":"v","showlegend":true,"textposition":"auto","x":[5,3,2,6,7,4,1],"xaxis":"x","y":[10.493077993392944,11.601869583129883,2.4326950709025064,6.173372507095337,15.978981018066406,7.893036524454753,17.721132198969524],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=ibis-datafusion\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion, n2d-standard-32","marker":{"color":"#636efa","pattern":{"shape":"\u002f"}},"name":"ibis-datafusion, n2d-standard-32","offsetgroup":"ibis-datafusion, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[7,4,2,1,5,6,3],"xaxis":"x","y":[11.63159171740214,7.482565720876058,2.2544215520222983,16.529266754786175,7.471903959910075,3.4388548533121743,9.200567960739136],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8],["AMD EPYC",2,8]],"hovertemplate":"system=ibis-datafusion-sql\u003cbr\u003einstance_type=n2d-standard-2\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion-sql, n2d-standard-2","marker":{"color":"#EF553B","pattern":{"shape":"x"}},"name":"ibis-datafusion-sql, n2d-standard-2","offsetgroup":"ibis-datafusion-sql, n2d-standard-2","orientation":"v","showlegend":true,"textposition":"auto","x":[1,4,6,2,3,5],"xaxis":"x","y":[150.74161338806152,55.97467875480652,57.67109179496765,29.713732481002808,88.4080200990041,111.47976183891296],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16],["AMD EPYC",4,16]],"hovertemplate":"system=ibis-datafusion-sql\u003cbr\u003einstance_type=n2d-standard-4\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion-sql, n2d-standard-4","marker":{"color":"#EF553B","pattern":{"shape":"+"}},"name":"ibis-datafusion-sql, n2d-standard-4","offsetgroup":"ibis-datafusion-sql, n2d-standard-4","orientation":"v","showlegend":true,"textposition":"auto","x":[5,6,4,3,2,1],"xaxis":"x","y":[55.346779664357506,37.8270780245463,26.76049606005351,61.042712370554604,17.599053780237835,69.05837146441142],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32]],"hovertemplate":"system=ibis-datafusion-sql\u003cbr\u003einstance_type=n2d-standard-8\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion-sql, n2d-standard-8","marker":{"color":"#EF553B","pattern":{"shape":"."}},"name":"ibis-datafusion-sql, n2d-standard-8","offsetgroup":"ibis-datafusion-sql, n2d-standard-8","orientation":"v","showlegend":true,"textposition":"auto","x":[3,6,5,1,2,4,7],"xaxis":"x","y":[16.597763617833454,8.179972171783447,21.060061931610107,33.04584511121114,8.765077829360962,9.519487619400024,40.027138233184814],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64]],"hovertemplate":"system=ibis-datafusion-sql\u003cbr\u003einstance_type=n2d-standard-16\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion-sql, n2d-standard-16","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"ibis-datafusion-sql, n2d-standard-16","offsetgroup":"ibis-datafusion-sql, n2d-standard-16","orientation":"v","showlegend":true,"textposition":"auto","x":[5,3,2,6,7,4,1],"xaxis":"x","y":[12.02802308400472,11.203579425811768,6.750166734059651,4.181100845336914,24.014207124710083,5.670323610305786,16.38461971282959],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=ibis-datafusion-sql\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion-sql, n2d-standard-32","marker":{"color":"#EF553B","pattern":{"shape":"\u002f"}},"name":"ibis-datafusion-sql, n2d-standard-32","offsetgroup":"ibis-datafusion-sql, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[1,2,3,4,7,6,5],"xaxis":"x","y":[12.949114084243774,6.693936745325725,9.455447912216187,3.730076869328817,17.029499053955078,2.7630774974823,9.587421178817749],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"query_number"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mean_execution_seconds"},"type":"log"},"legend":{"title":{"text":"system, instance_type"},"tracegroupgap":0},"title":{"text":"sf: 128"},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('72b6748e-95f5-4ec6-877c-aeaedb0206fe');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>We see a similar story. Let’s confirm with a table:</p>
<div id="206c8807" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    agg.<span class="bu">filter</span>(agg[<span class="st">"sf"</span>] <span class="op">==</span> sf_filter)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(agg[<span class="st">"system"</span>].isin(systems_filter))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(agg[<span class="st">"instance_type"</span>].isin(instances_filter))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(agg[<span class="st">"query_number"</span>].isin(queries_filter))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    .group_by(<span class="st">"system"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        total_execution_seconds<span class="op">=</span>agg[<span class="st">"mean_execution_seconds"</span>].<span class="bu">sum</span>(),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        total_queries<span class="op">=</span>ibis._.count(),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    .mutate(</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        seconds_per_query<span class="op">=</span>ibis._[<span class="st">"total_execution_seconds"</span>] <span class="op">/</span> ibis._[<span class="st">"total_queries"</span>]</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> system              </span>┃<span style="font-weight: bold"> total_execution_seconds </span>┃<span style="font-weight: bold"> total_queries </span>┃<span style="font-weight: bold"> seconds_per_query </span>┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │
├─────────────────────┼─────────────────────────┼───────────────┼───────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion-sql</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1041.259330</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31.553313</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion    </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1202.149386</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.347125</span> │
└─────────────────────┴─────────────────────────┴───────────────┴───────────────────┘
</pre>
</div>
</div>
<p>This time Ibis dataframe code is a bit slower overall. <strong>However, also notice two queries are missing from <code>ibis-datafusion-sql</code></strong>. These are query 7 on <code>n2d-standard-2</code> and <code>n2d-standard-4</code> (the two instances with the least memory). We’ll investigate failing queries more thoroughly in the next section.</p>
<p>First, let’s look at Polars:</p>
<div id="3540c1c6" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>systems_filter <span class="op">=</span> [<span class="st">"ibis-polars"</span>, <span class="st">"polars-lazy"</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>timings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="a1de20d0-c0b7-4571-8d23-d360d1ac8ff4" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a1de20d0-c0b7-4571-8d23-d360d1ac8ff4")) {                    Plotly.newPlot(                        "a1de20d0-c0b7-4571-8d23-d360d1ac8ff4",                        [{"alignmentgroup":"True","customdata":[["AMD EPYC",2,8],["AMD EPYC",2,8]],"hovertemplate":"system=ibis-polars\u003cbr\u003einstance_type=n2d-standard-2\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars, n2d-standard-2","marker":{"color":"#FFA15A","pattern":{"shape":"x"}},"name":"ibis-polars, n2d-standard-2","offsetgroup":"ibis-polars, n2d-standard-2","orientation":"v","showlegend":true,"textposition":"auto","x":[6,2],"xaxis":"x","y":[61.469714879989624,13.319883108139038],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",4,16],["AMD EPYC",4,16]],"hovertemplate":"system=ibis-polars\u003cbr\u003einstance_type=n2d-standard-4\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars, n2d-standard-4","marker":{"color":"#FFA15A","pattern":{"shape":"+"}},"name":"ibis-polars, n2d-standard-4","offsetgroup":"ibis-polars, n2d-standard-4","orientation":"v","showlegend":true,"textposition":"auto","x":[6,2],"xaxis":"x","y":[52.33062720298767,9.546661615371704],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",8,32],["AMD EPYC",8,32]],"hovertemplate":"system=ibis-polars\u003cbr\u003einstance_type=n2d-standard-8\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars, n2d-standard-8","marker":{"color":"#FFA15A","pattern":{"shape":"."}},"name":"ibis-polars, n2d-standard-8","offsetgroup":"ibis-polars, n2d-standard-8","orientation":"v","showlegend":true,"textposition":"auto","x":[2,6],"xaxis":"x","y":[6.598418553670247,18.069969574610393],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64]],"hovertemplate":"system=ibis-polars\u003cbr\u003einstance_type=n2d-standard-16\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars, n2d-standard-16","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"ibis-polars, n2d-standard-16","offsetgroup":"ibis-polars, n2d-standard-16","orientation":"v","showlegend":true,"textposition":"auto","x":[2,3,4,7,6],"xaxis":"x","y":[10.44108772277832,27.571980555852253,13.035804430643717,22.919936974843342,17.985748132069904],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=ibis-polars\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars, n2d-standard-32","marker":{"color":"#FFA15A","pattern":{"shape":"\u002f"}},"name":"ibis-polars, n2d-standard-32","offsetgroup":"ibis-polars, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[3,5,1,2,6,4,7],"xaxis":"x","y":[27.108211437861126,13.99797248840332,62.19382929801941,5.905109326044719,4.244828224182129,11.461715777715048,12.255585193634033],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",4,16],["AMD EPYC",4,16]],"hovertemplate":"system=polars-lazy\u003cbr\u003einstance_type=n2d-standard-4\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy, n2d-standard-4","marker":{"color":"#19d3f3","pattern":{"shape":"+"}},"name":"polars-lazy, n2d-standard-4","offsetgroup":"polars-lazy, n2d-standard-4","orientation":"v","showlegend":true,"textposition":"auto","x":[6,2],"xaxis":"x","y":[54.12349343299866,8.95040512084961],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32],["AMD EPYC",8,32]],"hovertemplate":"system=polars-lazy\u003cbr\u003einstance_type=n2d-standard-8\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy, n2d-standard-8","marker":{"color":"#19d3f3","pattern":{"shape":"."}},"name":"polars-lazy, n2d-standard-8","offsetgroup":"polars-lazy, n2d-standard-8","orientation":"v","showlegend":true,"textposition":"auto","x":[7,4,2,6],"xaxis":"x","y":[32.36805748939514,21.888363758722942,3.828543742497762,18.953997373580933],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64],["AMD EPYC",16,64]],"hovertemplate":"system=polars-lazy\u003cbr\u003einstance_type=n2d-standard-16\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy, n2d-standard-16","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"polars-lazy, n2d-standard-16","offsetgroup":"polars-lazy, n2d-standard-16","orientation":"v","showlegend":true,"textposition":"auto","x":[4,7,6,2,3],"xaxis":"x","y":[11.27583646774292,19.500889619191486,18.51408116022746,3.3814821243286133,28.86030451456706],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=polars-lazy\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy, n2d-standard-32","marker":{"color":"#19d3f3","pattern":{"shape":"\u002f"}},"name":"polars-lazy, n2d-standard-32","offsetgroup":"polars-lazy, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[7,4,5,6,1,2,3],"xaxis":"x","y":[10.39676809310913,10.389480113983154,13.94202979405721,3.6897570292154946,33.80695390701294,3.2517149448394775,13.268091122309366],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"query_number"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mean_execution_seconds"},"type":"log"},"legend":{"title":{"text":"system, instance_type"},"tracegroupgap":0},"title":{"text":"sf: 128"},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a1de20d0-c0b7-4571-8d23-d360d1ac8ff4');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>A lot of queries are missing from <code>ibis-polars</code> and <code>polars-lazy</code>. These are failing due to the high scale factor and limited memory on the instances.</p>
<p>Let’s look at a lower scale factor and my MacBooks (Polars tended to perform better on these):</p>
<div id="b8fd41a0" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>sf_filter <span class="op">=</span> <span class="dv">64</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>instances_filter <span class="op">=</span> [</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    instance <span class="cf">for</span> instance <span class="kw">in</span> instance_types <span class="cf">if</span> <span class="st">"laptop"</span> <span class="kw">in</span> instance</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>timings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="550f718b-ff8e-41e0-8484-21a26c47642b" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("550f718b-ff8e-41e0-8484-21a26c47642b")) {                    Plotly.newPlot(                        "550f718b-ff8e-41e0-8484-21a26c47642b",                        [{"alignmentgroup":"True","customdata":[["Apple M1 Max",12,32],["Apple M1 Max",12,32],["Apple M1 Max",12,32],["Apple M1 Max",12,32],["Apple M1 Max",12,32],["Apple M1 Max",12,32],["Apple M1 Max",12,32]],"hovertemplate":"system=ibis-polars\u003cbr\u003einstance_type=work laptop\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars, work laptop","marker":{"color":"#FFA15A","pattern":{"shape":"\\"}},"name":"ibis-polars, work laptop","offsetgroup":"ibis-polars, work laptop","orientation":"v","showlegend":true,"textposition":"auto","x":[5,6,7,4,1,2,3],"xaxis":"x","y":[13.21927841504415,4.801118771235148,9.317765474319458,5.086873133977254,110.36613933245341,1.3930803140004475,6.99468731880188],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["Apple M2 Max",12,96],["Apple M2 Max",12,96],["Apple M2 Max",12,96],["Apple M2 Max",12,96],["Apple M2 Max",12,96],["Apple M2 Max",12,96],["Apple M2 Max",12,96]],"hovertemplate":"system=ibis-polars\u003cbr\u003einstance_type=personal laptop\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars, personal laptop","marker":{"color":"#FFA15A","pattern":{"shape":"x"}},"name":"ibis-polars, personal laptop","offsetgroup":"ibis-polars, personal laptop","orientation":"v","showlegend":true,"textposition":"auto","x":[5,3,2,1,7,4,6],"xaxis":"x","y":[3.8612585067749023,3.482304255167643,1.8289570808410645,16.727041323979694,4.213795344034831,2.521452267964681,1.7339130242665608],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["Apple M1 Max",12,32],["Apple M1 Max",12,32],["Apple M1 Max",12,32],["Apple M1 Max",12,32],["Apple M1 Max",12,32],["Apple M1 Max",12,32],["Apple M1 Max",12,32]],"hovertemplate":"system=polars-lazy\u003cbr\u003einstance_type=work laptop\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy, work laptop","marker":{"color":"#19d3f3","pattern":{"shape":"\\"}},"name":"polars-lazy, work laptop","offsetgroup":"polars-lazy, work laptop","orientation":"v","showlegend":true,"textposition":"auto","x":[6,3,2,7,4,1,5],"xaxis":"x","y":[5.319633324940999,8.647685130437216,0.707722028096517,6.241333723068237,4.381483236948649,45.943869272867836,18.01548933982849],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["Apple M2 Max",12,96],["Apple M2 Max",12,96],["Apple M2 Max",12,96],["Apple M2 Max",12,96],["Apple M2 Max",12,96],["Apple M2 Max",12,96],["Apple M2 Max",12,96]],"hovertemplate":"system=polars-lazy\u003cbr\u003einstance_type=personal laptop\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy, personal laptop","marker":{"color":"#19d3f3","pattern":{"shape":"x"}},"name":"polars-lazy, personal laptop","offsetgroup":"polars-lazy, personal laptop","orientation":"v","showlegend":true,"textposition":"auto","x":[1,7,4,6,5,3,2],"xaxis":"x","y":[9.250827312469482,3.789229154586792,2.843586047490438,1.7952766418457031,4.006711959838867,3.5790963172912598,0.6358058452606201],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"query_number"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mean_execution_seconds"},"type":"log"},"legend":{"title":{"text":"system, instance_type"},"tracegroupgap":0},"title":{"text":"sf: 64"},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('550f718b-ff8e-41e0-8484-21a26c47642b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>We see a similar pattern as above – some queries are a little faster on <code>ibis-polars</code>, though some are <strong>much</strong> slower. In particular queries 1 and 2 tend to have a lot of overhead.</p>
<div id="7661cf77" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    agg.<span class="bu">filter</span>(agg[<span class="st">"sf"</span>] <span class="op">==</span> sf_filter)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(agg[<span class="st">"system"</span>].isin(systems_filter))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(agg[<span class="st">"instance_type"</span>].isin(instances_filter))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(agg[<span class="st">"query_number"</span>].isin(queries_filter))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    .group_by(<span class="st">"system"</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        total_execution_seconds<span class="op">=</span>agg[<span class="st">"mean_execution_seconds"</span>].<span class="bu">sum</span>(),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        total_queries<span class="op">=</span>ibis._.count(),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    .mutate(</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        seconds_per_query<span class="op">=</span>ibis._[<span class="st">"total_execution_seconds"</span>] <span class="op">/</span> ibis._[<span class="st">"total_queries"</span>]</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> system      </span>┃<span style="font-weight: bold"> total_execution_seconds </span>┃<span style="font-weight: bold"> total_queries </span>┃<span style="font-weight: bold"> seconds_per_query </span>┃
┡━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │
├─────────────┼─────────────────────────┼───────────────┼───────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">ibis-polars</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">185.547665</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.253405</span> │
│ <span style="color: #008000; text-decoration-color: #008000">polars-lazy</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">115.157749</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.225554</span> │
└─────────────┴─────────────────────────┴───────────────┴───────────────────┘
</pre>
</div>
</div>
<p>Let’s now compare all systems across a single instance type and query:</p>
<div id="782928a6" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sf_filter <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>instances_filter <span class="op">=</span> [<span class="st">"n2d-standard-32"</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>systems_filter <span class="op">=</span> systems</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>queries_filter <span class="op">=</span> [<span class="dv">1</span>]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>timings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="3df91817-773e-4036-9857-6b7d743e9563" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("3df91817-773e-4036-9857-6b7d743e9563")) {                    Plotly.newPlot(                        "3df91817-773e-4036-9857-6b7d743e9563",                        [{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128]],"hovertemplate":"system=ibis-datafusion\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion, n2d-standard-32","marker":{"color":"#636efa","pattern":{"shape":"\u002f"}},"name":"ibis-datafusion, n2d-standard-32","offsetgroup":"ibis-datafusion, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[16.529266754786175],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128]],"hovertemplate":"system=ibis-datafusion-sql\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion-sql, n2d-standard-32","marker":{"color":"#EF553B","pattern":{"shape":"\u002f"}},"name":"ibis-datafusion-sql, n2d-standard-32","offsetgroup":"ibis-datafusion-sql, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[12.949114084243774],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-32","marker":{"color":"#00cc96","pattern":{"shape":"\u002f"}},"name":"ibis-duckdb, n2d-standard-32","offsetgroup":"ibis-duckdb, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[5.938729286193848],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-32","marker":{"color":"#ab63fa","pattern":{"shape":"\u002f"}},"name":"ibis-duckdb-sql, n2d-standard-32","offsetgroup":"ibis-duckdb-sql, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[5.2171577612559],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128]],"hovertemplate":"system=ibis-polars\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars, n2d-standard-32","marker":{"color":"#FFA15A","pattern":{"shape":"\u002f"}},"name":"ibis-polars, n2d-standard-32","offsetgroup":"ibis-polars, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[62.19382929801941],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128]],"hovertemplate":"system=polars-lazy\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy, n2d-standard-32","marker":{"color":"#19d3f3","pattern":{"shape":"\u002f"}},"name":"polars-lazy, n2d-standard-32","offsetgroup":"polars-lazy, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[1],"xaxis":"x","y":[33.80695390701294],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"query_number"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mean_execution_seconds"},"type":"log"},"legend":{"title":{"text":"system, instance_type"},"tracegroupgap":0},"title":{"text":"sf: 128"},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('3df91817-773e-4036-9857-6b7d743e9563');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>And then the first 7 queries:</p>
<div id="0d936a1c" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>queries_filter <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">7</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>timings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="e09b85a5-ca55-41b9-8cc1-77d0f5785239" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e09b85a5-ca55-41b9-8cc1-77d0f5785239")) {                    Plotly.newPlot(                        "e09b85a5-ca55-41b9-8cc1-77d0f5785239",                        [{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=ibis-datafusion\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion, n2d-standard-32","marker":{"color":"#636efa","pattern":{"shape":"\u002f"}},"name":"ibis-datafusion, n2d-standard-32","offsetgroup":"ibis-datafusion, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[5,2,1,7,4,3,6],"xaxis":"x","y":[7.471903959910075,2.2544215520222983,16.529266754786175,11.63159171740214,7.482565720876058,9.200567960739136,3.4388548533121743],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=ibis-datafusion-sql\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion-sql, n2d-standard-32","marker":{"color":"#EF553B","pattern":{"shape":"\u002f"}},"name":"ibis-datafusion-sql, n2d-standard-32","offsetgroup":"ibis-datafusion-sql, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[6,4,7,1,3,2,5],"xaxis":"x","y":[2.7630774974823,3.730076869328817,17.029499053955078,12.949114084243774,9.455447912216187,6.693936745325725,9.587421178817749],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=ibis-duckdb\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb, n2d-standard-32","marker":{"color":"#00cc96","pattern":{"shape":"\u002f"}},"name":"ibis-duckdb, n2d-standard-32","offsetgroup":"ibis-duckdb, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[4,7,2,5,6,1,3],"xaxis":"x","y":[2.8200621604919434,7.479643742243449,0.6979877154032389,3.9903443654378257,2.341557025909424,5.938729286193848,3.935547669728597],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql, n2d-standard-32","marker":{"color":"#ab63fa","pattern":{"shape":"\u002f"}},"name":"ibis-duckdb-sql, n2d-standard-32","offsetgroup":"ibis-duckdb-sql, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[7,4,2,5,6,1,3],"xaxis":"x","y":[10.273284514745077,3.0171448389689126,1.0186904271443684,3.694347699483236,2.716411034266154,5.2171577612559,3.7939114570617676],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=ibis-polars\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars, n2d-standard-32","marker":{"color":"#FFA15A","pattern":{"shape":"\u002f"}},"name":"ibis-polars, n2d-standard-32","offsetgroup":"ibis-polars, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[6,4,7,1,3,2,5],"xaxis":"x","y":[4.244828224182129,11.461715777715048,12.255585193634033,62.19382929801941,27.108211437861126,5.905109326044719,13.99797248840332],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128],["AMD EPYC",32,128]],"hovertemplate":"system=polars-lazy\u003cbr\u003einstance_type=n2d-standard-32\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cbr\u003ecpu_type=%{customdata[0]}\u003cbr\u003ecpu_cores=%{customdata[1]}\u003cbr\u003ememory_gbs=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy, n2d-standard-32","marker":{"color":"#19d3f3","pattern":{"shape":"\u002f"}},"name":"polars-lazy, n2d-standard-32","offsetgroup":"polars-lazy, n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":[2,5,3,7,4,1,6],"xaxis":"x","y":[3.2517149448394775,13.94202979405721,13.268091122309366,10.39676809310913,10.389480113983154,33.80695390701294,3.6897570292154946],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"query_number"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mean_execution_seconds"},"type":"log"},"legend":{"title":{"text":"system, instance_type"},"tracegroupgap":0},"title":{"text":"sf: 128"},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e09b85a5-ca55-41b9-8cc1-77d0f5785239');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Lots of data, lots of takeaways">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lots of data, lots of takeaways
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is a lot of data and it’s easy to summarize and visualize it in a way that favors a given system. There’s a lot of missing data that needs to be accounted for, as it often indicates a query that failed due to memory pressure.</p>
<p>Each system has strengths and weaknesses. See <a href="#which-system-is-best">the discussion section below</a>.</p>
<p>See the <a href="https://ibis-bench.streamlit.app">Ibis benchmarking Streamlit app</a> for further analysis, or query the data yourself!</p>
</div>
</div>
</section>
<section id="failing-queries-due-to-memory-pressure" class="level3">
<h3 class="anchored" data-anchor-id="failing-queries-due-to-memory-pressure">Failing queries due to memory pressure</h3>
<p>Many queries fail due to memory pressure at higher scale factors with insufficient resources. Impressively, the exception here is DuckDB.</p>
<div id="2da2acc0" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Show code to get table of failing queries</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> failing_queries(agg, sf, instance_type):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    failing <span class="op">=</span> (</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>        t.<span class="bu">filter</span>(t[<span class="st">"sf"</span>] <span class="op">==</span> sf)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">filter</span>(t[<span class="st">"instance_type"</span>] <span class="op">==</span> instance_type)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        .group_by(<span class="st">"system"</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        .agg(present_queries<span class="op">=</span>ibis._[<span class="st">"query_number"</span>].collect().unique().sort())</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    failing <span class="op">=</span> (</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        failing.mutate(</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>            failing_queries<span class="op">=</span>t.distinct(on<span class="op">=</span><span class="st">"query_number"</span>)[<span class="st">"query_number"</span>]</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>            .collect()</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>            .<span class="bu">filter</span>(<span class="kw">lambda</span> x: <span class="op">~</span>failing[<span class="st">"present_queries"</span>].contains(x))</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        .mutate(</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>            num_failing_queries<span class="op">=</span>ibis._[<span class="st">"failing_queries"</span>].length(),</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>            num_successful_queries<span class="op">=</span>ibis._[<span class="st">"present_queries"</span>].length(),</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        .drop(<span class="st">"present_queries"</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>        .order_by(<span class="st">"num_failing_queries"</span>, <span class="st">"system"</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> failing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s look at the failing queries on the largest <code>n2d</code> instance::</p>
<div id="e2d0bd3f" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sf <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>instance_type <span class="op">=</span> <span class="st">"n2d-standard-32"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>failing <span class="op">=</span> failing_queries(agg, sf, instance_type)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>failing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> system              </span>┃<span style="font-weight: bold"> failing_queries                             </span>┃<span style="font-weight: bold"> num_failing_queries </span>┃<span style="font-weight: bold"> num_successful_queries </span>┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">array&lt;int64&gt;</span>                                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>                  │
├─────────────────────┼─────────────────────────────────────────────┼─────────────────────┼────────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb        </span> │ <span style="font-weight: bold">[]</span>                                          │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb-sql    </span> │ <span style="font-weight: bold">[]</span>                                          │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion-sql</span> │ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span><span style="font-weight: bold">]</span>                                        │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span> │
│ <span style="color: #008000; text-decoration-color: #008000">polars-lazy        </span> │ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span><span style="font-weight: bold">]</span>                                         │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion    </span> │ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span><span style="font-weight: bold">]</span>                                │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-polars        </span> │ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span><span style="font-weight: bold">]</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │
└─────────────────────┴─────────────────────────────────────────────┴─────────────────────┴────────────────────────┘
</pre>
</div>
</div>
<div id="dda4267f" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Show code to create a bar plot of the number of successful queries by system</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> px.bar(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    failing,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"system"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"num_successful_queries"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    category_orders<span class="op">=</span>{</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"system"</span>: systems,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"query_number"</span>: query_numbers,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"system"</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"completed queries"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="77fc68e0-065b-431f-b1e2-1e3b63632056" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("77fc68e0-065b-431f-b1e2-1e3b63632056")) {                    Plotly.newPlot(                        "77fc68e0-065b-431f-b1e2-1e3b63632056",                        [{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"ibis-datafusion","offsetgroup":"ibis-datafusion","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-datafusion"],"xaxis":"x","y":[19],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion-sql","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"ibis-datafusion-sql","offsetgroup":"ibis-datafusion-sql","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-datafusion-sql"],"xaxis":"x","y":[21],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"ibis-duckdb","offsetgroup":"ibis-duckdb","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-duckdb"],"xaxis":"x","y":[22],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"ibis-duckdb-sql","offsetgroup":"ibis-duckdb-sql","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-duckdb-sql"],"xaxis":"x","y":[22],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"ibis-polars","offsetgroup":"ibis-polars","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-polars"],"xaxis":"x","y":[11],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"polars-lazy","offsetgroup":"polars-lazy","orientation":"v","showlegend":true,"textposition":"auto","x":["polars-lazy"],"xaxis":"x","y":[21],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"system"},"categoryorder":"array","categoryarray":["ibis-datafusion","ibis-datafusion-sql","ibis-duckdb","ibis-duckdb-sql","ibis-polars","polars-lazy"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"num_successful_queries"}},"legend":{"title":{"text":"system"},"tracegroupgap":0},"title":{"text":"completed queries"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('77fc68e0-065b-431f-b1e2-1e3b63632056');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>And the smallest:</p>
<div id="46ef36c2" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>instance_type <span class="op">=</span> <span class="st">"n2d-standard-2"</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>failing <span class="op">=</span> failing_queries(agg, sf, instance_type)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>failing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> system              </span>┃<span style="font-weight: bold"> failing_queries                                                           </span>┃<span style="font-weight: bold"> num_failing_queries </span>┃<span style="font-weight: bold"> num_successful_queries </span>┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">array&lt;int64&gt;</span>                                                              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>                  │
├─────────────────────┼───────────────────────────────────────────────────────────────────────────┼─────────────────────┼────────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb        </span> │ <span style="font-weight: bold">[]</span>                                                                        │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb-sql    </span> │ <span style="font-weight: bold">[]</span>                                                                        │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion-sql</span> │ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span><span style="font-weight: bold">]</span>                                                        │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion    </span> │ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span><span style="font-weight: bold">]</span>                                                   │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
│ <span style="color: #008000; text-decoration-color: #008000">polars-lazy        </span> │ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span><span style="font-weight: bold">]</span>           │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span> │                      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-polars        </span> │ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span><span style="font-weight: bold">]</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span> │                      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└─────────────────────┴───────────────────────────────────────────────────────────────────────────┴─────────────────────┴────────────────────────┘
</pre>
</div>
</div>
<div id="ca4f11e4" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Show code to create a bar plot of the number of successful queries by system</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> px.bar(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    failing,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"system"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"num_successful_queries"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    category_orders<span class="op">=</span>{</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"system"</span>: systems,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"query_number"</span>: query_numbers,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"system"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"completed queries"</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="e6b603e8-b0ba-4967-921d-e5f9bbc13247" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e6b603e8-b0ba-4967-921d-e5f9bbc13247")) {                    Plotly.newPlot(                        "e6b603e8-b0ba-4967-921d-e5f9bbc13247",                        [{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"ibis-datafusion","offsetgroup":"ibis-datafusion","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-datafusion"],"xaxis":"x","y":[16],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion-sql","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"ibis-datafusion-sql","offsetgroup":"ibis-datafusion-sql","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-datafusion-sql"],"xaxis":"x","y":[17],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"ibis-duckdb","offsetgroup":"ibis-duckdb","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-duckdb"],"xaxis":"x","y":[22],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"ibis-duckdb-sql","offsetgroup":"ibis-duckdb-sql","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-duckdb-sql"],"xaxis":"x","y":[22],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"ibis-polars","offsetgroup":"ibis-polars","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-polars"],"xaxis":"x","y":[2],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"polars-lazy","offsetgroup":"polars-lazy","orientation":"v","showlegend":true,"textposition":"auto","x":["polars-lazy"],"xaxis":"x","y":[4],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"system"},"categoryorder":"array","categoryarray":["ibis-datafusion","ibis-datafusion-sql","ibis-duckdb","ibis-duckdb-sql","ibis-polars","polars-lazy"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"num_successful_queries"}},"legend":{"title":{"text":"system"},"tracegroupgap":0},"title":{"text":"completed queries"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e6b603e8-b0ba-4967-921d-e5f9bbc13247');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>A lot of queries are failing on the smallest instance due to memory pressure.</p>
<p>We can create a single visualization across the <code>n2d</code> instances:</p>
<div id="2a2f3a58" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Show code to create a bar plot of the number of successful queries by system and instance type</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>failing <span class="op">=</span> t.group_by(<span class="st">"instance_type"</span>, <span class="st">"system"</span>, <span class="st">"sf"</span>).agg(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    total_time<span class="op">=</span>t[<span class="st">"execution_seconds"</span>].<span class="bu">sum</span>(),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    present_queries<span class="op">=</span>ibis._[<span class="st">"query_number"</span>].collect().unique().sort(),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>failing <span class="op">=</span> (</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    failing.mutate(</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        failing_queries<span class="op">=</span>t.distinct(on<span class="op">=</span><span class="st">"query_number"</span>)[<span class="st">"query_number"</span>]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        .collect()</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">filter</span>(<span class="kw">lambda</span> x: <span class="op">~</span>failing[<span class="st">"present_queries"</span>].contains(x)),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    .mutate(</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>        num_failing_queries<span class="op">=</span>ibis._[<span class="st">"failing_queries"</span>].length(),</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>        num_successful_queries<span class="op">=</span>ibis._[<span class="st">"present_queries"</span>].length(),</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    .drop(<span class="st">"present_queries"</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    .relocate(<span class="st">"instance_type"</span>, <span class="st">"system"</span>, <span class="st">"sf"</span>, <span class="st">"failing_queries"</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    .order_by(<span class="st">"num_failing_queries"</span>, <span class="st">"instance_type"</span>, <span class="st">"system"</span>, <span class="st">"sf"</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>failing <span class="op">=</span> failing.join(instance_details, <span class="st">"instance_type"</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>failing <span class="op">=</span> (</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    failing.<span class="bu">filter</span>(</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        (failing[<span class="st">"sf"</span>] <span class="op">==</span> <span class="dv">128</span>) <span class="op">&amp;</span> (failing[<span class="st">"instance_type"</span>].startswith(<span class="st">"n2d-"</span>))</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>).order_by(ibis.desc(<span class="st">"memory_gbs"</span>))</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> px.bar(</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    failing,</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"system"</span>,</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"num_successful_queries"</span>,</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"instance_type"</span>,</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    barmode<span class="op">=</span><span class="st">"group"</span>,</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    hover_data<span class="op">=</span>[<span class="st">"cpu_cores"</span>, <span class="st">"memory_gbs"</span>],</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    category_orders<span class="op">=</span>{</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"system"</span>: systems,</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">"instance_type"</span>: <span class="bu">reversed</span>(</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>            [instance <span class="cf">for</span> instance <span class="kw">in</span> instance_types <span class="cf">if</span> instance.startswith(<span class="st">"n2d"</span>)]</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"completed queries"</span>,</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="c9948a0d-c7cf-4ac9-90f9-69eb1595d232" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("c9948a0d-c7cf-4ac9-90f9-69eb1595d232")) {                    Plotly.newPlot(                        "c9948a0d-c7cf-4ac9-90f9-69eb1595d232",                        [{"alignmentgroup":"True","customdata":[[32,128],[32,128],[32,128],[32,128],[32,128],[32,128]],"hovertemplate":"instance_type=n2d-standard-32\u003cbr\u003esystem=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cbr\u003ememory_gbs=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"n2d-standard-32","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"n2d-standard-32","offsetgroup":"n2d-standard-32","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-polars","ibis-duckdb-sql","ibis-duckdb","ibis-datafusion","polars-lazy","ibis-datafusion-sql"],"xaxis":"x","y":[11,22,22,19,21,21],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[16,64],[16,64],[16,64],[16,64],[16,64],[16,64]],"hovertemplate":"instance_type=n2d-standard-16\u003cbr\u003esystem=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cbr\u003ememory_gbs=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"n2d-standard-16","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"n2d-standard-16","offsetgroup":"n2d-standard-16","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-polars","polars-lazy","ibis-duckdb-sql","ibis-duckdb","ibis-datafusion","ibis-datafusion-sql"],"xaxis":"x","y":[7,17,22,22,18,21],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[8,32],[8,32],[8,32],[8,32],[8,32],[8,32]],"hovertemplate":"instance_type=n2d-standard-8\u003cbr\u003esystem=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cbr\u003ememory_gbs=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"n2d-standard-8","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"n2d-standard-8","offsetgroup":"n2d-standard-8","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-polars","polars-lazy","ibis-datafusion","ibis-datafusion-sql","ibis-duckdb-sql","ibis-duckdb"],"xaxis":"x","y":[3,13,18,21,22,22],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[4,16],[4,16],[4,16],[4,16],[4,16],[4,16]],"hovertemplate":"instance_type=n2d-standard-4\u003cbr\u003esystem=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cbr\u003ememory_gbs=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"n2d-standard-4","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"n2d-standard-4","offsetgroup":"n2d-standard-4","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-polars","polars-lazy","ibis-datafusion","ibis-datafusion-sql","ibis-duckdb-sql","ibis-duckdb"],"xaxis":"x","y":[2,8,17,18,22,22],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","customdata":[[2,8],[2,8],[2,8],[2,8],[2,8],[2,8]],"hovertemplate":"instance_type=n2d-standard-2\u003cbr\u003esystem=%{x}\u003cbr\u003enum_successful_queries=%{y}\u003cbr\u003ecpu_cores=%{customdata[0]}\u003cbr\u003ememory_gbs=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"n2d-standard-2","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"n2d-standard-2","offsetgroup":"n2d-standard-2","orientation":"v","showlegend":true,"textposition":"auto","x":["ibis-polars","polars-lazy","ibis-datafusion","ibis-datafusion-sql","ibis-duckdb-sql","ibis-duckdb"],"xaxis":"x","y":[2,4,16,17,22,22],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"system"},"categoryorder":"array","categoryarray":["ibis-datafusion","ibis-datafusion-sql","ibis-duckdb","ibis-duckdb-sql","ibis-polars","polars-lazy"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"num_successful_queries"}},"legend":{"title":{"text":"instance_type"},"tracegroupgap":0},"title":{"text":"completed queries"},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('c9948a0d-c7cf-4ac9-90f9-69eb1595d232');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Within each system, from left to right, we have decreasing resources (vCPUs and memory). We can see how each system performs on the same queries with different resources.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="Data is aggregated">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data is aggregated
</div>
</div>
<div class="callout-body-container callout-body">
<p>Keep in mind data is aggregated over three runs of each query. For DuckDB, there was actually a single failure on the smallest instance for query 9, out of six runs across the two systems, but this does not appear above because we are checking for the success of the query in any of the three runs per configuration.</p>
</div>
</div>
</section>
</section>
<section id="discussion-and-reproducibility" class="level2">
<h2 class="anchored" data-anchor-id="discussion-and-reproducibility">Discussion and reproducibility</h2>
<p>Benchmarking is fraught: it’s easy to get wrong and ship your bias in the results. We don’t want to end up as <a href="https://hannes.muehleisen.org/publications/DBTEST2018-performance-testing.pdf">Figure 1 in “Fair Benchmarking Considered Difficult: Common Pitfalls In Database Performance Testing”</a>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figure1.png" class="img-fluid figure-img"></p>
<figcaption>Figure 1</figcaption>
</figure>
</div>
<p>If you have any questions or concerns, feel free to <a href="https://github.com/lostmygithubaccount/ibis-bench/issues/new">open an issue</a> or comment on this post below.</p>
<section id="which-system-is-best" class="level3">
<h3 class="anchored" data-anchor-id="which-system-is-best">Which system is best?</h3>
<p>Trick question! It depends on your use case. DuckDB is a simple, performant in-process database with an on-disk file format (SQLite for OLAP). DataFusion is an extensible query engine and is often used for building databases or query engines. Polars is an OLAP query engine with a Python dataframe API that can be used as a more performant alternative to pandas.</p>
<p>All three make great Ibis backends and you can switch between them in a single line of code. This lets you write your code once and run it on the engine that’s best for your use case. If a better engine comes along you’ll likely be able to use that too. And you can scale up and out across the 20+ backends Ibis supports as needed.</p>
<p>TPC-H is a decent benchmark <em>for what it benchmarks, which is limited</em>. We’re not running window functions, doing timeseries analysis, or feature engineering for machine learning. We’re not using nested data types. We’re not performing regexes or using LLMs in UDFs…</p>
<p>It’s easy to summarize and visualize benchmarking data in a way that favors a given system. You should favor the system that works best for your use case.</p>
</section>
<section id="performance-converges-over-time" class="level3">
<h3 class="anchored" data-anchor-id="performance-converges-over-time">Performance converges over time</h3>
<p>Let’s look at some quotes from <a href="https://motherduck.com/blog/perf-is-not-enough">“Perf is not enough”</a> by Jordan Tigani of MotherDuck:</p>
<blockquote class="blockquote">
<p>If you take a bunch of databases, all actively maintained, and iterate them out a few years, <strong>performance is going to converge</strong>. If Clickhouse is applying a technique that gives it an advantage for scan speed today, Snowflake will likely have that within a year or two. If Snowflake adds incrementally materialized views, BigQuery will soon follow. It is unlikely that important performance differences will persist over time.</p>
<p>As clever as the engineers working for any of these companies are, none of them possess any magic incantations or things that cannot be replicated elsewhere. Each database uses a different bag of tricks in order to get good performance. One might compile queries to machine code, another might cache data on local SSDs, and a third might use specialized network hardware to do shuffles. <strong>Given time, all of these techniques can be implemented by anyone. If they work well, they likely will show up everywhere.</strong></p>
</blockquote>
<p>This is extra true for open source databases (or query engines). If DuckDB adds a feature that improves performance, it’s likely that DataFusion and Polars will follow suit – they can go read the source code and specific commits to see how it was done.</p>
</section>
<section id="reproducing-the-benchmark" class="level3">
<h3 class="anchored" data-anchor-id="reproducing-the-benchmark">Reproducing the benchmark</h3>
<p>The source code for <a href="https://github.com/lostmygithubaccount/ibis-bench/tree/v2.0.0">is available on GitHub</a>.</p>
<section id="a-tpc-h-benchmark-on-6-systems-in-3-commands" class="level4">
<h4 class="anchored" data-anchor-id="a-tpc-h-benchmark-on-6-systems-in-3-commands">A TPC-H benchmark on 6 systems in 3 commands</h4>
<p>First install <code>ibis-bench</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install ibis-bench</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then generate the TPC-H data:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bench</span> gen-data <span class="at">-s</span> 1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Finally run the benchmark:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bench</span> run <span class="at">-s</span> 1 ibis-duckdb ibis-duckdb-sql ibis-datafusion ibis-datafusion-sql ibis-polars polars-lazy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Congratulations! You’ve run a TPC-H benchmark on DuckDB (Ibis dataframe code and SQL), DataFusion (Ibis dataframe code and SQL), and Polars (dataframe code via Ibis and native Polars).</p>
</section>
<section id="what-just-happened" class="level4">
<h4 class="anchored" data-anchor-id="what-just-happened">What just happened?</h4>
<p>This will generate TPC-H data at scale factor 1 as Parquet files in the <code>tpch_data</code> directory:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="ex">tpch_data</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└──</span> parquet</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">└──</span> sf=1</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        <span class="ex">└──</span> n=1</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>            <span class="ex">├──</span> customer</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>            <span class="ex">│</span>   └── 0000.parquet</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>            <span class="ex">├──</span> lineitem</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>            <span class="ex">│</span>   └── 0000.parquet</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>            <span class="ex">├──</span> nation</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>            <span class="ex">│</span>   └── 0000.parquet</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>            <span class="ex">├──</span> orders</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>            <span class="ex">│</span>   └── 0000.parquet</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>            <span class="ex">├──</span> part</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>            <span class="ex">│</span>   └── 0000.parquet</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>            <span class="ex">├──</span> partsupp</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>            <span class="ex">│</span>   └── 0000.parquet</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>            <span class="ex">├──</span> region</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>            <span class="ex">│</span>   └── 0000.parquet</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>            <span class="ex">└──</span> supplier</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>                <span class="ex">└──</span> 0000.parquet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The scale factor is roughly the size of data <strong>in memory</strong> in gigabytes (GBs). The size of data on disk, however, is smaller because Parquet is compressed. We can take a look at the size of the data:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="ex">384M</span>    tpch_data/parquet/sf=1/n=1</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="ex">262M</span>    tpch_data/parquet/sf=1/n=1/lineitem</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a> <span class="ex">59M</span>    tpch_data/parquet/sf=1/n=1/orders</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a> <span class="ex">12M</span>    tpch_data/parquet/sf=1/n=1/customer</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a> <span class="ex">43M</span>    tpch_data/parquet/sf=1/n=1/partsupp</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="ex">6.6M</span>    tpch_data/parquet/sf=1/n=1/part</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="ex">788K</span>    tpch_data/parquet/sf=1/n=1/supplier</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="ex">4.0K</span>    tpch_data/parquet/sf=1/n=1/nation</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="ex">4.0K</span>    tpch_data/parquet/sf=1/n=1/region</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We can see the total size is 0.38 GB and the size of the tables – <code>lineitem</code> is by far the largest.</p>
<p>Using <code>bench run</code> results in a <code>results_data</code> directory with the results of the queries and a <code>bench_logs_v2</code> directory with the logs of the benchmark run.</p>
</section>
<section id="analyzing-the-results" class="level4">
<h4 class="anchored" data-anchor-id="analyzing-the-results">Analyzing the results</h4>
<p>We can use Ibis to load and analyze the log data:</p>
<div id="b71f6e75" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ibis</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>ibis.options.<span class="bu">repr</span>.interactive.max_rows <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>ibis.options.<span class="bu">repr</span>.interactive.max_columns <span class="op">=</span> <span class="va">None</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> ibis.read_json(<span class="st">"bench_logs_v*/raw_json/file_id=*.json"</span>).relocate(</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"system"</span>, <span class="st">"sf"</span>, <span class="st">"query_number"</span>, <span class="st">"execution_seconds"</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> system              </span>┃<span style="font-weight: bold"> sf    </span>┃<span style="font-weight: bold"> query_number </span>┃<span style="font-weight: bold"> execution_seconds </span>┃<span style="font-weight: bold"> session_id                           </span>┃<span style="font-weight: bold"> instance_type </span>┃<span style="font-weight: bold"> timestamp                  </span>┃<span style="font-weight: bold"> n_partitions </span>┃<span style="font-weight: bold"> file_type </span>┃<span style="font-weight: bold"> file_id                                   </span>┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">uuid</span>                                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">json</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                                    │
├─────────────────────┼───────┼──────────────┼───────────────────┼──────────────────────────────────────┼───────────────┼────────────────────────────┼──────────────┼───────────┼───────────────────────────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion-sql</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.076600</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>          │ <span style="color: #008000; text-decoration-color: #008000">2024-06-13T16:09:34.476397</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">parquet  </span> │ <span style="color: #008000; text-decoration-color: #008000">00218347-a4cd-4590-a502-8cf79f4e87c9.json</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion-sql</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.165074</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>          │ <span style="color: #008000; text-decoration-color: #008000">2024-06-13T16:09:35.376753</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">parquet  </span> │ <span style="color: #008000; text-decoration-color: #008000">01089668-608c-4551-ae65-6d98d69f959b.json</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-polars        </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.075944</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>          │ <span style="color: #008000; text-decoration-color: #008000">2024-06-13T16:09:36.956001</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">parquet  </span> │ <span style="color: #008000; text-decoration-color: #008000">02a991bd-797a-4c08-83de-c1b537f713fe.json</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.144007</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>          │ <span style="color: #008000; text-decoration-color: #008000">2024-06-13T16:09:32.297647</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">parquet  </span> │ <span style="color: #008000; text-decoration-color: #008000">02bd900a-3c0a-4871-b651-1690f11a81ab.json</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion-sql</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.067048</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>          │ <span style="color: #008000; text-decoration-color: #008000">2024-06-13T16:09:33.699368</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">parquet  </span> │ <span style="color: #008000; text-decoration-color: #008000">08490a6b-e1ab-482c-83bc-85469c6b96a3.json</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb        </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.160302</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>          │ <span style="color: #008000; text-decoration-color: #008000">2024-06-13T16:09:27.316339</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">parquet  </span> │ <span style="color: #008000; text-decoration-color: #008000">08b92577-8150-4040-bceb-9316da7bfaf4.json</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                   │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                          │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                                         │
└─────────────────────┴───────┴──────────────┴───────────────────┴──────────────────────────────────────┴───────────────┴────────────────────────────┴──────────────┴───────────┴───────────────────────────────────────────┘
</pre>
</div>
</div>
<p>We can check the total execution time for each system:</p>
<div id="a00b0895" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>t.group_by(<span class="st">"system"</span>).agg(total_seconds<span class="op">=</span>t[<span class="st">"execution_seconds"</span>].<span class="bu">sum</span>()).order_by(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"total_seconds"</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> system              </span>┃<span style="font-weight: bold"> total_seconds </span>┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │
├─────────────────────┼───────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion-sql</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.006620</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb-sql    </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.067606</span> │
│ <span style="color: #008000; text-decoration-color: #008000">polars-lazy        </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.086350</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-polars        </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.168417</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-duckdb        </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.495270</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ibis-datafusion    </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.529014</span> │
└─────────────────────┴───────────────┘
</pre>
</div>
</div>
<p>We can visualize the results:</p>
<div id="2fa3f9cb" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>px.defaults.template <span class="op">=</span> <span class="st">"plotly_dark"</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>agg <span class="op">=</span> t.group_by(<span class="st">"system"</span>, <span class="st">"query_number"</span>).agg(</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    mean_execution_seconds<span class="op">=</span>t[<span class="st">"execution_seconds"</span>].mean(),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> px.bar(</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    agg,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"query_number"</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"mean_execution_seconds"</span>,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"system"</span>,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    barmode<span class="op">=</span><span class="st">"group"</span>,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Mean execution time by query"</span>,</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    category_orders<span class="op">=</span>{</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"system"</span>: <span class="bu">sorted</span>(t.select(<span class="st">"system"</span>).distinct().to_pandas()[<span class="st">"system"</span>].tolist())</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>chart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="a420bdb4-635f-4cce-8c67-be1f489fed54" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a420bdb4-635f-4cce-8c67-be1f489fed54")) {                    Plotly.newPlot(                        "a420bdb4-635f-4cce-8c67-be1f489fed54",                        [{"alignmentgroup":"True","hovertemplate":"system=ibis-datafusion\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"ibis-datafusion","offsetgroup":"ibis-datafusion","orientation":"v","showlegend":true,"textposition":"auto","x":[4,1,20,12,3,6,2,18,10,9,5,17,14,11,15,8,7,19,13],"xaxis":"x","y":[0.08527374267578125,0.1856980323791504,0.09459996223449707,0.09185004234313965,0.11346817016601562,0.060302019119262695,0.11647200584411621,0.21512389183044434,0.14400672912597656,0.25276899337768555,0.16351318359375,0.1508030891418457,0.05874824523925781,0.05636405944824219,0.09078383445739746,0.17679595947265625,0.21130585670471191,0.18033623695373535,0.08080005645751953],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=ibis-datafusion-sql\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-datafusion-sql","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"ibis-datafusion-sql","offsetgroup":"ibis-datafusion-sql","orientation":"v","showlegend":true,"textposition":"auto","x":[1,21,4,8,7,13,19,11,22,15,5,17,14,9,10,18,2,12,20,6,3],"xaxis":"x","y":[0.16572284698486328,0.16507411003112793,0.05468416213989258,0.10038995742797852,0.11693096160888672,0.08853602409362793,0.10790419578552246,0.04051613807678223,0.04712080955505371,0.08836483955383301,0.09019279479980469,0.1384258270263672,0.05418872833251953,0.14054203033447266,0.11253213882446289,0.16417670249938965,0.06422877311706543,0.0766000747680664,0.08157896995544434,0.04186129570007324,0.06704831123352051],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=ibis-duckdb\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"ibis-duckdb","offsetgroup":"ibis-duckdb","orientation":"v","showlegend":true,"textposition":"auto","x":[17,14,9,5,22,16,11,15,8,13,19,7,1,21,4,3,6,20,12,10,18,2],"xaxis":"x","y":[0.0946509838104248,0.07600784301757812,0.15702605247497559,0.13889694213867188,0.05627894401550293,0.050956010818481445,0.046521902084350586,0.10355687141418457,0.17993402481079102,0.08141613006591797,0.10899090766906738,0.22138595581054688,0.11120414733886719,0.18820619583129883,0.10530900955200195,0.11275124549865723,0.05837392807006836,0.09756278991699219,0.08757591247558594,0.16030216217041016,0.19187211990356445,0.06649017333984375],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=ibis-duckdb-sql\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-duckdb-sql","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"ibis-duckdb-sql","offsetgroup":"ibis-duckdb-sql","orientation":"v","showlegend":true,"textposition":"auto","x":[7,19,8,13,20,6,12,3,1,21,14,5,17,9,11,16,15,22,2,18,10,4],"xaxis":"x","y":[0.1173713207244873,0.10991191864013672,0.10016512870788574,0.11796116828918457,0.0834193229675293,0.0639650821685791,0.1077890396118164,0.08614110946655273,0.0995640754699707,0.18464303016662598,0.07589483261108398,0.08590102195739746,0.0904390811920166,0.1208350658416748,0.03215789794921875,0.040780067443847656,0.11138105392456055,0.052903175354003906,0.04390978813171387,0.14215707778930664,0.13234424591064453,0.06797170639038086],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=ibis-polars\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ibis-polars","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"ibis-polars","offsetgroup":"ibis-polars","orientation":"v","showlegend":true,"textposition":"auto","x":[12,3,6,8,7,19,4,18,2,10,9,5,1],"xaxis":"x","y":[0.0759439468383789,0.08300375938415527,0.04763507843017578,0.13718080520629883,0.14421916007995605,0.24024128913879395,0.061795949935913086,0.4647057056427002,0.062339067459106445,0.09395790100097656,0.375777006149292,0.0971367359161377,0.2844810485839844],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"system=polars-lazy\u003cbr\u003equery_number=%{x}\u003cbr\u003emean_execution_seconds=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"polars-lazy","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"polars-lazy","offsetgroup":"polars-lazy","orientation":"v","showlegend":true,"textposition":"auto","x":[1,21,4,13,8,19,7,11,15,16,22,14,9,17,5,10,18,2,6,12,3,20],"xaxis":"x","y":[0.14653277397155762,0.4784820079803467,0.04979085922241211,0.07697010040283203,0.08124113082885742,0.09669184684753418,0.07666802406311035,0.060350894927978516,0.0383148193359375,0.027947187423706055,0.034562110900878906,0.04080796241760254,0.2673678398132324,0.07406091690063477,0.06595110893249512,0.08218693733215332,0.10887598991394043,0.02666497230529785,0.04187202453613281,0.09165000915527344,0.05814409255981445,0.06121683120727539],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"query_number"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mean_execution_seconds"}},"legend":{"title":{"text":"system"},"tracegroupgap":0},"title":{"text":"Mean execution time by query"},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a420bdb4-635f-4cce-8c67-be1f489fed54');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="what-did-we-run-and-measure-exactly" class="level4">
<h4 class="anchored" data-anchor-id="what-did-we-run-and-measure-exactly">What did we run and measure, exactly?</h4>
<p>We can import <code>ibis_bench</code> as a library and read in the TPC-H tables:</p>
<div id="1a13c9ac" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ibis</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> date</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ibis_bench.utils.read_data <span class="im">import</span> get_ibis_tables, get_polars_tables</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>sf <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Ibis (DuckDB)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Ibis (DataFusion)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Ibis (Polars)</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div id="433ef1b7" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> ibis.<span class="ex">connect</span>(<span class="st">"duckdb://"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>(customer, lineitem, nation, orders, part, partsupp, region, supplier) <span class="op">=</span> (</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    get_ibis_tables(sf<span class="op">=</span>sf, con<span class="op">=</span>con)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="158ed122" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>lineitem.order_by(ibis.desc(<span class="st">"l_orderkey"</span>), ibis.asc(<span class="st">"l_partkey"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> l_orderkey </span>┃<span style="font-weight: bold"> l_partkey </span>┃<span style="font-weight: bold"> l_suppkey </span>┃<span style="font-weight: bold"> l_linenumber </span>┃<span style="font-weight: bold"> l_quantity     </span>┃<span style="font-weight: bold"> l_extendedprice </span>┃<span style="font-weight: bold"> l_discount     </span>┃<span style="font-weight: bold"> l_tax          </span>┃<span style="font-weight: bold"> l_returnflag </span>┃<span style="font-weight: bold"> l_linestatus </span>┃<span style="font-weight: bold"> l_shipdate </span>┃<span style="font-weight: bold"> l_commitdate </span>┃<span style="font-weight: bold"> l_receiptdate </span>┃<span style="font-weight: bold"> l_shipinstruct    </span>┃<span style="font-weight: bold"> l_shipmode </span>┃<span style="font-weight: bold"> l_comment                                </span>┃
┡━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                                   │
├────────────┼───────────┼───────────┼──────────────┼────────────────┼─────────────────┼────────────────┼────────────────┼──────────────┼──────────────┼────────────┼──────────────┼───────────────┼───────────────────┼────────────┼──────────────────────────────────────────┤
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6000000</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32255</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2256</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.00</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5936.25</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span> │ <span style="color: #008000; text-decoration-color: #008000">N           </span> │ <span style="color: #008000; text-decoration-color: #008000">O           </span> │ <span style="color: #800080; text-decoration-color: #800080">1996-11-02</span> │ <span style="color: #800080; text-decoration-color: #800080">1996-11-19</span>   │ <span style="color: #800080; text-decoration-color: #800080">1996-12-01</span>    │ <span style="color: #008000; text-decoration-color: #008000">TAKE BACK RETURN </span> │ <span style="color: #008000; text-decoration-color: #008000">MAIL      </span> │ <span style="color: #008000; text-decoration-color: #008000">riously pe                              </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6000000</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96127</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6128</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31447.36</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02</span> │ <span style="color: #008000; text-decoration-color: #008000">N           </span> │ <span style="color: #008000; text-decoration-color: #008000">O           </span> │ <span style="color: #800080; text-decoration-color: #800080">1996-09-22</span> │ <span style="color: #800080; text-decoration-color: #800080">1996-10-01</span>   │ <span style="color: #800080; text-decoration-color: #800080">1996-10-21</span>    │ <span style="color: #008000; text-decoration-color: #008000">NONE             </span> │ <span style="color: #008000; text-decoration-color: #008000">AIR       </span> │ <span style="color: #008000; text-decoration-color: #008000">pecial excuses nag evenly f             </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999975</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6452</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1453</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.00</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9509.15</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │ <span style="color: #008000; text-decoration-color: #008000">A           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-11-02</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-23</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-11-19</span>    │ <span style="color: #008000; text-decoration-color: #008000">DELIVER IN PERSON</span> │ <span style="color: #008000; text-decoration-color: #008000">SHIP      </span> │ <span style="color: #008000; text-decoration-color: #008000">ffily along the sly                     </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999975</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7272</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2273</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37736.64</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span> │ <span style="color: #008000; text-decoration-color: #008000">R           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-10-07</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-30</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-10-21</span>    │ <span style="color: #008000; text-decoration-color: #008000">COLLECT COD      </span> │ <span style="color: #008000; text-decoration-color: #008000">REG AIR   </span> │ <span style="color: #008000; text-decoration-color: #008000">ld deposits aga                         </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999975</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37131</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2138</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19226.34</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span> │ <span style="color: #008000; text-decoration-color: #008000">A           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-11-17</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-08-28</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-12-08</span>    │ <span style="color: #008000; text-decoration-color: #008000">DELIVER IN PERSON</span> │ <span style="color: #008000; text-decoration-color: #008000">FOB       </span> │ <span style="color: #008000; text-decoration-color: #008000">counts cajole evenly? sly orbits boost f</span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999974</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10463</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5466</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">63179.16</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06</span> │ <span style="color: #008000; text-decoration-color: #008000">R           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-16</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-21</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-10-02</span>    │ <span style="color: #008000; text-decoration-color: #008000">COLLECT COD      </span> │ <span style="color: #008000; text-decoration-color: #008000">RAIL      </span> │ <span style="color: #008000; text-decoration-color: #008000">se slyly alo                            </span> │
│          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                                        │
└────────────┴───────────┴───────────┴──────────────┴────────────────┴─────────────────┴────────────────┴────────────────┴──────────────┴──────────────┴────────────┴──────────────┴───────────────┴───────────────────┴────────────┴──────────────────────────────────────────┘
</pre>
</div>
</div>
<div id="fa046a2f" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>lineitem.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div class="ansi-escaped-output">
<pre>┌─────────┐
│ <span class="ansi-cyan-fg ansi-bold">6001215</span> │
└─────────┘</pre>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div id="f55bfce4" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> ibis.<span class="ex">connect</span>(<span class="st">"datafusion://"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>(customer, lineitem, nation, orders, part, partsupp, region, supplier) <span class="op">=</span> (</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    get_ibis_tables(sf<span class="op">=</span>sf, con<span class="op">=</span>con)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a44a2da2" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>lineitem.order_by(ibis.desc(<span class="st">"l_orderkey"</span>), ibis.asc(<span class="st">"l_partkey"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> l_orderkey </span>┃<span style="font-weight: bold"> l_partkey </span>┃<span style="font-weight: bold"> l_suppkey </span>┃<span style="font-weight: bold"> l_linenumber </span>┃<span style="font-weight: bold"> l_quantity     </span>┃<span style="font-weight: bold"> l_extendedprice </span>┃<span style="font-weight: bold"> l_discount     </span>┃<span style="font-weight: bold"> l_tax          </span>┃<span style="font-weight: bold"> l_returnflag </span>┃<span style="font-weight: bold"> l_linestatus </span>┃<span style="font-weight: bold"> l_shipdate </span>┃<span style="font-weight: bold"> l_commitdate </span>┃<span style="font-weight: bold"> l_receiptdate </span>┃<span style="font-weight: bold"> l_shipinstruct    </span>┃<span style="font-weight: bold"> l_shipmode </span>┃<span style="font-weight: bold"> l_comment                                </span>┃
┡━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                                   │
├────────────┼───────────┼───────────┼──────────────┼────────────────┼─────────────────┼────────────────┼────────────────┼──────────────┼──────────────┼────────────┼──────────────┼───────────────┼───────────────────┼────────────┼──────────────────────────────────────────┤
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6000000</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32255</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2256</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.00</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5936.25</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span> │ <span style="color: #008000; text-decoration-color: #008000">N           </span> │ <span style="color: #008000; text-decoration-color: #008000">O           </span> │ <span style="color: #800080; text-decoration-color: #800080">1996-11-02</span> │ <span style="color: #800080; text-decoration-color: #800080">1996-11-19</span>   │ <span style="color: #800080; text-decoration-color: #800080">1996-12-01</span>    │ <span style="color: #008000; text-decoration-color: #008000">TAKE BACK RETURN </span> │ <span style="color: #008000; text-decoration-color: #008000">MAIL      </span> │ <span style="color: #008000; text-decoration-color: #008000">riously pe                              </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6000000</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96127</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6128</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31447.36</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02</span> │ <span style="color: #008000; text-decoration-color: #008000">N           </span> │ <span style="color: #008000; text-decoration-color: #008000">O           </span> │ <span style="color: #800080; text-decoration-color: #800080">1996-09-22</span> │ <span style="color: #800080; text-decoration-color: #800080">1996-10-01</span>   │ <span style="color: #800080; text-decoration-color: #800080">1996-10-21</span>    │ <span style="color: #008000; text-decoration-color: #008000">NONE             </span> │ <span style="color: #008000; text-decoration-color: #008000">AIR       </span> │ <span style="color: #008000; text-decoration-color: #008000">pecial excuses nag evenly f             </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999975</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6452</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1453</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.00</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9509.15</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │ <span style="color: #008000; text-decoration-color: #008000">A           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-11-02</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-23</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-11-19</span>    │ <span style="color: #008000; text-decoration-color: #008000">DELIVER IN PERSON</span> │ <span style="color: #008000; text-decoration-color: #008000">SHIP      </span> │ <span style="color: #008000; text-decoration-color: #008000">ffily along the sly                     </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999975</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7272</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2273</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37736.64</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span> │ <span style="color: #008000; text-decoration-color: #008000">R           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-10-07</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-30</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-10-21</span>    │ <span style="color: #008000; text-decoration-color: #008000">COLLECT COD      </span> │ <span style="color: #008000; text-decoration-color: #008000">REG AIR   </span> │ <span style="color: #008000; text-decoration-color: #008000">ld deposits aga                         </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999975</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37131</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2138</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19226.34</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span> │ <span style="color: #008000; text-decoration-color: #008000">A           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-11-17</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-08-28</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-12-08</span>    │ <span style="color: #008000; text-decoration-color: #008000">DELIVER IN PERSON</span> │ <span style="color: #008000; text-decoration-color: #008000">FOB       </span> │ <span style="color: #008000; text-decoration-color: #008000">counts cajole evenly? sly orbits boost f</span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999974</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10463</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5466</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">63179.16</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06</span> │ <span style="color: #008000; text-decoration-color: #008000">R           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-16</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-21</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-10-02</span>    │ <span style="color: #008000; text-decoration-color: #008000">COLLECT COD      </span> │ <span style="color: #008000; text-decoration-color: #008000">RAIL      </span> │ <span style="color: #008000; text-decoration-color: #008000">se slyly alo                            </span> │
│          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                                        │
└────────────┴───────────┴───────────┴──────────────┴────────────────┴─────────────────┴────────────────┴────────────────┴──────────────┴──────────────┴────────────┴──────────────┴───────────────┴───────────────────┴────────────┴──────────────────────────────────────────┘
</pre>
</div>
</div>
<div id="dede606b" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>lineitem.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div class="ansi-escaped-output">
<pre>┌─────────┐
│ <span class="ansi-cyan-fg ansi-bold">6001215</span> │
└─────────┘</pre>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div id="f5311d71" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> ibis.<span class="ex">connect</span>(<span class="st">"polars://"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>(customer, lineitem, nation, orders, part, partsupp, region, supplier) <span class="op">=</span> (</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    get_ibis_tables(sf<span class="op">=</span>sf, con<span class="op">=</span>con)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="22d64fa7" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>lineitem.order_by(ibis.desc(<span class="st">"l_orderkey"</span>), ibis.asc(<span class="st">"l_partkey"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> l_orderkey </span>┃<span style="font-weight: bold"> l_partkey </span>┃<span style="font-weight: bold"> l_suppkey </span>┃<span style="font-weight: bold"> l_linenumber </span>┃<span style="font-weight: bold"> l_quantity     </span>┃<span style="font-weight: bold"> l_extendedprice </span>┃<span style="font-weight: bold"> l_discount     </span>┃<span style="font-weight: bold"> l_tax          </span>┃<span style="font-weight: bold"> l_returnflag </span>┃<span style="font-weight: bold"> l_linestatus </span>┃<span style="font-weight: bold"> l_shipdate </span>┃<span style="font-weight: bold"> l_commitdate </span>┃<span style="font-weight: bold"> l_receiptdate </span>┃<span style="font-weight: bold"> l_shipinstruct    </span>┃<span style="font-weight: bold"> l_shipmode </span>┃<span style="font-weight: bold"> l_comment                                </span>┃
┡━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decimal(15, 2)</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                                   │
├────────────┼───────────┼───────────┼──────────────┼────────────────┼─────────────────┼────────────────┼────────────────┼──────────────┼──────────────┼────────────┼──────────────┼───────────────┼───────────────────┼────────────┼──────────────────────────────────────────┤
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6000000</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32255</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2256</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.00</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5936.25</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span> │ <span style="color: #008000; text-decoration-color: #008000">N           </span> │ <span style="color: #008000; text-decoration-color: #008000">O           </span> │ <span style="color: #800080; text-decoration-color: #800080">1996-11-02</span> │ <span style="color: #800080; text-decoration-color: #800080">1996-11-19</span>   │ <span style="color: #800080; text-decoration-color: #800080">1996-12-01</span>    │ <span style="color: #008000; text-decoration-color: #008000">TAKE BACK RETURN </span> │ <span style="color: #008000; text-decoration-color: #008000">MAIL      </span> │ <span style="color: #008000; text-decoration-color: #008000">riously pe                              </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6000000</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96127</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6128</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31447.36</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02</span> │ <span style="color: #008000; text-decoration-color: #008000">N           </span> │ <span style="color: #008000; text-decoration-color: #008000">O           </span> │ <span style="color: #800080; text-decoration-color: #800080">1996-09-22</span> │ <span style="color: #800080; text-decoration-color: #800080">1996-10-01</span>   │ <span style="color: #800080; text-decoration-color: #800080">1996-10-21</span>    │ <span style="color: #008000; text-decoration-color: #008000">NONE             </span> │ <span style="color: #008000; text-decoration-color: #008000">AIR       </span> │ <span style="color: #008000; text-decoration-color: #008000">pecial excuses nag evenly f             </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999975</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6452</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1453</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.00</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9509.15</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │ <span style="color: #008000; text-decoration-color: #008000">A           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-11-02</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-23</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-11-19</span>    │ <span style="color: #008000; text-decoration-color: #008000">DELIVER IN PERSON</span> │ <span style="color: #008000; text-decoration-color: #008000">SHIP      </span> │ <span style="color: #008000; text-decoration-color: #008000">ffily along the sly                     </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999975</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7272</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2273</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37736.64</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span> │ <span style="color: #008000; text-decoration-color: #008000">R           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-10-07</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-30</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-10-21</span>    │ <span style="color: #008000; text-decoration-color: #008000">COLLECT COD      </span> │ <span style="color: #008000; text-decoration-color: #008000">REG AIR   </span> │ <span style="color: #008000; text-decoration-color: #008000">ld deposits aga                         </span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999975</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37131</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2138</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19226.34</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span> │ <span style="color: #008000; text-decoration-color: #008000">A           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-11-17</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-08-28</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-12-08</span>    │ <span style="color: #008000; text-decoration-color: #008000">DELIVER IN PERSON</span> │ <span style="color: #008000; text-decoration-color: #008000">FOB       </span> │ <span style="color: #008000; text-decoration-color: #008000">counts cajole evenly? sly orbits boost f</span> │
│    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5999974</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10463</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5466</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">63179.16</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06</span> │ <span style="color: #008000; text-decoration-color: #008000">R           </span> │ <span style="color: #008000; text-decoration-color: #008000">F           </span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-16</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-09-21</span>   │ <span style="color: #800080; text-decoration-color: #800080">1993-10-02</span>    │ <span style="color: #008000; text-decoration-color: #008000">COLLECT COD      </span> │ <span style="color: #008000; text-decoration-color: #008000">RAIL      </span> │ <span style="color: #008000; text-decoration-color: #008000">se slyly alo                            </span> │
│          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                                        │
└────────────┴───────────┴───────────┴──────────────┴────────────────┴─────────────────┴────────────────┴────────────────┴──────────────┴──────────────┴────────────┴──────────────┴───────────────┴───────────────────┴────────────┴──────────────────────────────────────────┘
</pre>
</div>
</div>
<div id="748af914" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>lineitem.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div class="ansi-escaped-output">
<pre>┌─────────┐
│ <span class="ansi-cyan-fg ansi-bold">6001215</span> │
└─────────┘</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<p>The queries are also defined in <code>ibis_bench.queries</code>. Let’s look at query 4 as an example for Ibis dataframe code, Polars dataframe code, and SQL code via Ibis:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Ibis (dataframe)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Polars (dataframe)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Ibis (SQL)</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Define query 4:</p>
<div id="7453444c" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> q4(lineitem, orders, <span class="op">**</span>kwargs):</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    var1 <span class="op">=</span> date(<span class="dv">1993</span>, <span class="dv">7</span>, <span class="dv">1</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    var2 <span class="op">=</span> date(<span class="dv">1993</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    q_final <span class="op">=</span> (</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>        lineitem.join(orders, lineitem[<span class="st">"l_orderkey"</span>] <span class="op">==</span> orders[<span class="st">"o_orderkey"</span>])</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">filter</span>((orders[<span class="st">"o_orderdate"</span>] <span class="op">&gt;=</span> var1) <span class="op">&amp;</span> (orders[<span class="st">"o_orderdate"</span>] <span class="op">&lt;</span> var2))</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">filter</span>(lineitem[<span class="st">"l_commitdate"</span>] <span class="op">&lt;</span> lineitem[<span class="st">"l_receiptdate"</span>])</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>        .distinct(on<span class="op">=</span>[<span class="st">"o_orderpriority"</span>, <span class="st">"l_orderkey"</span>])</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>        .group_by(<span class="st">"o_orderpriority"</span>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>        .agg(order_count<span class="op">=</span>ibis._.count())</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>        .order_by(<span class="st">"o_orderpriority"</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> q_final</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run query 4:</p>
<div id="f0eccdcd" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> q4(lineitem, orders)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> o_orderpriority </span>┃<span style="font-weight: bold"> order_count </span>┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │
├─────────────────┼─────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">1-URGENT       </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10594</span> │
│ <span style="color: #008000; text-decoration-color: #008000">2-HIGH         </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10476</span> │
│ <span style="color: #008000; text-decoration-color: #008000">3-MEDIUM       </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10410</span> │
│ <span style="color: #008000; text-decoration-color: #008000">4-NOT SPECIFIED</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10556</span> │
│ <span style="color: #008000; text-decoration-color: #008000">5-LOW          </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10487</span> │
└─────────────────┴─────────────┘
</pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Define query 4:</p>
<div id="29462da9" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> q4(lineitem, orders, <span class="op">**</span>kwargs):</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    var1 <span class="op">=</span> date(<span class="dv">1993</span>, <span class="dv">7</span>, <span class="dv">1</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    var2 <span class="op">=</span> date(<span class="dv">1993</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    q_final <span class="op">=</span> (</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>        lineitem.join(orders, left_on<span class="op">=</span><span class="st">"l_orderkey"</span>, right_on<span class="op">=</span><span class="st">"o_orderkey"</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">filter</span>(pl.col(<span class="st">"o_orderdate"</span>).is_between(var1, var2, closed<span class="op">=</span><span class="st">"left"</span>))</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">filter</span>(pl.col(<span class="st">"l_commitdate"</span>) <span class="op">&lt;</span> pl.col(<span class="st">"l_receiptdate"</span>))</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>        .unique(subset<span class="op">=</span>[<span class="st">"o_orderpriority"</span>, <span class="st">"l_orderkey"</span>])</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>        .group_by(<span class="st">"o_orderpriority"</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        .agg(pl.<span class="bu">len</span>().alias(<span class="st">"order_count"</span>))</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>        .sort(<span class="st">"o_orderpriority"</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> q_final</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run query 4:</p>
<div id="413c54da" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> q4(lineitem.to_polars().lazy(), orders.to_polars().lazy()).collect()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">o_orderpriority</th>
<th data-quarto-table-cell-role="th">order_count</th>
</tr>
<tr class="odd">
<th>str</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"1-URGENT"</td>
<td>10594</td>
</tr>
<tr class="even">
<td>"2-HIGH"</td>
<td>10476</td>
</tr>
<tr class="odd">
<td>"3-MEDIUM"</td>
<td>10410</td>
</tr>
<tr class="even">
<td>"4-NOT SPECIFIED"</td>
<td>10556</td>
</tr>
<tr class="odd">
<td>"5-LOW"</td>
<td>10487</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Define query 4:</p>
<div id="e5b9eefb" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>q4_sql <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="st">    o_orderpriority,</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="st">    count(*) AS order_count</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="st">    orders</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="st">    o_orderdate &gt;= CAST('1993-07-01' AS date)</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="st">    AND o_orderdate &lt; CAST('1993-10-01' AS date)</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="st">    AND EXISTS (</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="st">        SELECT</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="st">            *</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="st">        FROM</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="st">            lineitem</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="st">        WHERE</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="st">            l_orderkey = o_orderkey</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="st">            AND l_commitdate &lt; l_receiptdate)</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="st">    o_orderpriority</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="st">    o_orderpriority;</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>q4_sql <span class="op">=</span> q4_sql.strip().strip(<span class="st">";"</span>)</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> q4(lineitem, orders, dialect<span class="op">=</span><span class="st">"duckdb"</span>, <span class="op">**</span>kwargs):</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> orders.sql(q4_sql, dialect<span class="op">=</span>dialect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run query 4:</p>
<div id="b9d83a87" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> q4(lineitem, orders)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> o_orderpriority </span>┃<span style="font-weight: bold"> order_count </span>┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │
├─────────────────┼─────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">1-URGENT       </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10594</span> │
│ <span style="color: #008000; text-decoration-color: #008000">2-HIGH         </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10476</span> │
│ <span style="color: #008000; text-decoration-color: #008000">3-MEDIUM       </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10410</span> │
│ <span style="color: #008000; text-decoration-color: #008000">4-NOT SPECIFIED</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10556</span> │
│ <span style="color: #008000; text-decoration-color: #008000">5-LOW          </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10487</span> │
└─────────────────┴─────────────┘
</pre>
</div>
</div>
</div>
</div>
</div>
<p>Finally, we write the result to a Parquet file. We are measuring the execution time in seconds of calling the query and writing the results to disk.</p>
</section>
</section>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next steps</h2>
<p>We’ll publish the next iteration of this benchmark soon with updated Polars TPC-H queries and using newer versions of all libraries. Polars v1.0.0 should release soon. A new DataFusion version that fixes the remaining failing queries is also expected soon.</p>
<p>If you spot anything wrong, have any questions, or want to share your own analysis, feel free to share below!</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ibis-project\.org");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="ibis-project/ibis" data-repo-id="MDEwOlJlcG9zaXRvcnkzNDEzOTIzMA==" data-category="Q&amp;A" data-category-id="DIC_kwDOAgjsXs4CASeT" data-mapping="title" data-reactions-enabled="0" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ibis-project/ibis/edit/main/docs/posts/ibis-bench/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ibis-project/ibis/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ibis-project">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://ibis-project.zulipchat.com">
      <i class="bi bi-zulip" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://ibis-project.org/posts.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>