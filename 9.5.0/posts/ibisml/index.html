<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jiting Xu">
<meta name="dcterms.date" content="2024-08-22">

<title>Using IbisML and DuckDB for a Kaggle competition: credit risk model stability – Ibis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<script src="../../site_libs/quarto-search/autocomplete-preset-algolia.umd.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../logo.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e67ff5f79a98c6389aa7c0b9e6712459.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-14475e581903c9a7e5ed069634c08d5c.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-12c8c4cf821d2fd1848e951be45237d8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "algolia": {
    "application-id": "TNU9HG3L41",
    "search-only-api-key": "26350948d1961209df16d9717a7e01d6",
    "index-name": "prod_ibis",
    "analytics-events": true,
    "show-logo": true,
    "libDir": "site_libs"
  },
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.5.1/dist/algoliasearch-lite.umd.js"></script>


<script type="text/javascript">
var ALGOLIA_INSIGHTS_SRC = "https://cdn.jsdelivr.net/npm/search-insights/dist/search-insights.iife.min.js";
!function(e,a,t,n,s,i,c){e.AlgoliaAnalyticsObject=s,e[s]=e[s]||function(){
(e[s].queue=e[s].queue||[]).push(arguments)},i=a.createElement(t),c=a.getElementsByTagName(t)[0],
i.async=1,i.src=n,c.parentNode.insertBefore(i,c)
}(window,document,"script",ALGOLIA_INSIGHTS_SRC,"aa");
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-algolia-insights">

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>
<script data-goatcounter="https://ibis.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Using IbisML and DuckDB for a Kaggle competition: credit risk model stability – Ibis">
<meta property="og:description" content="the portable Python dataframe library">
<meta property="og:image" content="https://ibis-project.org/posts/ibisml/logo.png">
<meta property="og:site_name" content="Ibis">
<meta name="twitter:title" content="Using IbisML and DuckDB for a Kaggle competition: credit risk model stability – Ibis">
<meta name="twitter:description" content="the portable Python dataframe library">
<meta name="twitter:image" content="https://ibis-project.org/posts/ibisml/logo.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Ibis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-getting-started" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Getting started</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-getting-started">    
        <li>
    <a class="dropdown-item" href="../../install.html">
 <span class="dropdown-text">Installation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/getting_started.html">
 <span class="dropdown-text">Tutorial: getting started</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/ibis-for-dplyr-users.html">
 <span class="dropdown-text">Tutorial: Ibis for dplyr users</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/ibis-for-pandas-users.html">
 <span class="dropdown-text">Tutorial: Ibis for pandas users</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/ibis-for-sql-users.html">
 <span class="dropdown-text">Tutorial: Ibis for SQL users</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Browser</li>
        <li>
    <a class="dropdown-item" href="../../tutorials/browser/repl.html">
 <span class="dropdown-text">JupyterLite console</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Cloud Data Platforms</li>
        <li>
    <a class="dropdown-item" href="../../tutorials/cloud-data-platforms/clickhouse.html">
 <span class="dropdown-text">ClickHouse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/cloud-data-platforms/starburst-galaxy/0_setup.html">
 <span class="dropdown-text">Starburst Galaxy</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Open Source Software</li>
        <li>
    <a class="dropdown-item" href="../../tutorials/open-source-software/apache-flink/0_setup.html">
 <span class="dropdown-text">Apache Flink</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-concepts" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Concepts</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-concepts">    
        <li>
    <a class="dropdown-item" href="../../why.html">
 <span class="dropdown-text">Why Ibis?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/composable-ecosystem.html">
 <span class="dropdown-text">Composable data ecosystem</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/datatypes.html">
 <span class="dropdown-text">Datatypes and Datashapes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/internals.html">
 <span class="dropdown-text">Internals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/user-testimonials.html">
 <span class="dropdown-text">User testimonials</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/versioning.html">
 <span class="dropdown-text">Versioning policy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../concepts/who.html">
 <span class="dropdown-text">Who supports Ibis?</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-backends" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Backends</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-backends">    
        <li>
    <a class="dropdown-item" href="../../backends/bigquery.html">
 <span class="dropdown-text">BigQuery</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/clickhouse.html">
 <span class="dropdown-text">ClickHouse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/dask.html">
 <span class="dropdown-text">Dask</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/datafusion.html">
 <span class="dropdown-text">DataFusion</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/druid.html">
 <span class="dropdown-text">Druid</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/duckdb.html">
 <span class="dropdown-text">DuckDB</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/exasol.html">
 <span class="dropdown-text">Exasol</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/flink.html">
 <span class="dropdown-text">Flink</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/impala.html">
 <span class="dropdown-text">Impala</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/mssql.html">
 <span class="dropdown-text">MSSQL</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/mysql.html">
 <span class="dropdown-text">MySQL</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/oracle.html">
 <span class="dropdown-text">Oracle</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/pandas.html">
 <span class="dropdown-text">pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/polars.html">
 <span class="dropdown-text">Polars</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/postgresql.html">
 <span class="dropdown-text">PostgreSQL</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/pyspark.html">
 <span class="dropdown-text">PySpark</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/risingwave.html">
 <span class="dropdown-text">RisingWave</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/snowflake.html">
 <span class="dropdown-text">Snowflake</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/sqlite.html">
 <span class="dropdown-text">SQLite</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/trino.html">
 <span class="dropdown-text">Trino</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Support</li>
        <li>
    <a class="dropdown-item" href="../../backends/support/matrix.html">
 <span class="dropdown-text">Operation support matrix</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../backends/support/operations.html">
 <span class="dropdown-text">Operations</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-how-to" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">How-to</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-how-to">    
        <li class="dropdown-header">Configure</li>
        <li>
    <a class="dropdown-item" href="../../how-to/configure/basics.html">
 <span class="dropdown-text">Basic configuration</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Input Output</li>
        <li>
    <a class="dropdown-item" href="../../how-to/input-output/basics.html">
 <span class="dropdown-text">Basic input/output</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/input-output/duckdb-parquet.html">
 <span class="dropdown-text">Read parquet files with Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/input-output/gcs_duckdb.html">
 <span class="dropdown-text">Loading Google Cloud Storage files with DuckDB</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/input-output/multiple-backends.html">
 <span class="dropdown-text">Work with multiple backends</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Analytics</li>
        <li>
    <a class="dropdown-item" href="../../how-to/analytics/basics.html">
 <span class="dropdown-text">Basic analytics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/analytics/chain_expressions.html">
 <span class="dropdown-text">Chaining expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/analytics/imdb.html">
 <span class="dropdown-text">Analyze IMDB data using Ibis</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Visualization</li>
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/altair.html">
 <span class="dropdown-text">Altair + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/graphs.html">
 <span class="dropdown-text">GraphViz + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/matplotlib.html">
 <span class="dropdown-text">matplotlib + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/plotly.html">
 <span class="dropdown-text">Plotly + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/plotnine.html">
 <span class="dropdown-text">plotnine + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/seaborn.html">
 <span class="dropdown-text">seaborn + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/visualization/streamlit.html">
 <span class="dropdown-text">Streamlit + Ibis</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Extending</li>
        <li>
    <a class="dropdown-item" href="../../how-to/extending/builtin.html">
 <span class="dropdown-text">Reference built-in functions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/extending/sql.html">
 <span class="dropdown-text">Using SQL strings with Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/extending/streaming.html">
 <span class="dropdown-text">Ibis for streaming</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../how-to/extending/unbound_expression.html">
 <span class="dropdown-text">Write and execute unbound expressions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-reference" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Reference</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-reference">    
        <li class="dropdown-header">Expression API</li>
        <li>
    <a class="dropdown-item" href="../../reference/expression-tables.html">
 <span class="dropdown-text">Table expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/selectors.html">
 <span class="dropdown-text">Column selectors</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-generic.html">
 <span class="dropdown-text">Generic expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-numeric.html">
 <span class="dropdown-text">Numeric and Boolean expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-strings.html">
 <span class="dropdown-text">String expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-temporal.html">
 <span class="dropdown-text">Temporal expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-collections.html">
 <span class="dropdown-text">Collection expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/expression-geospatial.html">
 <span class="dropdown-text">Geospatial expressions</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Type system</li>
        <li>
    <a class="dropdown-item" href="../../reference/datatypes.html">
 <span class="dropdown-text">Data types</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/schemas.html">
 <span class="dropdown-text">Schemas</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">UDFs</li>
        <li>
    <a class="dropdown-item" href="../../reference/scalar-udfs.html">
 <span class="dropdown-text">Scalar UDFs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/aggregate-udfs.html">
 <span class="dropdown-text">Aggregate UDFs (experimental)</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Connection APIs</li>
        <li>
    <a class="dropdown-item" href="../../reference/connection.html">
 <span class="dropdown-text">Top-level connection APIs</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Configuration</li>
        <li>
    <a class="dropdown-item" href="../../reference/Interactive.html">
 <span class="dropdown-text">Interactive</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/Options.html">
 <span class="dropdown-text">Options</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/Repr.html">
 <span class="dropdown-text">Repr</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../reference/SQL.html">
 <span class="dropdown-text">SQL</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Cursed Knowledge</li>
        <li>
    <a class="dropdown-item" href="../../reference/cursed_knowledge.html">
 <span class="dropdown-text">Cursed Knowledge</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../presentations.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../release_notes.html"> 
<span class="menu-text">Release notes</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-contribute" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Contribute</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-contribute">    
        <li class="dropdown-header">Contribute</li>
        <li>
    <a class="dropdown-item" href="../../contribute/01_environment.html">
 <span class="dropdown-text">Setting up a development environment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../contribute/02_workflow.html">
 <span class="dropdown-text">Contribute to the Ibis codebase</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../contribute/03_style.html">
 <span class="dropdown-text">Style and formatting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../contribute/04_maintainers_guide.html">
 <span class="dropdown-text">Maintaining the codebase</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../contribute/05_reference.html">
 <span class="dropdown-text">Test class reference</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis">
            Source code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/issues/new?assignees=&amp;labels=bug&amp;projects=&amp;template=bug-report.yml&amp;title=bug">
            Report a bug
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/issues/new?assignees=&amp;labels=docs&amp;projects=&amp;template=docs-issue.yml&amp;title=docs">
            Report a documentation issue
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/issues/new?assignees=&amp;labels=feature&amp;projects=&amp;template=feature-request.yml&amp;title=feat">
            Submit a feature request
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/discussions/new?category=q-a">
            Ask the community for help
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Using IbisML and DuckDB for a Kaggle competition: credit risk model stability</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">blog</div>
                <div class="quarto-category">duckdb</div>
                <div class="quarto-category">machine learning</div>
                <div class="quarto-category">feature engineering</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jiting Xu </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 22, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites">Prerequisites</a>
  <ul class="collapse">
  <li><a href="#download-data" id="toc-download-data" class="nav-link" data-scroll-target="#download-data">Download data</a></li>
  <li><a href="#install-libraries" id="toc-install-libraries" class="nav-link" data-scroll-target="#install-libraries">Install libraries</a></li>
  </ul></li>
  <li><a href="#data-loading-and-processing" id="toc-data-loading-and-processing" class="nav-link" data-scroll-target="#data-loading-and-processing">Data loading and processing</a>
  <ul class="collapse">
  <li><a href="#directory-structure-and-tables" id="toc-directory-structure-and-tables" class="nav-link" data-scroll-target="#directory-structure-and-tables">Directory structure and tables</a></li>
  <li><a href="#data-loading-and-processing-1" id="toc-data-loading-and-processing-1" class="nav-link" data-scroll-target="#data-loading-and-processing-1">Data loading and processing</a></li>
  <li><a href="#select-features" id="toc-select-features" class="nav-link" data-scroll-target="#select-features">Select features</a></li>
  </ul></li>
  <li><a href="#last-mile-data-preprocessing" id="toc-last-mile-data-preprocessing" class="nav-link" data-scroll-target="#last-mile-data-preprocessing">Last-mile data preprocessing</a>
  <ul class="collapse">
  <li><a href="#impute-features" id="toc-impute-features" class="nav-link" data-scroll-target="#impute-features">Impute features</a></li>
  <li><a href="#encode-categorical-features" id="toc-encode-categorical-features" class="nav-link" data-scroll-target="#encode-categorical-features">Encode categorical features</a></li>
  <li><a href="#handle-date-variables" id="toc-handle-date-variables" class="nav-link" data-scroll-target="#handle-date-variables">Handle date variables</a></li>
  <li><a href="#handle-outliers" id="toc-handle-outliers" class="nav-link" data-scroll-target="#handle-outliers">Handle outliers</a></li>
  <li><a href="#construct-recipe" id="toc-construct-recipe" class="nav-link" data-scroll-target="#construct-recipe">Construct recipe</a></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling">Modeling</a>
  <ul class="collapse">
  <li><a href="#train-and-test-data-splitting" id="toc-train-and-test-data-splitting" class="nav-link" data-scroll-target="#train-and-test-data-splitting">Train and test data splitting</a></li>
  <li><a href="#xgboost" id="toc-xgboost" class="nav-link" data-scroll-target="#xgboost">XGBoost</a></li>
  <li><a href="#neural-network-classifier" id="toc-neural-network-classifier" class="nav-link" data-scroll-target="#neural-network-classifier">Neural network classifier</a></li>
  </ul></li>
  <li><a href="#takeaways" id="toc-takeaways" class="nav-link" data-scroll-target="#takeaways">Takeaways</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ibis-project/ibis/edit/main/docs/posts/ibisml/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ibis-project/ibis/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this post, we’ll demonstrate how to use Ibis and <a href="https://github.com/ibis-project/ibis-ml">IbisML</a> end-to-end for the <a href="https://www.kaggle.com/competitions/home-credit-credit-risk-model-stability">credit risk model stability Kaggle competition</a>.</p>
<ol type="1">
<li>Load data and perform feature engineering on DuckDB backend using IbisML</li>
<li>Perform last-mile ML data preprocessing on DuckDB backend using IbisML</li>
<li>Train two models using different frameworks:
<ul>
<li>An XGBoost model within a scikit-learn pipeline.</li>
<li>A neural network with PyTorch and PyTorch Lightning.</li>
</ul></li>
</ol>
<p>The aim of this competition is to predict which clients are more likely to default on their loans by using both internal and external data sources.</p>
<p>To get started with Ibis and IbisML, please refer to the websites:</p>
<ul>
<li><a href="https://ibis-project.org/">Ibis</a>: An open-source dataframe library that works with any data system.</li>
<li><a href="https://ibis-project.github.io/ibis-ml/">IbisML</a>: A library for building scalable ML pipelines.</li>
</ul>
</section>
<section id="prerequisites" class="level2">
<h2 class="anchored" data-anchor-id="prerequisites">Prerequisites</h2>
<p>To run this example, you’ll need to download the data from Kaggle website with a Kaggle user account and install Ibis, IbisML, and the necessary modeling library.</p>
<section id="download-data" class="level3">
<h3 class="anchored" data-anchor-id="download-data">Download data</h3>
<p>You need a Kaggle account to download the data. If you do not have one, feel free to register one.</p>
<ol type="1">
<li>Option 1: Manual download
<ul>
<li>Log into your Kaggle account and download all data from this <a href="https://www.kaggle.com/competitions/home-credit-credit-risk-model-stability/data">link</a>, unzip the files, and save them to your local disk.</li>
</ul></li>
<li>Option 2: Kaggle API
<ul>
<li><p>Go to your <code>Kaggle Account Settings</code>.</p></li>
<li><p>Under the <code>API</code> section, click on <code>Create New API Token</code>. This will download the <code>kaggle.json</code> file to your computer.</p></li>
<li><p>Place the <code>kaggle.json</code> file in the correct directory, normally it is under your home directory <code>~/.kaggle</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> ~/.kaggle</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> ~/Downloads/kaggle.json ~/.kaggle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Install Kaggle CLI and download the data:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install kaggle</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">kaggle</span> competitions download <span class="at">-c</span> home-credit-credit-risk-model-stability</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span> home-credit-credit-risk-model-stability.zip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
</ol>
</section>
<section id="install-libraries" class="level3">
<h3 class="anchored" data-anchor-id="install-libraries">Install libraries</h3>
<p>To use Ibis and IbisML with the DuckDB backend for building models, you’ll need to install the necessary packages. Depending on your preferred machine learning framework, you can choose one of the following installation commands:</p>
<p>For PyTorch-based models:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="st">'ibis-framework[duckdb]'</span> ibis-ml torch pytorch-lightning</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For XGBoost and scikit-learn-based models:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="st">'ibis-framework[duckdb]'</span> ibis-ml xgboost<span class="pp">[</span><span class="ss">scikit</span><span class="pp">-</span><span class="ss">learn</span><span class="pp">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Import libraries:</p>
<div id="dba3e08c" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ibis</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ibis.expr.datatypes <span class="im">as</span> dt</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ibis_ml <span class="im">as</span> ml</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> glob <span class="im">import</span> glob</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># enable interactive mode for ibis</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Set the backend for computing:</p>
<div id="d4b26ac9" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> ibis.duckdb.<span class="ex">connect</span>()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the black bars from duckdb's progress bar</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>con.raw_sql(<span class="st">"set enable_progress_bar = false"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># DuckDB is the default backend for Ibis</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ibis.set_backend(con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Set data path:</p>
<div id="9930c4ad" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change the root path to yours</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ROOT <span class="op">=</span> Path(<span class="st">"/Users/claypot/Downloads/home-credit-credit-risk-model-stability"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>TRAIN_DIR <span class="op">=</span> ROOT <span class="op">/</span> <span class="st">"parquet_files"</span> <span class="op">/</span> <span class="st">"train"</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>TEST_DIR <span class="op">=</span> ROOT <span class="op">/</span> <span class="st">"parquet_files"</span> <span class="op">/</span> <span class="st">"test"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-loading-and-processing" class="level2">
<h2 class="anchored" data-anchor-id="data-loading-and-processing">Data loading and processing</h2>
<p>We’ll use Ibis to read the Parquet files and perform the necessary processing for the next step.</p>
<section id="directory-structure-and-tables" class="level3">
<h3 class="anchored" data-anchor-id="directory-structure-and-tables">Directory structure and tables</h3>
<p>Since there are many data files, let’s start by examining the directory structure and tables within the train directory:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change this to your directory</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">tree</span> <span class="at">-L</span> 2 ~/Downloads/home-credit-credit-risk-model-stability/parquet_files/train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show data files">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show data files
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">~/Downloads/home-credit-credit-risk-model-stability/parquet_files/train</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_applprev_1_0.parquet</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_applprev_1_1.parquet</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_applprev_2.parquet</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_base.parquet</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_1_0.parquet</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_1_1.parquet</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_1_3.parquet</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_2_0.parquet</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_2_1.parquet</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_2_10.parquet</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_2_2.parquet</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_2_3.parquet</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_2_4.parquet</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_2_5.parquet</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_2_6.parquet</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_2_7.parquet</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_2_8.parquet</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_a_2_9.parquet</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_b_1.parquet</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_credit_bureau_b_2.parquet</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_debitcard_1.parquet</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_deposit_1.parquet</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_other_1.parquet</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_person_1.parquet</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_person_2.parquet</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_static_0_0.parquet</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_static_0_1.parquet</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_static_cb_0.parquet</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_tax_registry_a_1.parquet</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> train_tax_registry_b_1.parquet</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="ex">└──</span> train_tax_registry_c_1.parquet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The <code>train_base.parquet</code> file is the base table, while the others are feature tables. Let’s take a quick look at these tables.</p>
<section id="base-table" class="level4">
<h4 class="anchored" data-anchor-id="base-table">Base table</h4>
<p>The base table (<code>train_base.parquet</code>) contains the unique ID, a binary target flag and other information for the training samples. This unique ID will serve as the linking key for joining with other feature tables.</p>
<ul>
<li><code>case_id</code> - This is the unique ID for each loan. You’ll need this ID to join feature tables to the base table. There are about 1.5m unique loans.</li>
<li><code>date_decision</code> - This refers to the date when a decision was made regarding the approval of the loan.</li>
<li><code>WEEK_NUM</code> - This is the week number used for aggregation. In the test sample, <code>WEEK_NUM</code> continues sequentially from the last training value of <code>WEEK_NUM</code>.</li>
<li><code>MONTH</code> - This column represents the month when the approval decision was made.</li>
<li><code>target</code> - This is the binary target flag, determined after a certain period based on whether or not the client defaulted on the specific loan.</li>
</ul>
<p>Here is several examples from the base table:</p>
<div id="54d40a5b" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Show code to get the top 5 rows of base table</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ibis.read_parquet(TRAIN_DIR <span class="op">/</span> <span class="st">"train_base.parquet"</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> case_id </span>┃<span style="font-weight: bold"> date_decision </span>┃<span style="font-weight: bold"> MONTH  </span>┃<span style="font-weight: bold"> WEEK_NUM </span>┃<span style="font-weight: bold"> target </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │
├─────────┼───────────────┼────────┼──────────┼────────┤
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │ <span style="color: #008000; text-decoration-color: #008000">2019-01-03   </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">201901</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">2019-01-03   </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">201901</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">2019-01-04   </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">201901</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">2019-01-03   </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">201901</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │ <span style="color: #008000; text-decoration-color: #008000">2019-01-04   </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">201901</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
└─────────┴───────────────┴────────┴──────────┴────────┘
</pre>
</div>
</div>
</section>
<section id="feature-tables" class="level4">
<h4 class="anchored" data-anchor-id="feature-tables">Feature tables</h4>
<p>The remaining files contain features, consisting of approximately 370 features from previous loan applications and external data sources. Their definitions can be found in the feature definition <a href="https://www.kaggle.com/competitions/home-credit-credit-risk-model-stability/data">file</a> from the competition website.</p>
<p>There are several things we want to mention for the feature tables:</p>
<ul>
<li><strong>Union datasets</strong>: One dataset could be saved into multiple parquet files, such as <code>train_applprev_1_0.parquet</code> and <code>train_applprev_1_1.parquet</code>, We need to union this data.</li>
<li><strong>Dataset levels</strong>: Datasets may have different levels, which we will explain as follows:
<ul>
<li><strong>Depth = 0</strong>: Each row in the table is identified by a unique <code>case_id</code>. In this case, you can directly join the features with the base table and use them as features for further analysis or processing.</li>
<li><strong>Depth &gt; 0</strong>: You will group the data based on the <code>case_id</code> and perform calculations or aggregations within each group.</li>
</ul></li>
</ul>
<p>Here are two examples of tables with different levels.</p>
<p>Example of table with depth = 0, <code>case_id</code> is the row identifier, features can be directly joined with the base table.</p>
<div id="fdaf873c" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Show code to get the top 5 rows of user static data</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ibis.read_parquet(TRAIN_DIR <span class="op">/</span> <span class="st">"train_static_cb_0.parquet"</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> case_id </span>┃<span style="font-weight: bold"> assignmentdate_238D </span>┃<span style="font-weight: bold"> assignmentdate_4527235D </span>┃<span style="font-weight: bold"> assignmentdate_4955616D </span>┃<span style="font-weight: bold"> birthdate_574D </span>┃<span style="font-weight: bold"> contractssum_5085716L </span>┃<span style="font-weight: bold"> dateofbirth_337D </span>┃<span style="font-weight: bold"> dateofbirth_342D </span>┃<span style="font-weight: bold"> days120_123L </span>┃<span style="font-weight: bold"> days180_256L </span>┃<span style="font-weight: bold"> days30_165L </span>┃<span style="font-weight: bold"> days360_512L </span>┃<span style="font-weight: bold"> days90_310L </span>┃<span style="font-weight: bold"> description_5085714M </span>┃<span style="font-weight: bold"> education_1103M </span>┃<span style="font-weight: bold"> education_88M </span>┃<span style="font-weight: bold"> firstquarter_103L </span>┃<span style="font-weight: bold"> for3years_128L </span>┃<span style="font-weight: bold"> for3years_504L </span>┃<span style="font-weight: bold"> for3years_584L </span>┃<span style="font-weight: bold"> formonth_118L </span>┃<span style="font-weight: bold"> formonth_206L </span>┃<span style="font-weight: bold"> formonth_535L </span>┃<span style="font-weight: bold"> forquarter_1017L </span>┃<span style="font-weight: bold"> forquarter_462L </span>┃<span style="font-weight: bold"> forquarter_634L </span>┃<span style="font-weight: bold"> fortoday_1092L </span>┃<span style="font-weight: bold"> forweek_1077L </span>┃<span style="font-weight: bold"> forweek_528L </span>┃<span style="font-weight: bold"> forweek_601L </span>┃<span style="font-weight: bold"> foryear_618L </span>┃<span style="font-weight: bold"> foryear_818L </span>┃<span style="font-weight: bold"> foryear_850L </span>┃<span style="font-weight: bold"> fourthquarter_440L </span>┃<span style="font-weight: bold"> maritalst_385M </span>┃<span style="font-weight: bold"> maritalst_893M </span>┃<span style="font-weight: bold"> numberofqueries_373L </span>┃<span style="font-weight: bold"> pmtaverage_3A </span>┃<span style="font-weight: bold"> pmtaverage_4527227A </span>┃<span style="font-weight: bold"> pmtaverage_4955615A </span>┃<span style="font-weight: bold"> pmtcount_4527229L </span>┃<span style="font-weight: bold"> pmtcount_4955617L </span>┃<span style="font-weight: bold"> pmtcount_693L </span>┃<span style="font-weight: bold"> pmtscount_423L </span>┃<span style="font-weight: bold"> pmtssum_45A </span>┃<span style="font-weight: bold"> requesttype_4525192L </span>┃<span style="font-weight: bold"> responsedate_1012D </span>┃<span style="font-weight: bold"> responsedate_4527233D </span>┃<span style="font-weight: bold"> responsedate_4917613D </span>┃<span style="font-weight: bold"> riskassesment_302T </span>┃<span style="font-weight: bold"> riskassesment_940T </span>┃<span style="font-weight: bold"> secondquarter_766L </span>┃<span style="font-weight: bold"> thirdquarter_1082L </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │
├─────────┼─────────────────────┼─────────────────────────┼─────────────────────────┼────────────────┼───────────────────────┼──────────────────┼──────────────────┼──────────────┼──────────────┼─────────────┼──────────────┼─────────────┼──────────────────────┼─────────────────┼───────────────┼───────────────────┼────────────────┼────────────────┼────────────────┼───────────────┼───────────────┼───────────────┼──────────────────┼─────────────────┼─────────────────┼────────────────┼───────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────────────┼────────────────┼────────────────┼──────────────────────┼───────────────┼─────────────────────┼─────────────────────┼───────────────────┼───────────────────┼───────────────┼────────────────┼─────────────┼──────────────────────┼────────────────────┼───────────────────────┼───────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">357</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                    │ <span style="color: #008000; text-decoration-color: #008000">1988-04-01    </span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>             │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1            </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1       </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1     </span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.0</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6301.4000</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │ <span style="color: #008000; text-decoration-color: #008000">2019-01-25        </span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">381</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                    │ <span style="color: #008000; text-decoration-color: #008000">1973-11-01    </span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>             │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1            </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1       </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1     </span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.0</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4019.6000</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │ <span style="color: #008000; text-decoration-color: #008000">2019-01-25        </span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">388</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                    │ <span style="color: #008000; text-decoration-color: #008000">1989-04-01    </span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">1989-04-01      </span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>             │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1            </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1       </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1     </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.0</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.0</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14548.0000</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │ <span style="color: #008000; text-decoration-color: #008000">2019-01-28        </span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">405</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                    │ <span style="color: #008000; text-decoration-color: #008000">1974-03-01    </span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">1974-03-01      </span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>             │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1            </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1       </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1     </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.0</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10498.2400</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │ <span style="color: #008000; text-decoration-color: #008000">2019-01-21        </span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">409</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                    │ <span style="color: #008000; text-decoration-color: #008000">1993-06-01    </span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">1993-06-01      </span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>             │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1            </span> │ <span style="color: #008000; text-decoration-color: #008000">717ddd49       </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1     </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a7fcb6e5      </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.0</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6344.8804</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │ <span style="color: #008000; text-decoration-color: #008000">2019-01-21        </span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │
└─────────┴─────────────────────┴─────────────────────────┴─────────────────────────┴────────────────┴───────────────────────┴──────────────────┴──────────────────┴──────────────┴──────────────┴─────────────┴──────────────┴─────────────┴──────────────────────┴─────────────────┴───────────────┴───────────────────┴────────────────┴────────────────┴────────────────┴───────────────┴───────────────┴───────────────┴──────────────────┴─────────────────┴─────────────────┴────────────────┴───────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴────────────────────┴────────────────┴────────────────┴──────────────────────┴───────────────┴─────────────────────┴─────────────────────┴───────────────────┴───────────────────┴───────────────┴────────────────┴─────────────┴──────────────────────┴────────────────────┴───────────────────────┴───────────────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┘
</pre>
</div>
</div>
<p>Example of a table with depth = 1, we need to aggregate the features and collect statistics based on <code>case_id</code> then join with the base table.</p>
<div id="4765269b" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Show code to get the top 5 rows of credit bureau data</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ibis.read_parquet(TRAIN_DIR <span class="op">/</span> <span class="st">"train_credit_bureau_b_1.parquet"</span>).relocate(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"num_group1"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>).order_by([<span class="st">"case_id"</span>, <span class="st">"num_group1"</span>]).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> num_group1 </span>┃<span style="font-weight: bold"> case_id </span>┃<span style="font-weight: bold"> amount_1115A </span>┃<span style="font-weight: bold"> classificationofcontr_1114M </span>┃<span style="font-weight: bold"> contractdate_551D </span>┃<span style="font-weight: bold"> contractmaturitydate_151D </span>┃<span style="font-weight: bold"> contractst_516M </span>┃<span style="font-weight: bold"> contracttype_653M </span>┃<span style="font-weight: bold"> credlmt_1052A </span>┃<span style="font-weight: bold"> credlmt_228A </span>┃<span style="font-weight: bold"> credlmt_3940954A </span>┃<span style="font-weight: bold"> credor_3940957M </span>┃<span style="font-weight: bold"> credquantity_1099L </span>┃<span style="font-weight: bold"> credquantity_984L </span>┃<span style="font-weight: bold"> debtpastduevalue_732A </span>┃<span style="font-weight: bold"> debtvalue_227A </span>┃<span style="font-weight: bold"> dpd_550P </span>┃<span style="font-weight: bold"> dpd_733P </span>┃<span style="font-weight: bold"> dpdmax_851P </span>┃<span style="font-weight: bold"> dpdmaxdatemonth_804T </span>┃<span style="font-weight: bold"> dpdmaxdateyear_742T </span>┃<span style="font-weight: bold"> installmentamount_644A </span>┃<span style="font-weight: bold"> installmentamount_833A </span>┃<span style="font-weight: bold"> instlamount_892A </span>┃<span style="font-weight: bold"> interesteffectiverate_369L </span>┃<span style="font-weight: bold"> interestrateyearly_538L </span>┃<span style="font-weight: bold"> lastupdate_260D </span>┃<span style="font-weight: bold"> maxdebtpduevalodued_3940955A </span>┃<span style="font-weight: bold"> numberofinstls_810L </span>┃<span style="font-weight: bold"> overdueamountmax_950A </span>┃<span style="font-weight: bold"> overdueamountmaxdatemonth_494T </span>┃<span style="font-weight: bold"> overdueamountmaxdateyear_432T </span>┃<span style="font-weight: bold"> periodicityofpmts_997L </span>┃<span style="font-weight: bold"> periodicityofpmts_997M </span>┃<span style="font-weight: bold"> pmtdaysoverdue_1135P </span>┃<span style="font-weight: bold"> pmtmethod_731M </span>┃<span style="font-weight: bold"> pmtnumpending_403L </span>┃<span style="font-weight: bold"> purposeofcred_722M </span>┃<span style="font-weight: bold"> residualamount_1093A </span>┃<span style="font-weight: bold"> residualamount_127A </span>┃<span style="font-weight: bold"> residualamount_3940956A </span>┃<span style="font-weight: bold"> subjectrole_326M </span>┃<span style="font-weight: bold"> subjectrole_43M </span>┃<span style="font-weight: bold"> totalamount_503A </span>┃<span style="font-weight: bold"> totalamount_881A </span>┃
┡━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>          │
├────────────┼─────────┼──────────────┼─────────────────────────────┼───────────────────┼───────────────────────────┼─────────────────┼───────────────────┼───────────────┼──────────────┼──────────────────┼─────────────────┼────────────────────┼───────────────────┼───────────────────────┼────────────────┼──────────┼──────────┼─────────────┼──────────────────────┼─────────────────────┼────────────────────────┼────────────────────────┼──────────────────┼────────────────────────────┼─────────────────────────┼─────────────────┼──────────────────────────────┼─────────────────────┼───────────────────────┼────────────────────────────────┼───────────────────────────────┼────────────────────────┼────────────────────────┼──────────────────────┼────────────────┼────────────────────┼────────────────────┼──────────────────────┼─────────────────────┼─────────────────────────┼──────────────────┼─────────────────┼──────────────────┼──────────────────┤
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">467</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">ea6782cc                   </span> │ <span style="color: #008000; text-decoration-color: #008000">2011-06-15       </span> │ <span style="color: #008000; text-decoration-color: #008000">2031-06-13               </span> │ <span style="color: #008000; text-decoration-color: #008000">7241344e       </span> │ <span style="color: #008000; text-decoration-color: #008000">724be82a         </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.000000e+06</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10000.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.000000e+06</span> │ <span style="color: #008000; text-decoration-color: #008000">P164_34_168    </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">2019-01-20     </span> │                         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │ <span style="color: #008000; text-decoration-color: #008000">a55475b1              </span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">96a8fdfe          </span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">fa4f56f1        </span> │ <span style="color: #008000; text-decoration-color: #008000">ab3c25cf       </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.000000e+06</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10000.0</span> │
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">467</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">ea6782cc                   </span> │ <span style="color: #008000; text-decoration-color: #008000">2019-01-04       </span> │ <span style="color: #008000; text-decoration-color: #008000">2021-08-04               </span> │ <span style="color: #008000; text-decoration-color: #008000">7241344e       </span> │ <span style="color: #008000; text-decoration-color: #008000">724be82a         </span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.303650e+05</span> │ <span style="color: #008000; text-decoration-color: #008000">P164_34_168    </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26571.969</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">2019-01-20     </span> │                         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │ <span style="color: #008000; text-decoration-color: #008000">a55475b1              </span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">96a8fdfe          </span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">ab3c25cf        </span> │ <span style="color: #008000; text-decoration-color: #008000">ab3c25cf       </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.800000e+04</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">960000.0</span> │
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">467</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">78000.0</span> │ <span style="color: #008000; text-decoration-color: #008000">ea6782cc                   </span> │ <span style="color: #008000; text-decoration-color: #008000">2016-10-25       </span> │ <span style="color: #008000; text-decoration-color: #008000">2019-10-25               </span> │ <span style="color: #008000; text-decoration-color: #008000">7241344e       </span> │ <span style="color: #008000; text-decoration-color: #008000">4257cbed         </span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">c5a72b57       </span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26571.969</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.0</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2016.0</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2898.76</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">2019-01-10     </span> │                          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.0</span> │                        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2016.0</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │ <span style="color: #008000; text-decoration-color: #008000">a0b598e4              </span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │ <span style="color: #008000; text-decoration-color: #008000">e914c86c      </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.0</span> │ <span style="color: #008000; text-decoration-color: #008000">96a8fdfe          </span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1        </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1       </span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">ea6782cc                   </span> │ <span style="color: #008000; text-decoration-color: #008000">2015-01-30       </span> │ <span style="color: #008000; text-decoration-color: #008000">2021-01-30               </span> │ <span style="color: #008000; text-decoration-color: #008000">7241344e       </span> │ <span style="color: #008000; text-decoration-color: #008000">1c9c5356         </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.000000e+05</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100000.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.400000e+04</span> │ <span style="color: #008000; text-decoration-color: #008000">b619fa46       </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200418.0</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2018.0</span> │                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">2019-01-19     </span> │                          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.4</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> │                            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │                        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2018.0</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │ <span style="color: #008000; text-decoration-color: #008000">a55475b1              </span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">60c73645          </span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">73044.18</span> │ <span style="color: #008000; text-decoration-color: #008000">daf49a8a        </span> │ <span style="color: #008000; text-decoration-color: #008000">ab3c25cf       </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.000000e+05</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100000.0</span> │
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">01f63ac8                   </span> │ <span style="color: #008000; text-decoration-color: #008000">2014-09-12       </span> │ <span style="color: #008000; text-decoration-color: #008000">2021-09-12               </span> │ <span style="color: #008000; text-decoration-color: #008000">7241344e       </span> │ <span style="color: #008000; text-decoration-color: #008000">724be82a         </span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.000000e+05</span> │ <span style="color: #008000; text-decoration-color: #008000">74bd67a8       </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.0</span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">209617.770</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">2019-01-13     </span> │                         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │ <span style="color: #008000; text-decoration-color: #008000">a55475b1              </span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">96a8fdfe          </span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">ab3c25cf        </span> │ <span style="color: #008000; text-decoration-color: #008000">ab3c25cf       </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.968006e+05</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">184587.8</span> │
└────────────┴─────────┴──────────────┴─────────────────────────────┴───────────────────┴───────────────────────────┴─────────────────┴───────────────────┴───────────────┴──────────────┴──────────────────┴─────────────────┴────────────────────┴───────────────────┴───────────────────────┴────────────────┴──────────┴──────────┴─────────────┴──────────────────────┴─────────────────────┴────────────────────────┴────────────────────────┴──────────────────┴────────────────────────────┴─────────────────────────┴─────────────────┴──────────────────────────────┴─────────────────────┴───────────────────────┴────────────────────────────────┴───────────────────────────────┴────────────────────────┴────────────────────────┴──────────────────────┴────────────────┴────────────────────┴────────────────────┴──────────────────────┴─────────────────────┴─────────────────────────┴──────────────────┴─────────────────┴──────────────────┴──────────────────┘
</pre>
</div>
</div>
<p>For more details on features and its exploratory data analysis (EDA), you can refer to feature definition and these Kaggle notebooks:</p>
<ul>
<li><a href="https://www.kaggle.com/competitions/home-credit-credit-risk-model-stability/data#:~:text=calendar_view_week-,feature_definitions,-.csv">Feature definition</a></li>
<li><a href="https://www.kaggle.com/code/loki97/home-credit-risk-prediction-eda">Home credit risk prediction EDA</a></li>
<li><a href="https://www.kaggle.com/code/sergiosaharovskiy/home-credit-crms-2024-eda-and-submission">Home credit CRMS 2024 EDA</a></li>
</ul>
</section>
</section>
<section id="data-loading-and-processing-1" class="level3">
<h3 class="anchored" data-anchor-id="data-loading-and-processing-1">Data loading and processing</h3>
<p>We will perform the following data processing steps using Ibis and IbisML:</p>
<ul>
<li><strong>Convert data types</strong>: Ensure consistency by converting data types, as the same column in different sub-files may have different types.</li>
<li><strong>Aggregate features</strong>: For tables with depth greater than 0, aggregate features based on <code>case_id</code>, including statistics calculation. You can collect statistics such as mean, median, mode, minimum, standard deviation, and others.</li>
<li><strong>Union and join datasets</strong>: Combine multiple sub-files of the same dataset into one table, as some datasets are split into multiple sub-files with a common prefix. Afterward, join these tables with the base table.</li>
</ul>
<section id="convert-data-types" class="level4">
<h4 class="anchored" data-anchor-id="convert-data-types">Convert data types</h4>
<p>We’ll use IbisML to create a chain of <code>Cast</code> steps, forming a recipe for data type conversion across the dataset. This conversion is based on the provided information extracted from column names. Columns that have similar transformations are indicated by a capital letter at the end of their names:</p>
<ul>
<li>P - Transform DPD (Days past due)</li>
<li>M - Masking categories</li>
<li>A - Transform amount</li>
<li>D - Transform date</li>
<li>T - Unspecified Transform</li>
<li>L - Unspecified Transform</li>
</ul>
<p>For example, we’ll define a IbisML transformation step to convert columns ends with <code>P</code> to floating number:</p>
<div id="92f70762" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert columns ends with P to floating number</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>step_cast_P_to_float <span class="op">=</span> ml.Cast(ml.endswith(<span class="st">"P"</span>), dt.float64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, let’s define additional type conversion transformations based on the postfix of column names:</p>
<div id="3e3be631" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Show code to define more steps</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert columns ends with A to floating number</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>step_cast_A_to_float <span class="op">=</span> ml.Cast(ml.endswith(<span class="st">"A"</span>), dt.float64)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert columns ends with D to date</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>step_cast_D_to_date <span class="op">=</span> ml.Cast(ml.endswith(<span class="st">"D"</span>), dt.date)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># convert columns ends with M to str</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>step_cast_M_to_str <span class="op">=</span> ml.Cast(ml.endswith(<span class="st">"M"</span>), dt.<span class="bu">str</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We’ll construct the <a href="https://ibis-project.github.io/ibis-ml/reference/core.html#ibis_ml.Recipe">IbisML Recipe</a> which chains together all the transformation steps.</p>
<div id="a275dbfd" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Show code to construct the recipe</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_type_recipes <span class="op">=</span> ml.Recipe(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    step_cast_P_to_float,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    step_cast_D_to_date,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    step_cast_M_to_str,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    step_cast_A_to_float,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cast some special columns</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    ml.Cast([<span class="st">"date_decision"</span>], <span class="st">"date"</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    ml.Cast([<span class="st">"case_id"</span>, <span class="st">"WEEK_NUM"</span>, <span class="st">"num_group1"</span>, <span class="st">"num_group2"</span>], dt.int64),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    ml.Cast(</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cardtype_51L"</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"credacc_status_367L"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"requesttype_4525192L"</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"riskassesment_302T"</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_periodicityofpmts_997L"</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        dt.<span class="bu">str</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    ml.Cast(</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">"isbidproductrequest_292L"</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">"isdebitcard_527L"</span>,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">"equalityempfrom_62L"</span>,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        dt.int64,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Data format conversion recipe:</span><span class="ch">\n</span><span class="sc">{</span>data_type_recipes<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data format conversion recipe:
Recipe(Cast(endswith('P'), 'float64'),
       Cast(endswith('D'), 'date'),
       Cast(endswith('M'), 'string'),
       Cast(endswith('A'), 'float64'),
       Cast(cols(('date_decision',)), 'date'),
       Cast(cols(('case_id', 'WEEK_NUM', 'num_group1', 'num_group2')), 'int64'),
       Cast(cols(('cardtype_51L', 'credacc_status_367L', 'requesttype_4525192L', 'riskassesment_302T', 'max_periodicityofpmts_997L')),
            'string'),
       Cast(cols(('isbidproductrequest_292L', 'isdebitcard_527L', 'equalityempfrom_62L')),
            'int64'))</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>IbisML offers a powerful set of column selectors, allowing you to select columns based on names, types, and patterns. For more information, you can refer to the IbisML column selectors <a href="https://ibis-project.github.io/ibis-ml/reference/selectors.html">documentation</a>.</p>
</div>
</div>
</section>
<section id="aggregate-features" class="level4">
<h4 class="anchored" data-anchor-id="aggregate-features">Aggregate features</h4>
<p>For tables with a depth greater than 0 that can’t be directly joined with the base table, we need to aggregate the features by the <code>case_id</code>. You could compute the different statistics for numeric columns and non-numeric columns.</p>
<p>Here, we use the <code>maximum</code> as an example.</p>
<div id="4f274968" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Show code to aggregate features by case_id using max</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> agg_by_id(table):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> table.group_by(<span class="st">"case_id"</span>).agg(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>            table[col_name].<span class="bu">max</span>().name(<span class="ss">f"max_</span><span class="sc">{</span>col_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> col_name <span class="kw">in</span> table.columns</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> col_name[<span class="op">-</span><span class="dv">1</span>] <span class="kw">in</span> (<span class="st">"T"</span>, <span class="st">"L"</span>, <span class="st">"P"</span>, <span class="st">"A"</span>, <span class="st">"D"</span>, <span class="st">"M"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For better predicting power, you need to collect different statistics based on the meaning of features. For simplicity, we’ll only collect the maximum value of the features here.</p>
</div>
</div>
</section>
<section id="put-them-together" class="level4">
<h4 class="anchored" data-anchor-id="put-them-together">Put them together</h4>
<p>We’ll put them together in a function reads parquet files, optionally handles regex patterns for multiple sub-files, applies data type transformations defined by <code>data_type_recipes</code>, and performs aggregation based on <code>case_id</code> if specified by the depth parameter.</p>
<div id="4116845d" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Show code to read and process data files</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_and_process_files(file_path, depth<span class="op">=</span><span class="va">None</span>, is_regex<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Read and process Parquet files.</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">        file_path (str): Path to the file or regex pattern to match files.</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">        depth (int, optional): Depth of processing. If 1 or 2, additional aggregation is performed.</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">        is_regex (bool, optional): Whether the file_path is a regex pattern.</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">        ibis.Table: The processed Ibis table.</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_regex:</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># read and union multiple files</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        chunks <span class="op">=</span> []</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> path <span class="kw">in</span> glob(<span class="bu">str</span>(file_path)):</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>            chunk <span class="op">=</span> ibis.read_parquet(path)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># transform table using IbisML Recipe</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>            chunk <span class="op">=</span> data_type_recipes.fit(chunk).to_ibis(chunk)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>            chunks.append(chunk)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>        table <span class="op">=</span> ibis.union(<span class="op">*</span>chunks)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># read a single file</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>        table <span class="op">=</span> ibis.read_parquet(file_path)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># transform table using IbisML</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>        table <span class="op">=</span> data_type_recipes.fit(table).to_ibis(table)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># perform aggregation if depth is 1 or 2</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> depth <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>]:</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>        table <span class="op">=</span> agg_by_id(table)</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s define two dictionaries, <code>train_data_store</code> and <code>test_data_store</code>, that organize and store processed datasets for training and testing datasets.</p>
<div id="513c202e" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Show code to load all data into a dict</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>train_data_store <span class="op">=</span> {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"df_base"</span>: read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_base.parquet"</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"depth_0"</span>: [</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_static_cb_0.parquet"</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_static_0_*.parquet"</span>, is_regex<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"depth_1"</span>: [</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>            TRAIN_DIR <span class="op">/</span> <span class="st">"train_applprev_1_*.parquet"</span>, <span class="dv">1</span>, is_regex<span class="op">=</span><span class="va">True</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_tax_registry_a_1.parquet"</span>, <span class="dv">1</span>),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_tax_registry_b_1.parquet"</span>, <span class="dv">1</span>),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_tax_registry_c_1.parquet"</span>, <span class="dv">1</span>),</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_credit_bureau_b_1.parquet"</span>, <span class="dv">1</span>),</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_other_1.parquet"</span>, <span class="dv">1</span>),</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_person_1.parquet"</span>, <span class="dv">1</span>),</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_deposit_1.parquet"</span>, <span class="dv">1</span>),</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_debitcard_1.parquet"</span>, <span class="dv">1</span>),</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"depth_2"</span>: [</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        read_and_process_files(TRAIN_DIR <span class="op">/</span> <span class="st">"train_credit_bureau_b_2.parquet"</span>, <span class="dv">2</span>),</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co"># we won't be submitting the predictions, so let's comment out the test data.</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co"># test_data_store = {</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     "df_base": read_and_process_files(TEST_DIR / "test_base.parquet"),</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     "depth_0": [</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_static_cb_0.parquet"),</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_static_0_*.parquet", is_regex=True),</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     ],</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     "depth_1": [</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_applprev_1_*.parquet", 1, is_regex=True),</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_tax_registry_a_1.parquet", 1),</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_tax_registry_b_1.parquet", 1),</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_tax_registry_c_1.parquet", 1),</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_credit_bureau_b_1.parquet", 1),</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_other_1.parquet", 1),</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_person_1.parquet", 1),</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_deposit_1.parquet", 1),</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_debitcard_1.parquet", 1),</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     ],</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     "depth_2": [</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="co">#         read_and_process_files(TEST_DIR / "test_credit_bureau_b_2.parquet", 2),</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     ]</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Join all features data to base table:</p>
<div id="93211f82" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Define function to join feature tables to base table</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> join_data(df_base, depth_0, depth_1, depth_2):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, df <span class="kw">in</span> <span class="bu">enumerate</span>(depth_0 <span class="op">+</span> depth_1 <span class="op">+</span> depth_2):</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        df_base <span class="op">=</span> df_base.join(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>            df, <span class="st">"case_id"</span>, how<span class="op">=</span><span class="st">"left"</span>, rname<span class="op">=</span><span class="st">"</span><span class="sc">{name}</span><span class="st">_right"</span> <span class="op">+</span> <span class="ss">f"_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_base</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Generate train and test datasets:</p>
<div id="3b26eaf7" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Show code to generate train and test datasets</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> join_data(<span class="op">**</span>train_data_store)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df_test = join_data(**test_data_store)</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>total_rows <span class="op">=</span> df_train.count().execute()</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"There is </span><span class="sc">{</span>total_rows<span class="sc">}</span><span class="ss"> rows and </span><span class="sc">{</span><span class="bu">len</span>(df_train.columns)<span class="sc">}</span><span class="ss"> columns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>There is 1526659 rows and 377 columns</code></pre>
</div>
</div>
</section>
</section>
<section id="select-features" class="level3">
<h3 class="anchored" data-anchor-id="select-features">Select features</h3>
<p>Given the large number of features (~370), we’ll focus on selecting just a few of the most informative ones by name for demonstration purposes in this post:</p>
<div id="36e0ec8e" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Show code to select important features for the train dataset</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> df_train.select(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"case_id"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"date_decision"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"target"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># number of credit bureau queries for the last X days.</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"days30_165L"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"days360_512L"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"days90_310L"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># number of tax deduction payments</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pmtscount_423L"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sum of tax deductions for the client</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pmtssum_45A"</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dateofbirth_337D"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"education_1103M"</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"firstquarter_103L"</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"secondquarter_766L"</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thirdquarter_1082L"</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fourthquarter_440L"</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"maritalst_893M"</span>,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"numberofqueries_373L"</span>,</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"requesttype_4525192L"</span>,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"responsedate_4527233D"</span>,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"actualdpdtolerance_344P"</span>,</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"amtinstpaidbefduel24m_4187115A"</span>,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"annuity_780A"</span>,</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"annuitynextmonth_57A"</span>,</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"applicationcnt_361L"</span>,</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"applications30d_658L"</span>,</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"applicationscnt_1086L"</span>,</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># average days past or before due of payment during the last 24 months.</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"avgdbddpdlast24m_3658932P"</span>,</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># average days past or before due of payment during the last 3 months.</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"avgdbddpdlast3m_4187120P"</span>,</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># end date of active contract.</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_contractmaturitydate_151D"</span>,</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># credit limit of an active loan.</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_credlmt_1052A"</span>,</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># number of credits in credit bureau</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_credquantity_1099L"</span>,</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_dpdmaxdatemonth_804T"</span>,</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_dpdmaxdateyear_742T"</span>,</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_maxdebtpduevalodued_3940955A"</span>,</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_overdueamountmax_950A"</span>,</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_purposeofcred_722M"</span>,</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_residualamount_3940956A"</span>,</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_totalamount_503A"</span>,</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_cancelreason_3545846M"</span>,</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_childnum_21L"</span>,</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_currdebt_94A"</span>,</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_employedfrom_700D"</span>,</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># client's main income amount in their previous application</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_mainoccupationinc_437A"</span>,</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_profession_152M"</span>,</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_rejectreason_755M"</span>,</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_status_219L"</span>,</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># credit amount of the active contract provided by the credit bureau</span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_amount_1115A"</span>,</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># amount of unpaid debt for existing contracts</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_debtpastduevalue_732A"</span>,</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_debtvalue_227A"</span>,</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_installmentamount_833A"</span>,</span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_instlamount_892A"</span>,</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_numberofinstls_810L"</span>,</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_pmtnumpending_403L"</span>,</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_last180dayaveragebalance_704A"</span>,</span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_last30dayturnover_651A"</span>,</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_openingdate_857D"</span>,</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_amount_416A"</span>,</span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_amtdebitincoming_4809443A"</span>,</span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_amtdebitoutgoing_4809440A"</span>,</span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_amtdepositbalance_4809441A"</span>,</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_amtdepositincoming_4809444A"</span>,</span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_amtdepositoutgoing_4809442A"</span>,</span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_empl_industry_691L"</span>,</span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_gender_992L"</span>,</span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_housingtype_772L"</span>,</span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_mainoccupationinc_384A"</span>,</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max_incometype_1044T"</span>,</span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>df_train.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> case_id </span>┃<span style="font-weight: bold"> date_decision </span>┃<span style="font-weight: bold"> target </span>┃<span style="font-weight: bold"> days30_165L </span>┃<span style="font-weight: bold"> days360_512L </span>┃<span style="font-weight: bold"> days90_310L </span>┃<span style="font-weight: bold"> pmtscount_423L </span>┃<span style="font-weight: bold"> pmtssum_45A </span>┃<span style="font-weight: bold"> dateofbirth_337D </span>┃<span style="font-weight: bold"> education_1103M </span>┃<span style="font-weight: bold"> firstquarter_103L </span>┃<span style="font-weight: bold"> secondquarter_766L </span>┃<span style="font-weight: bold"> thirdquarter_1082L </span>┃<span style="font-weight: bold"> fourthquarter_440L </span>┃<span style="font-weight: bold"> maritalst_893M </span>┃<span style="font-weight: bold"> numberofqueries_373L </span>┃<span style="font-weight: bold"> requesttype_4525192L </span>┃<span style="font-weight: bold"> responsedate_4527233D </span>┃<span style="font-weight: bold"> actualdpdtolerance_344P </span>┃<span style="font-weight: bold"> amtinstpaidbefduel24m_4187115A </span>┃<span style="font-weight: bold"> annuity_780A </span>┃<span style="font-weight: bold"> annuitynextmonth_57A </span>┃<span style="font-weight: bold"> applicationcnt_361L </span>┃<span style="font-weight: bold"> applications30d_658L </span>┃<span style="font-weight: bold"> applicationscnt_1086L </span>┃<span style="font-weight: bold"> avgdbddpdlast24m_3658932P </span>┃<span style="font-weight: bold"> avgdbddpdlast3m_4187120P </span>┃<span style="font-weight: bold"> max_contractmaturitydate_151D </span>┃<span style="font-weight: bold"> max_credlmt_1052A </span>┃<span style="font-weight: bold"> max_credquantity_1099L </span>┃<span style="font-weight: bold"> max_dpdmaxdatemonth_804T </span>┃<span style="font-weight: bold"> max_dpdmaxdateyear_742T </span>┃<span style="font-weight: bold"> max_maxdebtpduevalodued_3940955A </span>┃<span style="font-weight: bold"> max_overdueamountmax_950A </span>┃<span style="font-weight: bold"> max_purposeofcred_722M </span>┃<span style="font-weight: bold"> max_residualamount_3940956A </span>┃<span style="font-weight: bold"> max_totalamount_503A </span>┃<span style="font-weight: bold"> max_cancelreason_3545846M </span>┃<span style="font-weight: bold"> max_childnum_21L </span>┃<span style="font-weight: bold"> max_currdebt_94A </span>┃<span style="font-weight: bold"> max_employedfrom_700D </span>┃<span style="font-weight: bold"> max_mainoccupationinc_437A </span>┃<span style="font-weight: bold"> max_profession_152M </span>┃<span style="font-weight: bold"> max_rejectreason_755M </span>┃<span style="font-weight: bold"> max_status_219L </span>┃<span style="font-weight: bold"> max_amount_1115A </span>┃<span style="font-weight: bold"> max_debtpastduevalue_732A </span>┃<span style="font-weight: bold"> max_debtvalue_227A </span>┃<span style="font-weight: bold"> max_installmentamount_833A </span>┃<span style="font-weight: bold"> max_instlamount_892A </span>┃<span style="font-weight: bold"> max_numberofinstls_810L </span>┃<span style="font-weight: bold"> max_pmtnumpending_403L </span>┃<span style="font-weight: bold"> max_last180dayaveragebalance_704A </span>┃<span style="font-weight: bold"> max_last30dayturnover_651A </span>┃<span style="font-weight: bold"> max_openingdate_857D </span>┃<span style="font-weight: bold"> max_amount_416A </span>┃<span style="font-weight: bold"> max_amtdebitincoming_4809443A </span>┃<span style="font-weight: bold"> max_amtdebitoutgoing_4809440A </span>┃<span style="font-weight: bold"> max_amtdepositbalance_4809441A </span>┃<span style="font-weight: bold"> max_amtdepositincoming_4809444A </span>┃<span style="font-weight: bold"> max_amtdepositoutgoing_4809442A </span>┃<span style="font-weight: bold"> max_empl_industry_691L </span>┃<span style="font-weight: bold"> max_gender_992L </span>┃<span style="font-weight: bold"> max_housingtype_772L </span>┃<span style="font-weight: bold"> max_mainoccupationinc_384A </span>┃<span style="font-weight: bold"> max_incometype_1044T    </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>                          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                  │
├─────────┼───────────────┼────────┼─────────────┼──────────────┼─────────────┼────────────────┼─────────────┼──────────────────┼─────────────────┼───────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────┼──────────────────────┼──────────────────────┼───────────────────────┼─────────────────────────┼────────────────────────────────┼──────────────┼──────────────────────┼─────────────────────┼──────────────────────┼───────────────────────┼───────────────────────────┼──────────────────────────┼───────────────────────────────┼───────────────────┼────────────────────────┼──────────────────────────┼─────────────────────────┼──────────────────────────────────┼───────────────────────────┼────────────────────────┼─────────────────────────────┼──────────────────────┼───────────────────────────┼──────────────────┼──────────────────┼───────────────────────┼────────────────────────────┼─────────────────────┼───────────────────────┼─────────────────┼──────────────────┼───────────────────────────┼────────────────────┼────────────────────────────┼──────────────────────┼─────────────────────────┼────────────────────────┼───────────────────────────────────┼────────────────────────────┼──────────────────────┼─────────────────┼───────────────────────────────┼───────────────────────────────┼────────────────────────────────┼─────────────────────────────────┼─────────────────────────────────┼────────────────────────┼─────────────────┼──────────────────────┼────────────────────────────┼─────────────────────────┤
│ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1915559</span> │ <span style="color: #800080; text-decoration-color: #800080">2020-09-02</span>    │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #800080; text-decoration-color: #800080">1963-12-01</span>       │ <span style="color: #008000; text-decoration-color: #008000">717ddd49       </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9490.187</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1366.6000</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.0</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                          │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │                        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1                 </span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000</span> │ <span style="color: #800080; text-decoration-color: #800080">2012-11-15</span>            │                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">72000.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1           </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1             </span> │ <span style="color: #008000; text-decoration-color: #008000">T              </span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50000.0</span> │ <span style="color: #008000; text-decoration-color: #008000">PRIVATE_SECTOR_EMPLOYEE</span> │
│ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1915592</span> │ <span style="color: #800080; text-decoration-color: #800080">2020-09-02</span>    │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #800080; text-decoration-color: #800080">1983-01-01</span>       │ <span style="color: #008000; text-decoration-color: #008000">6b2ae0fa       </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.0</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61296.600</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1268.4000</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.0</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                          │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │                        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1                 </span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000</span> │ <span style="color: #800080; text-decoration-color: #800080">2013-09-15</span>            │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">199600.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1           </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1             </span> │ <span style="color: #008000; text-decoration-color: #008000">K              </span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70000.0</span> │ <span style="color: #008000; text-decoration-color: #008000">SALARIED_GOVT          </span> │
│ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1915605</span> │ <span style="color: #800080; text-decoration-color: #800080">2020-09-02</span>    │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #800080; text-decoration-color: #800080">1977-01-01</span>       │ <span style="color: #008000; text-decoration-color: #008000">a55475b1       </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">359920.470</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8483.2000</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6434.4</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.0</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.0</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                          │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │                        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1                 </span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43596.227</span> │ <span style="color: #800080; text-decoration-color: #800080">2014-01-15</span>            │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">199600.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1           </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1             </span> │ <span style="color: #008000; text-decoration-color: #008000">T              </span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200000.0</span> │ <span style="color: #008000; text-decoration-color: #008000">SELFEMPLOYED           </span> │
│ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1915620</span> │ <span style="color: #800080; text-decoration-color: #800080">2020-09-02</span>    │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #800080; text-decoration-color: #800080">1993-04-01</span>       │ <span style="color: #008000; text-decoration-color: #008000">a55475b1       </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">129430.370</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2368.2000</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.0</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                          │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │                        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1                 </span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000</span> │ <span style="color: #800080; text-decoration-color: #800080">2018-06-15</span>            │                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30000.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1           </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1             </span> │ <span style="color: #008000; text-decoration-color: #008000">K              </span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24000.0</span> │ <span style="color: #008000; text-decoration-color: #008000">SALARIED_GOVT          </span> │
│ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1915695</span> │ <span style="color: #800080; text-decoration-color: #800080">2020-09-02</span>    │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #800080; text-decoration-color: #800080">1981-07-01</span>       │ <span style="color: #008000; text-decoration-color: #008000">a55475b1       </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1      </span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                  │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15998.000</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6839.8003</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-10.0</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                          │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │                        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1                 </span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000</span> │ <span style="color: #800080; text-decoration-color: #800080">2016-01-15</span>            │                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40000.0</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1           </span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1             </span> │ <span style="color: #008000; text-decoration-color: #008000">K              </span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │                            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>                 │                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30000.0</span> │ <span style="color: #008000; text-decoration-color: #008000">SALARIED_GOVT          </span> │
└─────────┴───────────────┴────────┴─────────────┴──────────────┴─────────────┴────────────────┴─────────────┴──────────────────┴─────────────────┴───────────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────┴──────────────────────┴──────────────────────┴───────────────────────┴─────────────────────────┴────────────────────────────────┴──────────────┴──────────────────────┴─────────────────────┴──────────────────────┴───────────────────────┴───────────────────────────┴──────────────────────────┴───────────────────────────────┴───────────────────┴────────────────────────┴──────────────────────────┴─────────────────────────┴──────────────────────────────────┴───────────────────────────┴────────────────────────┴─────────────────────────────┴──────────────────────┴───────────────────────────┴──────────────────┴──────────────────┴───────────────────────┴────────────────────────────┴─────────────────────┴───────────────────────┴─────────────────┴──────────────────┴───────────────────────────┴────────────────────┴────────────────────────────┴──────────────────────┴─────────────────────────┴────────────────────────┴───────────────────────────────────┴────────────────────────────┴──────────────────────┴─────────────────┴───────────────────────────────┴───────────────────────────────┴────────────────────────────────┴─────────────────────────────────┴─────────────────────────────────┴────────────────────────┴─────────────────┴──────────────────────┴────────────────────────────┴─────────────────────────┘
</pre>
</div>
</div>
<p>Univariate analysis:</p>
<div id="2b1a9226" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Show code to describe the train dataset</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># take the first 10 columns</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df_train[df_train.columns[:<span class="dv">10</span>]].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> name            </span>┃<span style="font-weight: bold"> pos   </span>┃<span style="font-weight: bold"> type    </span>┃<span style="font-weight: bold"> count   </span>┃<span style="font-weight: bold"> nulls  </span>┃<span style="font-weight: bold"> unique  </span>┃<span style="font-weight: bold"> mode     </span>┃<span style="font-weight: bold"> mean         </span>┃<span style="font-weight: bold"> std           </span>┃<span style="font-weight: bold"> min     </span>┃<span style="font-weight: bold"> p25         </span>┃<span style="font-weight: bold"> p50          </span>┃<span style="font-weight: bold"> p75          </span>┃<span style="font-weight: bold"> max          </span>┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int16</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │
├─────────────────┼───────┼─────────┼─────────┼────────┼─────────┼──────────┼──────────────┼───────────────┼─────────┼─────────────┼──────────────┼──────────────┼──────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">case_id        </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │ <span style="color: #008000; text-decoration-color: #008000">int64  </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1526659</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1526659</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>     │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.286077e+06</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">718946.592285</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">766197.5000</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.357358e+06</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.739022e+06</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.703454e+06</span> │
│ <span style="color: #008000; text-decoration-color: #008000">target         </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">int64  </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1526659</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>     │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.143728e-02</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.174496</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0000</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000000e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000000e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.000000e+00</span> │
│ <span style="color: #008000; text-decoration-color: #008000">days30_165L    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">float64</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1526659</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">140968</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>     │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.177078e-01</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.899238</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0000</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000000e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.000000e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.200000e+01</span> │
│ <span style="color: #008000; text-decoration-color: #008000">days360_512L   </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │ <span style="color: #008000; text-decoration-color: #008000">float64</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1526659</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">140968</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">92</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>     │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.777066e+00</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.168856</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0000</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.000000e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.500000e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.150000e+02</span> │
│ <span style="color: #008000; text-decoration-color: #008000">days90_310L    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │ <span style="color: #008000; text-decoration-color: #008000">float64</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1526659</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">140968</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>     │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.211420e+00</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.655931</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0000</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.000000e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.000000e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.100000e+01</span> │
│ <span style="color: #008000; text-decoration-color: #008000">pmtscount_423L </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │ <span style="color: #008000; text-decoration-color: #008000">float64</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1526659</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">954021</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">66</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>     │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.839291e+00</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.148264</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0000</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.000000e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.000000e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.210000e+02</span> │
│ <span style="color: #008000; text-decoration-color: #008000">pmtssum_45A    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │ <span style="color: #008000; text-decoration-color: #008000">float64</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1526659</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">954021</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">265229</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>     │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.319994e+04</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18117.218312</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3156.4001</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.391900e+03</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.699200e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.768434e+05</span> │
│ <span style="color: #008000; text-decoration-color: #008000">education_1103M</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span> │ <span style="color: #008000; text-decoration-color: #008000">string </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1526659</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26183</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │ <span style="color: #008000; text-decoration-color: #008000">a55475b1</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
└─────────────────┴───────┴─────────┴─────────┴────────┴─────────┴──────────┴──────────────┴───────────────┴─────────┴─────────────┴──────────────┴──────────────┴──────────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="last-mile-data-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="last-mile-data-preprocessing">Last-mile data preprocessing</h2>
<p>We will perform the following transformation before feeding the data to models:</p>
<ul>
<li>Missing value imputation</li>
<li>Encoding categorical variables</li>
<li>Handling date variables</li>
<li>Handling outliers</li>
<li>Scaling and normalization</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>IbisML provides a set of transformations. You can find the <a href="https://github.com/ibis-project/ibis-ml/issues/32">roadmap</a>. The <a href="https://ibis-project.github.io/ibis-ml/">IbisML website</a> also includes tutorials and API documentation.</p>
</div>
</div>
<section id="impute-features" class="level3">
<h3 class="anchored" data-anchor-id="impute-features">Impute features</h3>
<p>Impute all numeric columns using the median. In real-life scenarios, it’s important to understand the meaning of each feature and apply the appropriate imputation method for different features. For more imputations, please refer to this <a href="https://ibis-project.github.io/ibis-ml/reference/steps-imputation.html">documentation</a>.</p>
<div id="99303c5a" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Show code to impute all numeric columns with median</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>step_impute_median <span class="op">=</span> ml.ImputeMedian(ml.numeric())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="encode-categorical-features" class="level3">
<h3 class="anchored" data-anchor-id="encode-categorical-features">Encode categorical features</h3>
<p>Encode all categorical features using one-hot-encode. For more encoding steps, please refer to this <a href="https://ibis-project.github.io/ibis-ml/reference/steps-encoding.html">doc</a>.</p>
<div id="3e1df3b1" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Show code to one-hot encode selected columns</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ohe_step <span class="op">=</span> ml.OneHotEncode(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"maritalst_893M"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"requesttype_4525192L"</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"max_profession_152M"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"max_gender_992L"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"max_empl_industry_691L"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"max_housingtype_772L"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"max_incometype_1044T"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"max_cancelreason_3545846M"</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"max_rejectreason_755M"</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"education_1103M"</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"max_status_219L"</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="handle-date-variables" class="level3">
<h3 class="anchored" data-anchor-id="handle-date-variables">Handle date variables</h3>
<p>Calculate all the days difference between any date columns and the column <code>date_decision</code>:</p>
<div id="cb197a80" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Show code to calculate days difference between date columns and date_decision</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>date_cols <span class="op">=</span> [col_name <span class="cf">for</span> col_name <span class="kw">in</span> df_train.columns <span class="cf">if</span> col_name[<span class="op">-</span><span class="dv">1</span>] <span class="op">==</span> <span class="st">"D"</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>days_to_decision_expr <span class="op">=</span> {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># difference in days</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">_date_decision_diff"</span>: (</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        _.date_decision.epoch_seconds() <span class="op">-</span> <span class="bu">getattr</span>(_, col).epoch_seconds()</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> (<span class="dv">60</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">24</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> date_cols</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>days_to_decision_step <span class="op">=</span> ml.Mutate(days_to_decision_expr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Extract information from the date columns:</p>
<div id="63129062" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Show code to extract day and week info from date columns</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dow and month is set to catagoery</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>expand_date_step <span class="op">=</span> ml.ExpandDate(ml.date(), [<span class="st">"week"</span>, <span class="st">"day"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="handle-outliers" class="level3">
<h3 class="anchored" data-anchor-id="handle-outliers">Handle outliers</h3>
<p>Capping outliers using <code>z-score</code> method:</p>
<div id="fe15771d" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Show code to cap outliers for selected columns</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>step_handle_outliers <span class="op">=</span> ml.HandleUnivariateOutliers(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"max_amount_1115A"</span>, <span class="st">"max_overdueamountmax_950A"</span>],</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">"z-score"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    treatment<span class="op">=</span><span class="st">"capping"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    deviation_factor<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="construct-recipe" class="level3">
<h3 class="anchored" data-anchor-id="construct-recipe">Construct recipe</h3>
<p>We’ll construct the last mile preprocessing <a href="https://ibis-project.github.io/ibis-ml/reference/core.html#ibis_ml.Recipe">recipe</a> by chaining all transformation steps, which will be fitted to the training dataset and later applied test datasets.</p>
<div id="fd8a067a" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Show code to construct the recipe</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>last_mile_preprocessing <span class="op">=</span> ml.Recipe(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    expand_date_step,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    ml.Drop(ml.date()),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># handle string columns</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    ohe_step,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    ml.Drop(ml.string()),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># handle numeric cols</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># capping outliers</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    step_handle_outliers,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    step_impute_median,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    ml.ScaleMinMax(ml.numeric()),</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill missing value</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    ml.FillNA(ml.numeric(), <span class="dv">0</span>),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    ml.Cast(ml.numeric(), <span class="st">"float32"</span>),</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Last-mile preprocessing recipe: </span><span class="ch">\n</span><span class="sc">{</span>last_mile_preprocessing<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Last-mile preprocessing recipe: 
Recipe(ExpandDate(date(), components=['week', 'day']),
       Drop(date()),
       OneHotEncode(cols(('maritalst_893M', 'requesttype_4525192L', 'max_profession_152M', 'max_gender_992L', 'max_empl_industry_691L', 'max_housingtype_772L', 'max_incometype_1044T', 'max_cancelreason_3545846M', 'max_rejectreason_755M', 'education_1103M', 'max_status_219L'))),
       Drop(string()),
       HandleUnivariateOutliers(cols(('max_amount_1115A', 'max_overdueamountmax_950A')),
                                method='z-score',
                                deviation_factor=3,
                                treatment='capping'),
       ImputeMedian(numeric()),
       ScaleMinMax(numeric()),
       FillNA(numeric(), 0),
       Cast(numeric(), 'float32'))</code></pre>
</div>
</div>
</section>
</section>
<section id="modeling" class="level2">
<h2 class="anchored" data-anchor-id="modeling">Modeling</h2>
<p>After completing data preprocessing with Ibis and IbisML, we proceed to the modeling phase. Here are two approaches:</p>
<ul>
<li>Use IbisML as a independent data preprocessing component and hand off the data to downstream modeling frameworks with various output formats:
<ul>
<li>pandas Dataframe</li>
<li>NumPy Array</li>
<li>Polars Dataframe</li>
<li>Dask Dataframe</li>
<li>xgboost.DMatrix</li>
<li>Pyarrow Table</li>
</ul></li>
<li>Use IbisML recipes as components within an sklearn Pipeline and train models similarly to how you would do with sklearn pipeline.</li>
</ul>
<p>We will build an XGBoost model within a scikit-learn pipeline, and a neural network classifier using the output transformed by IbisML recipes.</p>
<section id="train-and-test-data-splitting" class="level3">
<h3 class="anchored" data-anchor-id="train-and-test-data-splitting">Train and test data splitting</h3>
<p>We’ll use hashing on the unique key to consistently split rows to different groups. Hashing is robust to underlying changes in the data, such as adding, deleting, or reordering rows. This deterministic process ensures that each data point is always assigned to the same split, thereby enhancing reproducibility.</p>
<div id="07531183" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Show code to split data into train and test</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this enables the analysis to be reproducible when random numbers are used</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">222</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>random_key <span class="op">=</span> <span class="bu">str</span>(random.getrandbits(<span class="dv">256</span>))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># put 3/4 of the data into the training set</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> df_train.mutate(</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    train_flag<span class="op">=</span>(df_train.case_id.cast(dt.<span class="bu">str</span>) <span class="op">+</span> random_key).<span class="bu">hash</span>().<span class="bu">abs</span>() <span class="op">%</span> <span class="dv">4</span> <span class="op">&lt;</span> <span class="dv">3</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># split the dataset by train_flag</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># todo: use ml.train_test_split() after next release</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> df_train[df_train.train_flag].drop(<span class="st">"train_flag"</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> df_train[<span class="op">~</span>df_train.train_flag].drop(<span class="st">"train_flag"</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> train_data.drop(<span class="st">"target"</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> train_data.target.cast(dt.float32).name(<span class="st">"target"</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> test_data.drop(<span class="st">"target"</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> test_data.target.cast(dt.float32).name(<span class="st">"target"</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>train_cnt <span class="op">=</span> X_train.count().execute()</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>test_cnt <span class="op">=</span> X_test.count().execute()</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"train dataset size = </span><span class="sc">{</span>train_cnt<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">test data size = </span><span class="sc">{</span>test_cnt<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>train dataset size = 1144339 
test data size = 382320</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Hashing provides a consistent but pseudo-random distribution of data, which may not precisely align with the specified train/test ratio. While hash codes ensure reproducibility, they don’t guarantee an exact split. Due to statistical variance, you might find a slight imbalance in the distribution, resulting in marginally more or fewer samples in either the training or test dataset than the target percentage. This minor deviation from the intended ratio is a normal consequence of hash-based partitioning.</p>
</div>
</div>
</section>
<section id="xgboost" class="level3">
<h3 class="anchored" data-anchor-id="xgboost">XGBoost</h3>
<p>In this section, we integrate XGBoost into a scikit-learn pipeline to create a streamlined workflow for training and evaluating our model.</p>
<p>We’ll set up a pipeline that includes two components:</p>
<ul>
<li><strong>Preprocessing</strong>: This step applies the <code>last_mile_preprocessing</code> for final data preprocessing.</li>
<li><strong>Modeling</strong>: This step applies the <code>xgb.XGBClassifier()</code> to train the XGBoost model.</li>
</ul>
<div id="7a5ff114" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Show code to built and fit the pipeline</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_auc_score</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> xgb.XGBClassifier(</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    max_depth<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    learning_rate<span class="op">=</span><span class="fl">0.05</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    subsample<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    colsample_bytree<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># create the pipeline with the last mile ML recipes and the model</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>pipe <span class="op">=</span> Pipeline([(<span class="st">"last_mile_recipes"</span>, last_mile_preprocessing), (<span class="st">"model"</span>, model)])</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the pipeline on the training data</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>pipe.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="56">
<style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</a></style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('last_mile_recipes',
                 Recipe(ExpandDate(date(), components=['week', 'day']),
                        Drop(date()),
                        OneHotEncode(cols(('maritalst_893M', 'requesttype_4525192L', 'max_profession_152M', 'max_gender_992L', 'max_empl_industry_691L', 'max_housingtype_772L', 'max_incometype_1044T', 'max_cancelreason_3545846M', 'max_rejectreason_755M', 'education_1103M', 'max_sta...
                               feature_types=None, gamma=None, grow_policy=None,
                               importance_type=None,
                               interaction_constraints=None, learning_rate=0.05,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=5, max_leaves=None,
                               min_child_weight=None, missing=nan,
                               monotone_constraints=None, multi_strategy=None,
                               n_estimators=100, n_jobs=None,
                               num_parallel_tree=None, random_state=42, ...))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-13" type="checkbox"><label for="sk-estimator-id-13" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;Pipeline<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.4/modules/generated/sklearn.pipeline.Pipeline.html">?<span>Documentation for Pipeline</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[('last_mile_recipes',
                 Recipe(ExpandDate(date(), components=['week', 'day']),
                        Drop(date()),
                        OneHotEncode(cols(('maritalst_893M', 'requesttype_4525192L', 'max_profession_152M', 'max_gender_992L', 'max_empl_industry_691L', 'max_housingtype_772L', 'max_incometype_1044T', 'max_cancelreason_3545846M', 'max_rejectreason_755M', 'education_1103M', 'max_sta...
                               feature_types=None, gamma=None, grow_policy=None,
                               importance_type=None,
                               interaction_constraints=None, learning_rate=0.05,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=5, max_leaves=None,
                               min_child_weight=None, missing=nan,
                               monotone_constraints=None, multi_strategy=None,
                               n_estimators=100, n_jobs=None,
                               num_parallel_tree=None, random_state=42, ...))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-14" type="checkbox"><label for="sk-estimator-id-14" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">last_mile_recipes: Recipe</label><div class="sk-toggleable__content fitted"><pre>Recipe(ExpandDate(date(), components=['week', 'day']),
       Drop(date()),
       OneHotEncode(cols(('maritalst_893M', 'requesttype_4525192L', 'max_profession_152M', 'max_gender_992L', 'max_empl_industry_691L', 'max_housingtype_772L', 'max_incometype_1044T', 'max_cancelreason_3545846M', 'max_rejectreason_755M', 'education_1103M', 'max_status_219L'))),
       Drop(string()),
       HandleUnivariateOutliers(cols(('max_amount_1115A', 'max_overdueamountmax_950A')),
                                method='z-score',
                                deviation_factor=3,
                                treatment='capping'),
       ImputeMedian(numeric()),
       ScaleMinMax(numeric()),
       FillNA(numeric(), 0),
       Cast(numeric(), 'float32'))</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-15" type="checkbox"><label for="sk-estimator-id-15" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;ExpandDate<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://ibis-project.github.io/ibis-ml/reference/steps-temporal-feature-extraction.html#ibis_ml.ExpandDate">?<span>Documentation for ExpandDate</span></a></label><div class="sk-toggleable__content fitted"><pre>ExpandDate(date(), components=['week', 'day'])</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-16" type="checkbox"><label for="sk-estimator-id-16" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;Drop<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://ibis-project.github.io/ibis-ml/reference/steps-other.html#ibis_ml.Drop">?<span>Documentation for Drop</span></a></label><div class="sk-toggleable__content fitted"><pre>Drop(date())</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-17" type="checkbox"><label for="sk-estimator-id-17" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;OneHotEncode<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://ibis-project.github.io/ibis-ml/reference/steps-encoding.html#ibis_ml.OneHotEncode">?<span>Documentation for OneHotEncode</span></a></label><div class="sk-toggleable__content fitted"><pre>OneHotEncode(cols(('maritalst_893M', 'requesttype_4525192L', 'max_profession_152M', 'max_gender_992L', 'max_empl_industry_691L', 'max_housingtype_772L', 'max_incometype_1044T', 'max_cancelreason_3545846M', 'max_rejectreason_755M', 'education_1103M', 'max_status_219L')))</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-18" type="checkbox"><label for="sk-estimator-id-18" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;Drop<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://ibis-project.github.io/ibis-ml/reference/steps-other.html#ibis_ml.Drop">?<span>Documentation for Drop</span></a></label><div class="sk-toggleable__content fitted"><pre>Drop(string())</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-19" type="checkbox"><label for="sk-estimator-id-19" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;HandleUnivariateOutliers<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://ibis-project.github.io/ibis-ml/reference/steps-outlier-handling.html#ibis_ml.HandleUnivariateOutliers">?<span>Documentation for HandleUnivariateOutliers</span></a></label><div class="sk-toggleable__content fitted"><pre>HandleUnivariateOutliers(cols(('max_amount_1115A', 'max_overdueamountmax_950A')),
                         method='z-score',
                         deviation_factor=3,
                         treatment='capping')</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-20" type="checkbox"><label for="sk-estimator-id-20" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;ImputeMedian<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://ibis-project.github.io/ibis-ml/reference/steps-imputation.html#ibis_ml.ImputeMedian">?<span>Documentation for ImputeMedian</span></a></label><div class="sk-toggleable__content fitted"><pre>ImputeMedian(numeric())</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-21" type="checkbox"><label for="sk-estimator-id-21" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;ScaleMinMax<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://ibis-project.github.io/ibis-ml/reference/steps-standardization.html#ibis_ml.ScaleMinMax">?<span>Documentation for ScaleMinMax</span></a></label><div class="sk-toggleable__content fitted"><pre>ScaleMinMax(numeric())</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-22" type="checkbox"><label for="sk-estimator-id-22" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;FillNA<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://ibis-project.github.io/ibis-ml/reference/steps-imputation.html#ibis_ml.FillNA">?<span>Documentation for FillNA</span></a></label><div class="sk-toggleable__content fitted"><pre>FillNA(numeric(), 0)</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-23" type="checkbox"><label for="sk-estimator-id-23" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;Cast<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://ibis-project.github.io/ibis-ml/reference/steps-other.html#ibis_ml.Cast">?<span>Documentation for Cast</span></a></label><div class="sk-toggleable__content fitted"><pre>Cast(numeric(), 'float32')</pre></div> </div></div></div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-24" type="checkbox"><label for="sk-estimator-id-24" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">XGBClassifier</label><div class="sk-toggleable__content fitted"><pre>XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.8, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.05, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=5, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, random_state=42, ...)</pre></div> </div></div></div></div></div></div>
</div>
</div>
<p>Let’s evaluate the model on the test data using Gini index:</p>
<div id="123379e8" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Show code to calculate the Gini score for the test dataset</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>y_pred_proba <span class="op">=</span> pipe.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the AUC score</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>auc <span class="op">=</span> roc_auc_score(y_test, y_pred_proba)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the Gini score</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>gini_score <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> auc <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"gini_score for test dataset: </span><span class="sc">{</span>gini_score<span class="sc">:,}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>gini_score for test dataset: 0.07954028892065734</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The competition is evaluated using a Gini stability metric. For more information, see the <a href="https://www.kaggle.com/competitions/home-credit-credit-risk-model-stability/overview/evaluation">evaluation guidelines</a></p>
</div>
</div>
</section>
<section id="neural-network-classifier" class="level3">
<h3 class="anchored" data-anchor-id="neural-network-classifier">Neural network classifier</h3>
<p>Build a neural network classifier using PyTorch and PyTorch Lightning.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is not recommended to build a neural network classifier for this competition, we are building it solely for demonstration purposes.</p>
</div>
</div>
<p>We’ll demonstrate how to build a model by directly passing the data to it. IbisML recipes can output data in various formats, making it compatible with different modeling frameworks. Let’s first train the recipe:</p>
<div id="6e7a02ad" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Show code to train the IbisML recipe</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># train preprocessing recipe using training dataset</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>last_mile_preprocessing.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>Recipe(ExpandDate(date(), components=['week', 'day']),
       Drop(date()),
       OneHotEncode(cols(('maritalst_893M', 'requesttype_4525192L', 'max_profession_152M', 'max_gender_992L', 'max_empl_industry_691L', 'max_housingtype_772L', 'max_incometype_1044T', 'max_cancelreason_3545846M', 'max_rejectreason_755M', 'education_1103M', 'max_status_219L'))),
       Drop(string()),
       HandleUnivariateOutliers(cols(('max_amount_1115A', 'max_overdueamountmax_950A')),
                                method='z-score',
                                deviation_factor=3,
                                treatment='capping'),
       ImputeMedian(numeric()),
       ScaleMinMax(numeric()),
       FillNA(numeric(), 0),
       Cast(numeric(), 'float32'))</code></pre>
</div>
</div>
<p>In the previous cell, we trained the recipe using the training dataset. Now, we will transform both the train and test datasets using the same recipe. The default output format is a <code>NumPy array</code></p>
<div id="ac5aaa87" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Show code to transform the datasets using fitted recipe</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform train and test dataset using IbisML recipe</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>X_train_transformed <span class="op">=</span> last_mile_preprocessing.transform(X_train)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>X_test_transformed <span class="op">=</span> last_mile_preprocessing.transform(X_test)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"train data shape = </span><span class="sc">{</span>X_train_transformed<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"test data shape = </span><span class="sc">{</span>X_test_transformed<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>train data shape = (1144339, 977)
test data shape = (382320, 977)</code></pre>
</div>
</div>
<p>Let’s define a neural network classifier using PyTorch and PyTorch Lighting:</p>
<div id="92200558" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Show code to define a torch classifier</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> DataLoader, TensorDataset</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytorch_lightning <span class="im">as</span> pl</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pytorch_lightning <span class="im">import</span> Trainer</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NeuralNetClassifier(pl.LightningModule):</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_dim, hidden_dim<span class="op">=</span><span class="dv">8</span>, output_dim<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> nn.Sequential(</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>            nn.Linear(input_dim, hidden_dim),</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>            nn.ReLU(),</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>            nn.Linear(hidden_dim, output_dim),</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.loss <span class="op">=</span> nn.BCEWithLogitsLoss()</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.sigmoid <span class="op">=</span> nn.Sigmoid()</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.model(x)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> training_step(<span class="va">self</span>, batch, batch_idx):</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>        x, y <span class="op">=</span> batch</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>        y_hat <span class="op">=</span> <span class="va">self</span>(x)</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> <span class="va">self</span>.loss(y_hat.view(<span class="op">-</span><span class="dv">1</span>), y)</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log(<span class="st">"train_loss"</span>, loss)</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> loss</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> validation_step(<span class="va">self</span>, batch, batch_idx):</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>        x, y <span class="op">=</span> batch</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>        y_hat <span class="op">=</span> <span class="va">self</span>(x)</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> <span class="va">self</span>.loss(y_hat.view(<span class="op">-</span><span class="dv">1</span>), y)</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log(<span class="st">"val_loss"</span>, loss)</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> loss</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> configure_optimizers(<span class="va">self</span>):</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> optim.Adam(<span class="va">self</span>.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> predict_proba(<span class="va">self</span>, x):</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.<span class="bu">eval</span>()</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> x.to(<span class="va">self</span>.device)</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.sigmoid(<span class="va">self</span>(x))</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize your Lightning Module</span></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>nn_classifier <span class="op">=</span> NeuralNetClassifier(input_dim<span class="op">=</span>X_train_transformed.shape[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we’ll create the PyTorch DataLoader using the output from IbisML:</p>
<div id="76fda8db" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Show code to convert IbisML output to tensor</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>y_train_array <span class="op">=</span> y_train.to_pandas().to_numpy().astype(np.float32)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>x_train_tensor <span class="op">=</span> torch.from_numpy(X_train_transformed)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>y_train_tensor <span class="op">=</span> torch.from_numpy(y_train_array)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>train_dataset <span class="op">=</span> TensorDataset(x_train_tensor, y_train_tensor)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>y_test_array <span class="op">=</span> y_test.to_pandas().to_numpy().astype(np.float32)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>X_test_tensor <span class="op">=</span> torch.from_numpy(X_test_transformed)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>y_test_tensor <span class="op">=</span> torch.from_numpy(y_test_array)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>val_dataset <span class="op">=</span> TensorDataset(X_test_tensor, y_test_tensor)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>train_loader <span class="op">=</span> DataLoader(train_dataset, batch_size<span class="op">=</span><span class="dv">32</span>, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>val_loader <span class="op">=</span> DataLoader(val_dataset, batch_size<span class="op">=</span><span class="dv">32</span>, shuffle<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Initialize the PyTorch Lightning Trainer:</p>
<div id="4331ae3c" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Show code to construct PyTorch Lightning Trainer</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize a Trainer</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>trainer <span class="op">=</span> Trainer(max_epochs<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nn_classifier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>NeuralNetClassifier(
  (model): Sequential(
    (0): Linear(in_features=977, out_features=8, bias=True)
    (1): ReLU()
    (2): Linear(in_features=8, out_features=1, bias=True)
  )
  (loss): BCEWithLogitsLoss()
  (sigmoid): Sigmoid()
)</code></pre>
</div>
</div>
<p>Let’s train the classifier:</p>
<div id="fbfc82b9" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Show code to train the pytorch classifier</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># train the model</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>trainer.fit(nn_classifier, train_loader, val_loader)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a8835524dc5744d083f8bc99d0d1ee21","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"95c1d4d51e35415aacad0b0c48391169","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"80f23800f5224bb6b0bafa9b3f11c09f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8efd0507f1144c1e9a76770adc9c1dbd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<p>Let’s use the trained model to make a prediction:</p>
<div id="004ce1cf" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Show code to predict using the trained pytorch classifier</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> nn_classifier.predict_proba(X_test_tensor[:<span class="dv">10</span>])</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>y_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>tensor([[0.0238],
        [0.0253],
        [0.0210],
        [0.0254],
        [0.0236],
        [0.0239],
        [0.0242],
        [0.0240],
        [0.0169],
        [0.0236]])</code></pre>
</div>
</div>
</section>
</section>
<section id="takeaways" class="level2">
<h2 class="anchored" data-anchor-id="takeaways">Takeaways</h2>
<p>IbisML provides a powerful suite of last-mile preprocessing transformations, including an advanced column selector that streamlines the selection and transformation of specific columns in your dataset.</p>
<p>It integrates seamlessly with scikit-learn pipelines, allowing you to incorporate preprocessing recipes directly into your workflow. Additionally, IbisML supports a variety of data output formats such as Dask, NumPy, and Arrow, ensuring compatibility with different machine learning frameworks.</p>
<p>Another key advantage of IbisML is its flexibility in performing data preprocessing across multiple backends, including DuckDB, Polars, Spark, BigQuery, and other Ibis backends. This enables you to preprocess your training data using the backend that best suits your needs, whether for large or small datasets, on local machines or compute backends, and in both development and production environments. Stay tuned for a future post where we will explore this capability in more detail.</p>
</section>
<section id="reference" class="level2">
<h2 class="anchored" data-anchor-id="reference">Reference</h2>
<ul>
<li><a href="https://www.kaggle.com/code/yuuniekiri/fork-of-home-credit-risk-lightgbm">1st Place Solution</a></li>
<li><a href="https://www.kaggle.com/code/jetakow/home-credit-2024-starter-notebook">home-credit-2024-starter-notebook</a></li>
<li><a href="https://www.kaggle.com/competitions/home-credit-credit-risk-model-stability/discussion/508337">EDA and Submission</a></li>
<li><a href="https://www.kaggle.com/code/greysky/home-credit-baseline">Home Credit Baseline</a></li>
</ul>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"state":{"1384ea71de0c4fc78f25761d9c5b7ee1":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_13a0d4e7e26c468d8f9107c900820c70","placeholder":"​","style":"IPY_MODEL_920abe1c134c4dbab840441a8bfe3265","tabbable":null,"tooltip":null,"value":"Validation DataLoader 0: 100%"}},"13a0d4e7e26c468d8f9107c900820c70":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"16b195af8b7c4539ba0e7b066b441c1c":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"187e84d347224f76947c6f8ed744deac":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1f8efa5b4812447a86868f33db8c411b":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_bdfab51ef12948fab297a6bd5b11fbe7","placeholder":"​","style":"IPY_MODEL_b22e26063347472097b120f2a576530d","tabbable":null,"tooltip":null,"value":" 2/2 [00:00&lt;00:00, 24.50it/s]"}},"24b2c88c9b9c481e9cb10d45e99350c2":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_c243290c92c64397b84da341aa2b9e12","placeholder":"​","style":"IPY_MODEL_72884c2a78a74be2b2f6c70c5d38dc3e","tabbable":null,"tooltip":null,"value":"Validation DataLoader 0: 100%"}},"2999a904dd5e42dea6713255824f3a7b":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"","description":"","description_allow_html":false,"layout":"IPY_MODEL_b79706ee40c1457a84fae0fa22b355c1","max":2,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3053f083f2fc4935bd06322273e19559","tabbable":null,"tooltip":null,"value":2}},"2f395c103dc1484e9bf92ba38af98856":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3053f083f2fc4935bd06322273e19559":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"30f16c0c172e4188b8187533a1a6f328":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_16b195af8b7c4539ba0e7b066b441c1c","placeholder":"​","style":"IPY_MODEL_5332a7912a424e14a044f533d52f3027","tabbable":null,"tooltip":null,"value":" 35761/35761 [05:50&lt;00:00, 101.93it/s, v_num=22]"}},"31662d5c8abc401d84d8e0286ae134db":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3a3995a15b234252acd1904c424edfbf":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"47caeeeda211459b9a35b9bdbcca8208":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_a4cf5e12c5514c98bead6857025bd4c8","placeholder":"​","style":"IPY_MODEL_767889a1066b4f8bb545c1f6c7b3aedd","tabbable":null,"tooltip":null,"value":"Sanity Checking DataLoader 0: 100%"}},"5332a7912a424e14a044f533d52f3027":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"59b891ecf3504578907bbb8385a108b3":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"5de4313389394cc0951474da82045311":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6c28b18916d443cba9db0821d843e554":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"","description":"","description_allow_html":false,"layout":"IPY_MODEL_b3ccd1f2a683402c98c7771a6360c35f","max":11948,"min":0,"orientation":"horizontal","style":"IPY_MODEL_187e84d347224f76947c6f8ed744deac","tabbable":null,"tooltip":null,"value":11948}},"6e9435f4b8974e3e81630a84797ba4f2":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"72884c2a78a74be2b2f6c70c5d38dc3e":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"76577cbc4aa942898c1a6b58442152a3":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"767889a1066b4f8bb545c1f6c7b3aedd":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"7dec257bf8944f1290bb997ebb48708f":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"80f23800f5224bb6b0bafa9b3f11c09f":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_24b2c88c9b9c481e9cb10d45e99350c2","IPY_MODEL_e88d442e82ea47dfbfc90507ea96a5b5","IPY_MODEL_e061e09bb90d4d72af041d77b51e10b7"],"layout":"IPY_MODEL_c588bb534d4245dd9c6bc6affa135e8c","tabbable":null,"tooltip":null}},"89928e5649d64658aa25e6041201d52d":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8d694f8516bc4a23a04697acda422a5c":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_89928e5649d64658aa25e6041201d52d","max":35761,"min":0,"orientation":"horizontal","style":"IPY_MODEL_76577cbc4aa942898c1a6b58442152a3","tabbable":null,"tooltip":null,"value":35761}},"8efd0507f1144c1e9a76770adc9c1dbd":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1384ea71de0c4fc78f25761d9c5b7ee1","IPY_MODEL_6c28b18916d443cba9db0821d843e554","IPY_MODEL_cb5c990dbc9f46bd8bfadf27815223af"],"layout":"IPY_MODEL_7dec257bf8944f1290bb997ebb48708f","tabbable":null,"tooltip":null}},"920abe1c134c4dbab840441a8bfe3265":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"95c1d4d51e35415aacad0b0c48391169":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_976bdfb185234c2195db6ab6a6eb604f","IPY_MODEL_8d694f8516bc4a23a04697acda422a5c","IPY_MODEL_30f16c0c172e4188b8187533a1a6f328"],"layout":"IPY_MODEL_f99ff86f76f3480b997b3c290772226c","tabbable":null,"tooltip":null}},"976bdfb185234c2195db6ab6a6eb604f":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_3a3995a15b234252acd1904c424edfbf","placeholder":"​","style":"IPY_MODEL_fcc8f592d94c4ea9b37ea5f79ea237cc","tabbable":null,"tooltip":null,"value":"Epoch 1: 100%"}},"9f3542eb33e44611912ad34092ce3957":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"a4cf5e12c5514c98bead6857025bd4c8":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a8835524dc5744d083f8bc99d0d1ee21":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_47caeeeda211459b9a35b9bdbcca8208","IPY_MODEL_2999a904dd5e42dea6713255824f3a7b","IPY_MODEL_1f8efa5b4812447a86868f33db8c411b"],"layout":"IPY_MODEL_59b891ecf3504578907bbb8385a108b3","tabbable":null,"tooltip":null}},"b22e26063347472097b120f2a576530d":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"b3ccd1f2a683402c98c7771a6360c35f":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b79706ee40c1457a84fae0fa22b355c1":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bdfab51ef12948fab297a6bd5b11fbe7":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c243290c92c64397b84da341aa2b9e12":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c588bb534d4245dd9c6bc6affa135e8c":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"cb5c990dbc9f46bd8bfadf27815223af":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_31662d5c8abc401d84d8e0286ae134db","placeholder":"​","style":"IPY_MODEL_9f3542eb33e44611912ad34092ce3957","tabbable":null,"tooltip":null,"value":" 11948/11948 [00:29&lt;00:00, 400.23it/s]"}},"cd0d35abd33f4e88886c2664f7e9796d":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e061e09bb90d4d72af041d77b51e10b7":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_5de4313389394cc0951474da82045311","placeholder":"​","style":"IPY_MODEL_6e9435f4b8974e3e81630a84797ba4f2","tabbable":null,"tooltip":null,"value":" 11948/11948 [00:29&lt;00:00, 409.22it/s]"}},"e88d442e82ea47dfbfc90507ea96a5b5":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"","description":"","description_allow_html":false,"layout":"IPY_MODEL_cd0d35abd33f4e88886c2664f7e9796d","max":11948,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2f395c103dc1484e9bf92ba38af98856","tabbable":null,"tooltip":null,"value":11948}},"f99ff86f76f3480b997b3c290772226c":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"100%"}},"fcc8f592d94c4ea9b37ea5f79ea237cc":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}}},"version_major":2,"version_minor":0}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ibis-project\.org");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="ibis-project/ibis" data-repo-id="MDEwOlJlcG9zaXRvcnkzNDEzOTIzMA==" data-category="Q&amp;A" data-category-id="DIC_kwDOAgjsXs4CASeT" data-mapping="title" data-reactions-enabled="0" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ibis-project/ibis/edit/main/docs/posts/ibisml/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ibis-project/ibis/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ibis-project">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://ibis-project.zulipchat.com">
      <i class="bi bi-zulip" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://ibis-project.org/posts.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>