<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>expression-tables – Ibis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<script src="../site_libs/quarto-search/autocomplete-preset-algolia.umd.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e67ff5f79a98c6389aa7c0b9e6712459.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-14475e581903c9a7e5ed069634c08d5c.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-12c8c4cf821d2fd1848e951be45237d8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "algolia": {
    "application-id": "TNU9HG3L41",
    "search-only-api-key": "26350948d1961209df16d9717a7e01d6",
    "index-name": "prod_ibis",
    "analytics-events": true,
    "show-logo": true,
    "libDir": "site_libs"
  },
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.5.1/dist/algoliasearch-lite.umd.js"></script>


<script type="text/javascript">
var ALGOLIA_INSIGHTS_SRC = "https://cdn.jsdelivr.net/npm/search-insights/dist/search-insights.iife.min.js";
!function(e,a,t,n,s,i,c){e.AlgoliaAnalyticsObject=s,e[s]=e[s]||function(){
(e[s].queue=e[s].queue||[]).push(arguments)},i=a.createElement(t),c=a.getElementsByTagName(t)[0],
i.async=1,i.src=n,c.parentNode.insertBefore(i,c)
}(window,document,"script",ALGOLIA_INSIGHTS_SRC,"aa");
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-algolia-insights">

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script data-goatcounter="https://ibis.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Ibis">
<meta property="og:description" content="the portable Python dataframe library">
<meta property="og:image" content="https://ibis-project.org/reference/logo.png">
<meta property="og:site_name" content="Ibis">
<meta name="twitter:title" content="Ibis">
<meta name="twitter:description" content="the portable Python dataframe library">
<meta name="twitter:image" content="https://ibis-project.org/reference/logo.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Ibis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-getting-started" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Getting started</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-getting-started">    
        <li>
    <a class="dropdown-item" href="../install.html">
 <span class="dropdown-text">Installation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/getting_started.html">
 <span class="dropdown-text">Tutorial: getting started</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/ibis-for-dplyr-users.html">
 <span class="dropdown-text">Tutorial: Ibis for dplyr users</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/ibis-for-pandas-users.html">
 <span class="dropdown-text">Tutorial: Ibis for pandas users</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/ibis-for-sql-users.html">
 <span class="dropdown-text">Tutorial: Ibis for SQL users</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Browser</li>
        <li>
    <a class="dropdown-item" href="../tutorials/browser/repl.html">
 <span class="dropdown-text">JupyterLite console</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Cloud Data Platforms</li>
        <li>
    <a class="dropdown-item" href="../tutorials/cloud-data-platforms/clickhouse.html">
 <span class="dropdown-text">ClickHouse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/cloud-data-platforms/starburst-galaxy/0_setup.html">
 <span class="dropdown-text">Starburst Galaxy</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Open Source Software</li>
        <li>
    <a class="dropdown-item" href="../tutorials/open-source-software/apache-flink/0_setup.html">
 <span class="dropdown-text">Apache Flink</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-concepts" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Concepts</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-concepts">    
        <li>
    <a class="dropdown-item" href="../why.html">
 <span class="dropdown-text">Why Ibis?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../concepts/composable-ecosystem.html">
 <span class="dropdown-text">Composable data ecosystem</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../concepts/datatypes.html">
 <span class="dropdown-text">Datatypes and Datashapes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../concepts/internals.html">
 <span class="dropdown-text">Internals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../concepts/user-testimonials.html">
 <span class="dropdown-text">User testimonials</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../concepts/versioning.html">
 <span class="dropdown-text">Versioning policy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../concepts/who.html">
 <span class="dropdown-text">Who supports Ibis?</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-backends" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Backends</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-backends">    
        <li>
    <a class="dropdown-item" href="../backends/bigquery.html">
 <span class="dropdown-text">BigQuery</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/clickhouse.html">
 <span class="dropdown-text">ClickHouse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/dask.html">
 <span class="dropdown-text">Dask</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/datafusion.html">
 <span class="dropdown-text">DataFusion</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/druid.html">
 <span class="dropdown-text">Druid</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/duckdb.html">
 <span class="dropdown-text">DuckDB</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/exasol.html">
 <span class="dropdown-text">Exasol</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/flink.html">
 <span class="dropdown-text">Flink</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/impala.html">
 <span class="dropdown-text">Impala</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/mssql.html">
 <span class="dropdown-text">MSSQL</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/mysql.html">
 <span class="dropdown-text">MySQL</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/oracle.html">
 <span class="dropdown-text">Oracle</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/pandas.html">
 <span class="dropdown-text">pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/polars.html">
 <span class="dropdown-text">Polars</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/postgresql.html">
 <span class="dropdown-text">PostgreSQL</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/pyspark.html">
 <span class="dropdown-text">PySpark</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/risingwave.html">
 <span class="dropdown-text">RisingWave</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/snowflake.html">
 <span class="dropdown-text">Snowflake</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/sqlite.html">
 <span class="dropdown-text">SQLite</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/trino.html">
 <span class="dropdown-text">Trino</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Support</li>
        <li>
    <a class="dropdown-item" href="../backends/support/matrix.html">
 <span class="dropdown-text">Operation support matrix</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../backends/support/operations.html">
 <span class="dropdown-text">Operations</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-how-to" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">How-to</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-how-to">    
        <li class="dropdown-header">Configure</li>
        <li>
    <a class="dropdown-item" href="../how-to/configure/basics.html">
 <span class="dropdown-text">Basic configuration</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Input Output</li>
        <li>
    <a class="dropdown-item" href="../how-to/input-output/basics.html">
 <span class="dropdown-text">Basic input/output</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/input-output/duckdb-parquet.html">
 <span class="dropdown-text">Read parquet files with Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/input-output/gcs_duckdb.html">
 <span class="dropdown-text">Loading Google Cloud Storage files with DuckDB</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/input-output/multiple-backends.html">
 <span class="dropdown-text">Work with multiple backends</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Analytics</li>
        <li>
    <a class="dropdown-item" href="../how-to/analytics/basics.html">
 <span class="dropdown-text">Basic analytics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/analytics/chain_expressions.html">
 <span class="dropdown-text">Chaining expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/analytics/imdb.html">
 <span class="dropdown-text">Analyze IMDB data using Ibis</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Visualization</li>
        <li>
    <a class="dropdown-item" href="../how-to/visualization/altair.html">
 <span class="dropdown-text">Altair + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/visualization/graphs.html">
 <span class="dropdown-text">GraphViz + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/visualization/matplotlib.html">
 <span class="dropdown-text">matplotlib + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/visualization/plotly.html">
 <span class="dropdown-text">Plotly + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/visualization/plotnine.html">
 <span class="dropdown-text">plotnine + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/visualization/seaborn.html">
 <span class="dropdown-text">seaborn + Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/visualization/streamlit.html">
 <span class="dropdown-text">Streamlit + Ibis</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Extending</li>
        <li>
    <a class="dropdown-item" href="../how-to/extending/builtin.html">
 <span class="dropdown-text">Reference built-in functions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/extending/sql.html">
 <span class="dropdown-text">Using SQL strings with Ibis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/extending/streaming.html">
 <span class="dropdown-text">Ibis for streaming</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../how-to/extending/unbound_expression.html">
 <span class="dropdown-text">Write and execute unbound expressions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-reference" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Reference</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-reference">    
        <li class="dropdown-header">Expression API</li>
        <li>
    <a class="dropdown-item" href="../reference/expression-tables.html">
 <span class="dropdown-text">Table expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/selectors.html">
 <span class="dropdown-text">Column selectors</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/expression-generic.html">
 <span class="dropdown-text">Generic expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/expression-numeric.html">
 <span class="dropdown-text">Numeric and Boolean expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/expression-strings.html">
 <span class="dropdown-text">String expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/expression-temporal.html">
 <span class="dropdown-text">Temporal expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/expression-collections.html">
 <span class="dropdown-text">Collection expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/expression-geospatial.html">
 <span class="dropdown-text">Geospatial expressions</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Type system</li>
        <li>
    <a class="dropdown-item" href="../reference/datatypes.html">
 <span class="dropdown-text">Data types</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/schemas.html">
 <span class="dropdown-text">Schemas</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">UDFs</li>
        <li>
    <a class="dropdown-item" href="../reference/scalar-udfs.html">
 <span class="dropdown-text">Scalar UDFs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/aggregate-udfs.html">
 <span class="dropdown-text">Aggregate UDFs (experimental)</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Connection APIs</li>
        <li>
    <a class="dropdown-item" href="../reference/connection.html">
 <span class="dropdown-text">Top-level connection APIs</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Configuration</li>
        <li>
    <a class="dropdown-item" href="../reference/Interactive.html">
 <span class="dropdown-text">Interactive</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/Options.html">
 <span class="dropdown-text">Options</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/Repr.html">
 <span class="dropdown-text">Repr</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reference/SQL.html">
 <span class="dropdown-text">SQL</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Cursed Knowledge</li>
        <li>
    <a class="dropdown-item" href="../reference/cursed_knowledge.html">
 <span class="dropdown-text">Cursed Knowledge</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../posts.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../presentations.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../release_notes.html"> 
<span class="menu-text">Release notes</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-contribute" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Contribute</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-contribute">    
        <li class="dropdown-header">Contribute</li>
        <li>
    <a class="dropdown-item" href="../contribute/01_environment.html">
 <span class="dropdown-text">Setting up a development environment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../contribute/02_workflow.html">
 <span class="dropdown-text">Contribute to the Ibis codebase</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../contribute/03_style.html">
 <span class="dropdown-text">Style and formatting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../contribute/04_maintainers_guide.html">
 <span class="dropdown-text">Maintaining the codebase</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../contribute/05_reference.html">
 <span class="dropdown-text">Test class reference</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis">
            Source code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/issues/new?assignees=&amp;labels=bug&amp;projects=&amp;template=bug-report.yml&amp;title=bug">
            Report a bug
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/issues/new?assignees=&amp;labels=docs&amp;projects=&amp;template=docs-issue.yml&amp;title=docs">
            Report a documentation issue
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/issues/new?assignees=&amp;labels=feature&amp;projects=&amp;template=feature-request.yml&amp;title=feat">
            Submit a feature request
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/ibis-project/ibis/discussions/new?category=q-a">
            Ask the community for help
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../reference/expression-tables.html">Expression API</a></li><li class="breadcrumb-item"><a href="../reference/expression-tables.html">Table expressions</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Expression API</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/expression-tables.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Table expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/selectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Column selectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/expression-generic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generic expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/expression-numeric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numeric and Boolean expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/expression-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">String expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/expression-temporal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Temporal expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/expression-collections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Collection expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/expression-geospatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geospatial expressions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Type system</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/datatypes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/schemas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schemas</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">UDFs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/scalar-udfs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scalar UDFs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/aggregate-udfs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aggregate UDFs (experimental)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Connection APIs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/connection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Top-level connection APIs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Configuration</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/Interactive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactive</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/Options.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Options</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/Repr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Repr</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/SQL.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SQL</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Cursed Knowledge</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/cursed_knowledge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cursed Knowledge</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ibis.expr.types.relations.Table" id="toc-ibis.expr.types.relations.Table" class="nav-link active" data-scroll-target="#ibis.expr.types.relations.Table">Table</a>
  <ul class="collapse">
  <li><a href="#attributes" id="toc-attributes" class="nav-link" data-scroll-target="#attributes">Attributes</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#ibis.expr.types.relations.Table.aggregate" id="toc-ibis.expr.types.relations.Table.aggregate" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.aggregate">aggregate</a></li>
  <li><a href="#ibis.expr.types.relations.Table.alias" id="toc-ibis.expr.types.relations.Table.alias" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.alias">alias</a></li>
  <li><a href="#ibis.expr.types.relations.Table.as_scalar" id="toc-ibis.expr.types.relations.Table.as_scalar" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.as_scalar">as_scalar</a></li>
  <li><a href="#ibis.expr.types.relations.Table.as_table" id="toc-ibis.expr.types.relations.Table.as_table" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.as_table">as_table</a></li>
  <li><a href="#ibis.expr.types.relations.Table.asof_join" id="toc-ibis.expr.types.relations.Table.asof_join" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.asof_join">asof_join</a></li>
  <li><a href="#ibis.expr.types.relations.Table.bind" id="toc-ibis.expr.types.relations.Table.bind" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.bind">bind</a></li>
  <li><a href="#ibis.expr.types.relations.Table.cache" id="toc-ibis.expr.types.relations.Table.cache" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.cache">cache</a></li>
  <li><a href="#ibis.expr.types.relations.Table.cast" id="toc-ibis.expr.types.relations.Table.cast" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.cast">cast</a></li>
  <li><a href="#ibis.expr.types.relations.Table.count" id="toc-ibis.expr.types.relations.Table.count" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.count">count</a></li>
  <li><a href="#ibis.expr.types.relations.Table.cross_join" id="toc-ibis.expr.types.relations.Table.cross_join" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.cross_join">cross_join</a></li>
  <li><a href="#ibis.expr.types.relations.Table.describe" id="toc-ibis.expr.types.relations.Table.describe" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.describe">describe</a></li>
  <li><a href="#ibis.expr.types.relations.Table.difference" id="toc-ibis.expr.types.relations.Table.difference" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.difference">difference</a></li>
  <li><a href="#ibis.expr.types.relations.Table.distinct" id="toc-ibis.expr.types.relations.Table.distinct" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.distinct">distinct</a></li>
  <li><a href="#ibis.expr.types.relations.Table.drop" id="toc-ibis.expr.types.relations.Table.drop" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.drop">drop</a></li>
  <li><a href="#ibis.expr.types.relations.Table.drop_null" id="toc-ibis.expr.types.relations.Table.drop_null" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.drop_null">drop_null</a></li>
  <li><a href="#ibis.expr.types.relations.Table.dropna" id="toc-ibis.expr.types.relations.Table.dropna" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.dropna">dropna</a></li>
  <li><a href="#ibis.expr.types.relations.Table.fill_null" id="toc-ibis.expr.types.relations.Table.fill_null" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.fill_null">fill_null</a></li>
  <li><a href="#ibis.expr.types.relations.Table.fillna" id="toc-ibis.expr.types.relations.Table.fillna" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.fillna">fillna</a></li>
  <li><a href="#ibis.expr.types.relations.Table.filter" id="toc-ibis.expr.types.relations.Table.filter" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.filter">filter</a></li>
  <li><a href="#ibis.expr.types.relations.Table.get_name" id="toc-ibis.expr.types.relations.Table.get_name" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.get_name">get_name</a></li>
  <li><a href="#ibis.expr.types.relations.Table.group_by" id="toc-ibis.expr.types.relations.Table.group_by" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.group_by">group_by</a></li>
  <li><a href="#ibis.expr.types.relations.Table.head" id="toc-ibis.expr.types.relations.Table.head" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.head">head</a></li>
  <li><a href="#ibis.expr.types.relations.Table.info" id="toc-ibis.expr.types.relations.Table.info" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.info">info</a></li>
  <li><a href="#ibis.expr.types.relations.Table.intersect" id="toc-ibis.expr.types.relations.Table.intersect" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.intersect">intersect</a></li>
  <li><a href="#ibis.expr.types.relations.Table.join" id="toc-ibis.expr.types.relations.Table.join" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.join">join</a></li>
  <li><a href="#ibis.expr.types.relations.Table.limit" id="toc-ibis.expr.types.relations.Table.limit" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.limit">limit</a></li>
  <li><a href="#ibis.expr.types.relations.Table.mutate" id="toc-ibis.expr.types.relations.Table.mutate" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.mutate">mutate</a></li>
  <li><a href="#ibis.expr.types.relations.Table.nunique" id="toc-ibis.expr.types.relations.Table.nunique" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.nunique">nunique</a></li>
  <li><a href="#ibis.expr.types.relations.Table.order_by" id="toc-ibis.expr.types.relations.Table.order_by" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.order_by">order_by</a></li>
  <li><a href="#ibis.expr.types.relations.Table.pivot_longer" id="toc-ibis.expr.types.relations.Table.pivot_longer" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.pivot_longer">pivot_longer</a></li>
  <li><a href="#ibis.expr.types.relations.Table.pivot_wider" id="toc-ibis.expr.types.relations.Table.pivot_wider" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.pivot_wider">pivot_wider</a></li>
  <li><a href="#ibis.expr.types.relations.Table.preview" id="toc-ibis.expr.types.relations.Table.preview" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.preview">preview</a></li>
  <li><a href="#ibis.expr.types.relations.Table.relabel" id="toc-ibis.expr.types.relations.Table.relabel" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.relabel">relabel</a></li>
  <li><a href="#ibis.expr.types.relations.Table.relocate" id="toc-ibis.expr.types.relations.Table.relocate" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.relocate">relocate</a></li>
  <li><a href="#ibis.expr.types.relations.Table.rename" id="toc-ibis.expr.types.relations.Table.rename" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.rename">rename</a></li>
  <li><a href="#ibis.expr.types.relations.Table.rowid" id="toc-ibis.expr.types.relations.Table.rowid" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.rowid">rowid</a></li>
  <li><a href="#ibis.expr.types.relations.Table.sample" id="toc-ibis.expr.types.relations.Table.sample" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.sample">sample</a></li>
  <li><a href="#ibis.expr.types.relations.Table.schema" id="toc-ibis.expr.types.relations.Table.schema" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.schema">schema</a></li>
  <li><a href="#ibis.expr.types.relations.Table.select" id="toc-ibis.expr.types.relations.Table.select" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.select">select</a></li>
  <li><a href="#ibis.expr.types.relations.Table.sql" id="toc-ibis.expr.types.relations.Table.sql" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.sql">sql</a></li>
  <li><a href="#ibis.expr.types.relations.Table.to_array" id="toc-ibis.expr.types.relations.Table.to_array" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.to_array">to_array</a></li>
  <li><a href="#ibis.expr.types.relations.Table.to_pandas" id="toc-ibis.expr.types.relations.Table.to_pandas" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.to_pandas">to_pandas</a></li>
  <li><a href="#ibis.expr.types.relations.Table.try_cast" id="toc-ibis.expr.types.relations.Table.try_cast" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.try_cast">try_cast</a></li>
  <li><a href="#ibis.expr.types.relations.Table.union" id="toc-ibis.expr.types.relations.Table.union" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.union">union</a></li>
  <li><a href="#ibis.expr.types.relations.Table.unnest" id="toc-ibis.expr.types.relations.Table.unnest" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.unnest">unnest</a></li>
  <li><a href="#ibis.expr.types.relations.Table.unpack" id="toc-ibis.expr.types.relations.Table.unpack" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.unpack">unpack</a></li>
  <li><a href="#ibis.expr.types.relations.Table.value_counts" id="toc-ibis.expr.types.relations.Table.value_counts" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.value_counts">value_counts</a></li>
  <li><a href="#ibis.expr.types.relations.Table.view" id="toc-ibis.expr.types.relations.Table.view" class="nav-link" data-scroll-target="#ibis.expr.types.relations.Table.view">view</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ibis.expr.types.groupby.GroupedTable" id="toc-ibis.expr.types.groupby.GroupedTable" class="nav-link" data-scroll-target="#ibis.expr.types.groupby.GroupedTable">GroupedTable</a>
  <ul class="collapse">
  <li><a href="#methods-1" id="toc-methods-1" class="nav-link" data-scroll-target="#methods-1">Methods</a>
  <ul class="collapse">
  <li><a href="#ibis.expr.types.groupby.GroupedTable.aggregate" id="toc-ibis.expr.types.groupby.GroupedTable.aggregate" class="nav-link" data-scroll-target="#ibis.expr.types.groupby.GroupedTable.aggregate">aggregate</a></li>
  <li><a href="#ibis.expr.types.groupby.GroupedTable.count" id="toc-ibis.expr.types.groupby.GroupedTable.count" class="nav-link" data-scroll-target="#ibis.expr.types.groupby.GroupedTable.count">count</a></li>
  <li><a href="#ibis.expr.types.groupby.GroupedTable.having" id="toc-ibis.expr.types.groupby.GroupedTable.having" class="nav-link" data-scroll-target="#ibis.expr.types.groupby.GroupedTable.having">having</a></li>
  <li><a href="#ibis.expr.types.groupby.GroupedTable.mutate" id="toc-ibis.expr.types.groupby.GroupedTable.mutate" class="nav-link" data-scroll-target="#ibis.expr.types.groupby.GroupedTable.mutate">mutate</a></li>
  <li><a href="#ibis.expr.types.groupby.GroupedTable.order_by" id="toc-ibis.expr.types.groupby.GroupedTable.order_by" class="nav-link" data-scroll-target="#ibis.expr.types.groupby.GroupedTable.order_by">order_by</a></li>
  <li><a href="#ibis.expr.types.groupby.GroupedTable.over" id="toc-ibis.expr.types.groupby.GroupedTable.over" class="nav-link" data-scroll-target="#ibis.expr.types.groupby.GroupedTable.over">over</a></li>
  <li><a href="#ibis.expr.types.groupby.GroupedTable.select" id="toc-ibis.expr.types.groupby.GroupedTable.select" class="nav-link" data-scroll-target="#ibis.expr.types.groupby.GroupedTable.select">select</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ibis.read_csv" id="toc-ibis.read_csv" class="nav-link" data-scroll-target="#ibis.read_csv">read_csv</a>
  <ul class="collapse">
  <li><a href="#parameters-39" id="toc-parameters-39" class="nav-link" data-scroll-target="#parameters-39">Parameters</a></li>
  <li><a href="#returns-45" id="toc-returns-45" class="nav-link" data-scroll-target="#returns-45">Returns</a></li>
  <li><a href="#examples-39" id="toc-examples-39" class="nav-link" data-scroll-target="#examples-39">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.read_delta" id="toc-ibis.read_delta" class="nav-link" data-scroll-target="#ibis.read_delta">read_delta</a>
  <ul class="collapse">
  <li><a href="#parameters-40" id="toc-parameters-40" class="nav-link" data-scroll-target="#parameters-40">Parameters</a></li>
  <li><a href="#returns-46" id="toc-returns-46" class="nav-link" data-scroll-target="#returns-46">Returns</a></li>
  <li><a href="#examples-40" id="toc-examples-40" class="nav-link" data-scroll-target="#examples-40">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.read_json" id="toc-ibis.read_json" class="nav-link" data-scroll-target="#ibis.read_json">read_json</a>
  <ul class="collapse">
  <li><a href="#parameters-41" id="toc-parameters-41" class="nav-link" data-scroll-target="#parameters-41">Parameters</a></li>
  <li><a href="#returns-47" id="toc-returns-47" class="nav-link" data-scroll-target="#returns-47">Returns</a></li>
  <li><a href="#examples-41" id="toc-examples-41" class="nav-link" data-scroll-target="#examples-41">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.read_parquet" id="toc-ibis.read_parquet" class="nav-link" data-scroll-target="#ibis.read_parquet">read_parquet</a>
  <ul class="collapse">
  <li><a href="#parameters-42" id="toc-parameters-42" class="nav-link" data-scroll-target="#parameters-42">Parameters</a></li>
  <li><a href="#returns-48" id="toc-returns-48" class="nav-link" data-scroll-target="#returns-48">Returns</a></li>
  <li><a href="#examples-42" id="toc-examples-42" class="nav-link" data-scroll-target="#examples-42">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.memtable" id="toc-ibis.memtable" class="nav-link" data-scroll-target="#ibis.memtable">memtable</a>
  <ul class="collapse">
  <li><a href="#parameters-43" id="toc-parameters-43" class="nav-link" data-scroll-target="#parameters-43">Parameters</a></li>
  <li><a href="#returns-49" id="toc-returns-49" class="nav-link" data-scroll-target="#returns-49">Returns</a></li>
  <li><a href="#examples-43" id="toc-examples-43" class="nav-link" data-scroll-target="#examples-43">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.table" id="toc-ibis.table" class="nav-link" data-scroll-target="#ibis.table">table</a>
  <ul class="collapse">
  <li><a href="#parameters-44" id="toc-parameters-44" class="nav-link" data-scroll-target="#parameters-44">Parameters</a></li>
  <li><a href="#returns-50" id="toc-returns-50" class="nav-link" data-scroll-target="#returns-50">Returns</a></li>
  <li><a href="#examples-44" id="toc-examples-44" class="nav-link" data-scroll-target="#examples-44">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.difference" id="toc-ibis.difference" class="nav-link" data-scroll-target="#ibis.difference">difference</a>
  <ul class="collapse">
  <li><a href="#parameters-45" id="toc-parameters-45" class="nav-link" data-scroll-target="#parameters-45">Parameters</a></li>
  <li><a href="#returns-51" id="toc-returns-51" class="nav-link" data-scroll-target="#returns-51">Returns</a></li>
  <li><a href="#examples-45" id="toc-examples-45" class="nav-link" data-scroll-target="#examples-45">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.intersect" id="toc-ibis.intersect" class="nav-link" data-scroll-target="#ibis.intersect">intersect</a>
  <ul class="collapse">
  <li><a href="#parameters-46" id="toc-parameters-46" class="nav-link" data-scroll-target="#parameters-46">Parameters</a></li>
  <li><a href="#returns-52" id="toc-returns-52" class="nav-link" data-scroll-target="#returns-52">Returns</a></li>
  <li><a href="#examples-46" id="toc-examples-46" class="nav-link" data-scroll-target="#examples-46">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.union" id="toc-ibis.union" class="nav-link" data-scroll-target="#ibis.union">union</a>
  <ul class="collapse">
  <li><a href="#parameters-47" id="toc-parameters-47" class="nav-link" data-scroll-target="#parameters-47">Parameters</a></li>
  <li><a href="#returns-53" id="toc-returns-53" class="nav-link" data-scroll-target="#returns-53">Returns</a></li>
  <li><a href="#examples-47" id="toc-examples-47" class="nav-link" data-scroll-target="#examples-47">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.join" id="toc-ibis.join" class="nav-link" data-scroll-target="#ibis.join">join</a>
  <ul class="collapse">
  <li><a href="#parameters-48" id="toc-parameters-48" class="nav-link" data-scroll-target="#parameters-48">Parameters</a></li>
  <li><a href="#examples-48" id="toc-examples-48" class="nav-link" data-scroll-target="#examples-48">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.row_number" id="toc-ibis.row_number" class="nav-link" data-scroll-target="#ibis.row_number">row_number</a>
  <ul class="collapse">
  <li><a href="#returns-54" id="toc-returns-54" class="nav-link" data-scroll-target="#returns-54">Returns</a></li>
  <li><a href="#examples-49" id="toc-examples-49" class="nav-link" data-scroll-target="#examples-49">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.rank" id="toc-ibis.rank" class="nav-link" data-scroll-target="#ibis.rank">rank</a>
  <ul class="collapse">
  <li><a href="#returns-55" id="toc-returns-55" class="nav-link" data-scroll-target="#returns-55">Returns</a></li>
  <li><a href="#examples-50" id="toc-examples-50" class="nav-link" data-scroll-target="#examples-50">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.dense_rank" id="toc-ibis.dense_rank" class="nav-link" data-scroll-target="#ibis.dense_rank">dense_rank</a>
  <ul class="collapse">
  <li><a href="#returns-56" id="toc-returns-56" class="nav-link" data-scroll-target="#returns-56">Returns</a></li>
  <li><a href="#examples-51" id="toc-examples-51" class="nav-link" data-scroll-target="#examples-51">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.percent_rank" id="toc-ibis.percent_rank" class="nav-link" data-scroll-target="#ibis.percent_rank">percent_rank</a>
  <ul class="collapse">
  <li><a href="#returns-57" id="toc-returns-57" class="nav-link" data-scroll-target="#returns-57">Returns</a></li>
  <li><a href="#examples-52" id="toc-examples-52" class="nav-link" data-scroll-target="#examples-52">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.cume_dist" id="toc-ibis.cume_dist" class="nav-link" data-scroll-target="#ibis.cume_dist">cume_dist</a>
  <ul class="collapse">
  <li><a href="#returns-58" id="toc-returns-58" class="nav-link" data-scroll-target="#returns-58">Returns</a></li>
  <li><a href="#examples-53" id="toc-examples-53" class="nav-link" data-scroll-target="#examples-53">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.ntile" id="toc-ibis.ntile" class="nav-link" data-scroll-target="#ibis.ntile">ntile</a>
  <ul class="collapse">
  <li><a href="#parameters-49" id="toc-parameters-49" class="nav-link" data-scroll-target="#parameters-49">Parameters</a></li>
  <li><a href="#examples-54" id="toc-examples-54" class="nav-link" data-scroll-target="#examples-54">Examples</a></li>
  </ul></li>
  <li><a href="#ibis.window" id="toc-ibis.window" class="nav-link" data-scroll-target="#ibis.window">window</a>
  <ul class="collapse">
  <li><a href="#parameters-50" id="toc-parameters-50" class="nav-link" data-scroll-target="#parameters-50">Parameters</a></li>
  <li><a href="#returns-59" id="toc-returns-59" class="nav-link" data-scroll-target="#returns-59">Returns</a></li>
  </ul></li>
  <li><a href="#ibis.cumulative_window" id="toc-ibis.cumulative_window" class="nav-link" data-scroll-target="#ibis.cumulative_window">cumulative_window</a>
  <ul class="collapse">
  <li><a href="#parameters-51" id="toc-parameters-51" class="nav-link" data-scroll-target="#parameters-51">Parameters</a></li>
  <li><a href="#returns-60" id="toc-returns-60" class="nav-link" data-scroll-target="#returns-60">Returns</a></li>
  </ul></li>
  <li><a href="#ibis.range_window" id="toc-ibis.range_window" class="nav-link" data-scroll-target="#ibis.range_window">range_window</a>
  <ul class="collapse">
  <li><a href="#parameters-52" id="toc-parameters-52" class="nav-link" data-scroll-target="#parameters-52">Parameters</a></li>
  <li><a href="#returns-61" id="toc-returns-61" class="nav-link" data-scroll-target="#returns-61">Returns</a></li>
  </ul></li>
  <li><a href="#ibis.trailing_range_window" id="toc-ibis.trailing_range_window" class="nav-link" data-scroll-target="#ibis.trailing_range_window">trailing_range_window</a>
  <ul class="collapse">
  <li><a href="#parameters-53" id="toc-parameters-53" class="nav-link" data-scroll-target="#parameters-53">Parameters</a></li>
  <li><a href="#returns-62" id="toc-returns-62" class="nav-link" data-scroll-target="#returns-62">Returns</a></li>
  </ul></li>
  <li><a href="#ibis.trailing_window" id="toc-ibis.trailing_window" class="nav-link" data-scroll-target="#ibis.trailing_window">trailing_window</a>
  <ul class="collapse">
  <li><a href="#parameters-54" id="toc-parameters-54" class="nav-link" data-scroll-target="#parameters-54">Parameters</a></li>
  <li><a href="#returns-63" id="toc-returns-63" class="nav-link" data-scroll-target="#returns-63">Returns</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ibis-project/ibis/edit/main/docs/reference/expression-tables.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ibis-project/ibis/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../reference/expression-tables.html">Expression API</a></li><li class="breadcrumb-item"><a href="../reference/expression-tables.html">Table expressions</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Table expressions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Tables are one of the core data structures in Ibis.</p>
<section id="ibis.expr.types.relations.Table" class="level1">
<h1>Table</h1>
<p><code>Table(self, arg)</code></p>
<p>An immutable and lazy dataframe.</p>
<p>Analogous to a SQL table or a pandas DataFrame. A table expression contains an <a href="../reference/schemas.html#ibis.expr.schema.Schema">ordered set of named columns</a>, each with a single known type. Unless explicitly ordered with an <a href="../reference/expression-tables.html#ibis.expr.types.relations.Table.order_by"><code>.order_by()</code></a>, the order of rows is undefined.</p>
<p>Table immutability means that the data underlying an Ibis <code>Table</code> cannot be modified: every method on a Table returns a new Table with those changes. Laziness means that an Ibis <code>Table</code> expression does not run your computation every time you call one of its methods. Instead, it is a symbolic expression that represents a set of operations to be performed, which typically is translated into a SQL query. That SQL query is then executed on a backend, where the data actually lives. The result (now small enough to be manageable) can then be materialized back into python as a pandas/pyarrow/python DataFrame/Column/scalar.</p>
<p>You will not create Table objects directly. Instead, you will create one</p>
<ul>
<li>from a pandas DataFrame, pyarrow table, Polars table, or raw python dicts/lists with <a href="../reference/expression-tables.html#ibis.memtable"><code>ibis.memtable(df)</code></a></li>
<li>from an existing table in a data platform with <a href="../reference/expression-tables.html#ibis.backends.duckdb.Backend.table"><code>connection.table("name")</code></a></li>
<li>from a file or URL, into a specific backend with <a href="../backends/duckdb.html#ibis.backends.duckdb.Backend.read_csv"><code>connection.read_csv/parquet/json("path/to/file")</code></a> (only some backends, typically local ones, support this)</li>
<li>from a file or URL, into the default backend with <a href="../reference/expression-tables.html#ibis.read_csv"><code>ibis.read_csv/read_json/read_parquet("path/to/file")</code></a></li>
</ul>
<p>See the <a href="https://ibis-project.org/how-to/input-output/basics">user guide</a> for more info.</p>
<section id="attributes" class="level2">
<h2 class="anchored" data-anchor-id="attributes">Attributes</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.columns">columns</a></td>
<td>The list of column names in this table.</td>
</tr>
</tbody>
</table>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.aggregate">aggregate</a></td>
<td>Aggregate a table with a given set of reductions grouping by <code>by</code>.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.alias">alias</a></td>
<td>Create a table expression with a specific name <code>alias</code>.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.as_scalar">as_scalar</a></td>
<td>Inform ibis that the table expression should be treated as a scalar.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.as_table">as_table</a></td>
<td>Promote the expression to a table.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.asof_join">asof_join</a></td>
<td>Perform an “as-of” join between <code>left</code> and <code>right</code>.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.bind">bind</a></td>
<td>Bind column values to a table expression.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.cache">cache</a></td>
<td>Cache the provided expression.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.cast">cast</a></td>
<td>Cast the columns of a table.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.count">count</a></td>
<td>Compute the number of rows in the table.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.cross_join">cross_join</a></td>
<td>Compute the cross join of a sequence of tables.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.describe">describe</a></td>
<td>Return summary information about a table.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.difference">difference</a></td>
<td>Compute the set difference of multiple table expressions.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.distinct">distinct</a></td>
<td>Return a Table with duplicate rows removed.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.drop">drop</a></td>
<td>Remove fields from a table.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.drop_null">drop_null</a></td>
<td>Remove rows with null values from the table.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.dropna">dropna</a></td>
<td>Deprecated - use <code>drop_null</code> instead.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.fill_null">fill_null</a></td>
<td>Fill null values in a table expression.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.fillna">fillna</a></td>
<td>Deprecated - use <code>fill_null</code> instead.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.filter">filter</a></td>
<td>Select rows from <code>table</code> based on <code>predicates</code>.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.get_name">get_name</a></td>
<td>Return the fully qualified name of the table.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.group_by">group_by</a></td>
<td>Create a grouped table expression.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.head">head</a></td>
<td>Select the first <code>n</code> rows of a table.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.info">info</a></td>
<td>Return summary information about a table.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.intersect">intersect</a></td>
<td>Compute the set intersection of multiple table expressions.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.join">join</a></td>
<td>Perform a join between two tables.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.limit">limit</a></td>
<td>Select <code>n</code> rows from <code>self</code> starting at <code>offset</code>.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.mutate">mutate</a></td>
<td>Add columns to a table expression.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.nunique">nunique</a></td>
<td>Compute the number of unique rows in the table.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.order_by">order_by</a></td>
<td>Sort a table by one or more expressions.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.pivot_longer">pivot_longer</a></td>
<td>Transform a table from wider to longer.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.pivot_wider">pivot_wider</a></td>
<td>Pivot a table to a wider format.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.preview">preview</a></td>
<td>Return a subset as a Rich Table.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.relabel">relabel</a></td>
<td>Deprecated in favor of <code>Table.rename</code>.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.relocate">relocate</a></td>
<td>Relocate <code>columns</code> before or after other specified columns.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.rename">rename</a></td>
<td>Rename columns in the table.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.rowid">rowid</a></td>
<td>A unique integer per row.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.sample">sample</a></td>
<td>Sample a fraction of rows from a table.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.schema">schema</a></td>
<td>Return the <a href="../reference/schemas.html#ibis.expr.schema.Schema">Schema</a> for this table.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.select">select</a></td>
<td>Compute a new table expression using <code>exprs</code> and <code>named_exprs</code>.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.sql">sql</a></td>
<td>Run a SQL query against a table expression.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.to_array">to_array</a></td>
<td>View a single column table as an array.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.to_pandas">to_pandas</a></td>
<td>Convert a table expression to a pandas DataFrame.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.try_cast">try_cast</a></td>
<td>Cast the columns of a table.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.union">union</a></td>
<td>Compute the set union of multiple table expressions.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.unnest">unnest</a></td>
<td>Unnest an array <code>column</code> from a table.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.unpack">unpack</a></td>
<td>Project the struct fields of each of <code>columns</code> into <code>self</code>.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.relations.Table.value_counts">value_counts</a></td>
<td>Compute a frequency table of this table’s values.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.relations.Table.view">view</a></td>
<td>Create a new table expression distinct from the current one.</td>
</tr>
</tbody>
</table>
<section id="ibis.expr.types.relations.Table.aggregate" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.aggregate">aggregate</h3>
<p><code>aggregate(metrics=(), by=(), having=(), **kwargs)</code></p>
<p>Aggregate a table with a given set of reductions grouping by <code>by</code>.</p>
<section id="parameters" class="level4">
<h4 class="anchored" data-anchor-id="parameters">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>metrics</code></td>
<td><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<code>ir</code>.<code>Scalar</code>] | None</td>
<td>Aggregate expressions. These can be any scalar-producing expression, including aggregation functions like <code>sum</code> or literal values like <code>ibis.literal(1)</code>.</td>
<td><code>()</code></td>
</tr>
<tr class="even">
<td><code>by</code></td>
<td><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<code>ir</code>.<code>Value</code>] | None</td>
<td>Grouping expressions.</td>
<td><code>()</code></td>
</tr>
<tr class="odd">
<td><code>having</code></td>
<td><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<code>ir</code>.<code>BooleanValue</code>] | None</td>
<td>Post-aggregation filters. The shape requirements are the same <code>metrics</code>, but the output type for <code>having</code> is <code>boolean</code>. ::: {.callout-warning} ## Expressions like <code>x is None</code> return <code>bool</code> and <strong>will not</strong> generate a SQL comparison to <code>NULL</code> :::</td>
<td><code>()</code></td>
</tr>
<tr class="even">
<td><code>kwargs</code></td>
<td><code>ir</code>.<code>Value</code></td>
<td>Named aggregate expressions</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns" class="level4">
<h4 class="anchored" data-anchor-id="returns">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>An aggregate table expression</td>
</tr>
</tbody>
</table>
</section>
<section id="examples" class="level4">
<h4 class="anchored" data-anchor-id="examples">Examples</h4>
<div id="0ba79674" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>...     {</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>...         <span class="st">"fruit"</span>: [<span class="st">"apple"</span>, <span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"orange"</span>],</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>...         <span class="st">"price"</span>: [<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.33</span>],</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>...     }</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> fruit  </span>┃<span style="font-weight: bold"> price   </span>┃
┡━━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │
├────────┼─────────┤
│ <span style="color: #008000; text-decoration-color: #008000">apple </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.50</span> │
│ <span style="color: #008000; text-decoration-color: #008000">apple </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.50</span> │
│ <span style="color: #008000; text-decoration-color: #008000">banana</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.25</span> │
│ <span style="color: #008000; text-decoration-color: #008000">orange</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.33</span> │
└────────┴─────────┘
</pre>
</div>
</div>
<div id="443a99db" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.aggregate(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>...     by<span class="op">=</span>[<span class="st">"fruit"</span>],</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>...     total_cost<span class="op">=</span>_.price.<span class="bu">sum</span>(),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>...     avg_cost<span class="op">=</span>_.price.mean(),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>...     having<span class="op">=</span>_.price.<span class="bu">sum</span>() <span class="op">&lt;</span> <span class="fl">0.5</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━┓
┃<span style="font-weight: bold"> fruit  </span>┃<span style="font-weight: bold"> total_cost </span>┃<span style="font-weight: bold"> avg_cost </span>┃
┡━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │
├────────┼────────────┼──────────┤
│ <span style="color: #008000; text-decoration-color: #008000">banana</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.25</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.25</span> │
│ <span style="color: #008000; text-decoration-color: #008000">orange</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.33</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.33</span> │
└────────┴────────────┴──────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.alias" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.alias">alias</h3>
<p><code>alias(alias)</code></p>
<p>Create a table expression with a specific name <code>alias</code>.</p>
<p>This method is useful for exposing an ibis expression to the underlying backend for use in the <a href="#ibis.expr.types.relations.Table.sql"><code>Table.sql</code></a> method.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>.alias</code> will create a temporary view
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>.alias</code> creates a temporary view in the database.</p>
<p>This side effect will be removed in a future version of ibis and <strong>is not part of the public API</strong>.</p>
</div>
</div>
<section id="parameters-1" class="level4">
<h4 class="anchored" data-anchor-id="parameters-1">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>alias</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>Name of the child expression</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-1" class="level4">
<h4 class="anchored" data-anchor-id="returns-1">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>An table expression</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-1" class="level4">
<h4 class="anchored" data-anchor-id="examples-1">Examples</h4>
<div id="9108ba82" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr <span class="op">=</span> t.alias(<span class="st">"pingüinos"</span>).sql(<span class="st">'SELECT * FROM "pingüinos" LIMIT 5'</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.as_scalar" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.as_scalar">as_scalar</h3>
<p><code>as_scalar()</code></p>
<p>Inform ibis that the table expression should be treated as a scalar.</p>
<p>Note that the table must have exactly one column and one row for this to work. If the table has more than one column an error will be raised in expression construction time. If the table has more than one row an error will be raised by the backend when the expression is executed.</p>
<section id="returns-2" class="level4">
<h4 class="anchored" data-anchor-id="returns-2">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Scalar</code></td>
<td>A scalar subquery</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-2" class="level4">
<h4 class="anchored" data-anchor-id="examples-2">Examples</h4>
<div id="303069ee" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> heavy_gentoo <span class="op">=</span> t.<span class="bu">filter</span>(t.species <span class="op">==</span> <span class="st">"Gentoo"</span>, t.body_mass_g <span class="op">&gt;</span> <span class="dv">6200</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> from_that_island <span class="op">=</span> t.<span class="bu">filter</span>(t.island <span class="op">==</span> heavy_gentoo.select(<span class="st">"island"</span>).as_scalar())</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> from_that_island.species.value_counts().order_by(<span class="st">"species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> species_count </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │
├─────────┼───────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Gentoo </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">124</span> │
└─────────┴───────────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.as_table" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.as_table">as_table</h3>
<p><code>as_table()</code></p>
<p>Promote the expression to a table.</p>
<p>This method is a no-op for table expressions.</p>
<section id="returns-3" class="level4">
<h4 class="anchored" data-anchor-id="returns-3">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>A table expression</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-3" class="level4">
<h4 class="anchored" data-anchor-id="examples-3">Examples</h4>
<div id="0d30abbe" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.table(<span class="bu">dict</span>(a<span class="op">=</span><span class="st">"int"</span>), name<span class="op">=</span><span class="st">"t"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> s <span class="op">=</span> t.as_table()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="kw">is</span> s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>True</code></pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.asof_join" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.asof_join">asof_join</h3>
<p><code>asof_join(left, right, on, predicates=(), tolerance=None, *, lname='', rname='{name}_right')</code></p>
<p>Perform an “as-of” join between <code>left</code> and <code>right</code>.</p>
<p>Similar to a left join except that the match is done on nearest key rather than equal keys.</p>
<section id="parameters-2" class="level4">
<h4 class="anchored" data-anchor-id="parameters-2">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>left</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Table expression</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>right</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Table expression</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td><code>on</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>BooleanColumn</code></td>
<td>Closest match inequality condition</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>predicates</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>Column</code> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>Column</code>]</td>
<td>Additional join predicates</td>
<td><code>()</code></td>
</tr>
<tr class="odd">
<td><code>tolerance</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>IntervalScalar</code> | None</td>
<td>Amount of time to look behind when joining</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>lname</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>A format string to use to rename overlapping columns in the left table (e.g.&nbsp;<code>"left_{name}"</code>).</td>
<td><code>''</code></td>
</tr>
<tr class="odd">
<td><code>rname</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>A format string to use to rename overlapping columns in the right table (e.g.&nbsp;<code>"right_{name}"</code>).</td>
<td><code>'{name}_right'</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-4" class="level4">
<h4 class="anchored" data-anchor-id="returns-4">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Table expression</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.expr.types.relations.Table.bind" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.bind">bind</h3>
<p><code>bind(*args, **kwargs)</code></p>
<p>Bind column values to a table expression.</p>
<p>This method handles the binding of every kind of column-like value that Ibis handles, including strings, integers, deferred expressions and selectors, to a table expression.</p>
<section id="parameters-3" class="level4">
<h4 class="anchored" data-anchor-id="parameters-3">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>args</code></td>
<td><a href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></td>
<td>Column-like values to bind.</td>
<td><code>()</code></td>
</tr>
<tr class="even">
<td><code>kwargs</code></td>
<td><a href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></td>
<td>Column-like values to bind, with names.</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-5" class="level4">
<h4 class="anchored" data-anchor-id="returns-5">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a href="../reference/expression-generic.html#ibis.expr.types.generic.Value">Value</a>, …]</td>
<td>A tuple of bound values</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.expr.types.relations.Table.cache" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.cache">cache</h3>
<p><code>cache()</code></p>
<p>Cache the provided expression.</p>
<p>All subsequent operations on the returned expression will be performed on the cached data. The lifetime of the cached table is tied to its python references (ie. it is released once the last reference to it is garbage collected). Alternatively, use the <a href="https://docs.python.org/3/reference/compound_stmts.html#with"><code>with</code></a> statement or call the <code>.release()</code> method for more control.</p>
<p>This method is idempotent: calling it multiple times in succession will return the same value as the first call.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
This method eagerly evaluates the expression prior to caching
</div>
</div>
<div class="callout-body-container callout-body">
<p>Subsequent evaluations will not recompute the expression so method chaining will not incur the overhead of caching more than once.</p>
</div>
</div>
<section id="returns-6" class="level4">
<h4 class="anchored" data-anchor-id="returns-6">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Cached table</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-4" class="level4">
<h4 class="anchored" data-anchor-id="examples-4">Examples</h4>
<div id="8132776f" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> heavy_computation <span class="op">=</span> ibis.literal(<span class="st">"Heavy Computation"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cached_penguins <span class="op">=</span> t.mutate(computation<span class="op">=</span>heavy_computation).cache()</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cached_penguins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> computation       </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │
├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┼───────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Heavy Computation</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Heavy Computation</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Heavy Computation</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Heavy Computation</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Heavy Computation</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3650</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Heavy Computation</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.9</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.8</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3625</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Heavy Computation</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4675</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Heavy Computation</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.1</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3475</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Heavy Computation</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.2</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4250</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Heavy Computation</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                 │
└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┴───────────────────┘
</pre>
</div>
</div>
<p>Explicit cache cleanup</p>
<div id="e3f3f6bc" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">with</span> t.mutate(computation<span class="op">=</span>heavy_computation).cache() <span class="im">as</span> cached_penguins:</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>...     cached_penguins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.cast" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.cast">cast</h3>
<p><code>cast(schema)</code></p>
<p>Cast the columns of a table.</p>
<p>Similar to <code>pandas.DataFrame.astype</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
If you need to cast columns to a single type, use <a href="../reference/selectors.html">selectors</a>.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<section id="parameters-4" class="level4">
<h4 class="anchored" data-anchor-id="parameters-4">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 36%">
<col style="width: 45%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>schema</code></td>
<td><code>SchemaLike</code></td>
<td>Mapping, schema or iterable of pairs to use for casting</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-7" class="level4">
<h4 class="anchored" data-anchor-id="returns-7">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Casted table</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-5" class="level4">
<h4 class="anchored" data-anchor-id="examples-5">Examples</h4>
<div id="e6ecf68e" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.schema()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>ibis.Schema {
  species            string
  island             string
  bill_length_mm     float64
  bill_depth_mm      float64
  flipper_length_mm  int64
  body_mass_g        int64
  sex                string
  year               int64
}</code></pre>
</div>
</div>
<div id="4007d3a3" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cols <span class="op">=</span> [<span class="st">"body_mass_g"</span>, <span class="st">"bill_length_mm"</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t[cols].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃
┡━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │
├─────────────┼────────────────┤
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │
│        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │
└─────────────┴────────────────┘
</pre>
</div>
</div>
<p>Columns not present in the input schema will be passed through unchanged</p>
<div id="fd60ad47" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>['species',
 'island',
 'bill_length_mm',
 'bill_depth_mm',
 'flipper_length_mm',
 'body_mass_g',
 'sex',
 'year']</code></pre>
</div>
</div>
<div id="f9e2e61e" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr <span class="op">=</span> t.cast({<span class="st">"body_mass_g"</span>: <span class="st">"float64"</span>, <span class="st">"bill_length_mm"</span>: <span class="st">"int"</span>})</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr.select(<span class="op">*</span>cols).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃
┡━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>          │
├─────────────┼────────────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750.0</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800.0</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250.0</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40</span> │
│        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450.0</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37</span> │
└─────────────┴────────────────┘
</pre>
</div>
</div>
<p>Columns that are in the input <code>schema</code> but not in the table raise an error</p>
<div id="f4b2ca7c" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.cast({<span class="st">"foo"</span>: <span class="st">"string"</span>})  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">IbisError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[35], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">t</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">cast</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">{</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">foo</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">:</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">string</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">}</span><span class="ansi-yellow-bg">)</span>  

File <span class="ansi-green-fg">~/github.com/ibis-project/ibis/ibis/expr/types/relations.py:438</span>, in <span class="ansi-cyan-fg">Table.cast</span><span class="ansi-blue-fg">(self, schema)</span>
<span class="ansi-green-fg ansi-bold">    363</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">cast</span>(<span style="color:rgb(0,135,0)">self</span>, schema: SchemaLike) <span style="color:rgb(98,98,98)">-</span><span style="color:rgb(98,98,98)">&gt;</span> Table:
<span class="ansi-green-fg ansi-bold">    364</span> <span style="color:rgb(188,188,188)">    </span><span style="font-style:italic;color:rgb(175,0,0)">"""Cast the columns of a table.</span>
<span class="ansi-green-fg ansi-bold">    365</span> 
<span class="ansi-green-fg ansi-bold">    366</span> <span style="font-style:italic;color:rgb(175,0,0)">    Similar to `pandas.DataFrame.astype`.</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    436</span> <span style="font-style:italic;color:rgb(175,0,0)">    ibis.common.exceptions.IbisError: Cast schema has fields that are not in the table: ['foo']</span>
<span class="ansi-green-fg ansi-bold">    437</span> <span style="font-style:italic;color:rgb(175,0,0)">    """</span>
<span class="ansi-green-fg">--&gt; 438</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_cast</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">schema</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cast_method</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">cast</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/github.com/ibis-project/ibis/ibis/expr/types/relations.py:481</span>, in <span class="ansi-cyan-fg">Table._cast</span><span class="ansi-blue-fg">(self, schema, cast_method)</span>
<span class="ansi-green-fg ansi-bold">    479</span> columns <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>columns
<span class="ansi-green-fg ansi-bold">    480</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> missing_fields <span style="color:rgb(98,98,98)">:=</span> <span style="color:rgb(0,135,0)">frozenset</span>(schema<span style="color:rgb(98,98,98)">.</span>names)<span style="color:rgb(98,98,98)">.</span>difference(columns):
<span class="ansi-green-fg">--&gt; 481</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> com<span style="color:rgb(98,98,98)">.</span>IbisError(
<span class="ansi-green-fg ansi-bold">    482</span>         <span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Cast schema has fields that are not in the table: </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span><span style="color:rgb(0,135,0)">sorted</span>(missing_fields)<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">    483</span>     )
<span class="ansi-green-fg ansi-bold">    485</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> col <span style="font-weight:bold;color:rgb(175,0,255)">in</span> columns:
<span class="ansi-green-fg ansi-bold">    486</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> (new_type <span style="color:rgb(98,98,98)">:=</span> schema<span style="color:rgb(98,98,98)">.</span>get(col)) <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:

<span class="ansi-red-fg">IbisError</span>: Cast schema has fields that are not in the table: ['foo']</pre>
</div>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.count" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.count">count</h3>
<p><code>count(where=None)</code></p>
<p>Compute the number of rows in the table.</p>
<section id="parameters-5" class="level4">
<h4 class="anchored" data-anchor-id="parameters-5">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 50%">
<col style="width: 37%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>where</code></td>
<td><code>ir</code>.<code>BooleanValue</code> | None</td>
<td>Optional boolean expression to filter rows when counting.</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-8" class="level4">
<h4 class="anchored" data-anchor-id="returns-8">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>IntegerScalar</code></td>
<td>Number of rows in the table</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-6" class="level4">
<h4 class="anchored" data-anchor-id="examples-6">Examples</h4>
<div id="35f62654" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="st">"foo"</span>, <span class="st">"bar"</span>, <span class="st">"baz"</span>]})</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┓
┃<span style="font-weight: bold"> a      </span>┃
┡━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├────────┤
│ <span style="color: #008000; text-decoration-color: #008000">foo   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">bar   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">baz   </span> │
└────────┘
</pre>
</div>
</div>
<div id="202e82ec" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div class="ansi-escaped-output">
<pre>┌───┐
│ <span class="ansi-cyan-fg ansi-bold">3</span> │
└───┘</pre>
</div>
</div>
</div>
<div id="616222f5" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.count(t.a <span class="op">!=</span> <span class="st">"foo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div class="ansi-escaped-output">
<pre>┌───┐
│ <span class="ansi-cyan-fg ansi-bold">2</span> │
└───┘</pre>
</div>
</div>
</div>
<div id="3da1e1e7" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">type</span>(t.count())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>ibis.expr.types.numeric.IntegerScalar</code></pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.cross_join" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.cross_join">cross_join</h3>
<p><code>cross_join(left, right, *rest, lname='', rname='{name}_right')</code></p>
<p>Compute the cross join of a sequence of tables.</p>
<section id="parameters-6" class="level4">
<h4 class="anchored" data-anchor-id="parameters-6">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>left</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Left table</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>right</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Right table</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td><code>rest</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Additional tables to cross join</td>
<td><code>()</code></td>
</tr>
<tr class="even">
<td><code>lname</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>A format string to use to rename overlapping columns in the left table (e.g.&nbsp;<code>"left_{name}"</code>).</td>
<td><code>''</code></td>
</tr>
<tr class="odd">
<td><code>rname</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>A format string to use to rename overlapping columns in the right table (e.g.&nbsp;<code>"right_{name}"</code>).</td>
<td><code>'{name}_right'</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-9" class="level4">
<h4 class="anchored" data-anchor-id="returns-9">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Cross join of <code>left</code>, <code>right</code> and <code>rest</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-7" class="level4">
<h4 class="anchored" data-anchor-id="examples-7">Examples</h4>
<div id="c169a4c8" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div class="ansi-escaped-output">
<pre>┌─────┐
│ <span class="ansi-cyan-fg ansi-bold">344</span> │
└─────┘</pre>
</div>
</div>
</div>
<div id="906efded" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> agg <span class="op">=</span> t.drop(<span class="st">"year"</span>).agg(s.across(s.numeric(), _.mean()))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr <span class="op">=</span> t.cross_join(agg)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> bill_length_mm_right </span>┃<span style="font-weight: bold"> bill_depth_mm_right </span>┃<span style="font-weight: bold"> flipper_length_mm_right </span>┃<span style="font-weight: bold"> body_mass_g_right </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>                 │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │
├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┼──────────────────────┼─────────────────────┼─────────────────────────┼───────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3650</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.9</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.8</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3625</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4675</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.1</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3475</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.2</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4250</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┴──────────────────────┴─────────────────────┴─────────────────────────┴───────────────────┘
</pre>
</div>
</div>
<div id="9fd52178" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>['species',
 'island',
 'bill_length_mm',
 'bill_depth_mm',
 'flipper_length_mm',
 'body_mass_g',
 'sex',
 'year',
 'bill_length_mm_right',
 'bill_depth_mm_right',
 'flipper_length_mm_right',
 'body_mass_g_right']</code></pre>
</div>
</div>
<div id="bed06099" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div class="ansi-escaped-output">
<pre>┌─────┐
│ <span class="ansi-cyan-fg ansi-bold">344</span> │
└─────┘</pre>
</div>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.describe" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.describe">describe</h3>
<p><code>describe(quantile=(0.25, 0.5, 0.75))</code></p>
<p>Return summary information about a table.</p>
<section id="parameters-7" class="level4">
<h4 class="anchored" data-anchor-id="parameters-7">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>quantile</code></td>
<td><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<code>ir</code>.<code>NumericValue</code> | <a href="https://docs.python.org/3/library/functions.html#float">float</a>]</td>
<td>The quantiles to compute for numerical columns. Defaults to (0.25, 0.5, 0.75).</td>
<td><code>(0.25, 0.5, 0.75)</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-10" class="level4">
<h4 class="anchored" data-anchor-id="returns-10">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>A table containing summary information about the columns of self.</td>
</tr>
</tbody>
</table>
</section>
<section id="notes" class="level4">
<h4 class="anchored" data-anchor-id="notes">Notes</h4>
<p>This function computes summary statistics for each column in the table. For numerical columns, it computes statistics such as minimum, maximum, mean, standard deviation, and quantiles. For string columns, it computes the mode and the number of unique values.</p>
</section>
<section id="examples-8" class="level4">
<h4 class="anchored" data-anchor-id="examples-8">Examples</h4>
<div id="2a916008" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> name              </span>┃<span style="font-weight: bold"> pos   </span>┃<span style="font-weight: bold"> type    </span>┃<span style="font-weight: bold"> count </span>┃<span style="font-weight: bold"> nulls </span>┃<span style="font-weight: bold"> unique </span>┃<span style="font-weight: bold"> mode   </span>┃<span style="font-weight: bold"> mean        </span>┃<span style="font-weight: bold"> std        </span>┃<span style="font-weight: bold"> min     </span>┃<span style="font-weight: bold"> p25      </span>┃<span style="font-weight: bold"> p50     </span>┃<span style="font-weight: bold"> p75     </span>┃<span style="font-weight: bold"> max     </span>┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int16</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │
├───────────────────┼───────┼─────────┼───────┼───────┼────────┼────────┼─────────────┼────────────┼─────────┼──────────┼─────────┼─────────┼─────────┤
│ <span style="color: #008000; text-decoration-color: #008000">species          </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │ <span style="color: #008000; text-decoration-color: #008000">string </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">island           </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">string </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">bill_length_mm   </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">float64</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">164</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.921930</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.459584</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.1</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.225</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.45</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.5</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59.6</span> │
│ <span style="color: #008000; text-decoration-color: #008000">bill_depth_mm    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">float64</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.151170</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.974793</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.1</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.600</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.30</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">flipper_length_mm</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │ <span style="color: #008000; text-decoration-color: #008000">int64  </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">55</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.061714</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">172.0</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190.000</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">197.00</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">213.0</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">231.0</span> │
│ <span style="color: #008000; text-decoration-color: #008000">body_mass_g      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │ <span style="color: #008000; text-decoration-color: #008000">int64  </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">94</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">801.954536</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2700.0</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3550.000</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4050.00</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4750.0</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6300.0</span> │
│ <span style="color: #008000; text-decoration-color: #008000">sex              </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │ <span style="color: #008000; text-decoration-color: #008000">string </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">year             </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │ <span style="color: #008000; text-decoration-color: #008000">int64  </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008.029070</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.818356</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007.0</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007.000</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008.00</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009.0</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009.0</span> │
└───────────────────┴───────┴─────────┴───────┴───────┴────────┴────────┴─────────────┴────────────┴─────────┴──────────┴─────────┴─────────┴─────────┘
</pre>
</div>
</div>
<div id="4ff94d81" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.select(s.of_type(<span class="st">"numeric"</span>)).describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> name              </span>┃<span style="font-weight: bold"> pos   </span>┃<span style="font-weight: bold"> type    </span>┃<span style="font-weight: bold"> count </span>┃<span style="font-weight: bold"> nulls </span>┃<span style="font-weight: bold"> unique </span>┃<span style="font-weight: bold"> mean        </span>┃<span style="font-weight: bold"> std        </span>┃<span style="font-weight: bold"> min     </span>┃<span style="font-weight: bold"> p25      </span>┃<span style="font-weight: bold"> p50     </span>┃<span style="font-weight: bold"> p75     </span>┃<span style="font-weight: bold"> max     </span>┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int16</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │
├───────────────────┼───────┼─────────┼───────┼───────┼────────┼─────────────┼────────────┼─────────┼──────────┼─────────┼─────────┼─────────┤
│ <span style="color: #008000; text-decoration-color: #008000">flipper_length_mm</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">int64  </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">55</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.061714</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">172.0</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190.000</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">197.00</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">213.0</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">231.0</span> │
│ <span style="color: #008000; text-decoration-color: #008000">body_mass_g      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">int64  </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">94</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">801.954536</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2700.0</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3550.000</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4050.00</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4750.0</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6300.0</span> │
│ <span style="color: #008000; text-decoration-color: #008000">year             </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │ <span style="color: #008000; text-decoration-color: #008000">int64  </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008.029070</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.818356</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007.0</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007.000</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008.00</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009.0</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009.0</span> │
│ <span style="color: #008000; text-decoration-color: #008000">bill_length_mm   </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │ <span style="color: #008000; text-decoration-color: #008000">float64</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">164</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.921930</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.459584</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.1</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.225</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.45</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.5</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59.6</span> │
│ <span style="color: #008000; text-decoration-color: #008000">bill_depth_mm    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">float64</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.151170</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.974793</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.1</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.600</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.30</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.5</span> │
└───────────────────┴───────┴─────────┴───────┴───────┴────────┴─────────────┴────────────┴─────────┴──────────┴─────────┴─────────┴─────────┘
</pre>
</div>
</div>
<div id="1e4b54a7" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.select(s.of_type(<span class="st">"string"</span>)).describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> name    </span>┃<span style="font-weight: bold"> pos   </span>┃<span style="font-weight: bold"> type   </span>┃<span style="font-weight: bold"> count </span>┃<span style="font-weight: bold"> nulls </span>┃<span style="font-weight: bold"> unique </span>┃<span style="font-weight: bold"> mode   </span>┃
┡━━━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int16</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├─────────┼───────┼────────┼───────┼───────┼────────┼────────┤
│ <span style="color: #008000; text-decoration-color: #008000">sex    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">string</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │
│ <span style="color: #008000; text-decoration-color: #008000">species</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │ <span style="color: #008000; text-decoration-color: #008000">string</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie</span> │
│ <span style="color: #008000; text-decoration-color: #008000">island </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">string</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe</span> │
└─────────┴───────┴────────┴───────┴───────┴────────┴────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.difference" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.difference">difference</h3>
<p><code>difference(table, *rest, distinct=True)</code></p>
<p>Compute the set difference of multiple table expressions.</p>
<p>The input tables must have identical schemas.</p>
<section id="parameters-8" class="level4">
<h4 class="anchored" data-anchor-id="parameters-8">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>table</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>A table expression</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>*rest</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Additional table expressions</td>
<td><code>()</code></td>
</tr>
<tr class="odd">
<td><code>distinct</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#bool">bool</a></td>
<td>Only diff distinct rows not occurring in the calling table</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
</section>
<section id="see-also" class="level4">
<h4 class="anchored" data-anchor-id="see-also">See Also</h4>
<p><a href="../reference/expression-tables.html#ibis.difference"><code>ibis.difference</code></a></p>
</section>
<section id="returns-11" class="level4">
<h4 class="anchored" data-anchor-id="returns-11">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>The rows present in <code>self</code> that are not present in <code>tables</code>.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-9" class="level4">
<h4 class="anchored" data-anchor-id="examples-9">Examples</h4>
<div id="a9b85ee0" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">1</span>, <span class="dv">2</span>]})</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└───────┘
</pre>
</div>
</div>
<div id="dfcc0a3e" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">2</span>, <span class="dv">3</span>]})</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
└───────┘
</pre>
</div>
</div>
<div id="eeefef71" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1.difference(t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
└───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.distinct" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.distinct">distinct</h3>
<p><code>distinct(on=None, keep='first')</code></p>
<p>Return a Table with duplicate rows removed.</p>
<p>Similar to <code>pandas.DataFrame.drop_duplicates()</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Some backends do not support <code>keep='last'</code>
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<section id="parameters-9" class="level4">
<h4 class="anchored" data-anchor-id="parameters-9">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>on</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <code>s</code>.<code>Selector</code> | None</td>
<td>Only consider certain columns for identifying duplicates. By default deduplicate all of the columns.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>keep</code></td>
<td><a href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[‘first’, ‘last’] | None</td>
<td>Determines which duplicates to keep. - <code>"first"</code>: Drop duplicates except for the first occurrence. - <code>"last"</code>: Drop duplicates except for the last occurrence. - <code>None</code>: Drop all duplicates</td>
<td><code>'first'</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-10" class="level4">
<h4 class="anchored" data-anchor-id="examples-10">Examples</h4>
<div id="70e1a22c" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.examples <span class="im">as</span> ex</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ex.penguins.fetch()</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3650</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.9</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.8</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3625</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4675</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.1</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3475</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.2</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4250</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<p>Compute the distinct rows of a subset of columns</p>
<div id="4fd1f0c2" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t[[<span class="st">"species"</span>, <span class="st">"island"</span>]].distinct().order_by(s.<span class="bu">all</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━┓
┃<span style="font-weight: bold"> species   </span>┃<span style="font-weight: bold"> island    </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │
├───────────┼───────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Chinstrap</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │
│ <span style="color: #008000; text-decoration-color: #008000">Gentoo   </span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │
└───────────┴───────────┘
</pre>
</div>
</div>
<p>Drop all duplicate rows except the first</p>
<div id="3467e102" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.distinct(on<span class="op">=</span>[<span class="st">"species"</span>, <span class="st">"island"</span>], keep<span class="op">=</span><span class="st">"first"</span>).order_by(s.<span class="bu">all</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> species   </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.8</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">174</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3400</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">178</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Chinstrap</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.9</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">192</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3500</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Gentoo   </span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.2</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">211</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4500</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
└───────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<p>Drop all duplicate rows except the last</p>
<div id="eaa58a25" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.distinct(on<span class="op">=</span>[<span class="st">"species"</span>, <span class="st">"island"</span>], keep<span class="op">=</span><span class="st">"last"</span>).order_by(s.<span class="bu">all</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> species   </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">196</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4075</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.5</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">201</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4000</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.2</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">197</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3500</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Chinstrap</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">198</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3775</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Gentoo   </span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49.9</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.1</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">213</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5400</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │
└───────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<p>Drop all duplicated rows</p>
<div id="51efaf71" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr <span class="op">=</span> t.distinct(on<span class="op">=</span>[<span class="st">"species"</span>, <span class="st">"island"</span>, <span class="st">"year"</span>, <span class="st">"bill_length_mm"</span>], keep<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="92">
<div class="ansi-escaped-output">
<pre>┌─────┐
│ <span class="ansi-cyan-fg ansi-bold">273</span> │
└─────┘</pre>
</div>
</div>
</div>
<div id="142aba34" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="95">
<div class="ansi-escaped-output">
<pre>┌─────┐
│ <span class="ansi-cyan-fg ansi-bold">344</span> │
└─────┘</pre>
</div>
</div>
</div>
<p>You can pass <a href="../reference/selectors.html"><code>selectors</code></a> to <code>on</code></p>
<div id="9adf3be4" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.distinct(on<span class="op">=~</span>s.numeric())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> species   </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">180</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3600</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Gentoo   </span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">230</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5700</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.9</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">179</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2975</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Gentoo   </span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">216</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4100</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.8</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">174</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3400</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Gentoo   </span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.2</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">211</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4500</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.1</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3475</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie   </span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.1</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">178</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3900</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Chinstrap</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.9</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">192</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3500</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└───────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<p>The only valid values of <code>keep</code> are <code>"first"</code>, <code>"last"</code> and <a href="https://docs.python.org/3/library/constants.html#None"><code>None</code></a>.</p>
<div id="0192438b" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.distinct(on<span class="op">=</span><span class="st">"species"</span>, keep<span class="op">=</span><span class="st">"second"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">IbisError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[101], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">t</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">distinct</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">on</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">species</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">keep</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">second</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">)</span>  

File <span class="ansi-green-fg">~/github.com/ibis-project/ibis/ibis/expr/types/relations.py:1182</span>, in <span class="ansi-cyan-fg">Table.distinct</span><span class="ansi-blue-fg">(self, on, keep)</span>
<span class="ansi-green-fg ansi-bold">   1180</span>     method <span style="color:rgb(98,98,98)">=</span> keep
<span class="ansi-green-fg ansi-bold">   1181</span> <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 1182</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> com<span style="color:rgb(98,98,98)">.</span>IbisError(
<span class="ansi-green-fg ansi-bold">   1183</span>         <span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Invalid value for `keep`: </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>keep<span style="font-weight:bold;color:rgb(175,95,135)">!r}</span><span style="color:rgb(175,0,0)">, must be </span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">first</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">, </span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">last</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)"> or None</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">   1184</span>     )
<span class="ansi-green-fg ansi-bold">   1186</span> aggs <span style="color:rgb(98,98,98)">=</span> {col<span style="color:rgb(98,98,98)">.</span>get_name(): <span style="color:rgb(0,135,0)">getattr</span>(col, method)() <span style="font-weight:bold;color:rgb(0,135,0)">for</span> col <span style="font-weight:bold;color:rgb(175,0,255)">in</span> (<span style="color:rgb(98,98,98)">~</span>on)<span style="color:rgb(98,98,98)">.</span>expand(<span style="color:rgb(0,135,0)">self</span>)}
<span class="ansi-green-fg ansi-bold">   1187</span> res <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>aggregate(aggs, by<span style="color:rgb(98,98,98)">=</span>on, having<span style="color:rgb(98,98,98)">=</span>having)

<span class="ansi-red-fg">IbisError</span>: Invalid value for `keep`: 'second', must be 'first', 'last' or None</pre>
</div>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.drop" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.drop">drop</h3>
<p><code>drop(*fields)</code></p>
<p>Remove fields from a table.</p>
<section id="parameters-10" class="level4">
<h4 class="anchored" data-anchor-id="parameters-10">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>fields</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>Selector</code></td>
<td>Fields to drop. Strings and selectors are accepted.</td>
<td><code>()</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-12" class="level4">
<h4 class="anchored" data-anchor-id="returns-12">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>A table with all columns matching <code>fields</code> removed.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-11" class="level4">
<h4 class="anchored" data-anchor-id="examples-11">Examples</h4>
<div id="65295d63" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3650</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.9</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.8</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3625</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4675</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.1</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3475</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.2</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4250</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<p>Drop one or more columns</p>
<div id="cdcf3394" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.drop(<span class="st">"species"</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
└───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<div id="dd750b38" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.drop(<span class="st">"species"</span>, <span class="st">"bill_length_mm"</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
└───────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<p>Drop with selectors, mix and match</p>
<div id="e52b7768" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.drop(<span class="st">"species"</span>, s.startswith(<span class="st">"bill_"</span>)).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
└───────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.drop_null" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.drop_null">drop_null</h3>
<p><code>drop_null(subset=None, how='any')</code></p>
<p>Remove rows with null values from the table.</p>
<section id="parameters-11" class="level4">
<h4 class="anchored" data-anchor-id="parameters-11">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>subset</code></td>
<td><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</td>
<td>Columns names to consider when dropping nulls. By default all columns are considered.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>how</code></td>
<td><a href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[‘any’, ‘all’]</td>
<td>Determine whether a row is removed if there is <strong>at least one null value in the row</strong> (<code>'any'</code>), or if <strong>all</strong> row values are null (<code>'all'</code>).</td>
<td><code>'any'</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-13" class="level4">
<h4 class="anchored" data-anchor-id="returns-13">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Table expression</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-12" class="level4">
<h4 class="anchored" data-anchor-id="examples-12">Examples</h4>
<div id="0bf12d86" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3650</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.9</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.8</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3625</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4675</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.1</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3475</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.2</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4250</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<div id="bec768a6" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="119">
<div class="ansi-escaped-output">
<pre>┌─────┐
│ <span class="ansi-cyan-fg ansi-bold">344</span> │
└─────┘</pre>
</div>
</div>
</div>
<div id="67d78fe1" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.drop_null([<span class="st">"bill_length_mm"</span>, <span class="st">"body_mass_g"</span>]).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="122">
<div class="ansi-escaped-output">
<pre>┌─────┐
│ <span class="ansi-cyan-fg ansi-bold">342</span> │
└─────┘</pre>
</div>
</div>
</div>
<div id="2141f0f0" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.drop_null(how<span class="op">=</span><span class="st">"all"</span>).count()  <span class="co"># no rows where all columns are null</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="125">
<div class="ansi-escaped-output">
<pre>┌─────┐
│ <span class="ansi-cyan-fg ansi-bold">344</span> │
└─────┘</pre>
</div>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.dropna" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.dropna">dropna</h3>
<p><code>dropna(subset=None, how='any')</code></p>
<p>Deprecated - use <code>drop_null</code> instead.</p>
</section>
<section id="ibis.expr.types.relations.Table.fill_null" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.fill_null">fill_null</h3>
<p><code>fill_null(replacements)</code></p>
<p>Fill null values in a table expression.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
There is potential lack of type stability with the <code>fill_null</code> API
</div>
</div>
<div class="callout-body-container callout-body">
<p>For example, different library versions may impact whether a given backend promotes integer replacement values to floats.</p>
</div>
</div>
<section id="parameters-12" class="level4">
<h4 class="anchored" data-anchor-id="parameters-12">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>replacements</code></td>
<td><code>ir</code>.<code>Scalar</code> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping">Mapping</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <code>ir</code>.<code>Scalar</code>]</td>
<td>Value with which to fill nulls. If <code>replacements</code> is a mapping, the keys are column names that map to their replacement value. If passed as a scalar all columns are filled with that value.</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-14" class="level4">
<h4 class="anchored" data-anchor-id="returns-14">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Table expression</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-13" class="level4">
<h4 class="anchored" data-anchor-id="examples-13">Examples</h4>
<div id="38b1dbdf" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┓
┃<span style="font-weight: bold"> sex    </span>┃
┡━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├────────┤
│ <span style="color: #008000; text-decoration-color: #008000">male  </span> │
│ <span style="color: #008000; text-decoration-color: #008000">female</span> │
│ <span style="color: #008000; text-decoration-color: #008000">female</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #008000; text-decoration-color: #008000">female</span> │
│ <span style="color: #008000; text-decoration-color: #008000">male  </span> │
│ <span style="color: #008000; text-decoration-color: #008000">female</span> │
│ <span style="color: #008000; text-decoration-color: #008000">male  </span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │
└────────┘
</pre>
</div>
</div>
<div id="826b27fc" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.fill_null({<span class="st">"sex"</span>: <span class="st">"unrecorded"</span>}).sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="131">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> sex        </span>┃
┡━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>     │
├────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">male      </span> │
│ <span style="color: #008000; text-decoration-color: #008000">female    </span> │
│ <span style="color: #008000; text-decoration-color: #008000">female    </span> │
│ <span style="color: #008000; text-decoration-color: #008000">unrecorded</span> │
│ <span style="color: #008000; text-decoration-color: #008000">female    </span> │
│ <span style="color: #008000; text-decoration-color: #008000">male      </span> │
│ <span style="color: #008000; text-decoration-color: #008000">female    </span> │
│ <span style="color: #008000; text-decoration-color: #008000">male      </span> │
│ <span style="color: #008000; text-decoration-color: #008000">unrecorded</span> │
│ <span style="color: #008000; text-decoration-color: #008000">unrecorded</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>          │
└────────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.fillna" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.fillna">fillna</h3>
<p><code>fillna(replacements)</code></p>
<p>Deprecated - use <code>fill_null</code> instead.</p>
</section>
<section id="ibis.expr.types.relations.Table.filter" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.filter">filter</h3>
<p><code>filter(*predicates)</code></p>
<p>Select rows from <code>table</code> based on <code>predicates</code>.</p>
<section id="parameters-13" class="level4">
<h4 class="anchored" data-anchor-id="parameters-13">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>predicates</code></td>
<td><code>ir</code>.<code>BooleanValue</code> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<code>ir</code>.<code>BooleanValue</code>] | <code>IfAnyAll</code></td>
<td>Boolean value expressions used to select rows in <code>table</code>.</td>
<td><code>()</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-15" class="level4">
<h4 class="anchored" data-anchor-id="returns-15">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Filtered table expression</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-14" class="level4">
<h4 class="anchored" data-anchor-id="examples-14">Examples</h4>
<div id="2b1632b4" class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3650</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.9</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.8</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3625</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4675</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.1</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3475</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.2</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4250</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<div id="3849b990" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.<span class="bu">filter</span>([t.species <span class="op">==</span> <span class="st">"Adelie"</span>, t.body_mass_g <span class="op">&gt;</span> <span class="dv">3500</span>]).sex.value_counts().drop_null(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>...     <span class="st">"sex"</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>... ).order_by(<span class="st">"sex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━━━┓
┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> sex_count </span>┃
┡━━━━━━━━╇━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │
├────────┼───────────┤
│ <span style="color: #008000; text-decoration-color: #008000">female</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │
│ <span style="color: #008000; text-decoration-color: #008000">male  </span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68</span> │
└────────┴───────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.get_name" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.get_name">get_name</h3>
<p><code>get_name()</code></p>
<p>Return the fully qualified name of the table.</p>
</section>
<section id="ibis.expr.types.relations.Table.group_by" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.group_by">group_by</h3>
<p><code>group_by(*by, **key_exprs)</code></p>
<p>Create a grouped table expression.</p>
<p>Similar to SQL’s GROUP BY statement, or pandas .groupby() method.</p>
<section id="parameters-14" class="level4">
<h4 class="anchored" data-anchor-id="parameters-14">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>by</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>Value</code> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<code>ir</code>.<code>Value</code>] | None</td>
<td>Grouping expressions</td>
<td><code>()</code></td>
</tr>
<tr class="even">
<td><code>key_exprs</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>Value</code> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<code>ir</code>.<code>Value</code>]</td>
<td>Named grouping expressions</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-16" class="level4">
<h4 class="anchored" data-anchor-id="returns-16">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.groupby.GroupedTable">GroupedTable</a></td>
<td>A grouped table expression</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-15" class="level4">
<h4 class="anchored" data-anchor-id="examples-15">Examples</h4>
<div id="c1419aa8" class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>...     {</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>...         <span class="st">"fruit"</span>: [<span class="st">"apple"</span>, <span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"orange"</span>],</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>...         <span class="st">"price"</span>: [<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.33</span>],</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>...     }</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> fruit  </span>┃<span style="font-weight: bold"> price   </span>┃
┡━━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │
├────────┼─────────┤
│ <span style="color: #008000; text-decoration-color: #008000">apple </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.50</span> │
│ <span style="color: #008000; text-decoration-color: #008000">apple </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.50</span> │
│ <span style="color: #008000; text-decoration-color: #008000">banana</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.25</span> │
│ <span style="color: #008000; text-decoration-color: #008000">orange</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.33</span> │
└────────┴─────────┘
</pre>
</div>
</div>
<div id="fb142dc0" class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.group_by(<span class="st">"fruit"</span>).agg(total_cost<span class="op">=</span>_.price.<span class="bu">sum</span>(), avg_cost<span class="op">=</span>_.price.mean()).order_by(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>...     <span class="st">"fruit"</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━┓
┃<span style="font-weight: bold"> fruit  </span>┃<span style="font-weight: bold"> total_cost </span>┃<span style="font-weight: bold"> avg_cost </span>┃
┡━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │
├────────┼────────────┼──────────┤
│ <span style="color: #008000; text-decoration-color: #008000">apple </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.00</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.50</span> │
│ <span style="color: #008000; text-decoration-color: #008000">banana</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.25</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.25</span> │
│ <span style="color: #008000; text-decoration-color: #008000">orange</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.33</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.33</span> │
└────────┴────────────┴──────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.head" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.head">head</h3>
<p><code>head(n=5)</code></p>
<p>Select the first <code>n</code> rows of a table.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The result set is not deterministic without a call to <a href="#ibis.expr.types.relations.Table.order_by"><code>order_by</code></a>.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<section id="parameters-15" class="level4">
<h4 class="anchored" data-anchor-id="parameters-15">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>n</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a></td>
<td>Number of rows to include</td>
<td><code>5</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-17" class="level4">
<h4 class="anchored" data-anchor-id="returns-17">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td><code>self</code> limited to <code>n</code> rows</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-16" class="level4">
<h4 class="anchored" data-anchor-id="examples-16">Examples</h4>
<div id="9b53d574" class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>], <span class="st">"b"</span>: [<span class="st">"c"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>]})</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="146">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
└───────┴────────┘
</pre>
</div>
</div>
<div id="a558a2a8" class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
└───────┴────────┘
</pre>
</div>
</div>
</section>
<section id="see-also-1" class="level4">
<h4 class="anchored" data-anchor-id="see-also-1">See Also</h4>
<p><a href="#ibis.expr.types.relations.Table.limit"><code>Table.limit</code></a> <a href="#ibis.expr.types.relations.Table.order_by"><code>Table.order_by</code></a></p>
</section>
</section>
<section id="ibis.expr.types.relations.Table.info" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.info">info</h3>
<p><code>info()</code></p>
<p>Return summary information about a table.</p>
<section id="returns-18" class="level4">
<h4 class="anchored" data-anchor-id="returns-18">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Summary of <code>self</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-17" class="level4">
<h4 class="anchored" data-anchor-id="examples-17">Examples</h4>
<div id="04d222fc" class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="152">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> name              </span>┃<span style="font-weight: bold"> type    </span>┃<span style="font-weight: bold"> nullable </span>┃<span style="font-weight: bold"> nulls </span>┃<span style="font-weight: bold"> non_nulls </span>┃<span style="font-weight: bold"> null_frac </span>┃<span style="font-weight: bold"> pos   </span>┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">boolean</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int16</span> │
├───────────────────┼─────────┼──────────┼───────┼───────────┼───────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">species          </span> │ <span style="color: #008000; text-decoration-color: #008000">string </span> │ True     │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000000</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│ <span style="color: #008000; text-decoration-color: #008000">island           </span> │ <span style="color: #008000; text-decoration-color: #008000">string </span> │ True     │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000000</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│ <span style="color: #008000; text-decoration-color: #008000">bill_length_mm   </span> │ <span style="color: #008000; text-decoration-color: #008000">float64</span> │ True     │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">342</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005814</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│ <span style="color: #008000; text-decoration-color: #008000">bill_depth_mm    </span> │ <span style="color: #008000; text-decoration-color: #008000">float64</span> │ True     │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">342</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005814</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">flipper_length_mm</span> │ <span style="color: #008000; text-decoration-color: #008000">int64  </span> │ True     │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">342</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005814</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│ <span style="color: #008000; text-decoration-color: #008000">body_mass_g      </span> │ <span style="color: #008000; text-decoration-color: #008000">int64  </span> │ True     │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">342</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005814</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">sex              </span> │ <span style="color: #008000; text-decoration-color: #008000">string </span> │ True     │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">333</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.031977</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │
│ <span style="color: #008000; text-decoration-color: #008000">year             </span> │ <span style="color: #008000; text-decoration-color: #008000">int64  </span> │ True     │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">344</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.000000</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
└───────────────────┴─────────┴──────────┴───────┴───────────┴───────────┴───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.intersect" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.intersect">intersect</h3>
<p><code>intersect(table, *rest, distinct=True)</code></p>
<p>Compute the set intersection of multiple table expressions.</p>
<p>The input tables must have identical schemas.</p>
<section id="parameters-16" class="level4">
<h4 class="anchored" data-anchor-id="parameters-16">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>table</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>A table expression</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>*rest</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Additional table expressions</td>
<td><code>()</code></td>
</tr>
<tr class="odd">
<td><code>distinct</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#bool">bool</a></td>
<td>Only return distinct rows</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-19" class="level4">
<h4 class="anchored" data-anchor-id="returns-19">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>A new table containing the intersection of all input tables.</td>
</tr>
</tbody>
</table>
</section>
<section id="see-also-2" class="level4">
<h4 class="anchored" data-anchor-id="see-also-2">See Also</h4>
<p><a href="../reference/expression-tables.html#ibis.intersect"><code>ibis.intersect</code></a></p>
</section>
<section id="examples-18" class="level4">
<h4 class="anchored" data-anchor-id="examples-18">Examples</h4>
<div id="315fc5f8" class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">1</span>, <span class="dv">2</span>]})</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="155">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└───────┘
</pre>
</div>
</div>
<div id="3ec1323a" class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">2</span>, <span class="dv">3</span>]})</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
└───────┘
</pre>
</div>
</div>
<div id="43de4efb" class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1.intersect(t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.join" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.join">join</h3>
<p><code>join(left, right, predicates=(), how='inner', *, lname='', rname='{name}_right')</code></p>
<p>Perform a join between two tables.</p>
<section id="parameters-17" class="level4">
<h4 class="anchored" data-anchor-id="parameters-17">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>left</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Left table to join</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>right</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Right table to join</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td><code>predicates</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>BooleanColumn</code> | <a href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[True] | <a href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[False] | <a href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>Column</code> | <code>ir</code>.<code>Deferred</code>, <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>Column</code> | <code>ir</code>.<code>Deferred</code>]]</td>
<td>Condition(s) to join on. See examples for details.</td>
<td><code>()</code></td>
</tr>
<tr class="even">
<td><code>how</code></td>
<td><code>JoinKind</code></td>
<td>Join method, e.g.&nbsp;<code>"inner"</code> or <code>"left"</code>.</td>
<td><code>'inner'</code></td>
</tr>
<tr class="odd">
<td><code>lname</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>A format string to use to rename overlapping columns in the left table (e.g.&nbsp;<code>"left_{name}"</code>).</td>
<td><code>''</code></td>
</tr>
<tr class="even">
<td><code>rname</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>A format string to use to rename overlapping columns in the right table (e.g.&nbsp;<code>"right_{name}"</code>).</td>
<td><code>'{name}_right'</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-19" class="level4">
<h4 class="anchored" data-anchor-id="examples-19">Examples</h4>
<div id="a9d8e559" class="cell" data-execution_count="164">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> movies <span class="op">=</span> ibis.examples.ml_latest_small_movies.fetch()</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> movies.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="164">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> title                              </span>┃<span style="font-weight: bold"> genres                                      </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                                      │
├─────────┼────────────────────────────────────┼─────────────────────────────────────────────┤
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">Toy Story (1995)                  </span> │ <span style="color: #008000; text-decoration-color: #008000">Adventure|Animation|Children|Comedy|Fantasy</span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">Jumanji (1995)                    </span> │ <span style="color: #008000; text-decoration-color: #008000">Adventure|Children|Fantasy                 </span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">Grumpier Old Men (1995)           </span> │ <span style="color: #008000; text-decoration-color: #008000">Comedy|Romance                             </span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │ <span style="color: #008000; text-decoration-color: #008000">Waiting to Exhale (1995)          </span> │ <span style="color: #008000; text-decoration-color: #008000">Comedy|Drama|Romance                       </span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │ <span style="color: #008000; text-decoration-color: #008000">Father of the Bride Part II (1995)</span> │ <span style="color: #008000; text-decoration-color: #008000">Comedy                                     </span> │
└─────────┴────────────────────────────────────┴─────────────────────────────────────────────┘
</pre>
</div>
</div>
<div id="ce316a17" class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ratings <span class="op">=</span> ibis.examples.ml_latest_small_ratings.fetch().drop(<span class="st">"timestamp"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="167">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> userId </span>┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> rating  </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │
├────────┼─────────┼─────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │
└────────┴─────────┴─────────┘
</pre>
</div>
</div>
<p>Equality left join on the shared <code>movieId</code> column. Note the <code>_right</code> suffix added to all overlapping columns from the right table (in this case only the “movieId” column).</p>
<div id="aea257d9" class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ratings.join(movies, <span class="st">"movieId"</span>, how<span class="op">=</span><span class="st">"left"</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> userId </span>┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> rating  </span>┃<span style="font-weight: bold"> movieId_right </span>┃<span style="font-weight: bold"> title                       </span>┃<span style="font-weight: bold"> genres                                      </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                                      │
├────────┼─────────┼─────────┼───────────────┼─────────────────────────────┼─────────────────────────────────────────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">Toy Story (1995)           </span> │ <span style="color: #008000; text-decoration-color: #008000">Adventure|Animation|Children|Comedy|Fantasy</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">Grumpier Old Men (1995)    </span> │ <span style="color: #008000; text-decoration-color: #008000">Comedy|Romance                             </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │ <span style="color: #008000; text-decoration-color: #008000">Heat (1995)                </span> │ <span style="color: #008000; text-decoration-color: #008000">Action|Crime|Thriller                      </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span> │ <span style="color: #008000; text-decoration-color: #008000">Seven (a.k.a. Se7en) (1995)</span> │ <span style="color: #008000; text-decoration-color: #008000">Mystery|Thriller                           </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50</span> │ <span style="color: #008000; text-decoration-color: #008000">Usual Suspects, The (1995) </span> │ <span style="color: #008000; text-decoration-color: #008000">Crime|Mystery|Thriller                     </span> │
└────────┴─────────┴─────────┴───────────────┴─────────────────────────────┴─────────────────────────────────────────────┘
</pre>
</div>
</div>
<p>Explicit equality join using the default <code>how</code> value of <code>"inner"</code>. Note how there is no <code>_right</code> suffix added to the <code>movieId</code> column since this is an inner join and the <code>movieId</code> column is part of the join condition.</p>
<div id="ff4e9f5f" class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ratings.join(movies, ratings.movieId <span class="op">==</span> movies.movieId).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="173">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> userId </span>┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> rating  </span>┃<span style="font-weight: bold"> title                       </span>┃<span style="font-weight: bold"> genres                                      </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                                      │
├────────┼─────────┼─────────┼─────────────────────────────┼─────────────────────────────────────────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │ <span style="color: #008000; text-decoration-color: #008000">Toy Story (1995)           </span> │ <span style="color: #008000; text-decoration-color: #008000">Adventure|Animation|Children|Comedy|Fantasy</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │ <span style="color: #008000; text-decoration-color: #008000">Grumpier Old Men (1995)    </span> │ <span style="color: #008000; text-decoration-color: #008000">Comedy|Romance                             </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │ <span style="color: #008000; text-decoration-color: #008000">Heat (1995)                </span> │ <span style="color: #008000; text-decoration-color: #008000">Action|Crime|Thriller                      </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │ <span style="color: #008000; text-decoration-color: #008000">Seven (a.k.a. Se7en) (1995)</span> │ <span style="color: #008000; text-decoration-color: #008000">Mystery|Thriller                           </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │ <span style="color: #008000; text-decoration-color: #008000">Usual Suspects, The (1995) </span> │ <span style="color: #008000; text-decoration-color: #008000">Crime|Mystery|Thriller                     </span> │
└────────┴─────────┴─────────┴─────────────────────────────┴─────────────────────────────────────────────┘
</pre>
</div>
</div>
<div id="b7eca885" class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tags <span class="op">=</span> ibis.examples.ml_latest_small_tags.fetch()</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tags.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="176">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> userId </span>┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> tag             </span>┃<span style="font-weight: bold"> timestamp  </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │
├────────┼─────────┼─────────────────┼────────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60756</span> │ <span style="color: #008000; text-decoration-color: #008000">funny          </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445714994</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60756</span> │ <span style="color: #008000; text-decoration-color: #008000">Highly quotable</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445714996</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60756</span> │ <span style="color: #008000; text-decoration-color: #008000">will ferrell   </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445714992</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">89774</span> │ <span style="color: #008000; text-decoration-color: #008000">Boxing story   </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445715207</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">89774</span> │ <span style="color: #008000; text-decoration-color: #008000">MMA            </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445715200</span> │
└────────┴─────────┴─────────────────┴────────────┘
</pre>
</div>
</div>
<p>You can join on multiple columns/conditions by passing in a sequence. Find all instances where a user both tagged and rated a movie:</p>
<div id="97e07f31" class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tags.join(ratings, [<span class="st">"userId"</span>, <span class="st">"movieId"</span>]).head(<span class="dv">5</span>).order_by(<span class="st">"userId"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="179">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> userId </span>┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> tag            </span>┃<span style="font-weight: bold"> timestamp  </span>┃<span style="font-weight: bold"> rating  </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │
├────────┼─────────┼────────────────┼────────────┼─────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">Robin Williams</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1528843907</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">110</span> │ <span style="color: #008000; text-decoration-color: #008000">sword fight   </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1528152535</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.5</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">410</span> │ <span style="color: #008000; text-decoration-color: #008000">gothic        </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1525636609</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.5</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2023</span> │ <span style="color: #008000; text-decoration-color: #008000">mafia         </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1525636733</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2124</span> │ <span style="color: #008000; text-decoration-color: #008000">quirky        </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1525636846</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │
└────────┴─────────┴────────────────┴────────────┴─────────┘
</pre>
</div>
</div>
<p>To self-join a table with itself, you need to call <code>.view()</code> on one of the arguments so the two tables are distinct from each other.</p>
<p>For crafting more complex join conditions, a valid form of a join condition is a 2-tuple like <code>({left_key}, {right_key})</code>, where each key can be</p>
<ul>
<li>a Column</li>
<li>Deferred expression</li>
<li>lambda of the form (Table) -&gt; Column</li>
</ul>
<p>For example, to find all movies pairings that received the same (ignoring case) tags:</p>
<div id="5c2576b6" class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> movie_tags <span class="op">=</span> tags[<span class="st">"movieId"</span>, <span class="st">"tag"</span>]</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> view <span class="op">=</span> movie_tags.view()</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> movie_tags.join(</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>...     view,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>...     [</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>...         movie_tags.movieId <span class="op">!=</span> view.movieId,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>...         (_.tag.lower(), <span class="kw">lambda</span> t: t.tag.lower()),</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>...     ],</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>... ).head().order_by((<span class="st">"movieId"</span>, <span class="st">"movieId_right"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="182">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> tag               </span>┃<span style="font-weight: bold"> movieId_right </span>┃<span style="font-weight: bold"> tag_right         </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │
├─────────┼───────────────────┼───────────────┼───────────────────┤
│   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60756</span> │ <span style="color: #008000; text-decoration-color: #008000">funny            </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1732</span> │ <span style="color: #008000; text-decoration-color: #008000">funny            </span> │
│   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60756</span> │ <span style="color: #008000; text-decoration-color: #008000">Highly quotable  </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1732</span> │ <span style="color: #008000; text-decoration-color: #008000">Highly quotable  </span> │
│   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">89774</span> │ <span style="color: #008000; text-decoration-color: #008000">Tom Hardy        </span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">139385</span> │ <span style="color: #008000; text-decoration-color: #008000">tom hardy        </span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">106782</span> │ <span style="color: #008000; text-decoration-color: #008000">drugs            </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1732</span> │ <span style="color: #008000; text-decoration-color: #008000">drugs            </span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">106782</span> │ <span style="color: #008000; text-decoration-color: #008000">Leonardo DiCaprio</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5989</span> │ <span style="color: #008000; text-decoration-color: #008000">Leonardo DiCaprio</span> │
└─────────┴───────────────────┴───────────────┴───────────────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.limit" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.limit">limit</h3>
<p><code>limit(n, offset=0)</code></p>
<p>Select <code>n</code> rows from <code>self</code> starting at <code>offset</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The result set is not deterministic without a call to <a href="#ibis.expr.types.relations.Table.order_by"><code>order_by</code></a>.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<section id="parameters-18" class="level4">
<h4 class="anchored" data-anchor-id="parameters-18">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>n</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a> | None</td>
<td>Number of rows to include. If <code>None</code>, the entire table is selected starting from <code>offset</code>.</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>offset</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a></td>
<td>Number of rows to skip first</td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-20" class="level4">
<h4 class="anchored" data-anchor-id="returns-20">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>The first <code>n</code> rows of <code>self</code> starting at <code>offset</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-20" class="level4">
<h4 class="anchored" data-anchor-id="examples-20">Examples</h4>
<div id="4f8c196f" class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>], <span class="st">"b"</span>: [<span class="st">"c"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>]})</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="185">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
└───────┴────────┘
</pre>
</div>
</div>
<div id="5b849fb9" class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.limit(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="188">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
└───────┴────────┘
</pre>
</div>
</div>
<p>You can use <code>None</code> with <code>offset</code> to slice starting from a particular row</p>
<div id="b599a245" class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.limit(<span class="va">None</span>, offset<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="191">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
└───────┴────────┘
</pre>
</div>
</div>
</section>
<section id="see-also-3" class="level4">
<h4 class="anchored" data-anchor-id="see-also-3">See Also</h4>
<p><a href="#ibis.expr.types.relations.Table.order_by"><code>Table.order_by</code></a></p>
</section>
</section>
<section id="ibis.expr.types.relations.Table.mutate" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.mutate">mutate</h3>
<p><code>mutate(*exprs, **mutations)</code></p>
<p>Add columns to a table expression.</p>
<section id="parameters-19" class="level4">
<h4 class="anchored" data-anchor-id="parameters-19">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>exprs</code></td>
<td><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<code>ir</code>.<code>Expr</code>] | None</td>
<td>List of named expressions to add as columns</td>
<td><code>()</code></td>
</tr>
<tr class="even">
<td><code>mutations</code></td>
<td><code>ir</code>.<code>Value</code></td>
<td>Named expressions using keyword arguments</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-21" class="level4">
<h4 class="anchored" data-anchor-id="returns-21">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Table expression with additional columns</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-21" class="level4">
<h4 class="anchored" data-anchor-id="examples-21">Examples</h4>
<div id="f47edfa3" class="cell" data-execution_count="194">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch().select(<span class="st">"species"</span>, <span class="st">"year"</span>, <span class="st">"bill_length_mm"</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="194">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃
┡━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │
├─────────┼───────┼────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.9</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.2</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.1</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.0</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴───────┴────────────────┘
</pre>
</div>
</div>
<p>Add a new column from a per-element expression</p>
<div id="a6581ab4" class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.mutate(next_year<span class="op">=</span>_.year <span class="op">+</span> <span class="dv">1</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="197">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> next_year </span>┃
┡━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │
├─────────┼───────┼────────────────┼───────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
└─────────┴───────┴────────────────┴───────────┘
</pre>
</div>
</div>
<p>Add a new column based on an aggregation. Note the automatic broadcasting.</p>
<div id="c71c3e93" class="cell" data-execution_count="200">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.select(<span class="st">"species"</span>, bill_demean<span class="op">=</span>_.bill_length_mm <span class="op">-</span> _.bill_length_mm.mean()).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="200">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> bill_demean </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │
├─────────┼─────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.82193</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.42193</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-3.62193</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.22193</span> │
└─────────┴─────────────┘
</pre>
</div>
</div>
<p>Mutate across multiple columns</p>
<div id="9c19447f" class="cell" data-execution_count="203">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.mutate(s.across(s.numeric() <span class="op">&amp;</span> <span class="op">~</span>s.cols(<span class="st">"year"</span>), _ <span class="op">-</span> _.mean())).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="203">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃
┡━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │
├─────────┼───────┼────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.82193</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.42193</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-3.62193</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.22193</span> │
└─────────┴───────┴────────────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.nunique" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.nunique">nunique</h3>
<p><code>nunique(where=None)</code></p>
<p>Compute the number of unique rows in the table.</p>
<section id="parameters-20" class="level4">
<h4 class="anchored" data-anchor-id="parameters-20">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 50%">
<col style="width: 37%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>where</code></td>
<td><code>ir</code>.<code>BooleanValue</code> | None</td>
<td>Optional boolean expression to filter rows when counting.</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-22" class="level4">
<h4 class="anchored" data-anchor-id="returns-22">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 48%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>IntegerScalar</code></td>
<td>Number of unique rows in the table</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-22" class="level4">
<h4 class="anchored" data-anchor-id="examples-22">Examples</h4>
<div id="96e7f61c" class="cell" data-execution_count="206">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="st">"foo"</span>, <span class="st">"bar"</span>, <span class="st">"bar"</span>]})</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="206">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┓
┃<span style="font-weight: bold"> a      </span>┃
┡━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├────────┤
│ <span style="color: #008000; text-decoration-color: #008000">foo   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">bar   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">bar   </span> │
└────────┘
</pre>
</div>
</div>
<div id="9758cf66" class="cell" data-execution_count="209">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="209">
<div class="ansi-escaped-output">
<pre>┌───┐
│ <span class="ansi-cyan-fg ansi-bold">2</span> │
└───┘</pre>
</div>
</div>
</div>
<div id="922e24e9" class="cell" data-execution_count="212">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.nunique(t.a <span class="op">!=</span> <span class="st">"foo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="212">
<div class="ansi-escaped-output">
<pre>┌───┐
│ <span class="ansi-cyan-fg ansi-bold">1</span> │
└───┘</pre>
</div>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.order_by" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.order_by">order_by</h3>
<p><code>order_by(*by)</code></p>
<p>Sort a table by one or more expressions.</p>
<p>Similar to <code>pandas.DataFrame.sort_values()</code>.</p>
<section id="parameters-21" class="level4">
<h4 class="anchored" data-anchor-id="parameters-21">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>by</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>Column</code> | <code>s</code>.<code>Selector</code> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<code>ir</code>.<code>Column</code>] | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<code>s</code>.<code>Selector</code>] | None</td>
<td>Expressions to sort the table by.</td>
<td><code>()</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-23" class="level4">
<h4 class="anchored" data-anchor-id="returns-23">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Sorted table</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-23" class="level4">
<h4 class="anchored" data-anchor-id="examples-23">Examples</h4>
<div id="29361e02" class="cell" data-execution_count="215">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable(</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>...     {</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>...         <span class="st">"a"</span>: [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>...         <span class="st">"b"</span>: [<span class="st">"a"</span>, <span class="st">"B"</span>, <span class="st">"c"</span>, <span class="st">"D"</span>],</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>...         <span class="st">"c"</span>: [<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>...     }</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="215">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼────────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">B     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">D     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
└───────┴────────┴───────┘
</pre>
</div>
</div>
<p>Sort by b. Default is ascending. Note how capital letters come before lowercase</p>
<div id="488abf78" class="cell" data-execution_count="218">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.order_by(<span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="218">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼────────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">B     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">D     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
└───────┴────────┴───────┘
</pre>
</div>
</div>
<p>Sort in descending order</p>
<div id="ac4fb7ff" class="cell" data-execution_count="221">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.order_by(ibis.desc(<span class="st">"b"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="221">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼────────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">D     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">B     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │
└───────┴────────┴───────┘
</pre>
</div>
</div>
<p>You can also use the deferred API to get the same result</p>
<div id="b9527f08" class="cell" data-execution_count="224">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.order_by(_.b.desc())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="224">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼────────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">D     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">B     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │
└───────┴────────┴───────┘
</pre>
</div>
</div>
<p>Sort by multiple columns/expressions</p>
<div id="c693850b" class="cell" data-execution_count="227">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.order_by([<span class="st">"a"</span>, _.c.desc()])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="227">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼────────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">B     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">D     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
└───────┴────────┴───────┘
</pre>
</div>
</div>
<p>You can actually pass arbitrary expressions to use as sort keys. For example, to ignore the case of the strings in column <code>b</code></p>
<div id="4e14e079" class="cell" data-execution_count="230">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.order_by(_.b.lower())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="230">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼────────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">B     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">D     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
└───────┴────────┴───────┘
</pre>
</div>
</div>
<p>This means that shuffling a Table is super simple</p>
<div id="5120b6a8" class="cell" data-execution_count="233">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.order_by(ibis.random())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="233">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼────────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">B     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">D     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
└───────┴────────┴───────┘
</pre>
</div>
</div>
<p><a href="../reference/selectors.html">Selectors</a> are allowed as sort keys and are a concise way to sort by multiple columns matching some criteria</p>
<div id="9ed63369" class="cell" data-execution_count="236">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> penguins <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> penguins[[<span class="st">"year"</span>, <span class="st">"island"</span>]].value_counts().order_by(s.startswith(<span class="st">"year"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="236">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> year_island_count </span>┃
┡━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │
├───────┼───────────┼───────────────────┤
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60</span> │
└───────┴───────────┴───────────────────┘
</pre>
</div>
</div>
<p>Use the <a href="../reference/selectors.html#ibis.selectors.across"><code>across</code></a> selector to apply a specific order to multiple columns</p>
<div id="a94e945e" class="cell" data-execution_count="239">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> penguins[[<span class="st">"year"</span>, <span class="st">"island"</span>]].value_counts().order_by(</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>...     s.across(s.startswith(<span class="st">"year"</span>), _.desc())</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="239">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> year_island_count </span>┃
┡━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │
├───────┼───────────┼───────────────────┤
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span> │
└───────┴───────────┴───────────────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.pivot_longer" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.pivot_longer">pivot_longer</h3>
<p><code>pivot_longer(col, *, names_to='name', names_pattern='(.+)', names_transform=None, values_to='value', values_transform=None)</code></p>
<p>Transform a table from wider to longer.</p>
<section id="parameters-22" class="level4">
<h4 class="anchored" data-anchor-id="parameters-22">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>col</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>s</code>.<code>Selector</code></td>
<td>String column name or selector.</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>names_to</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</td>
<td>A string or iterable of strings indicating how to name the new pivoted columns.</td>
<td><code>'name'</code></td>
</tr>
<tr class="odd">
<td><code>names_pattern</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/re.html#module-re">re</a>.<a href="https://docs.python.org/3/library/re.html#re.Pattern">Pattern</a></td>
<td>Pattern to use to extract column names from the input. By default the entire column name is extracted.</td>
<td><code>'(.+)'</code></td>
</tr>
<tr class="even">
<td><code>names_transform</code></td>
<td><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable">Callable</a>[[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <code>ir</code>.<code>Value</code>] | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping">Mapping</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable">Callable</a>[[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <code>ir</code>.<code>Value</code>]] | None</td>
<td>Function or mapping of a name in <code>names_to</code> to a function to transform a column name to a value.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>values_to</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>Name of the pivoted value column.</td>
<td><code>'value'</code></td>
</tr>
<tr class="even">
<td><code>values_transform</code></td>
<td><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable">Callable</a>[[<code>ir</code>.<code>Value</code>], <code>ir</code>.<code>Value</code>] | <a href="../reference/expression-generic.html#ibis.common.deferred.Deferred">Deferred</a> | None</td>
<td>Apply a function to the value column. This can be a lambda or deferred expression.</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-24" class="level4">
<h4 class="anchored" data-anchor-id="returns-24">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Pivoted table</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-24" class="level4">
<h4 class="anchored" data-anchor-id="examples-24">Examples</h4>
<p>Basic usage</p>
<div id="c4945000" class="cell" data-execution_count="242">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> relig_income <span class="op">=</span> ibis.examples.relig_income_raw.fetch()</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> relig_income</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="242">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> religion                </span>┃<span style="font-weight: bold"> &lt;$10k </span>┃<span style="font-weight: bold"> $10-20k </span>┃<span style="font-weight: bold"> $20-30k </span>┃<span style="font-weight: bold"> $30-40k </span>┃<span style="font-weight: bold"> $40-50k </span>┃<span style="font-weight: bold"> $50-75k </span>┃<span style="font-weight: bold"> $75-100k </span>┃<span style="font-weight: bold"> $100-150k </span>┃<span style="font-weight: bold"> &gt;150k </span>┃<span style="font-weight: bold"> Don't know/refused </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>              │
├─────────────────────────┼───────┼─────────┼─────────┼─────────┼─────────┼─────────┼──────────┼───────────┼───────┼────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Agnostic               </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">137</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">122</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">109</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">84</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Atheist                </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">52</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">73</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">74</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Buddhist               </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">58</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Catholic               </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">418</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">617</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">732</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">670</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">638</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1116</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">949</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">792</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">633</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1489</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Don’t know/refused     </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">116</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Evangelical Prot       </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">575</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">869</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1064</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">982</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">881</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1486</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">949</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">723</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">414</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1529</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Hindu                  </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Historically Black Prot</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">228</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">244</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">236</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">238</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">197</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">223</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">131</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">78</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">339</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Jehovah's Witness      </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Jewish                 </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">95</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">69</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">151</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">162</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                       │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────────────────────┴───────┴─────────┴─────────┴─────────┴─────────┴─────────┴──────────┴───────────┴───────┴────────────────────┘
</pre>
</div>
</div>
<p>Here we convert column names not matching the selector for the <code>religion</code> column and convert those names into values</p>
<div id="afc0d096" class="cell" data-execution_count="245">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> relig_income.pivot_longer(<span class="op">~</span>s.cols(<span class="st">"religion"</span>), names_to<span class="op">=</span><span class="st">"income"</span>, values_to<span class="op">=</span><span class="st">"count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="245">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> religion </span>┃<span style="font-weight: bold"> income             </span>┃<span style="font-weight: bold"> count </span>┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├──────────┼────────────────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Agnostic</span> │ <span style="color: #008000; text-decoration-color: #008000">&lt;$10k             </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Agnostic</span> │ <span style="color: #008000; text-decoration-color: #008000">$10-20k           </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Agnostic</span> │ <span style="color: #008000; text-decoration-color: #008000">$20-30k           </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Agnostic</span> │ <span style="color: #008000; text-decoration-color: #008000">$30-40k           </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Agnostic</span> │ <span style="color: #008000; text-decoration-color: #008000">$40-50k           </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Agnostic</span> │ <span style="color: #008000; text-decoration-color: #008000">$50-75k           </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">137</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Agnostic</span> │ <span style="color: #008000; text-decoration-color: #008000">$75-100k          </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">122</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Agnostic</span> │ <span style="color: #008000; text-decoration-color: #008000">$100-150k         </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">109</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Agnostic</span> │ <span style="color: #008000; text-decoration-color: #008000">&gt;150k             </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">84</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Agnostic</span> │ <span style="color: #008000; text-decoration-color: #008000">Don't know/refused</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                  │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└──────────┴────────────────────┴───────┘
</pre>
</div>
</div>
<p>Similarly for a different example dataset, we convert names to values but using a different selector and the default <code>values_to</code> value.</p>
<div id="9b82afda" class="cell" data-execution_count="248">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> world_bank_pop <span class="op">=</span> ibis.examples.world_bank_pop_raw.fetch()</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> world_bank_pop.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="248">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> country </span>┃<span style="font-weight: bold"> indicator   </span>┃<span style="font-weight: bold"> 2000         </span>┃<span style="font-weight: bold"> 2001         </span>┃<span style="font-weight: bold"> 2002         </span>┃<span style="font-weight: bold"> 2003         </span>┃<span style="font-weight: bold"> 2004         </span>┃<span style="font-weight: bold"> 2005         </span>┃<span style="font-weight: bold"> 2006         </span>┃<span style="font-weight: bold"> 2007         </span>┃<span style="font-weight: bold"> 2008         </span>┃<span style="font-weight: bold"> 2009         </span>┃<span style="font-weight: bold"> 2010         </span>┃<span style="font-weight: bold"> 2011         </span>┃<span style="font-weight: bold"> 2012         </span>┃<span style="font-weight: bold"> 2013         </span>┃<span style="font-weight: bold"> 2014         </span>┃<span style="font-weight: bold"> 2015         </span>┃<span style="font-weight: bold"> 2016         </span>┃<span style="font-weight: bold"> 2017         </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │
├─────────┼─────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">ABW    </span> │ <span style="color: #008000; text-decoration-color: #008000">SP.URB.TOTL</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.162500e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.202500e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.219400e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.227700e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.231700e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.239900e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.255500e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.272900e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.290600e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.307900e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.320600e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.349300e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.386400e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.422800e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.458800e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.494300e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.529700e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.564800e+04</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ABW    </span> │ <span style="color: #008000; text-decoration-color: #008000">SP.URB.GROW</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.664222e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.563731e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.013352e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.965172e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.456936e-02</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.935880e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.672580e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.080490e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.133830e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.023963e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.943735e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.620631e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.493932e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.264135e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.106692e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.930256e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.845785e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.718989e-01</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ABW    </span> │ <span style="color: #008000; text-decoration-color: #008000">SP.POP.TOTL</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.910100e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.069100e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.178100e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.270100e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.354000e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.448300e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.560600e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.678700e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.799600e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.921200e+04</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.003410e+05</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.012880e+05</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.021120e+05</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.028800e+05</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.035940e+05</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.042570e+05</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.048740e+05</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.054390e+05</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ABW    </span> │ <span style="color: #008000; text-decoration-color: #008000">SP.POP.GROW</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.539234e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.768757e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.194718e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.973955e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.009892e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.003077e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.181566e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.227711e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.241397e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.233231e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.131541e+00</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.393559e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.102306e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.493010e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.916153e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.379592e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.900625e-01</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.372957e-01</span> │
│ <span style="color: #008000; text-decoration-color: #008000">AFE    </span> │ <span style="color: #008000; text-decoration-color: #008000">SP.URB.TOTL</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.155517e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.197755e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.242275e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.288340e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.336475e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.387456e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.440267e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.492313e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.553838e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.617762e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.684561e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.754157e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.825587e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.901087e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.980733e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.065563e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.150833e+08</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.237321e+08</span> │
└─────────┴─────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┘
</pre>
</div>
</div>
<div id="3c7bbbff" class="cell" data-execution_count="251">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> world_bank_pop.pivot_longer(s.matches(<span class="vs">r"\d</span><span class="sc">{4}</span><span class="vs">"</span>), names_to<span class="op">=</span><span class="st">"year"</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="251">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> country </span>┃<span style="font-weight: bold"> indicator   </span>┃<span style="font-weight: bold"> year   </span>┃<span style="font-weight: bold"> value   </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │
├─────────┼─────────────┼────────┼─────────┤
│ <span style="color: #008000; text-decoration-color: #008000">ABW    </span> │ <span style="color: #008000; text-decoration-color: #008000">SP.URB.TOTL</span> │ <span style="color: #008000; text-decoration-color: #008000">2000  </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41625.0</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ABW    </span> │ <span style="color: #008000; text-decoration-color: #008000">SP.URB.TOTL</span> │ <span style="color: #008000; text-decoration-color: #008000">2001  </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42025.0</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ABW    </span> │ <span style="color: #008000; text-decoration-color: #008000">SP.URB.TOTL</span> │ <span style="color: #008000; text-decoration-color: #008000">2002  </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42194.0</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ABW    </span> │ <span style="color: #008000; text-decoration-color: #008000">SP.URB.TOTL</span> │ <span style="color: #008000; text-decoration-color: #008000">2003  </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42277.0</span> │
│ <span style="color: #008000; text-decoration-color: #008000">ABW    </span> │ <span style="color: #008000; text-decoration-color: #008000">SP.URB.TOTL</span> │ <span style="color: #008000; text-decoration-color: #008000">2004  </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42317.0</span> │
└─────────┴─────────────┴────────┴─────────┘
</pre>
</div>
</div>
<p><code>pivot_longer</code> has some preprocessing capabilities like stripping a prefix and applying a function to column names</p>
<div id="00c2d623" class="cell" data-execution_count="254">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> billboard <span class="op">=</span> ibis.examples.billboard.fetch()</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> billboard</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="254">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> artist         </span>┃<span style="font-weight: bold"> track                   </span>┃<span style="font-weight: bold"> date_entered </span>┃<span style="font-weight: bold"> wk1   </span>┃<span style="font-weight: bold"> wk2   </span>┃<span style="font-weight: bold"> wk3   </span>┃<span style="font-weight: bold"> wk4   </span>┃<span style="font-weight: bold"> wk5   </span>┃<span style="font-weight: bold"> wk6   </span>┃<span style="font-weight: bold"> wk7   </span>┃<span style="font-weight: bold"> wk8   </span>┃<span style="font-weight: bold"> wk9   </span>┃<span style="font-weight: bold"> wk10  </span>┃<span style="font-weight: bold"> wk11  </span>┃<span style="font-weight: bold"> wk12  </span>┃<span style="font-weight: bold"> wk13  </span>┃<span style="font-weight: bold"> wk14  </span>┃<span style="font-weight: bold"> wk15  </span>┃<span style="font-weight: bold"> wk16  </span>┃<span style="font-weight: bold"> wk17  </span>┃<span style="font-weight: bold"> wk18  </span>┃<span style="font-weight: bold"> wk19  </span>┃<span style="font-weight: bold"> wk20  </span>┃<span style="font-weight: bold"> wk21  </span>┃<span style="font-weight: bold"> wk22  </span>┃<span style="font-weight: bold"> wk23  </span>┃<span style="font-weight: bold"> wk24  </span>┃<span style="font-weight: bold"> wk25  </span>┃<span style="font-weight: bold"> wk26  </span>┃<span style="font-weight: bold"> wk27  </span>┃<span style="font-weight: bold"> wk28  </span>┃<span style="font-weight: bold"> wk29  </span>┃<span style="font-weight: bold"> wk30  </span>┃<span style="font-weight: bold"> wk31  </span>┃<span style="font-weight: bold"> wk32  </span>┃<span style="font-weight: bold"> wk33  </span>┃<span style="font-weight: bold"> wk34  </span>┃<span style="font-weight: bold"> wk35  </span>┃<span style="font-weight: bold"> wk36  </span>┃<span style="font-weight: bold"> wk37  </span>┃<span style="font-weight: bold"> wk38  </span>┃<span style="font-weight: bold"> wk39  </span>┃<span style="font-weight: bold"> wk40  </span>┃<span style="font-weight: bold"> wk41  </span>┃<span style="font-weight: bold"> wk42  </span>┃<span style="font-weight: bold"> wk43  </span>┃<span style="font-weight: bold"> wk44  </span>┃<span style="font-weight: bold"> wk45  </span>┃<span style="font-weight: bold"> wk46  </span>┃<span style="font-weight: bold"> wk47  </span>┃<span style="font-weight: bold"> wk48  </span>┃<span style="font-weight: bold"> wk49  </span>┃<span style="font-weight: bold"> wk50  </span>┃<span style="font-weight: bold"> wk51  </span>┃<span style="font-weight: bold"> wk52  </span>┃<span style="font-weight: bold"> wk53  </span>┃<span style="font-weight: bold"> wk54  </span>┃<span style="font-weight: bold"> wk55  </span>┃<span style="font-weight: bold"> wk56  </span>┃<span style="font-weight: bold"> wk57  </span>┃<span style="font-weight: bold"> wk58  </span>┃<span style="font-weight: bold"> wk59  </span>┃<span style="font-weight: bold"> wk60  </span>┃<span style="font-weight: bold"> wk61  </span>┃<span style="font-weight: bold"> wk62  </span>┃<span style="font-weight: bold"> wk63  </span>┃<span style="font-weight: bold"> wk64  </span>┃<span style="font-weight: bold"> wk65  </span>┃<span style="font-weight: bold"> wk66   </span>┃<span style="font-weight: bold"> wk67   </span>┃<span style="font-weight: bold"> wk68   </span>┃<span style="font-weight: bold"> wk69   </span>┃<span style="font-weight: bold"> wk70   </span>┃<span style="font-weight: bold"> wk71   </span>┃<span style="font-weight: bold"> wk72   </span>┃<span style="font-weight: bold"> wk73   </span>┃<span style="font-weight: bold"> wk74   </span>┃<span style="font-weight: bold"> wk75   </span>┃<span style="font-weight: bold"> wk76   </span>┃
┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├────────────────┼─────────────────────────┼──────────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ <span style="color: #008000; text-decoration-color: #008000">2 Pac         </span> │ <span style="color: #008000; text-decoration-color: #008000">Baby Don't Cry (Keep...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-02-26</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">82</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">72</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">77</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">94</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">99</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #008000; text-decoration-color: #008000">2Ge+her       </span> │ <span style="color: #008000; text-decoration-color: #008000">The Hardest Part Of ...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-09-02</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">91</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">92</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #008000; text-decoration-color: #008000">3 Doors Down  </span> │ <span style="color: #008000; text-decoration-color: #008000">Kryptonite             </span> │ <span style="color: #800080; text-decoration-color: #800080">2000-04-08</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">66</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #008000; text-decoration-color: #008000">3 Doors Down  </span> │ <span style="color: #008000; text-decoration-color: #008000">Loser                  </span> │ <span style="color: #800080; text-decoration-color: #800080">2000-10-21</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">72</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">69</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">65</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">55</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">66</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">72</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">75</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">73</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #008000; text-decoration-color: #008000">504 Boyz      </span> │ <span style="color: #008000; text-decoration-color: #008000">Wobble Wobble          </span> │ <span style="color: #800080; text-decoration-color: #800080">2000-04-15</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">75</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">78</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">85</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">92</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #008000; text-decoration-color: #008000">98^0          </span> │ <span style="color: #008000; text-decoration-color: #008000">Give Me Just One Nig...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-08-19</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">66</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">84</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">93</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">94</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #008000; text-decoration-color: #008000">A*Teens       </span> │ <span style="color: #008000; text-decoration-color: #008000">Dancing Queen          </span> │ <span style="color: #800080; text-decoration-color: #800080">2000-07-08</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">97</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">97</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">95</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #008000; text-decoration-color: #008000">Aaliyah       </span> │ <span style="color: #008000; text-decoration-color: #008000">I Don't Wanna          </span> │ <span style="color: #800080; text-decoration-color: #800080">2000-01-29</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">84</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">63</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">83</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">86</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #008000; text-decoration-color: #008000">Aaliyah       </span> │ <span style="color: #008000; text-decoration-color: #008000">Try Again              </span> │ <span style="color: #800080; text-decoration-color: #800080">2000-03-18</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #008000; text-decoration-color: #008000">Adams, Yolanda</span> │ <span style="color: #008000; text-decoration-color: #008000">Open My Heart          </span> │ <span style="color: #800080; text-decoration-color: #800080">2000-08-26</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">74</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">69</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">58</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">66</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">63</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">79</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">89</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │
└────────────────┴─────────────────────────┴──────────────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┘
</pre>
</div>
</div>
<div id="0205563f" class="cell" data-execution_count="257">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> billboard.pivot_longer(</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>...     s.startswith(<span class="st">"wk"</span>),</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>...     names_to<span class="op">=</span><span class="st">"week"</span>,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>...     names_pattern<span class="op">=</span><span class="vs">r"wk(.+)"</span>,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>...     names_transform<span class="op">=</span><span class="bu">int</span>,</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>...     values_to<span class="op">=</span><span class="st">"rank"</span>,</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>...     values_transform<span class="op">=</span>_.cast(<span class="st">"int"</span>),</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>... ).drop_null(<span class="st">"rank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="257">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> artist  </span>┃<span style="font-weight: bold"> track                   </span>┃<span style="font-weight: bold"> date_entered </span>┃<span style="font-weight: bold"> week </span>┃<span style="font-weight: bold"> rank  </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">date</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int8</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├─────────┼─────────────────────────┼──────────────┼──────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">2 Pac  </span> │ <span style="color: #008000; text-decoration-color: #008000">Baby Don't Cry (Keep...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-02-26</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87</span> │
│ <span style="color: #008000; text-decoration-color: #008000">2 Pac  </span> │ <span style="color: #008000; text-decoration-color: #008000">Baby Don't Cry (Keep...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-02-26</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">82</span> │
│ <span style="color: #008000; text-decoration-color: #008000">2 Pac  </span> │ <span style="color: #008000; text-decoration-color: #008000">Baby Don't Cry (Keep...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-02-26</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">72</span> │
│ <span style="color: #008000; text-decoration-color: #008000">2 Pac  </span> │ <span style="color: #008000; text-decoration-color: #008000">Baby Don't Cry (Keep...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-02-26</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">77</span> │
│ <span style="color: #008000; text-decoration-color: #008000">2 Pac  </span> │ <span style="color: #008000; text-decoration-color: #008000">Baby Don't Cry (Keep...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-02-26</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87</span> │
│ <span style="color: #008000; text-decoration-color: #008000">2 Pac  </span> │ <span style="color: #008000; text-decoration-color: #008000">Baby Don't Cry (Keep...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-02-26</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">94</span> │
│ <span style="color: #008000; text-decoration-color: #008000">2 Pac  </span> │ <span style="color: #008000; text-decoration-color: #008000">Baby Don't Cry (Keep...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-02-26</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">99</span> │
│ <span style="color: #008000; text-decoration-color: #008000">2Ge+her</span> │ <span style="color: #008000; text-decoration-color: #008000">The Hardest Part Of ...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-09-02</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">91</span> │
│ <span style="color: #008000; text-decoration-color: #008000">2Ge+her</span> │ <span style="color: #008000; text-decoration-color: #008000">The Hardest Part Of ...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-09-02</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87</span> │
│ <span style="color: #008000; text-decoration-color: #008000">2Ge+her</span> │ <span style="color: #008000; text-decoration-color: #008000">The Hardest Part Of ...</span> │ <span style="color: #800080; text-decoration-color: #800080">2000-09-02</span>   │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">92</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴─────────────────────────┴──────────────┴──────┴───────┘
</pre>
</div>
</div>
<p>You can use regular expression capture groups to extract multiple variables stored in column names</p>
<div id="aa748f6d" class="cell" data-execution_count="260">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> who <span class="op">=</span> ibis.examples.who.fetch()</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> who</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="260">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> country     </span>┃<span style="font-weight: bold"> iso2   </span>┃<span style="font-weight: bold"> iso3   </span>┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> new_sp_m014 </span>┃<span style="font-weight: bold"> new_sp_m1524 </span>┃<span style="font-weight: bold"> new_sp_m2534 </span>┃<span style="font-weight: bold"> new_sp_m3544 </span>┃<span style="font-weight: bold"> new_sp_m4554 </span>┃<span style="font-weight: bold"> new_sp_m5564 </span>┃<span style="font-weight: bold"> new_sp_m65 </span>┃<span style="font-weight: bold"> new_sp_f014 </span>┃<span style="font-weight: bold"> new_sp_f1524 </span>┃<span style="font-weight: bold"> new_sp_f2534 </span>┃<span style="font-weight: bold"> new_sp_f3544 </span>┃<span style="font-weight: bold"> new_sp_f4554 </span>┃<span style="font-weight: bold"> new_sp_f5564 </span>┃<span style="font-weight: bold"> new_sp_f65 </span>┃<span style="font-weight: bold"> new_sn_m014 </span>┃<span style="font-weight: bold"> new_sn_m1524 </span>┃<span style="font-weight: bold"> new_sn_m2534 </span>┃<span style="font-weight: bold"> new_sn_m3544 </span>┃<span style="font-weight: bold"> new_sn_m4554 </span>┃<span style="font-weight: bold"> new_sn_m5564 </span>┃<span style="font-weight: bold"> new_sn_m65 </span>┃<span style="font-weight: bold"> new_sn_f014 </span>┃<span style="font-weight: bold"> new_sn_f1524 </span>┃<span style="font-weight: bold"> new_sn_f2534 </span>┃<span style="font-weight: bold"> new_sn_f3544 </span>┃<span style="font-weight: bold"> new_sn_f4554 </span>┃<span style="font-weight: bold"> new_sn_f5564 </span>┃<span style="font-weight: bold"> new_sn_f65 </span>┃<span style="font-weight: bold"> new_ep_m014 </span>┃<span style="font-weight: bold"> new_ep_m1524 </span>┃<span style="font-weight: bold"> new_ep_m2534 </span>┃<span style="font-weight: bold"> new_ep_m3544 </span>┃<span style="font-weight: bold"> new_ep_m4554 </span>┃<span style="font-weight: bold"> new_ep_m5564 </span>┃<span style="font-weight: bold"> new_ep_m65 </span>┃<span style="font-weight: bold"> new_ep_f014 </span>┃<span style="font-weight: bold"> new_ep_f1524 </span>┃<span style="font-weight: bold"> new_ep_f2534 </span>┃<span style="font-weight: bold"> new_ep_f3544 </span>┃<span style="font-weight: bold"> new_ep_f4554 </span>┃<span style="font-weight: bold"> new_ep_f5564 </span>┃<span style="font-weight: bold"> new_ep_f65 </span>┃<span style="font-weight: bold"> newrel_m014 </span>┃<span style="font-weight: bold"> newrel_m1524 </span>┃<span style="font-weight: bold"> newrel_m2534 </span>┃<span style="font-weight: bold"> newrel_m3544 </span>┃<span style="font-weight: bold"> newrel_m4554 </span>┃<span style="font-weight: bold"> newrel_m5564 </span>┃<span style="font-weight: bold"> newrel_m65 </span>┃<span style="font-weight: bold"> newrel_f014 </span>┃<span style="font-weight: bold"> newrel_f1524 </span>┃<span style="font-weight: bold"> newrel_f2534 </span>┃<span style="font-weight: bold"> newrel_f3544 </span>┃<span style="font-weight: bold"> newrel_f4554 </span>┃<span style="font-weight: bold"> newrel_f5564 </span>┃<span style="font-weight: bold"> newrel_f65 </span>┃
┡━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │
├─────────────┼────────┼────────┼───────┼─────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────┼─────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────┼─────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────┼─────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────┼─────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────┼─────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────┼─────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────┼─────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1981</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1982</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1983</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1984</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1985</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1986</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1987</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1988</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1989</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────────┴────────┴────────┴───────┴─────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴────────────┴─────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴────────────┴─────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴────────────┴─────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴────────────┴─────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴────────────┴─────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴────────────┴─────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴────────────┴─────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴────────────┘
</pre>
</div>
</div>
<div id="35ec6fbf" class="cell" data-execution_count="263">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">len</span>(who.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="263">
<pre><code>60</code></pre>
</div>
</div>
<div id="6781ab0c" class="cell" data-execution_count="266">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> who.pivot_longer(</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>...     s.index[<span class="st">"new_sp_m014"</span>:<span class="st">"newrel_f65"</span>],</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>...     names_to<span class="op">=</span>[<span class="st">"diagnosis"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span>],</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>...     names_pattern<span class="op">=</span><span class="st">"new_?(.*)_(.)(.*)"</span>,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>...     values_to<span class="op">=</span><span class="st">"count"</span>,</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="266">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> country     </span>┃<span style="font-weight: bold"> iso2   </span>┃<span style="font-weight: bold"> iso3   </span>┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> diagnosis </span>┃<span style="font-weight: bold"> gender </span>┃<span style="font-weight: bold"> age    </span>┃<span style="font-weight: bold"> count </span>┃
┡━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├─────────────┼────────┼────────┼───────┼───────────┼────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │ <span style="color: #008000; text-decoration-color: #008000">m     </span> │ <span style="color: #008000; text-decoration-color: #008000">014   </span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │ <span style="color: #008000; text-decoration-color: #008000">m     </span> │ <span style="color: #008000; text-decoration-color: #008000">1524  </span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │ <span style="color: #008000; text-decoration-color: #008000">m     </span> │ <span style="color: #008000; text-decoration-color: #008000">2534  </span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │ <span style="color: #008000; text-decoration-color: #008000">m     </span> │ <span style="color: #008000; text-decoration-color: #008000">3544  </span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │ <span style="color: #008000; text-decoration-color: #008000">m     </span> │ <span style="color: #008000; text-decoration-color: #008000">4554  </span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │ <span style="color: #008000; text-decoration-color: #008000">m     </span> │ <span style="color: #008000; text-decoration-color: #008000">5564  </span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │ <span style="color: #008000; text-decoration-color: #008000">m     </span> │ <span style="color: #008000; text-decoration-color: #008000">65    </span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │ <span style="color: #008000; text-decoration-color: #008000">f     </span> │ <span style="color: #008000; text-decoration-color: #008000">014   </span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │ <span style="color: #008000; text-decoration-color: #008000">f     </span> │ <span style="color: #008000; text-decoration-color: #008000">1524  </span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │ <span style="color: #008000; text-decoration-color: #008000">f     </span> │ <span style="color: #008000; text-decoration-color: #008000">2534  </span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────────┴────────┴────────┴───────┴───────────┴────────┴────────┴───────┘
</pre>
</div>
</div>
<p><code>names_transform</code> is flexible, and can be:</p>
<pre><code>1. A mapping of one or more names in `names_to` to callable
2. A callable that will be applied to every name</code></pre>
<p>Let’s recode gender and age to numeric values using a mapping</p>
<div id="6e84be36" class="cell" data-execution_count="269">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> who.pivot_longer(</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>...     s.index[<span class="st">"new_sp_m014"</span>:<span class="st">"newrel_f65"</span>],</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>...     names_to<span class="op">=</span>[<span class="st">"diagnosis"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span>],</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>...     names_pattern<span class="op">=</span><span class="st">"new_?(.*)_(.)(.*)"</span>,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>...     names_transform<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>...         gender<span class="op">=</span>{<span class="st">"m"</span>: <span class="dv">1</span>, <span class="st">"f"</span>: <span class="dv">2</span>}.get,</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>...         age<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>...             <span class="bu">zip</span>(</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>...                 [<span class="st">"014"</span>, <span class="st">"1524"</span>, <span class="st">"2534"</span>, <span class="st">"3544"</span>, <span class="st">"4554"</span>, <span class="st">"5564"</span>, <span class="st">"65"</span>],</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>...                 <span class="bu">range</span>(<span class="dv">7</span>),</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>...             )</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>...         ).get,</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>...     ),</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>...     values_to<span class="op">=</span><span class="st">"count"</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="269">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━┳━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> country     </span>┃<span style="font-weight: bold"> iso2   </span>┃<span style="font-weight: bold"> iso3   </span>┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> diagnosis </span>┃<span style="font-weight: bold"> gender </span>┃<span style="font-weight: bold"> age  </span>┃<span style="font-weight: bold"> count </span>┃
┡━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━╇━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int8</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int8</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├─────────────┼────────┼────────┼───────┼───────────┼────────┼──────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Afghanistan</span> │ <span style="color: #008000; text-decoration-color: #008000">AF    </span> │ <span style="color: #008000; text-decoration-color: #008000">AFG   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1980</span> │ <span style="color: #008000; text-decoration-color: #008000">sp       </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────────┴────────┴────────┴───────┴───────────┴────────┴──────┴───────┘
</pre>
</div>
</div>
<p>The number of match groups in <code>names_pattern</code> must match the length of <code>names_to</code></p>
<div id="90f9f6a6" class="cell" data-execution_count="272">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> who.pivot_longer(  </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>...     s.index[<span class="st">"new_sp_m014"</span>:<span class="st">"newrel_f65"</span>],</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>...     names_to<span class="op">=</span>[<span class="st">"diagnosis"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span>],</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>...     names_pattern<span class="op">=</span><span class="st">"new_?(.*)_.(.*)"</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">IbisInputError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[272], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">who</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">pivot_longer</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">  </span>
<span class="ansi-green-fg ansi-bold">      2</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">s</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">index</span><span class="ansi-yellow-bg">[</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">new_sp_m014</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">:</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">newrel_f65</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">      3</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">names_to</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">[</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">diagnosis</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">gender</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">age</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">      4</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">names_pattern</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">new_?(.*)_.(.*)</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">      5</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/github.com/ibis-project/ibis/ibis/expr/types/relations.py:3817</span>, in <span class="ansi-cyan-fg">Table.pivot_longer</span><span class="ansi-blue-fg">(self, col, names_to, names_pattern, names_transform, values_to, values_transform)</span>
<span class="ansi-green-fg ansi-bold">   3815</span> names_pattern <span style="color:rgb(98,98,98)">=</span> re<span style="color:rgb(98,98,98)">.</span>compile(names_pattern)
<span class="ansi-green-fg ansi-bold">   3816</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> (ngroups <span style="color:rgb(98,98,98)">:=</span> names_pattern<span style="color:rgb(98,98,98)">.</span>groups) <span style="color:rgb(98,98,98)">!=</span> (nnames <span style="color:rgb(98,98,98)">:=</span> <span style="color:rgb(0,135,0)">len</span>(names_to)):
<span class="ansi-green-fg">-&gt; 3817</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> com<span style="color:rgb(98,98,98)">.</span>IbisInputError(
<span class="ansi-green-fg ansi-bold">   3818</span>         <span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Number of match groups in `names_pattern`</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">   3819</span>         <span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>names_pattern<span style="color:rgb(98,98,98)">.</span>pattern<span style="font-weight:bold;color:rgb(175,95,135)">!r}</span><span style="color:rgb(175,0,0)"> (</span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>ngroups<span style="font-weight:bold;color:rgb(175,95,135)">:</span><span style="color:rgb(175,0,0)">d</span><span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)"> groups) doesn</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">t </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">   3820</span>         <span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">match the length of `names_to` </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>names_to<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)"> (length </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>nnames<span style="font-weight:bold;color:rgb(175,95,135)">:</span><span style="color:rgb(175,0,0)">d</span><span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">)</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">   3821</span>     )
<span class="ansi-green-fg ansi-bold">   3823</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> names_transform <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:
<span class="ansi-green-fg ansi-bold">   3824</span>     names_transform <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">dict</span><span style="color:rgb(98,98,98)">.</span>fromkeys(names_to, toolz<span style="color:rgb(98,98,98)">.</span>identity)

<span class="ansi-red-fg">IbisInputError</span>: Number of match groups in `names_pattern`'new_?(.*)_.(.*)' (2 groups) doesn't match the length of `names_to` ['diagnosis', 'gender', 'age'] (length 3)</pre>
</div>
</div>
</div>
<p><code>names_transform</code> must be a mapping or callable</p>
<div id="d98d4ec4" class="cell" data-execution_count="275">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> who.pivot_longer(</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>...     s.index[<span class="st">"new_sp_m014"</span>:<span class="st">"newrel_f65"</span>], names_transform<span class="op">=</span><span class="st">"upper"</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>... )  <span class="co"># quartodoc: +EXPECTED_FAILURE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">IbisTypeError</span>                             Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[275], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">who</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">pivot_longer</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">      2</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">s</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">index</span><span class="ansi-yellow-bg">[</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">new_sp_m014</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">:</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">newrel_f65</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">names_transform</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">upper</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span>
<span class="ansi-green-fg ansi-bold">      3</span> <span class="ansi-yellow-bg">)</span>  <span style="font-style:italic;color:rgb(95,135,135)"># quartodoc: +EXPECTED_FAILURE</span>

File <span class="ansi-green-fg">~/github.com/ibis-project/ibis/ibis/expr/types/relations.py:3829</span>, in <span class="ansi-cyan-fg">Table.pivot_longer</span><span class="ansi-blue-fg">(self, col, names_to, names_pattern, names_transform, values_to, values_transform)</span>
<span class="ansi-green-fg ansi-bold">   3827</span>         names_transform <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">dict</span><span style="color:rgb(98,98,98)">.</span>fromkeys(names_to, names_transform)
<span class="ansi-green-fg ansi-bold">   3828</span>     <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 3829</span>         <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> com<span style="color:rgb(98,98,98)">.</span>IbisTypeError(
<span class="ansi-green-fg ansi-bold">   3830</span>             <span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">`names_transform` must be a mapping or callable. Got </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span><span style="color:rgb(0,135,0)">type</span>(names_transform)<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">   3831</span>         )
<span class="ansi-green-fg ansi-bold">   3833</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> name <span style="font-weight:bold;color:rgb(175,0,255)">in</span> names_to:
<span class="ansi-green-fg ansi-bold">   3834</span>     names_transform<span style="color:rgb(98,98,98)">.</span>setdefault(name, toolz<span style="color:rgb(98,98,98)">.</span>identity)

<span class="ansi-red-fg">IbisTypeError</span>: `names_transform` must be a mapping or callable. Got &lt;class 'str'&gt;</pre>
</div>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.pivot_wider" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.pivot_wider">pivot_wider</h3>
<p><code>pivot_wider(id_cols=None, names_from='name', names_prefix='', names_sep='_', names_sort=False, names=None, values_from='value', values_fill=None, values_agg='arbitrary')</code></p>
<p>Pivot a table to a wider format.</p>
<section id="parameters-23" class="level4">
<h4 class="anchored" data-anchor-id="parameters-23">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>id_cols</code></td>
<td><code>s</code>.<code>Selector</code> | None</td>
<td>A set of columns that uniquely identify each observation.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>names_from</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <code>s</code>.<code>Selector</code></td>
<td>An argument describing which column or columns to use to get the name of the output columns.</td>
<td><code>'name'</code></td>
</tr>
<tr class="odd">
<td><code>names_prefix</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>String added to the start of every column name.</td>
<td><code>''</code></td>
</tr>
<tr class="even">
<td><code>names_sep</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>If <code>names_from</code> or <code>values_from</code> contains multiple columns, this argument will be used to join their values together into a single string to use as a column name.</td>
<td><code>'_'</code></td>
</tr>
<tr class="odd">
<td><code>names_sort</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#bool">bool</a></td>
<td>If <a href="https://docs.python.org/3/library/constants.html#True"><code>True</code></a> columns are sorted. If <a href="https://docs.python.org/3/library/constants.html#False"><code>False</code></a> column names are ordered by appearance.</td>
<td><code>False</code></td>
</tr>
<tr class="even">
<td><code>names</code></td>
<td><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</td>
<td>An explicit sequence of values to look for in columns matching <code>names_from</code>. * When this value is <code>None</code>, the values will be computed from <code>names_from</code>. * When this value is not <code>None</code>, each element’s length must match the length of <code>names_from</code>. See examples below for more detail.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>values_from</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <code>s</code>.<code>Selector</code></td>
<td>An argument describing which column or columns to get the cell values from.</td>
<td><code>'value'</code></td>
</tr>
<tr class="even">
<td><code>values_fill</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a> | <a href="https://docs.python.org/3/library/functions.html#float">float</a> | <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>Scalar</code> | None</td>
<td>A scalar value that specifies what each value should be filled with when missing.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>values_agg</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable">Callable</a>[[<code>ir</code>.<code>Value</code>], <code>ir</code>.<code>Scalar</code>] | <a href="../reference/expression-generic.html#ibis.common.deferred.Deferred">Deferred</a></td>
<td>A function applied to the value in each cell in the output.</td>
<td><code>'arbitrary'</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-25" class="level4">
<h4 class="anchored" data-anchor-id="returns-25">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Wider pivoted table</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-25" class="level4">
<h4 class="anchored" data-anchor-id="examples-25">Examples</h4>
<div id="3f1867d1" class="cell" data-execution_count="278">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Basic usage</p>
<div id="65208331" class="cell" data-execution_count="281">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fish_encounters <span class="op">=</span> ibis.examples.fish_encounters.fetch()</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fish_encounters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="281">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> fish  </span>┃<span style="font-weight: bold"> station </span>┃<span style="font-weight: bold"> seen  </span>┃
┡━━━━━━━╇━━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼─────────┼───────┤
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4842</span> │ <span style="color: #008000; text-decoration-color: #008000">Release</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4842</span> │ <span style="color: #008000; text-decoration-color: #008000">I80_1  </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4842</span> │ <span style="color: #008000; text-decoration-color: #008000">Lisbon </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4842</span> │ <span style="color: #008000; text-decoration-color: #008000">Rstr   </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4842</span> │ <span style="color: #008000; text-decoration-color: #008000">Base_TD</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4842</span> │ <span style="color: #008000; text-decoration-color: #008000">BCE    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4842</span> │ <span style="color: #008000; text-decoration-color: #008000">BCW    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4842</span> │ <span style="color: #008000; text-decoration-color: #008000">BCE2   </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4842</span> │ <span style="color: #008000; text-decoration-color: #008000">BCW2   </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4842</span> │ <span style="color: #008000; text-decoration-color: #008000">MAE    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└───────┴─────────┴───────┘
</pre>
</div>
</div>
<div id="e52e4abe" class="cell" data-execution_count="284">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fish_encounters.pivot_wider(names_from<span class="op">=</span><span class="st">"station"</span>, values_from<span class="op">=</span><span class="st">"seen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="284">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> fish  </span>┃<span style="font-weight: bold"> Lisbon </span>┃<span style="font-weight: bold"> Base_TD </span>┃<span style="font-weight: bold"> Rstr  </span>┃<span style="font-weight: bold"> BCW   </span>┃<span style="font-weight: bold"> BCW2  </span>┃<span style="font-weight: bold"> I80_1 </span>┃<span style="font-weight: bold"> MAW   </span>┃<span style="font-weight: bold"> Release </span>┃<span style="font-weight: bold"> BCE   </span>┃<span style="font-weight: bold"> BCE2  </span>┃<span style="font-weight: bold"> MAE   </span>┃
┡━━━━━━━╇━━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼────────┼─────────┼───────┼───────┼───────┼───────┼───────┼─────────┼───────┼───────┼───────┤
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4843</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4858</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4848</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4865</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4851</span> │   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4857</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4862</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4863</span> │   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4842</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4854</span> │   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└───────┴────────┴─────────┴───────┴───────┴───────┴───────┴───────┴─────────┴───────┴───────┴───────┘
</pre>
</div>
</div>
<p>You can do simple transpose-like operations using <code>pivot_wider</code></p>
<div id="e0dcae3c" class="cell" data-execution_count="287">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable(<span class="bu">dict</span>(outcome<span class="op">=</span>[<span class="st">"yes"</span>, <span class="st">"no"</span>], counted<span class="op">=</span>[<span class="dv">3</span>, <span class="dv">4</span>]))</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="287">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> outcome </span>┃<span style="font-weight: bold"> counted </span>┃
┡━━━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │
├─────────┼─────────┤
│ <span style="color: #008000; text-decoration-color: #008000">yes    </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">no     </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
└─────────┴─────────┘
</pre>
</div>
</div>
<div id="204ed043" class="cell" data-execution_count="290">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.pivot_wider(names_from<span class="op">=</span><span class="st">"outcome"</span>, values_from<span class="op">=</span><span class="st">"counted"</span>, names_sort<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="290">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> no    </span>┃<span style="font-weight: bold"> yes   </span>┃
┡━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
└───────┴───────┘
</pre>
</div>
</div>
<p>Fill missing pivoted values using <code>values_fill</code></p>
<div id="2591d195" class="cell" data-execution_count="293">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fish_encounters.pivot_wider(</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>...     names_from<span class="op">=</span><span class="st">"station"</span>, values_from<span class="op">=</span><span class="st">"seen"</span>, values_fill<span class="op">=</span><span class="dv">0</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="293">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> fish  </span>┃<span style="font-weight: bold"> Lisbon </span>┃<span style="font-weight: bold"> Base_TD </span>┃<span style="font-weight: bold"> Rstr  </span>┃<span style="font-weight: bold"> BCW   </span>┃<span style="font-weight: bold"> BCW2  </span>┃<span style="font-weight: bold"> MAE   </span>┃<span style="font-weight: bold"> MAW   </span>┃<span style="font-weight: bold"> Release </span>┃<span style="font-weight: bold"> BCE   </span>┃<span style="font-weight: bold"> BCE2  </span>┃<span style="font-weight: bold"> I80_1 </span>┃
┡━━━━━━━╇━━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼────────┼─────────┼───────┼───────┼───────┼───────┼───────┼─────────┼───────┼───────┼───────┤
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4848</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4865</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4851</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4857</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4862</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4863</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4847</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4850</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4864</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4843</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└───────┴────────┴─────────┴───────┴───────┴───────┴───────┴───────┴─────────┴───────┴───────┴───────┘
</pre>
</div>
</div>
<p>Compute multiple values columns</p>
<div id="3bccbb1f" class="cell" data-execution_count="296">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> us_rent_income <span class="op">=</span> ibis.examples.us_rent_income.fetch()</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> us_rent_income</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="296">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> geoid  </span>┃<span style="font-weight: bold"> name       </span>┃<span style="font-weight: bold"> variable </span>┃<span style="font-weight: bold"> estimate </span>┃<span style="font-weight: bold"> moe   </span>┃
┡━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├────────┼────────────┼──────────┼──────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">01    </span> │ <span style="color: #008000; text-decoration-color: #008000">Alabama   </span> │ <span style="color: #008000; text-decoration-color: #008000">income  </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24476</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">136</span> │
│ <span style="color: #008000; text-decoration-color: #008000">01    </span> │ <span style="color: #008000; text-decoration-color: #008000">Alabama   </span> │ <span style="color: #008000; text-decoration-color: #008000">rent    </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">747</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">02    </span> │ <span style="color: #008000; text-decoration-color: #008000">Alaska    </span> │ <span style="color: #008000; text-decoration-color: #008000">income  </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32940</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">508</span> │
│ <span style="color: #008000; text-decoration-color: #008000">02    </span> │ <span style="color: #008000; text-decoration-color: #008000">Alaska    </span> │ <span style="color: #008000; text-decoration-color: #008000">rent    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1200</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span> │
│ <span style="color: #008000; text-decoration-color: #008000">04    </span> │ <span style="color: #008000; text-decoration-color: #008000">Arizona   </span> │ <span style="color: #008000; text-decoration-color: #008000">income  </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27517</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">148</span> │
│ <span style="color: #008000; text-decoration-color: #008000">04    </span> │ <span style="color: #008000; text-decoration-color: #008000">Arizona   </span> │ <span style="color: #008000; text-decoration-color: #008000">rent    </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">972</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│ <span style="color: #008000; text-decoration-color: #008000">05    </span> │ <span style="color: #008000; text-decoration-color: #008000">Arkansas  </span> │ <span style="color: #008000; text-decoration-color: #008000">income  </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23789</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">165</span> │
│ <span style="color: #008000; text-decoration-color: #008000">05    </span> │ <span style="color: #008000; text-decoration-color: #008000">Arkansas  </span> │ <span style="color: #008000; text-decoration-color: #008000">rent    </span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">709</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">06    </span> │ <span style="color: #008000; text-decoration-color: #008000">California</span> │ <span style="color: #008000; text-decoration-color: #008000">income  </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29454</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">109</span> │
│ <span style="color: #008000; text-decoration-color: #008000">06    </span> │ <span style="color: #008000; text-decoration-color: #008000">California</span> │ <span style="color: #008000; text-decoration-color: #008000">rent    </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1358</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>        │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└────────┴────────────┴──────────┴──────────┴───────┘
</pre>
</div>
</div>
<div id="f885db6b" class="cell" data-execution_count="299">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> us_rent_income.pivot_wider(</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>...     names_from<span class="op">=</span><span class="st">"variable"</span>, values_from<span class="op">=</span>[<span class="st">"estimate"</span>, <span class="st">"moe"</span>]</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="299">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━┓
┃<span style="font-weight: bold"> geoid  </span>┃<span style="font-weight: bold"> name                 </span>┃<span style="font-weight: bold"> estimate_income </span>┃<span style="font-weight: bold"> moe_income </span>┃<span style="font-weight: bold"> estimate_rent </span>┃<span style="font-weight: bold"> moe_rent </span>┃
┡━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │
├────────┼──────────────────────┼─────────────────┼────────────┼───────────────┼──────────┤
│ <span style="color: #008000; text-decoration-color: #008000">05    </span> │ <span style="color: #008000; text-decoration-color: #008000">Arkansas            </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23789</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">165</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">709</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">16    </span> │ <span style="color: #008000; text-decoration-color: #008000">Idaho               </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25298</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">208</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">792</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
│ <span style="color: #008000; text-decoration-color: #008000">30    </span> │ <span style="color: #008000; text-decoration-color: #008000">Montana             </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26249</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">206</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">751</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span> │
│ <span style="color: #008000; text-decoration-color: #008000">39    </span> │ <span style="color: #008000; text-decoration-color: #008000">Ohio                </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27435</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">94</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">764</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│ <span style="color: #008000; text-decoration-color: #008000">47    </span> │ <span style="color: #008000; text-decoration-color: #008000">Tennessee           </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25453</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">102</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">808</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│ <span style="color: #008000; text-decoration-color: #008000">08    </span> │ <span style="color: #008000; text-decoration-color: #008000">Colorado            </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32401</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">109</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1125</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">09    </span> │ <span style="color: #008000; text-decoration-color: #008000">Connecticut         </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35326</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1123</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">11    </span> │ <span style="color: #008000; text-decoration-color: #008000">District of Columbia</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43198</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">681</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1424</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span> │
│ <span style="color: #008000; text-decoration-color: #008000">18    </span> │ <span style="color: #008000; text-decoration-color: #008000">Indiana             </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27247</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">117</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">782</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">23    </span> │ <span style="color: #008000; text-decoration-color: #008000">Maine               </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26841</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">187</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">808</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                    │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└────────┴──────────────────────┴─────────────────┴────────────┴───────────────┴──────────┘
</pre>
</div>
</div>
<p>The column name separator can be changed using the <code>names_sep</code> parameter</p>
<div id="e7b33bda" class="cell" data-execution_count="302">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> us_rent_income.pivot_wider(</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>...     names_from<span class="op">=</span><span class="st">"variable"</span>,</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>...     names_sep<span class="op">=</span><span class="st">"."</span>,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>...     values_from<span class="op">=</span>(<span class="st">"estimate"</span>, <span class="st">"moe"</span>),</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="302">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━┓
┃<span style="font-weight: bold"> geoid  </span>┃<span style="font-weight: bold"> name                 </span>┃<span style="font-weight: bold"> estimate.income </span>┃<span style="font-weight: bold"> moe.income </span>┃<span style="font-weight: bold"> estimate.rent </span>┃<span style="font-weight: bold"> moe.rent </span>┃
┡━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │
├────────┼──────────────────────┼─────────────────┼────────────┼───────────────┼──────────┤
│ <span style="color: #008000; text-decoration-color: #008000">05    </span> │ <span style="color: #008000; text-decoration-color: #008000">Arkansas            </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23789</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">165</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">709</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">16    </span> │ <span style="color: #008000; text-decoration-color: #008000">Idaho               </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25298</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">208</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">792</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
│ <span style="color: #008000; text-decoration-color: #008000">30    </span> │ <span style="color: #008000; text-decoration-color: #008000">Montana             </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26249</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">206</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">751</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span> │
│ <span style="color: #008000; text-decoration-color: #008000">39    </span> │ <span style="color: #008000; text-decoration-color: #008000">Ohio                </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27435</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">94</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">764</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│ <span style="color: #008000; text-decoration-color: #008000">47    </span> │ <span style="color: #008000; text-decoration-color: #008000">Tennessee           </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25453</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">102</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">808</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│ <span style="color: #008000; text-decoration-color: #008000">08    </span> │ <span style="color: #008000; text-decoration-color: #008000">Colorado            </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32401</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">109</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1125</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">09    </span> │ <span style="color: #008000; text-decoration-color: #008000">Connecticut         </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35326</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1123</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">11    </span> │ <span style="color: #008000; text-decoration-color: #008000">District of Columbia</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43198</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">681</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1424</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span> │
│ <span style="color: #008000; text-decoration-color: #008000">18    </span> │ <span style="color: #008000; text-decoration-color: #008000">Indiana             </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27247</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">117</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">782</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">23    </span> │ <span style="color: #008000; text-decoration-color: #008000">Maine               </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26841</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">187</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">808</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                    │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└────────┴──────────────────────┴─────────────────┴────────────┴───────────────┴──────────┘
</pre>
</div>
</div>
<p>Supply an alternative function to summarize values</p>
<div id="ffe4640b" class="cell" data-execution_count="305">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> warpbreaks <span class="op">=</span> ibis.examples.warpbreaks.fetch().select(<span class="st">"wool"</span>, <span class="st">"tension"</span>, <span class="st">"breaks"</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> warpbreaks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="305">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> wool   </span>┃<span style="font-weight: bold"> tension </span>┃<span style="font-weight: bold"> breaks </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │
├────────┼─────────┼────────┤
│ <span style="color: #008000; text-decoration-color: #008000">A     </span> │ <span style="color: #008000; text-decoration-color: #008000">L      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A     </span> │ <span style="color: #008000; text-decoration-color: #008000">L      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A     </span> │ <span style="color: #008000; text-decoration-color: #008000">L      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A     </span> │ <span style="color: #008000; text-decoration-color: #008000">L      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A     </span> │ <span style="color: #008000; text-decoration-color: #008000">L      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A     </span> │ <span style="color: #008000; text-decoration-color: #008000">L      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">52</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A     </span> │ <span style="color: #008000; text-decoration-color: #008000">L      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A     </span> │ <span style="color: #008000; text-decoration-color: #008000">L      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A     </span> │ <span style="color: #008000; text-decoration-color: #008000">L      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A     </span> │ <span style="color: #008000; text-decoration-color: #008000">M      </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└────────┴─────────┴────────┘
</pre>
</div>
</div>
<div id="948d3d28" class="cell" data-execution_count="308">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> warpbreaks.pivot_wider(</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>...     names_from<span class="op">=</span><span class="st">"wool"</span>, values_from<span class="op">=</span><span class="st">"breaks"</span>, values_agg<span class="op">=</span><span class="st">"mean"</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>... ).select(<span class="st">"tension"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>).order_by(<span class="st">"tension"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="308">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┓
┃<span style="font-weight: bold"> tension </span>┃<span style="font-weight: bold"> A         </span>┃<span style="font-weight: bold"> B         </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>   │
├─────────┼───────────┼───────────┤
│ <span style="color: #008000; text-decoration-color: #008000">H      </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.555556</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.777778</span> │
│ <span style="color: #008000; text-decoration-color: #008000">L      </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.555556</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.222222</span> │
│ <span style="color: #008000; text-decoration-color: #008000">M      </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.000000</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.777778</span> │
└─────────┴───────────┴───────────┘
</pre>
</div>
</div>
<p>Passing <code>Deferred</code> objects to <code>values_agg</code> is supported</p>
<div id="36467778" class="cell" data-execution_count="311">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> warpbreaks.pivot_wider(</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>...     names_from<span class="op">=</span><span class="st">"tension"</span>,</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>...     values_from<span class="op">=</span><span class="st">"breaks"</span>,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>...     values_agg<span class="op">=</span>_.<span class="bu">sum</span>(),</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>... ).select(<span class="st">"wool"</span>, <span class="st">"H"</span>, <span class="st">"L"</span>, <span class="st">"M"</span>).order_by(s.<span class="bu">all</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="311">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> wool   </span>┃<span style="font-weight: bold"> H     </span>┃<span style="font-weight: bold"> L     </span>┃<span style="font-weight: bold"> M     </span>┃
┡━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├────────┼───────┼───────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">A     </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">221</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">401</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">216</span> │
│ <span style="color: #008000; text-decoration-color: #008000">B     </span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">169</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">254</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">259</span> │
└────────┴───────┴───────┴───────┘
</pre>
</div>
</div>
<p>Use a custom aggregate function</p>
<div id="7b1a95b6" class="cell" data-execution_count="314">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> warpbreaks.pivot_wider(</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>...     names_from<span class="op">=</span><span class="st">"wool"</span>,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>...     values_from<span class="op">=</span><span class="st">"breaks"</span>,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>...     values_agg<span class="op">=</span><span class="kw">lambda</span> col: col.std() <span class="op">/</span> col.mean(),</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>... ).select(<span class="st">"tension"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>).order_by(<span class="st">"tension"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="314">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┓
┃<span style="font-weight: bold"> tension </span>┃<span style="font-weight: bold"> A        </span>┃<span style="font-weight: bold"> B        </span>┃
┡━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │
├─────────┼──────────┼──────────┤
│ <span style="color: #008000; text-decoration-color: #008000">H      </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.418344</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.260590</span> │
│ <span style="color: #008000; text-decoration-color: #008000">L      </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.406183</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.349325</span> │
│ <span style="color: #008000; text-decoration-color: #008000">M      </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.360844</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.327719</span> │
└─────────┴──────────┴──────────┘
</pre>
</div>
</div>
<p>Generate some random data, setting the random seed for reproducibility</p>
<div id="f04ec6ea" class="cell" data-execution_count="317">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> random</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> random.seed(<span class="dv">0</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> raw <span class="op">=</span> ibis.memtable(</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>...     [</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>...         <span class="bu">dict</span>(</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>...             product<span class="op">=</span>product,</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>...             country<span class="op">=</span>country,</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>...             year<span class="op">=</span>year,</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>...             production<span class="op">=</span>random.random(),</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>...         )</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>...         <span class="cf">for</span> product <span class="kw">in</span> <span class="st">"AB"</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>...         <span class="cf">for</span> country <span class="kw">in</span> [<span class="st">"AI"</span>, <span class="st">"EI"</span>]</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>...         <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2000</span>, <span class="dv">2015</span>)</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>...     ]</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> production <span class="op">=</span> raw.<span class="bu">filter</span>(((_.product <span class="op">==</span> <span class="st">"A"</span>) <span class="op">&amp;</span> (_.country <span class="op">==</span> <span class="st">"AI"</span>)) <span class="op">|</span> (_.product <span class="op">==</span> <span class="st">"B"</span>))</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> production.order_by(s.<span class="bu">all</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="317">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> product </span>┃<span style="font-weight: bold"> country </span>┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> production </span>┃
┡━━━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │
├─────────┼─────────┼───────┼────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">A      </span> │ <span style="color: #008000; text-decoration-color: #008000">AI     </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2000</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.844422</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A      </span> │ <span style="color: #008000; text-decoration-color: #008000">AI     </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2001</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.757954</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A      </span> │ <span style="color: #008000; text-decoration-color: #008000">AI     </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2002</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.420572</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A      </span> │ <span style="color: #008000; text-decoration-color: #008000">AI     </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2003</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.258917</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A      </span> │ <span style="color: #008000; text-decoration-color: #008000">AI     </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2004</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.511275</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A      </span> │ <span style="color: #008000; text-decoration-color: #008000">AI     </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2005</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.404934</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A      </span> │ <span style="color: #008000; text-decoration-color: #008000">AI     </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2006</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.783799</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A      </span> │ <span style="color: #008000; text-decoration-color: #008000">AI     </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.303313</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A      </span> │ <span style="color: #008000; text-decoration-color: #008000">AI     </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.476597</span> │
│ <span style="color: #008000; text-decoration-color: #008000">A      </span> │ <span style="color: #008000; text-decoration-color: #008000">AI     </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.583382</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴─────────┴───────┴────────────┘
</pre>
</div>
</div>
<p>Pivoting with multiple name columns</p>
<div id="4251d84e" class="cell" data-execution_count="320">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> production.pivot_wider(</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>...     names_from<span class="op">=</span>[<span class="st">"product"</span>, <span class="st">"country"</span>],</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>...     values_from<span class="op">=</span><span class="st">"production"</span>,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="320">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┓
┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> B_AI     </span>┃<span style="font-weight: bold"> B_EI     </span>┃<span style="font-weight: bold"> A_AI     </span>┃
┡━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │
├───────┼──────────┼──────────┼──────────┤
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2001</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.865310</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.191067</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.757954</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2003</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.805028</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.238616</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.258917</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.668153</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.507941</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.583382</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2006</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.719705</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.447970</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.783799</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.824845</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.320055</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.476597</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2004</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.548699</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.967540</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.511275</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.398824</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.080446</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.303313</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2011</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.493578</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.109058</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.504687</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2012</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.867603</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.551267</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.281838</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2002</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.260492</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.567511</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.420572</span> │
│     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└───────┴──────────┴──────────┴──────────┘
</pre>
</div>
</div>
<p>Select a subset of names. This call incurs no computation when constructing the expression.</p>
<div id="b8b7b91b" class="cell" data-execution_count="323">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> production.pivot_wider(</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>...     names_from<span class="op">=</span>[<span class="st">"product"</span>, <span class="st">"country"</span>],</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>...     names<span class="op">=</span>[(<span class="st">"A"</span>, <span class="st">"AI"</span>), (<span class="st">"B"</span>, <span class="st">"AI"</span>)],</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>...     values_from<span class="op">=</span><span class="st">"production"</span>,</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="323">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┓
┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> A_AI     </span>┃<span style="font-weight: bold"> B_AI     </span>┃
┡━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │
├───────┼──────────┼──────────┤
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2001</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.757954</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.865310</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2003</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.258917</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.805028</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.583382</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.668153</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2004</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.511275</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.548699</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.303313</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.398824</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2011</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.504687</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.493578</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2012</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.281838</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.867603</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2006</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.783799</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.719705</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.476597</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.824845</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2002</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.420572</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.260492</span> │
│     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└───────┴──────────┴──────────┘
</pre>
</div>
</div>
<p>Sort the new columns’ names</p>
<div id="b22abaa6" class="cell" data-execution_count="326">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> production.pivot_wider(</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>...     names_from<span class="op">=</span>[<span class="st">"product"</span>, <span class="st">"country"</span>],</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>...     values_from<span class="op">=</span><span class="st">"production"</span>,</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>...     names_sort<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="326">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┓
┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> A_AI     </span>┃<span style="font-weight: bold"> B_AI     </span>┃<span style="font-weight: bold"> B_EI     </span>┃
┡━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │
├───────┼──────────┼──────────┼──────────┤
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2001</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.757954</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.865310</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.191067</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2003</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.258917</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.805028</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.238616</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.583382</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.668153</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.507941</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2006</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.783799</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.719705</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.447970</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.476597</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.824845</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.320055</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2004</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.511275</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.548699</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.967540</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.303313</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.398824</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.080446</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2011</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.504687</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.493578</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.109058</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2012</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.281838</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.867603</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.551267</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2002</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.420572</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.260492</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.567511</span> │
│     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└───────┴──────────┴──────────┴──────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.preview" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.preview">preview</h3>
<p><code>preview(max_rows=None, max_columns=None, max_length=None, max_string=None, max_depth=None, console_width=None)</code></p>
<p>Return a subset as a Rich Table.</p>
<p>This is an explicit version of what you get when you inspect this object in interactive mode, except with this version you can pass formatting options. The options are the same as those exposed in <code>ibis.options.interactive</code>.</p>
<section id="parameters-24" class="level4">
<h4 class="anchored" data-anchor-id="parameters-24">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>max_rows</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a> | None</td>
<td>Maximum number of rows to display</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>max_columns</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a> | None</td>
<td>Maximum number of columns to display</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>max_length</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a> | None</td>
<td>Maximum length for pretty-printed arrays and maps</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>max_string</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a> | None</td>
<td>Maximum length for pretty-printed strings</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>max_depth</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a> | None</td>
<td>Maximum depth for nested data types</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>console_width</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a> | <a href="https://docs.python.org/3/library/functions.html#float">float</a> | None</td>
<td>Width of the console in characters. If not specified, the width will be inferred from the console.</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-26" class="level4">
<h4 class="anchored" data-anchor-id="examples-26">Examples</h4>
<div id="7084c11c" class="cell" data-execution_count="329">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Because the console_width is too small, only 2 columns are shown even though we specified up to 3.</p>
<div id="567ccd62" class="cell" data-execution_count="332">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.preview(</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>...     max_rows<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>...     max_columns<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>...     max_string<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>...     console_width<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="332">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━┳━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> island   </span>┃<span style="font-weight: bold"> … </span>┃
┡━━━━━━━━━╇━━━━━━━━━━╇━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
├─────────┼──────────┼───┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgers…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgers…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgers…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴──────────┴───┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.relabel" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.relabel">relabel</h3>
<p><code>relabel(substitutions)</code></p>
<p>Deprecated in favor of <code>Table.rename</code>.</p>
</section>
<section id="ibis.expr.types.relations.Table.relocate" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.relocate">relocate</h3>
<p><code>relocate(*columns, before=None, after=None, **kwargs)</code></p>
<p>Relocate <code>columns</code> before or after other specified columns.</p>
<section id="parameters-25" class="level4">
<h4 class="anchored" data-anchor-id="parameters-25">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>columns</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>s</code>.<code>Selector</code></td>
<td>Columns to relocate. Selectors are accepted.</td>
<td><code>()</code></td>
</tr>
<tr class="even">
<td><code>before</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>s</code>.<code>Selector</code> | None</td>
<td>A column name or selector to insert the new columns before.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>after</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>s</code>.<code>Selector</code> | None</td>
<td>A column name or selector. Columns in <code>columns</code> are relocated after the last column selected in <code>after</code>.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>kwargs</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>Additional column names to relocate, renaming argument values to keyword argument names.</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-26" class="level4">
<h4 class="anchored" data-anchor-id="returns-26">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>A table with the columns relocated.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-27" class="level4">
<h4 class="anchored" data-anchor-id="examples-27">Examples</h4>
<div id="3518d782" class="cell" data-execution_count="335">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable(<span class="bu">dict</span>(a<span class="op">=</span>[<span class="dv">1</span>], b<span class="op">=</span>[<span class="dv">1</span>], c<span class="op">=</span>[<span class="dv">1</span>], d<span class="op">=</span>[<span class="st">"a"</span>], e<span class="op">=</span>[<span class="st">"a"</span>], f<span class="op">=</span>[<span class="st">"a"</span>]))</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="335">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b     </span>┃<span style="font-weight: bold"> c     </span>┃<span style="font-weight: bold"> d      </span>┃<span style="font-weight: bold"> e      </span>┃<span style="font-weight: bold"> f      </span>┃
┡━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼───────┼───────┼────────┼────────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
└───────┴───────┴───────┴────────┴────────┴────────┘
</pre>
</div>
</div>
<div id="ba6ba0c2" class="cell" data-execution_count="338">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.relocate(<span class="st">"f"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="338">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> f      </span>┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b     </span>┃<span style="font-weight: bold"> c     </span>┃<span style="font-weight: bold"> d      </span>┃<span style="font-weight: bold"> e      </span>┃
┡━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├────────┼───────┼───────┼───────┼────────┼────────┤
│ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
└────────┴───────┴───────┴───────┴────────┴────────┘
</pre>
</div>
</div>
<div id="4fbb01ea" class="cell" data-execution_count="341">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.relocate(<span class="st">"a"</span>, after<span class="op">=</span><span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="341">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> b     </span>┃<span style="font-weight: bold"> c     </span>┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> d      </span>┃<span style="font-weight: bold"> e      </span>┃<span style="font-weight: bold"> f      </span>┃
┡━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼───────┼───────┼────────┼────────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
└───────┴───────┴───────┴────────┴────────┴────────┘
</pre>
</div>
</div>
<div id="dcde6779" class="cell" data-execution_count="344">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.relocate(<span class="st">"f"</span>, before<span class="op">=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="344">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> f      </span>┃<span style="font-weight: bold"> b     </span>┃<span style="font-weight: bold"> c     </span>┃<span style="font-weight: bold"> d      </span>┃<span style="font-weight: bold"> e      </span>┃
┡━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┼───────┼───────┼────────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
└───────┴────────┴───────┴───────┴────────┴────────┘
</pre>
</div>
</div>
<div id="8e5f7c26" class="cell" data-execution_count="347">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.relocate(<span class="st">"a"</span>, after<span class="op">=</span>s.last())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="347">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> b     </span>┃<span style="font-weight: bold"> c     </span>┃<span style="font-weight: bold"> d      </span>┃<span style="font-weight: bold"> e      </span>┃<span style="font-weight: bold"> f      </span>┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼───────┼────────┼────────┼────────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
└───────┴───────┴────────┴────────┴────────┴───────┘
</pre>
</div>
</div>
<p>Relocate allows renaming</p>
<div id="b3c76718" class="cell" data-execution_count="350">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.relocate(ff<span class="op">=</span><span class="st">"f"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="350">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> ff     </span>┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b     </span>┃<span style="font-weight: bold"> c     </span>┃<span style="font-weight: bold"> d      </span>┃<span style="font-weight: bold"> e      </span>┃
┡━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├────────┼───────┼───────┼───────┼────────┼────────┤
│ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
└────────┴───────┴───────┴───────┴────────┴────────┘
</pre>
</div>
</div>
<p>You can relocate based on any predicate selector, such as <a href="../reference/selectors.html#ibis.selectors.of_type"><code>of_type</code></a></p>
<div id="dbca9210" class="cell" data-execution_count="353">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.relocate(s.of_type(<span class="st">"string"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="353">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> d      </span>┃<span style="font-weight: bold"> e      </span>┃<span style="font-weight: bold"> f      </span>┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b     </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├────────┼────────┼────────┼───────┼───────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
└────────┴────────┴────────┴───────┴───────┴───────┘
</pre>
</div>
</div>
<div id="c013981f" class="cell" data-execution_count="356">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.relocate(s.numeric(), after<span class="op">=</span>s.last())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="356">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> d      </span>┃<span style="font-weight: bold"> e      </span>┃<span style="font-weight: bold"> f      </span>┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b     </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├────────┼────────┼────────┼───────┼───────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
└────────┴────────┴────────┴───────┴───────┴───────┘
</pre>
</div>
</div>
<p>When multiple columns are selected with <code>before</code> or <code>after</code>, those selected columns are moved before and after the <code>selectors</code> input</p>
<div id="97213dae" class="cell" data-execution_count="359">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable(<span class="bu">dict</span>(a<span class="op">=</span>[<span class="dv">1</span>], b<span class="op">=</span>[<span class="st">"a"</span>], c<span class="op">=</span>[<span class="dv">1</span>], d<span class="op">=</span>[<span class="st">"a"</span>]))</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.relocate(s.numeric(), after<span class="op">=</span>s.of_type(<span class="st">"string"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="359">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> b      </span>┃<span style="font-weight: bold"> d      </span>┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├────────┼────────┼───────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
└────────┴────────┴───────┴───────┘
</pre>
</div>
</div>
<div id="d1f40abd" class="cell" data-execution_count="362">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.relocate(s.numeric(), before<span class="op">=</span>s.of_type(<span class="st">"string"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="362">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> c     </span>┃<span style="font-weight: bold"> b      </span>┃<span style="font-weight: bold"> d      </span>┃
┡━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼───────┼────────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
└───────┴───────┴────────┴────────┘
</pre>
</div>
</div>
<p>When there are duplicate <strong>renames</strong> in a call to relocate, the last one is preserved</p>
<div id="be0e32cb" class="cell" data-execution_count="365">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.relocate(e<span class="op">=</span><span class="st">"d"</span>, f<span class="op">=</span><span class="st">"d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="365">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> f      </span>┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├────────┼───────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
└────────┴───────┴────────┴───────┘
</pre>
</div>
</div>
<p>However, if there are duplicates that are <strong>not</strong> part of a rename, the order specified in the relocate call is preserved</p>
<div id="4b06eed4" class="cell" data-execution_count="368">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.relocate(</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>...     <span class="st">"b"</span>,</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>...     s.of_type(<span class="st">"string"</span>),  <span class="co"># "b" is a string column, so the selector matches</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="368">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> b      </span>┃<span style="font-weight: bold"> d      </span>┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> c     </span>┃
┡━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├────────┼────────┼───────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
└────────┴────────┴───────┴───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.rename" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.rename">rename</h3>
<p><code>rename(method=None, /, **substitutions)</code></p>
<p>Rename columns in the table.</p>
<section id="parameters-26" class="level4">
<h4 class="anchored" data-anchor-id="parameters-26">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>method</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable">Callable</a>[[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None] | <a href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[‘snake_case’, ‘ALL_CAPS’] | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping">Mapping</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</td>
<td>An optional method for renaming columns. May be one of: - A format string to use to rename all columns, like <code>"prefix_{name}"</code>. - A function from old name to new name. If the function returns <code>None</code> the old name is used. - The literal strings <code>"snake_case"</code> or <code>"ALL_CAPS"</code> to rename all columns using a <code>snake_case</code> or <code>"ALL_CAPS"``   naming convention respectively. - A mapping from new name to old name. Existing columns not present   in the mapping will passthrough with their original name. |</code>None<code>| |</code>substitutions<code>| [str](</code>str<code>)                                                                                                                                                                                                                              | Columns to be explicitly renamed, expressed as</code>new_name=old_name`<code>keyword arguments.                                                                                                                                                                                                                                                                                                                                                                                                                                 |</code>`</td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-27" class="level4">
<h4 class="anchored" data-anchor-id="returns-27">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>A renamed table expression</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-28" class="level4">
<h4 class="anchored" data-anchor-id="examples-28">Examples</h4>
<div id="60554339" class="cell" data-execution_count="371">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> first3 <span class="op">=</span> s.index[:<span class="dv">3</span>]  <span class="co"># first 3 columns</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins_raw_raw.fetch().select(first3)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="371">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> studyName </span>┃<span style="font-weight: bold"> Sample Number </span>┃<span style="font-weight: bold"> Species                             </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                              │
├───────────┼───────────────┼─────────────────────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708  </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708  </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708  </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708  </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708  </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708  </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708  </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708  </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708  </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708  </span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                                   │
└───────────┴───────────────┴─────────────────────────────────────┘
</pre>
</div>
</div>
<p>Rename specific columns by passing keyword arguments like `new_name=“old_name”``</p>
<div id="45c7d3cd" class="cell" data-execution_count="374">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.rename(study_name<span class="op">=</span><span class="st">"studyName"</span>).head(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="374">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> study_name </span>┃<span style="font-weight: bold"> Sample Number </span>┃<span style="font-weight: bold"> Species                             </span>┃
┡━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                              │
├────────────┼───────────────┼─────────────────────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708   </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
└────────────┴───────────────┴─────────────────────────────────────┘
</pre>
</div>
</div>
<p>Rename all columns using a format string</p>
<div id="e5cbd636" class="cell" data-execution_count="377">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.rename(<span class="st">"p_</span><span class="sc">{name}</span><span class="st">"</span>).head(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="377">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> p_studyName </span>┃<span style="font-weight: bold"> p_Sample Number </span>┃<span style="font-weight: bold"> p_Species                           </span>┃
┡━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                              │
├─────────────┼─────────────────┼─────────────────────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708    </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
└─────────────┴─────────────────┴─────────────────────────────────────┘
</pre>
</div>
</div>
<p>Rename all columns using a snake_case convention</p>
<div id="37615b6c" class="cell" data-execution_count="380">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.rename(<span class="st">"snake_case"</span>).head(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="380">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> study_name </span>┃<span style="font-weight: bold"> sample_number </span>┃<span style="font-weight: bold"> species                             </span>┃
┡━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                              │
├────────────┼───────────────┼─────────────────────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708   </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
└────────────┴───────────────┴─────────────────────────────────────┘
</pre>
</div>
</div>
<p>Rename all columns using an ALL_CAPS convention</p>
<div id="63c1af07" class="cell" data-execution_count="383">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.rename(<span class="st">"ALL_CAPS"</span>).head(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="383">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> STUDY_NAME </span>┃<span style="font-weight: bold"> SAMPLE_NUMBER </span>┃<span style="font-weight: bold"> SPECIES                             </span>┃
┡━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                              │
├────────────┼───────────────┼─────────────────────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708   </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
└────────────┴───────────────┴─────────────────────────────────────┘
</pre>
</div>
</div>
<p>Rename all columns using a callable</p>
<div id="3ddb1a6a" class="cell" data-execution_count="386">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.rename(<span class="bu">str</span>.upper).head(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="386">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> STUDYNAME </span>┃<span style="font-weight: bold"> SAMPLE NUMBER </span>┃<span style="font-weight: bold"> SPECIES                             </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                              │
├───────────┼───────────────┼─────────────────────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">PAL0708  </span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">Adelie Penguin (Pygoscelis adeliae)</span> │
└───────────┴───────────────┴─────────────────────────────────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.rowid" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.rowid">rowid</h3>
<p><code>rowid()</code></p>
<p>A unique integer per row.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
This operation is only valid on physical tables
</div>
</div>
<div class="callout-body-container callout-body">
<p>Any further meaning behind this expression is backend dependent. Generally this corresponds to some index into the database storage (for example, SQLite and DuckDB’s <code>rowid</code>).</p>
<p>For a monotonically increasing row number, see <code>ibis.row_number</code>.</p>
</div>
</div>
<section id="returns-28" class="level4">
<h4 class="anchored" data-anchor-id="returns-28">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>IntegerColumn</code></td>
<td>An integer column</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.expr.types.relations.Table.sample" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.sample">sample</h3>
<p><code>sample(fraction, *, method='row', seed=None)</code></p>
<p>Sample a fraction of rows from a table.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results may be non-repeatable
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sampling is by definition a random operation. Some backends support specifying a <code>seed</code> for repeatable results, but not all backends support that option. And some backends (duckdb, for example) do support specifying a seed but may still not have repeatable results in all cases.</p>
<p>In all cases, results are backend-specific. An execution against one backend is unlikely to sample the same rows when executed against a different backend, even with the same <code>seed</code> set.</p>
</div>
</div>
<section id="parameters-27" class="level4">
<h4 class="anchored" data-anchor-id="parameters-27">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>fraction</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#float">float</a></td>
<td>The percentage of rows to include in the sample, expressed as a float between 0 and 1.</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>method</code></td>
<td><a href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[‘row’, ‘block’]</td>
<td>The sampling method to use. The default is “row”, which includes each row with a probability of <code>fraction</code>. If method is “block”, some backends may instead perform sampling a fraction of blocks of rows (where “block” is a backend dependent definition). This is identical to “row” for backends lacking a blockwise sampling implementation. For those coming from SQL, “row” and “block” correspond to “bernoulli” and “system” respectively in a TABLESAMPLE clause.</td>
<td><code>'row'</code></td>
</tr>
<tr class="odd">
<td><code>seed</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a> | None</td>
<td>An optional random seed to use, for repeatable sampling. The range of possible seed values is backend specific (most support at least <code>[0, 2**31 - 1]</code>). Backends that never support specifying a seed for repeatable sampling will error appropriately. Note that some backends (like DuckDB) do support specifying a seed, but may still not have repeatable results in all cases.</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-29" class="level4">
<h4 class="anchored" data-anchor-id="returns-29">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>The input table, with <code>fraction</code> of rows selected.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-29" class="level4">
<h4 class="anchored" data-anchor-id="examples-29">Examples</h4>
<div id="422d46cd" class="cell" data-execution_count="389">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"x"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], <span class="st">"y"</span>: [<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>]})</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="389">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> x     </span>┃<span style="font-weight: bold"> y      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">a     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">b     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │ <span style="color: #008000; text-decoration-color: #008000">d     </span> │
└───────┴────────┘
</pre>
</div>
</div>
<p>Sample approximately half the rows, with a seed specified for reproducibility.</p>
<div id="28addd62" class="cell" data-execution_count="392">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.sample(<span class="fl">0.5</span>, seed<span class="op">=</span><span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="392">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> x     </span>┃<span style="font-weight: bold"> y      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">b     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">c     </span> │
└───────┴────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.schema" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.schema">schema</h3>
<p><code>schema()</code></p>
<p>Return the <a href="../reference/schemas.html#ibis.expr.schema.Schema">Schema</a> for this table.</p>
<section id="returns-30" class="level4">
<h4 class="anchored" data-anchor-id="returns-30">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Schema</code></td>
<td>The table’s schema.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-30" class="level4">
<h4 class="anchored" data-anchor-id="examples-30">Examples</h4>
<div id="daa037a7" class="cell" data-execution_count="395">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.schema()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="395">
<pre><code>ibis.Schema {
  species            string
  island             string
  bill_length_mm     float64
  bill_depth_mm      float64
  flipper_length_mm  int64
  body_mass_g        int64
  sex                string
  year               int64
}</code></pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.select" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.select">select</h3>
<p><code>select(*exprs, **named_exprs)</code></p>
<p>Compute a new table expression using <code>exprs</code> and <code>named_exprs</code>.</p>
<p>Passing an aggregate function to this method will broadcast the aggregate’s value over the number of rows in the table and automatically constructs a window function expression. See the examples section for more details.</p>
<p>For backwards compatibility the keyword argument <code>exprs</code> is reserved and cannot be used to name an expression. This behavior will be removed in v4.</p>
<section id="parameters-28" class="level4">
<h4 class="anchored" data-anchor-id="parameters-28">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>exprs</code></td>
<td><code>ir</code>.<code>Value</code> | <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<code>ir</code>.<code>Value</code> | <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</td>
<td>Column expression, string, or list of column expressions and strings.</td>
<td><code>()</code></td>
</tr>
<tr class="even">
<td><code>named_exprs</code></td>
<td><code>ir</code>.<code>Value</code> | <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>Column expressions</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-31" class="level4">
<h4 class="anchored" data-anchor-id="returns-31">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Table expression</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-31" class="level4">
<h4 class="anchored" data-anchor-id="examples-31">Examples</h4>
<div id="69e378ea" class="cell" data-execution_count="398">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="398">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3650</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.9</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.8</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3625</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4675</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.1</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3475</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.2</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4250</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<p>Simple projection</p>
<div id="e76e3413" class="cell" data-execution_count="401">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.select(<span class="st">"island"</span>, <span class="st">"bill_length_mm"</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="401">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │
├───────────┼────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │
└───────────┴────────────────┘
</pre>
</div>
</div>
<p>In that simple case, you could also just use python’s indexing syntax</p>
<div id="dc4f2995" class="cell" data-execution_count="404">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t[[<span class="st">"island"</span>, <span class="st">"bill_length_mm"</span>]].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="404">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │
├───────────┼────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │
└───────────┴────────────────┘
</pre>
</div>
</div>
<p>Projection by zero-indexed column position</p>
<div id="3046e444" class="cell" data-execution_count="407">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.select(t[<span class="dv">0</span>], t[<span class="dv">4</span>]).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="407">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │
├─────────┼───────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │
└─────────┴───────────────────┘
</pre>
</div>
</div>
<p>Projection with renaming and compute in one call</p>
<div id="9f8e6376" class="cell" data-execution_count="410">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.select(next_year<span class="op">=</span>t.year <span class="op">+</span> <span class="dv">1</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="410">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┓
┃<span style="font-weight: bold"> next_year </span>┃
┡━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │
├───────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
└───────────┘
</pre>
</div>
</div>
<p>You can do the same thing with a named expression, and using the deferred API</p>
<div id="2bd5e297" class="cell" data-execution_count="413">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.select((_.year <span class="op">+</span> <span class="dv">1</span>).name(<span class="st">"next_year"</span>)).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="413">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┓
┃<span style="font-weight: bold"> next_year </span>┃
┡━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>     │
├───────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │
└───────────┘
</pre>
</div>
</div>
<p>Projection with aggregation expressions</p>
<div id="66e2f4bf" class="cell" data-execution_count="416">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.select(<span class="st">"island"</span>, bill_mean<span class="op">=</span>t.bill_length_mm.mean()).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="416">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━┓
┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_mean </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>   │
├───────────┼───────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │
└───────────┴───────────┘
</pre>
</div>
</div>
<p>Projection with a selector</p>
<div id="5df2c1f4" class="cell" data-execution_count="419">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.select(s.numeric() <span class="op">&amp;</span> <span class="op">~</span>s.cols(<span class="st">"year"</span>)).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="419">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃
┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │
├────────────────┼───────────────┼───────────────────┼─────────────┤
│           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │
│           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │
│           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │
│           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │
└────────────────┴───────────────┴───────────────────┴─────────────┘
</pre>
</div>
</div>
<p>Projection + aggregation across multiple columns</p>
<div id="1920e5e0" class="cell" data-execution_count="422">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.select(s.across(s.numeric() <span class="op">&amp;</span> <span class="op">~</span>s.cols(<span class="st">"year"</span>), _.mean())).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="422">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃
┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │
├────────────────┼───────────────┼───────────────────┼─────────────┤
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.92193</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.15117</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200.915205</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4201.754386</span> │
└────────────────┴───────────────┴───────────────────┴─────────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.sql" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.sql">sql</h3>
<p><code>sql(query, dialect=None)</code></p>
<p>Run a SQL query against a table expression.</p>
<section id="parameters-29" class="level4">
<h4 class="anchored" data-anchor-id="parameters-29">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>query</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>Query string</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>dialect</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</td>
<td>Optional string indicating the dialect of <code>query</code>. Defaults to the backend’s native dialect.</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-32" class="level4">
<h4 class="anchored" data-anchor-id="returns-32">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>An opaque table expression</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-32" class="level4">
<h4 class="anchored" data-anchor-id="examples-32">Examples</h4>
<div id="bffeb2f4" class="cell" data-execution_count="425">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch(table_name<span class="op">=</span><span class="st">"penguins"</span>)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr <span class="op">=</span> t.sql(</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>...     <span class="st">"""</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="st">...     SELECT island, mean(bill_length_mm) AS avg_bill_length</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="st">...     FROM penguins</span></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a><span class="st">...     GROUP BY 1</span></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a><span class="st">...     ORDER BY 2 DESC</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="st">...     """</span></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="425">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> avg_bill_length </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │
├───────────┼─────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.257485</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.167742</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.950980</span> │
└───────────┴─────────────────┘
</pre>
</div>
</div>
<p>Mix and match ibis expressions with SQL queries</p>
<div id="b67444fe" class="cell" data-execution_count="428">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch(table_name<span class="op">=</span><span class="st">"penguins"</span>)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr <span class="op">=</span> t.sql(</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>...     <span class="st">"""</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="st">...     SELECT island, mean(bill_length_mm) AS avg_bill_length</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="st">...     FROM penguins</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="st">...     GROUP BY 1</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="st">...     ORDER BY 2 DESC</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="st">...     """</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr <span class="op">=</span> expr.mutate(</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>...     island<span class="op">=</span>_.island.lower(),</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>...     avg_bill_length<span class="op">=</span>_.avg_bill_length.<span class="bu">round</span>(<span class="dv">1</span>),</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="428">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> avg_bill_length </span>┃
┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │
├───────────┼─────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">biscoe   </span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">dream    </span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.2</span> │
│ <span style="color: #008000; text-decoration-color: #008000">torgersen</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.0</span> │
└───────────┴─────────────────┘
</pre>
</div>
</div>
<p>Because ibis expressions aren’t named, they aren’t visible to subsequent <code>.sql</code> calls. Use the <a href="#ibis.expr.types.relations.Table.alias"><code>alias</code></a> method to assign a name to an expression.</p>
<div id="5f9e7062" class="cell" data-execution_count="431">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expr.alias(<span class="st">"b"</span>).sql(<span class="st">"SELECT * FROM b WHERE avg_bill_length &gt; 40"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="431">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> island </span>┃<span style="font-weight: bold"> avg_bill_length </span>┃
┡━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │
├────────┼─────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">biscoe</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">dream </span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.2</span> │
└────────┴─────────────────┘
</pre>
</div>
</div>
</section>
<section id="see-also-4" class="level4">
<h4 class="anchored" data-anchor-id="see-also-4">See Also</h4>
<p><a href="#ibis.expr.types.relations.Table.alias"><code>Table.alias</code></a></p>
</section>
</section>
<section id="ibis.expr.types.relations.Table.to_array" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.to_array">to_array</h3>
<p><code>to_array()</code></p>
<p>View a single column table as an array.</p>
<section id="returns-33" class="level4">
<h4 class="anchored" data-anchor-id="returns-33">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-generic.html#ibis.expr.types.generic.Value">Value</a></td>
<td>A single column view of a table</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.expr.types.relations.Table.to_pandas" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.to_pandas">to_pandas</h3>
<p><code>to_pandas(**kwargs)</code></p>
<p>Convert a table expression to a pandas DataFrame.</p>
<section id="parameters-30" class="level4">
<h4 class="anchored" data-anchor-id="parameters-30">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>kwargs</code></td>
<td></td>
<td>Same as keyword arguments to <a href="../reference/expression-generic.html#ibis.expr.types.core.Expr.execute"><code>execute</code></a></td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.expr.types.relations.Table.try_cast" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.try_cast">try_cast</h3>
<p><code>try_cast(schema)</code></p>
<p>Cast the columns of a table.</p>
<p>If the cast fails for a row, the value is returned as <code>NULL</code> or <code>NaN</code> depending on backend behavior.</p>
<section id="parameters-31" class="level4">
<h4 class="anchored" data-anchor-id="parameters-31">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 36%">
<col style="width: 45%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>schema</code></td>
<td><code>SchemaLike</code></td>
<td>Mapping, schema or iterable of pairs to use for casting</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-34" class="level4">
<h4 class="anchored" data-anchor-id="returns-34">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Casted table</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-33" class="level4">
<h4 class="anchored" data-anchor-id="examples-33">Examples</h4>
<div id="0b961a60" class="cell" data-execution_count="434">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>], <span class="st">"b"</span>: [<span class="st">"2.2"</span>, <span class="st">"3.3"</span>, <span class="st">"book"</span>]})</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.try_cast({<span class="st">"a"</span>: <span class="st">"int"</span>, <span class="st">"b"</span>: <span class="st">"float"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="434">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b       </span>┃
┡━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │
├───────┼─────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.3</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
└───────┴─────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.union" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.union">union</h3>
<p><code>union(table, *rest, distinct=False)</code></p>
<p>Compute the set union of multiple table expressions.</p>
<p>The input tables must have identical schemas.</p>
<section id="parameters-32" class="level4">
<h4 class="anchored" data-anchor-id="parameters-32">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>table</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>A table expression</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>*rest</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Additional table expressions</td>
<td><code>()</code></td>
</tr>
<tr class="odd">
<td><code>distinct</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#bool">bool</a></td>
<td>Only return distinct rows</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-35" class="level4">
<h4 class="anchored" data-anchor-id="returns-35">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>A new table containing the union of all input tables.</td>
</tr>
</tbody>
</table>
</section>
<section id="see-also-5" class="level4">
<h4 class="anchored" data-anchor-id="see-also-5">See Also</h4>
<p><a href="../reference/expression-tables.html#ibis.union"><code>ibis.union</code></a></p>
</section>
<section id="examples-34" class="level4">
<h4 class="anchored" data-anchor-id="examples-34">Examples</h4>
<div id="cb31d2f1" class="cell" data-execution_count="437">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">1</span>, <span class="dv">2</span>]})</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="437">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└───────┘
</pre>
</div>
</div>
<div id="24ee3e86" class="cell" data-execution_count="440">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">2</span>, <span class="dv">3</span>]})</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="440">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
└───────┘
</pre>
</div>
</div>
<div id="77d31db4" class="cell" data-execution_count="443">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1.union(t2)  <span class="co"># union all by default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="443">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
└───────┘
</pre>
</div>
</div>
<div id="acea9057" class="cell" data-execution_count="446">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1.union(t2, distinct<span class="op">=</span><span class="va">True</span>).order_by(<span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="446">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
└───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.unnest" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.unnest">unnest</h3>
<p><code>unnest(column, offset=None, keep_empty=False)</code></p>
<p>Unnest an array <code>column</code> from a table.</p>
<p>When unnesting an existing column the newly unnested column replaces the existing column.</p>
<section id="parameters-33" class="level4">
<h4 class="anchored" data-anchor-id="parameters-33">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>column</code></td>
<td></td>
<td>Array column to unnest.</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>offset</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</td>
<td>Name of the resulting index column.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>keep_empty</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#bool">bool</a></td>
<td>Keep empty array values as <code>NULL</code> in the output table, as well as existing <code>NULL</code> values.</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-36" class="level4">
<h4 class="anchored" data-anchor-id="returns-36">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Table with the array column <code>column</code> unnested.</td>
</tr>
</tbody>
</table>
</section>
<section id="see-also-6" class="level4">
<h4 class="anchored" data-anchor-id="see-also-6">See Also</h4>
<p><a href="../reference/expression-collections.html#ibis.expr.types.arrays.ArrayValue.unnest"><code>ArrayValue.unnest</code></a></p>
</section>
<section id="examples-35" class="level4">
<h4 class="anchored" data-anchor-id="examples-35">Examples</h4>
<div id="50e54771" class="cell" data-execution_count="449">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Construct a table expression with an array column.</p>
<div id="35fb1294" class="cell" data-execution_count="452">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"x"</span>: [[<span class="dv">1</span>, <span class="dv">2</span>], [], <span class="va">None</span>, [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]], <span class="st">"y"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]})</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="452">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> x              </span>┃<span style="font-weight: bold"> y     </span>┃
┡━━━━━━━━━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">array&lt;int64&gt;</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├────────────────┼───────┤
│ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">]</span>         │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│ <span style="font-weight: bold">[]</span>             │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>           │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
│ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #808000; text-decoration-color: #808000">...</span> +<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span><span style="font-weight: bold">]</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
└────────────────┴───────┘
</pre>
</div>
</div>
<p>Unnest the array column <code>x</code>, replacing the <strong>existing</strong> <code>x</code> column.</p>
<div id="9f748222" class="cell" data-execution_count="455">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.unnest(<span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="455">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> x     </span>┃<span style="font-weight: bold"> y     </span>┃
┡━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
└───────┴───────┘
</pre>
</div>
</div>
<p>Unnest the array column <code>x</code> with an offset. The <code>offset</code> parameter is the name of the resulting index column.</p>
<div id="efc3a82b" class="cell" data-execution_count="458">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.unnest(t.x, offset<span class="op">=</span><span class="st">"idx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="458">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> x     </span>┃<span style="font-weight: bold"> y     </span>┃<span style="font-weight: bold"> idx   </span>┃
┡━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼───────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└───────┴───────┴───────┘
</pre>
</div>
</div>
<p>Unnest the array column <code>x</code> keep empty array values as <code>NULL</code> in the output table.</p>
<div id="3dba152b" class="cell" data-execution_count="461">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.unnest(_.x, offset<span class="op">=</span><span class="st">"idx"</span>, keep_empty<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="461">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> x     </span>┃<span style="font-weight: bold"> y     </span>┃<span style="font-weight: bold"> idx   </span>┃
┡━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┼───────┼───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
└───────┴───────┴───────┘
</pre>
</div>
</div>
<p>If you need to preserve the row order of the preserved empty arrays or null values use <a href="../reference/expression-tables.html#ibis.row_number"><code>row_number</code></a> to create an index column before calling <code>unnest</code>.</p>
<div id="b7c130a2" class="cell" data-execution_count="464">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> (</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>...     t.mutate(original_row<span class="op">=</span>ibis.row_number())</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>...     .unnest(<span class="st">"x"</span>, offset<span class="op">=</span><span class="st">"idx"</span>, keep_empty<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>...     .relocate(<span class="st">"original_row"</span>)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>...     .order_by(<span class="st">"original_row"</span>)</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="464">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> original_row </span>┃<span style="font-weight: bold"> x     </span>┃<span style="font-weight: bold"> y     </span>┃<span style="font-weight: bold"> idx   </span>┃
┡━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├──────────────┼───────┼───────┼───────┤
│            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└──────────────┴───────┴───────┴───────┘
</pre>
</div>
</div>
<p>You can also unnest more complex expressions, and the resulting column will be projected as the last expression in the result.</p>
<div id="3bdb4a88" class="cell" data-execution_count="467">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.unnest(_.x.<span class="bu">map</span>(<span class="kw">lambda</span> v: v <span class="op">+</span> <span class="dv">1</span>).name(<span class="st">"plus_one"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="467">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━┓
┃<span style="font-weight: bold"> x              </span>┃<span style="font-weight: bold"> y     </span>┃<span style="font-weight: bold"> plus_one </span>┃
┡━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">array&lt;int64&gt;</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │
├────────────────┼───────┼──────────┤
│ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">]</span>         │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">]</span>         │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
│ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #808000; text-decoration-color: #808000">...</span> +<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span><span style="font-weight: bold">]</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #808000; text-decoration-color: #808000">...</span> +<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span><span style="font-weight: bold">]</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
│ <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #808000; text-decoration-color: #808000">...</span> +<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span><span style="font-weight: bold">]</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │
└────────────────┴───────┴──────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.unpack" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.unpack">unpack</h3>
<p><code>unpack(*columns)</code></p>
<p>Project the struct fields of each of <code>columns</code> into <code>self</code>.</p>
<p>Existing fields are retained in the projection.</p>
<section id="parameters-34" class="level4">
<h4 class="anchored" data-anchor-id="parameters-34">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>columns</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>String column names to project into <code>self</code>.</td>
<td><code>()</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-37" class="level4">
<h4 class="anchored" data-anchor-id="returns-37">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>The child table with struct fields of each of <code>columns</code> projected.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-36" class="level4">
<h4 class="anchored" data-anchor-id="examples-36">Examples</h4>
<div id="5be26754" class="cell" data-execution_count="470">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> lines <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="st">...     {"name": "a", "pos": {"lat": 10.1, "lon": 30.3</span><span class="sc">}}</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="st">...     {"name": "b", "pos": {"lat": 10.2, "lon": 30.2</span><span class="sc">}}</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="st">...     {"name": "c", "pos": {"lat": 10.3, "lon": 30.1</span><span class="sc">}}</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="st">... '''</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">with</span> <span class="bu">open</span>(<span class="st">"/tmp/lines.json"</span>, <span class="st">"w"</span>) <span class="im">as</span> f:</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>...     nbytes <span class="op">=</span> f.write(lines)  <span class="co"># nbytes is unused</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.read_json(<span class="st">"/tmp/lines.json"</span>)</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="470">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> name   </span>┃<span style="font-weight: bold"> pos                                </span>┃
┡━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">struct&lt;lat: float64, lon: float64&gt;</span> │
├────────┼────────────────────────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">a     </span> │ <span style="font-weight: bold">{</span><span style="color: #008000; text-decoration-color: #008000">'lat'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.1</span>, <span style="color: #008000; text-decoration-color: #008000">'lon'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.3</span><span style="font-weight: bold">}</span>         │
│ <span style="color: #008000; text-decoration-color: #008000">b     </span> │ <span style="font-weight: bold">{</span><span style="color: #008000; text-decoration-color: #008000">'lat'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.2</span>, <span style="color: #008000; text-decoration-color: #008000">'lon'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.2</span><span style="font-weight: bold">}</span>         │
│ <span style="color: #008000; text-decoration-color: #008000">c     </span> │ <span style="font-weight: bold">{</span><span style="color: #008000; text-decoration-color: #008000">'lat'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.3</span>, <span style="color: #008000; text-decoration-color: #008000">'lon'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.1</span><span style="font-weight: bold">}</span>         │
└────────┴────────────────────────────────────┘
</pre>
</div>
</div>
<div id="20723911" class="cell" data-execution_count="473">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.unpack(<span class="st">"pos"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="473">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> name   </span>┃<span style="font-weight: bold"> lat     </span>┃<span style="font-weight: bold"> lon     </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │
├────────┼─────────┼─────────┤
│ <span style="color: #008000; text-decoration-color: #008000">a     </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.3</span> │
│ <span style="color: #008000; text-decoration-color: #008000">b     </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.2</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.2</span> │
│ <span style="color: #008000; text-decoration-color: #008000">c     </span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.3</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.1</span> │
└────────┴─────────┴─────────┘
</pre>
</div>
</div>
</section>
<section id="see-also-7" class="level4">
<h4 class="anchored" data-anchor-id="see-also-7">See Also</h4>
<p><a href="../reference/expression-collections.html#ibis.expr.types.structs.StructValue.lift"><code>StructValue.lift</code></a></p>
</section>
</section>
<section id="ibis.expr.types.relations.Table.value_counts" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.value_counts">value_counts</h3>
<p><code>value_counts()</code></p>
<p>Compute a frequency table of this table’s values.</p>
<section id="returns-38" class="level4">
<h4 class="anchored" data-anchor-id="returns-38">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Frequency table of this table’s values.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-37" class="level4">
<h4 class="anchored" data-anchor-id="examples-37">Examples</h4>
<div id="1fb9d5a0" class="cell" data-execution_count="476">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> examples</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> examples.penguins.fetch()</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="476">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<div id="4509c062" class="cell" data-execution_count="479">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.year.value_counts().order_by(<span class="st">"year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="479">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> year_count </span>┃
┡━━━━━━━╇━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │
├───────┼────────────┤
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">110</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">120</span> │
└───────┴────────────┘
</pre>
</div>
</div>
<div id="133e9fd2" class="cell" data-execution_count="482">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t[[<span class="st">"year"</span>, <span class="st">"island"</span>]].value_counts().order_by(<span class="st">"year"</span>, <span class="st">"island"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="482">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> year  </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> year_island_count </span>┃
┡━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │
├───────┼───────────┼───────────────────┤
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2008</span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008000; text-decoration-color: #008000">Biscoe   </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008000; text-decoration-color: #008000">Dream    </span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2009</span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span> │
└───────┴───────────┴───────────────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.expr.types.relations.Table.view" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.relations.Table.view">view</h3>
<p><code>view()</code></p>
<p>Create a new table expression distinct from the current one.</p>
<p>Use this API for any self-referencing operations like a self-join.</p>
<section id="returns-39" class="level4">
<h4 class="anchored" data-anchor-id="returns-39">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Table expression</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>
<section id="ibis.expr.types.groupby.GroupedTable" class="level1">
<h1>GroupedTable</h1>
<p><code>GroupedTable(self, **kwargs)</code></p>
<p>An intermediate table expression to hold grouping information.</p>
<section id="methods-1" class="level2">
<h2 class="anchored" data-anchor-id="methods-1">Methods</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#ibis.expr.types.groupby.GroupedTable.aggregate">aggregate</a></td>
<td>Compute aggregates over a group by.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.groupby.GroupedTable.count">count</a></td>
<td>Computing the number of rows per group.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.groupby.GroupedTable.having">having</a></td>
<td>Add a post-aggregation result filter <code>expr</code>.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.groupby.GroupedTable.mutate">mutate</a></td>
<td>Return a table projection with window functions applied.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.groupby.GroupedTable.order_by">order_by</a></td>
<td>Sort a grouped table expression by <code>expr</code>.</td>
</tr>
<tr class="even">
<td><a href="#ibis.expr.types.groupby.GroupedTable.over">over</a></td>
<td>Apply a window over the input expressions.</td>
</tr>
<tr class="odd">
<td><a href="#ibis.expr.types.groupby.GroupedTable.select">select</a></td>
<td>Project new columns out of the grouped table.</td>
</tr>
</tbody>
</table>
<section id="ibis.expr.types.groupby.GroupedTable.aggregate" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.groupby.GroupedTable.aggregate">aggregate</h3>
<p><code>aggregate(*metrics, **kwds)</code></p>
<p>Compute aggregates over a group by.</p>
</section>
<section id="ibis.expr.types.groupby.GroupedTable.count" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.groupby.GroupedTable.count">count</h3>
<p><code>count()</code></p>
<p>Computing the number of rows per group.</p>
<section id="returns-40" class="level4">
<h4 class="anchored" data-anchor-id="returns-40">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Table</code></td>
<td>The aggregated table</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.expr.types.groupby.GroupedTable.having" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.groupby.GroupedTable.having">having</h3>
<p><code>having(*predicates)</code></p>
<p>Add a post-aggregation result filter <code>expr</code>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expressions like <code>x is None</code> return <code>bool</code> and <strong>will not</strong> generate a SQL comparison to <code>NULL</code>
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<section id="parameters-35" class="level4">
<h4 class="anchored" data-anchor-id="parameters-35">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 48%">
<col style="width: 35%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>predicates</code></td>
<td><code>ir</code>.<code>BooleanScalar</code></td>
<td>Expressions that filters based on an aggregate value.</td>
<td><code>()</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-41" class="level4">
<h4 class="anchored" data-anchor-id="returns-41">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.groupby.GroupedTable">GroupedTable</a></td>
<td>A grouped table expression</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.expr.types.groupby.GroupedTable.mutate" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.groupby.GroupedTable.mutate">mutate</h3>
<p><code>mutate(*exprs, **kwexprs)</code></p>
<p>Return a table projection with window functions applied.</p>
<p>Any arguments can be functions.</p>
<section id="parameters-36" class="level4">
<h4 class="anchored" data-anchor-id="parameters-36">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>exprs</code></td>
<td><code>ir</code>.<code>Value</code> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<code>ir</code>.<code>Value</code>]</td>
<td>List of expressions</td>
<td><code>()</code></td>
</tr>
<tr class="even">
<td><code>kwexprs</code></td>
<td><code>ir</code>.<code>Value</code></td>
<td>Expressions</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-38" class="level4">
<h4 class="anchored" data-anchor-id="examples-38">Examples</h4>
<div id="35055587" class="cell" data-execution_count="485">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis.selectors <span class="im">as</span> s</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.examples.penguins.fetch()</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="485">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> island    </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> bill_depth_mm </span>┃<span style="font-weight: bold"> flipper_length_mm </span>┃<span style="font-weight: bold"> body_mass_g </span>┃<span style="font-weight: bold"> sex    </span>┃<span style="font-weight: bold"> year  </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.7</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3750</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.5</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.4</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">186</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3800</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.0</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3250</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.7</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.3</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3450</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.3</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3650</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.9</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.8</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">181</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3625</span> │ <span style="color: #008000; text-decoration-color: #008000">female</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.6</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">195</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4675</span> │ <span style="color: #008000; text-decoration-color: #008000">male  </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.1</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.1</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">193</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3475</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │ <span style="color: #008000; text-decoration-color: #008000">Torgersen</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.2</span> │               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">190</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4250</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2007</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>      │     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘
</pre>
</div>
</div>
<div id="f1b6191d" class="cell" data-execution_count="488">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> (</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>...     t.select(<span class="st">"species"</span>, <span class="st">"bill_length_mm"</span>)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>...     .group_by(<span class="st">"species"</span>)</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>...     .mutate(centered_bill_len<span class="op">=</span>ibis._.bill_length_mm <span class="op">-</span> ibis._.bill_length_mm.mean())</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>...     .order_by(s.<span class="bu">all</span>())</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="488">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> species </span>┃<span style="font-weight: bold"> bill_length_mm </span>┃<span style="font-weight: bold"> centered_bill_len </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>           │
├─────────┼────────────────┼───────────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.1</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.691391</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.1</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.691391</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.291391</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.791391</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.1</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.691391</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.4</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.391391</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.291391</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.6</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.191391</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.6</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.191391</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Adelie </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-3.791391</span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>       │              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────┴────────────────┴───────────────────┘
</pre>
</div>
</div>
</section>
<section id="returns-42" class="level4">
<h4 class="anchored" data-anchor-id="returns-42">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Table</code></td>
<td>A table expression with window functions applied</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.expr.types.groupby.GroupedTable.order_by" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.groupby.GroupedTable.order_by">order_by</h3>
<p><code>order_by(*by)</code></p>
<p>Sort a grouped table expression by <code>expr</code>.</p>
<section id="notes-1" class="level4">
<h4 class="anchored" data-anchor-id="notes-1">Notes</h4>
<p>This API call is ignored in aggregations.</p>
</section>
<section id="parameters-37" class="level4">
<h4 class="anchored" data-anchor-id="parameters-37">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 50%">
<col style="width: 32%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>by</code></td>
<td><code>ir</code>.<code>Value</code></td>
<td>Expressions to order the results by</td>
<td><code>()</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-43" class="level4">
<h4 class="anchored" data-anchor-id="returns-43">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.groupby.GroupedTable">GroupedTable</a></td>
<td>A sorted grouped GroupedTable</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.expr.types.groupby.GroupedTable.over" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.groupby.GroupedTable.over">over</h3>
<p><code>over(window=None, *, rows=None, range=None, group_by=None, order_by=None)</code></p>
<p>Apply a window over the input expressions.</p>
<section id="parameters-38" class="level4">
<h4 class="anchored" data-anchor-id="parameters-38">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 57%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>window</code></td>
<td></td>
<td>Window to add to the input</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>rows</code></td>
<td></td>
<td>Whether to use the <code>ROWS</code> window clause</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>range</code></td>
<td></td>
<td>Whether to use the <code>RANGE</code> window clause</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>group_by</code></td>
<td></td>
<td>Grouping key</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>order_by</code></td>
<td></td>
<td>Ordering key</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-44" class="level4">
<h4 class="anchored" data-anchor-id="returns-44">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../reference/expression-tables.html#ibis.expr.types.groupby.GroupedTable">GroupedTable</a></td>
<td>A new grouped table expression</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.expr.types.groupby.GroupedTable.select" class="level3">
<h3 class="anchored" data-anchor-id="ibis.expr.types.groupby.GroupedTable.select">select</h3>
<p><code>select(*exprs, **kwexprs)</code></p>
<p>Project new columns out of the grouped table.</p>
<section id="see-also-8" class="level4">
<h4 class="anchored" data-anchor-id="see-also-8">See Also</h4>
<p><a href="#ibis.expr.types.groupby.GroupedTable.mutate"><code>GroupedTable.mutate</code></a></p>
</section>
</section>
</section>
</section>
<section id="ibis.read_csv" class="level1">
<h1>read_csv</h1>
<p><code>ibis.read_csv(sources, table_name=None, **kwargs)</code></p>
<p>Lazily load a CSV or set of CSVs.</p>
<p>This function delegates to the <code>read_csv</code> method on the current default backend (DuckDB or <code>ibis.config.default_backend</code>).</p>
<section id="parameters-39" class="level2">
<h2 class="anchored" data-anchor-id="parameters-39">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sources</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</td>
<td>A filesystem path or URL or list of same. Supports CSV and TSV files.</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>table_name</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</td>
<td>A name to refer to the table. If not provided, a name will be generated.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>kwargs</code></td>
<td><a href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></td>
<td>Backend-specific keyword arguments for the file type. For the DuckDB backend used by default, please refer to: * CSV/TSV: https://duckdb.org/docs/data/csv/overview.html#parameters.</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-45" class="level2">
<h2 class="anchored" data-anchor-id="returns-45">Returns</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 60%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ir</code>.<code>Table</code></td>
<td>Table expression representing a file</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-39" class="level2">
<h2 class="anchored" data-anchor-id="examples-39">Examples</h2>
<div id="16434131" class="cell" data-execution_count="491">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> lines <span class="op">=</span> <span class="st">'''a,b</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="st">... 1,d</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a><span class="st">... 2,</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="st">... ,f</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="st">... '''</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">with</span> <span class="bu">open</span>(<span class="st">"/tmp/lines.csv"</span>, mode<span class="op">=</span><span class="st">"w"</span>) <span class="im">as</span> f:</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>...     nbytes <span class="op">=</span> f.write(lines)  <span class="co"># nbytes is unused</span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.read_csv(<span class="st">"/tmp/lines.csv"</span>)</span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="491">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">d     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">f     </span> │
└───────┴────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.read_delta" class="level1">
<h1>read_delta</h1>
<p><code>ibis.read_delta(source, table_name=None, **kwargs)</code></p>
<p>Lazily load a Delta Lake table.</p>
<section id="parameters-40" class="level2">
<h2 class="anchored" data-anchor-id="parameters-40">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>source</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></td>
<td>A filesystem path or URL.</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>table_name</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</td>
<td>A name to refer to the table. If not provided, a name will be generated.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>kwargs</code></td>
<td><a href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></td>
<td>Backend-specific keyword arguments for the file type.</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-46" class="level2">
<h2 class="anchored" data-anchor-id="returns-46">Returns</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 60%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ir</code>.<code>Table</code></td>
<td>Table expression representing a file</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-40" class="level2">
<h2 class="anchored" data-anchor-id="examples-40">Examples</h2>
<div id="d2e54a83" class="cell" data-execution_count="494">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> df <span class="op">=</span> pd.DataFrame({<span class="st">"a"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], <span class="st">"b"</span>: <span class="bu">list</span>(<span class="st">"ghi"</span>)})</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="494">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>g</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>h</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>i</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a3544fa3" class="cell" data-execution_count="497">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> deltalake <span class="im">as</span> dl</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dl.write_deltalake(<span class="st">"/tmp/data.delta"</span>, df, mode<span class="op">=</span><span class="st">"overwrite"</span>)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.read_delta(<span class="st">"/tmp/data.delta"</span>)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="497">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">g     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">h     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">i     </span> │
└───────┴────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.read_json" class="level1">
<h1>read_json</h1>
<p><code>ibis.read_json(sources, table_name=None, **kwargs)</code></p>
<p>Lazily load newline-delimited JSON data.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
This API is experimental and subject to change.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>This function delegates to the <code>read_json</code> method on the current default backend (DuckDB or <code>ibis.config.default_backend</code>).</p>
<section id="parameters-41" class="level2">
<h2 class="anchored" data-anchor-id="parameters-41">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sources</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</td>
<td>A filesystem path or URL or list of same.</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>table_name</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</td>
<td>A name to refer to the table. If not provided, a name will be generated.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>kwargs</code></td>
<td><a href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></td>
<td>Backend-specific keyword arguments for the file type. See https://duckdb.org/docs/extensions/json.html for details.</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-47" class="level2">
<h2 class="anchored" data-anchor-id="returns-47">Returns</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 60%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ir</code>.<code>Table</code></td>
<td>Table expression representing a file</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-41" class="level2">
<h2 class="anchored" data-anchor-id="examples-41">Examples</h2>
<div id="854a022a" class="cell" data-execution_count="500">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> lines <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="st">... {"a": 1, "b": "d"}</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="st">... {"a": 2, "b": null}</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="st">... {"a": null, "b": "f"}</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="st">... '''</span></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">with</span> <span class="bu">open</span>(<span class="st">"/tmp/lines.json"</span>, mode<span class="op">=</span><span class="st">"w"</span>) <span class="im">as</span> f:</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>...     nbytes <span class="op">=</span> f.write(lines)  <span class="co"># nbytes is unused</span></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.read_json(<span class="st">"/tmp/lines.json"</span>)</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="500">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">d     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>   │
│  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #008000; text-decoration-color: #008000">f     </span> │
└───────┴────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.read_parquet" class="level1">
<h1>read_parquet</h1>
<p><code>ibis.read_parquet(sources, table_name=None, **kwargs)</code></p>
<p>Lazily load a parquet file or set of parquet files.</p>
<p>This function delegates to the <code>read_parquet</code> method on the current default backend (DuckDB or <code>ibis.config.default_backend</code>).</p>
<section id="parameters-42" class="level2">
<h2 class="anchored" data-anchor-id="parameters-42">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sources</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</td>
<td>A filesystem path or URL or list of same.</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>table_name</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</td>
<td>A name to refer to the table. If not provided, a name will be generated.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>kwargs</code></td>
<td><a href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></td>
<td>Backend-specific keyword arguments for the file type. For the DuckDB backend used by default, please refer to: * Parquet: https://duckdb.org/docs/data/parquet</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-48" class="level2">
<h2 class="anchored" data-anchor-id="returns-48">Returns</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 60%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ir</code>.<code>Table</code></td>
<td>Table expression representing a file</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-42" class="level2">
<h2 class="anchored" data-anchor-id="examples-42">Examples</h2>
<div id="3f920e5a" class="cell" data-execution_count="503">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> df <span class="op">=</span> pd.DataFrame({<span class="st">"a"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], <span class="st">"b"</span>: <span class="bu">list</span>(<span class="st">"ghi"</span>)})</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="503">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>g</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>h</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>i</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="d45bf0d8" class="cell" data-execution_count="506">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> df.to_parquet(<span class="st">"/tmp/data.parquet"</span>)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.read_parquet(<span class="st">"/tmp/data.parquet"</span>)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="506">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">g     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">h     </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">i     </span> │
└───────┴────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.memtable" class="level1">
<h1>memtable</h1>
<p><code>ibis.memtable(data, *, columns=None, schema=None, name=None)</code></p>
<p>Construct an ibis table expression from in-memory data.</p>
<section id="parameters-43" class="level2">
<h2 class="anchored" data-anchor-id="parameters-43">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>data</code></td>
<td></td>
<td>A table-like object (<code>pandas.DataFrame</code>, <code>pyarrow.Table</code>, or <code>polars.DataFrame</code>), or any data accepted by the <code>pandas.DataFrame</code> constructor (e.g.&nbsp;a list of dicts). Note that ibis objects (e.g.&nbsp;<code>MapValue</code>) may not be passed in as part of <code>data</code> and will result in an error. Do not depend on the underlying storage type (e.g., pyarrow.Table), it’s subject to change across non-major releases.</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>columns</code></td>
<td><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</td>
<td>Optional <a href="https://docs.python.org/3/library/typing.html#typing.Iterable"><code>typing.Iterable</code></a> of <a href="https://docs.python.org/3/library/stdtypes.html#str"><code>str</code></a> column names. If provided, must match the number of columns in <code>data</code>.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>schema</code></td>
<td><code>SchemaLike</code> | None</td>
<td>Optional <a href="../reference/schemas.html#ibis.expr.schema.Schema"><code>Schema</code></a>. The functions use <code>data</code> to infer a schema if not passed.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>name</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</td>
<td>Optional name of the table.</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-49" class="level2">
<h2 class="anchored" data-anchor-id="returns-49">Returns</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 42%">
<col style="width: 57%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Table</code></td>
<td>A table expression backed by in-memory data.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-43" class="level2">
<h2 class="anchored" data-anchor-id="examples-43">Examples</h2>
<div id="5ab2e6a6" class="cell" data-execution_count="509">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable([{<span class="st">"a"</span>: <span class="dv">1</span>}, {<span class="st">"a"</span>: <span class="dv">2</span>}])</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="509">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└───────┘
</pre>
</div>
</div>
<div id="7cc549ab" class="cell" data-execution_count="512">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable([{<span class="st">"a"</span>: <span class="dv">1</span>, <span class="st">"b"</span>: <span class="st">"foo"</span>}, {<span class="st">"a"</span>: <span class="dv">2</span>, <span class="st">"b"</span>: <span class="st">"baz"</span>}])</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="512">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">foo   </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">baz   </span> │
└───────┴────────┘
</pre>
</div>
</div>
<p>Create a table literal without column names embedded in the data and pass <code>columns</code></p>
<div id="21c46837" class="cell" data-execution_count="515">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable([(<span class="dv">1</span>, <span class="st">"foo"</span>), (<span class="dv">2</span>, <span class="st">"baz"</span>)], columns<span class="op">=</span>[<span class="st">"a"</span>, <span class="st">"b"</span>])</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="515">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃<span style="font-weight: bold"> b      </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">foo   </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">baz   </span> │
└───────┴────────┘
</pre>
</div>
</div>
<p>Create a table literal without column names embedded in the data. Ibis generates column names if none are provided.</p>
<div id="62b16c42" class="cell" data-execution_count="518">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable([(<span class="dv">1</span>, <span class="st">"foo"</span>), (<span class="dv">2</span>, <span class="st">"baz"</span>)])</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="518">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> col0  </span>┃<span style="font-weight: bold"> col1   </span>┃
┡━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span> │
├───────┼────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">foo   </span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">baz   </span> │
└───────┴────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.table" class="level1">
<h1>table</h1>
<p><code>ibis.table(schema=None, name=None, catalog=None, database=None)</code></p>
<p>Create a table literal or an abstract table without data.</p>
<p>Ibis uses the word database to refer to a collection of tables, and the word catalog to refer to a collection of databases. You can use a combination of <code>catalog</code> and <code>database</code> to specify a hierarchical location for table.</p>
<section id="parameters-44" class="level2">
<h2 class="anchored" data-anchor-id="parameters-44">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>schema</code></td>
<td><code>SchemaLike</code> | None</td>
<td>A schema for the table</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>name</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</td>
<td>Name for the table. One is generated if this value is <code>None</code>.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>catalog</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</td>
<td>A collection of database.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>database</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</td>
<td>A collection of tables. Required if catalog is not <code>None</code>.</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-50" class="level2">
<h2 class="anchored" data-anchor-id="returns-50">Returns</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Table</code></td>
<td>A table expression</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-44" class="level2">
<h2 class="anchored" data-anchor-id="examples-44">Examples</h2>
<p>Create a table with no data backing it</p>
<div id="3bf36fe1" class="cell" data-execution_count="521">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">False</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.table(schema<span class="op">=</span><span class="bu">dict</span>(a<span class="op">=</span><span class="st">"int"</span>, b<span class="op">=</span><span class="st">"string"</span>), name<span class="op">=</span><span class="st">"t"</span>)</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="521">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">UnboundTable: t
  a int64
  b string
</pre>
</div>
</div>
<p>Create a table with no data backing it in a specific location</p>
<div id="f23533fe" class="cell" data-execution_count="524">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">False</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.table(schema<span class="op">=</span><span class="bu">dict</span>(a<span class="op">=</span><span class="st">"int"</span>), name<span class="op">=</span><span class="st">"t"</span>, catalog<span class="op">=</span><span class="st">"cat"</span>, database<span class="op">=</span><span class="st">"db"</span>)</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="524">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">UnboundTable: cat.db.t
  a int64
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.difference" class="level1">
<h1>difference</h1>
<p><code>ibis.difference(table, *rest, distinct=True)</code></p>
<p>Compute the set difference of multiple table expressions.</p>
<p>The input tables must have identical schemas.</p>
<section id="parameters-45" class="level2">
<h2 class="anchored" data-anchor-id="parameters-45">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>table</code></td>
<td><code>ir</code>.<code>Table</code></td>
<td>A table expression</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>*rest</code></td>
<td><code>ir</code>.<code>Table</code></td>
<td>Additional table expressions</td>
<td><code>()</code></td>
</tr>
<tr class="odd">
<td><code>distinct</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#bool">bool</a></td>
<td>Only diff distinct rows not occurring in the calling table</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-51" class="level2">
<h2 class="anchored" data-anchor-id="returns-51">Returns</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 35%">
<col style="width: 64%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Table</code></td>
<td>The rows present in <code>self</code> that are not present in <code>tables</code>.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-45" class="level2">
<h2 class="anchored" data-anchor-id="examples-45">Examples</h2>
<div id="b8b2c44a" class="cell" data-execution_count="527">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">1</span>, <span class="dv">2</span>]})</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="527">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└───────┘
</pre>
</div>
</div>
<div id="ab09a763" class="cell" data-execution_count="530">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">2</span>, <span class="dv">3</span>]})</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="530">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
└───────┘
</pre>
</div>
</div>
<div id="5cf58b25" class="cell" data-execution_count="533">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.difference(t1, t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="533">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
└───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.intersect" class="level1">
<h1>intersect</h1>
<p><code>ibis.intersect(table, *rest, distinct=True)</code></p>
<p>Compute the set intersection of multiple table expressions.</p>
<p>The input tables must have identical schemas.</p>
<section id="parameters-46" class="level2">
<h2 class="anchored" data-anchor-id="parameters-46">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>table</code></td>
<td><code>ir</code>.<code>Table</code></td>
<td>A table expression</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>*rest</code></td>
<td><code>ir</code>.<code>Table</code></td>
<td>Additional table expressions</td>
<td><code>()</code></td>
</tr>
<tr class="odd">
<td><code>distinct</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#bool">bool</a></td>
<td>Only return distinct rows</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-52" class="level2">
<h2 class="anchored" data-anchor-id="returns-52">Returns</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 35%">
<col style="width: 64%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Table</code></td>
<td>A new table containing the intersection of all input tables.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-46" class="level2">
<h2 class="anchored" data-anchor-id="examples-46">Examples</h2>
<div id="1f155f86" class="cell" data-execution_count="536">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">1</span>, <span class="dv">2</span>]})</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="536">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└───────┘
</pre>
</div>
</div>
<div id="2dc32294" class="cell" data-execution_count="539">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">2</span>, <span class="dv">3</span>]})</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="539">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
└───────┘
</pre>
</div>
</div>
<div id="bad2ac28" class="cell" data-execution_count="542">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.intersect(t1, t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="542">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.union" class="level1">
<h1>union</h1>
<p><code>ibis.union(table, *rest, distinct=False)</code></p>
<p>Compute the set union of multiple table expressions.</p>
<p>The input tables must have identical schemas.</p>
<section id="parameters-47" class="level2">
<h2 class="anchored" data-anchor-id="parameters-47">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>table</code></td>
<td><code>ir</code>.<code>Table</code></td>
<td>A table expression</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>*rest</code></td>
<td><code>ir</code>.<code>Table</code></td>
<td>Additional table expressions</td>
<td><code>()</code></td>
</tr>
<tr class="odd">
<td><code>distinct</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#bool">bool</a></td>
<td>Only return distinct rows</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-53" class="level2">
<h2 class="anchored" data-anchor-id="returns-53">Returns</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Table</code></td>
<td>A new table containing the union of all input tables.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-47" class="level2">
<h2 class="anchored" data-anchor-id="examples-47">Examples</h2>
<div id="c0cdc176" class="cell" data-execution_count="545">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">1</span>, <span class="dv">2</span>]})</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="545">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└───────┘
</pre>
</div>
</div>
<div id="6a25ef52" class="cell" data-execution_count="548">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2 <span class="op">=</span> ibis.memtable({<span class="st">"a"</span>: [<span class="dv">2</span>, <span class="dv">3</span>]})</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="548">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
└───────┘
</pre>
</div>
</div>
<div id="d3311cf7" class="cell" data-execution_count="551">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.union(t1, t2)  <span class="co"># union all by default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="551">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
└───────┘
</pre>
</div>
</div>
<div id="b4a38601" class="cell" data-execution_count="554">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.union(t1, t2, distinct<span class="op">=</span><span class="va">True</span>).order_by(<span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="554">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━┓
┃<span style="font-weight: bold"> a     </span>┃
┡━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├───────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
└───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.join" class="level1">
<h1>join</h1>
<p><code>ibis.join(left, right, predicates=(), how='inner', *, lname='', rname='{name}_right')</code></p>
<p>Perform a join between two tables.</p>
<section id="parameters-48" class="level2">
<h2 class="anchored" data-anchor-id="parameters-48">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>left</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Left table to join</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>right</code></td>
<td><a href="../reference/expression-tables.html#ibis.expr.types.relations.Table">Table</a></td>
<td>Right table to join</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td><code>predicates</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>BooleanColumn</code> | <a href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[True] | <a href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[False] | <a href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>Column</code> | <code>ir</code>.<code>Deferred</code>, <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <code>ir</code>.<code>Column</code> | <code>ir</code>.<code>Deferred</code>]]</td>
<td>Condition(s) to join on. See examples for details.</td>
<td><code>()</code></td>
</tr>
<tr class="even">
<td><code>how</code></td>
<td><code>JoinKind</code></td>
<td>Join method, e.g.&nbsp;<code>"inner"</code> or <code>"left"</code>.</td>
<td><code>'inner'</code></td>
</tr>
<tr class="odd">
<td><code>lname</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>A format string to use to rename overlapping columns in the left table (e.g.&nbsp;<code>"left_{name}"</code>).</td>
<td><code>''</code></td>
</tr>
<tr class="even">
<td><code>rname</code></td>
<td><a href="https://docs.python.org/3/library/stdtypes.html#str">str</a></td>
<td>A format string to use to rename overlapping columns in the right table (e.g.&nbsp;<code>"right_{name}"</code>).</td>
<td><code>'{name}_right'</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-48" class="level2">
<h2 class="anchored" data-anchor-id="examples-48">Examples</h2>
<div id="a04788e2" class="cell" data-execution_count="557">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ibis <span class="im">import</span> _</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> movies <span class="op">=</span> ibis.examples.ml_latest_small_movies.fetch()</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> movies.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="557">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> title                              </span>┃<span style="font-weight: bold"> genres                                      </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                                      │
├─────────┼────────────────────────────────────┼─────────────────────────────────────────────┤
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">Toy Story (1995)                  </span> │ <span style="color: #008000; text-decoration-color: #008000">Adventure|Animation|Children|Comedy|Fantasy</span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">Jumanji (1995)                    </span> │ <span style="color: #008000; text-decoration-color: #008000">Adventure|Children|Fantasy                 </span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">Grumpier Old Men (1995)           </span> │ <span style="color: #008000; text-decoration-color: #008000">Comedy|Romance                             </span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │ <span style="color: #008000; text-decoration-color: #008000">Waiting to Exhale (1995)          </span> │ <span style="color: #008000; text-decoration-color: #008000">Comedy|Drama|Romance                       </span> │
│       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │ <span style="color: #008000; text-decoration-color: #008000">Father of the Bride Part II (1995)</span> │ <span style="color: #008000; text-decoration-color: #008000">Comedy                                     </span> │
└─────────┴────────────────────────────────────┴─────────────────────────────────────────────┘
</pre>
</div>
</div>
<div id="bd919b9f" class="cell" data-execution_count="560">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ratings <span class="op">=</span> ibis.examples.ml_latest_small_ratings.fetch().drop(<span class="st">"timestamp"</span>)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="560">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> userId </span>┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> rating  </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │
├────────┼─────────┼─────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │
└────────┴─────────┴─────────┘
</pre>
</div>
</div>
<p>Equality left join on the shared <code>movieId</code> column. Note the <code>_right</code> suffix added to all overlapping columns from the right table (in this case only the “movieId” column).</p>
<div id="9e8a7ab5" class="cell" data-execution_count="563">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ratings.join(movies, <span class="st">"movieId"</span>, how<span class="op">=</span><span class="st">"left"</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="563">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> userId </span>┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> rating  </span>┃<span style="font-weight: bold"> movieId_right </span>┃<span style="font-weight: bold"> title                       </span>┃<span style="font-weight: bold"> genres                                      </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                                      │
├────────┼─────────┼─────────┼───────────────┼─────────────────────────────┼─────────────────────────────────────────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008000; text-decoration-color: #008000">Toy Story (1995)           </span> │ <span style="color: #008000; text-decoration-color: #008000">Adventure|Animation|Children|Comedy|Fantasy</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008000; text-decoration-color: #008000">Grumpier Old Men (1995)    </span> │ <span style="color: #008000; text-decoration-color: #008000">Comedy|Romance                             </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │ <span style="color: #008000; text-decoration-color: #008000">Heat (1995)                </span> │ <span style="color: #008000; text-decoration-color: #008000">Action|Crime|Thriller                      </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span> │ <span style="color: #008000; text-decoration-color: #008000">Seven (a.k.a. Se7en) (1995)</span> │ <span style="color: #008000; text-decoration-color: #008000">Mystery|Thriller                           </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50</span> │ <span style="color: #008000; text-decoration-color: #008000">Usual Suspects, The (1995) </span> │ <span style="color: #008000; text-decoration-color: #008000">Crime|Mystery|Thriller                     </span> │
└────────┴─────────┴─────────┴───────────────┴─────────────────────────────┴─────────────────────────────────────────────┘
</pre>
</div>
</div>
<p>Explicit equality join using the default <code>how</code> value of <code>"inner"</code>. Note how there is no <code>_right</code> suffix added to the <code>movieId</code> column since this is an inner join and the <code>movieId</code> column is part of the join condition.</p>
<div id="0dc48b77" class="cell" data-execution_count="566">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ratings.join(movies, ratings.movieId <span class="op">==</span> movies.movieId).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="566">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> userId </span>┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> rating  </span>┃<span style="font-weight: bold"> title                       </span>┃<span style="font-weight: bold"> genres                                      </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                                      │
├────────┼─────────┼─────────┼─────────────────────────────┼─────────────────────────────────────────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │ <span style="color: #008000; text-decoration-color: #008000">Toy Story (1995)           </span> │ <span style="color: #008000; text-decoration-color: #008000">Adventure|Animation|Children|Comedy|Fantasy</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │ <span style="color: #008000; text-decoration-color: #008000">Grumpier Old Men (1995)    </span> │ <span style="color: #008000; text-decoration-color: #008000">Comedy|Romance                             </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │ <span style="color: #008000; text-decoration-color: #008000">Heat (1995)                </span> │ <span style="color: #008000; text-decoration-color: #008000">Action|Crime|Thriller                      </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │ <span style="color: #008000; text-decoration-color: #008000">Seven (a.k.a. Se7en) (1995)</span> │ <span style="color: #008000; text-decoration-color: #008000">Mystery|Thriller                           </span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │ <span style="color: #008000; text-decoration-color: #008000">Usual Suspects, The (1995) </span> │ <span style="color: #008000; text-decoration-color: #008000">Crime|Mystery|Thriller                     </span> │
└────────┴─────────┴─────────┴─────────────────────────────┴─────────────────────────────────────────────┘
</pre>
</div>
</div>
<div id="e3d8125c" class="cell" data-execution_count="569">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tags <span class="op">=</span> ibis.examples.ml_latest_small_tags.fetch()</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tags.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="569">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> userId </span>┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> tag             </span>┃<span style="font-weight: bold"> timestamp  </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │
├────────┼─────────┼─────────────────┼────────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60756</span> │ <span style="color: #008000; text-decoration-color: #008000">funny          </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445714994</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60756</span> │ <span style="color: #008000; text-decoration-color: #008000">Highly quotable</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445714996</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60756</span> │ <span style="color: #008000; text-decoration-color: #008000">will ferrell   </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445714992</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">89774</span> │ <span style="color: #008000; text-decoration-color: #008000">Boxing story   </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445715207</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">89774</span> │ <span style="color: #008000; text-decoration-color: #008000">MMA            </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1445715200</span> │
└────────┴─────────┴─────────────────┴────────────┘
</pre>
</div>
</div>
<p>You can join on multiple columns/conditions by passing in a sequence. Find all instances where a user both tagged and rated a movie:</p>
<div id="4a77b671" class="cell" data-execution_count="572">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tags.join(ratings, [<span class="st">"userId"</span>, <span class="st">"movieId"</span>]).head(<span class="dv">5</span>).order_by(<span class="st">"userId"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="572">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━┓
┃<span style="font-weight: bold"> userId </span>┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> tag            </span>┃<span style="font-weight: bold"> timestamp  </span>┃<span style="font-weight: bold"> rating  </span>┃
┡━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │
├────────┼─────────┼────────────────┼────────────┼─────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008000; text-decoration-color: #008000">Robin Williams</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1528843907</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">110</span> │ <span style="color: #008000; text-decoration-color: #008000">sword fight   </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1528152535</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.5</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">410</span> │ <span style="color: #008000; text-decoration-color: #008000">gothic        </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1525636609</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.5</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2023</span> │ <span style="color: #008000; text-decoration-color: #008000">mafia         </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1525636733</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2124</span> │ <span style="color: #008000; text-decoration-color: #008000">quirky        </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1525636846</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │
└────────┴─────────┴────────────────┴────────────┴─────────┘
</pre>
</div>
</div>
<p>To self-join a table with itself, you need to call <code>.view()</code> on one of the arguments so the two tables are distinct from each other.</p>
<p>For crafting more complex join conditions, a valid form of a join condition is a 2-tuple like <code>({left_key}, {right_key})</code>, where each key can be</p>
<ul>
<li>a Column</li>
<li>Deferred expression</li>
<li>lambda of the form (Table) -&gt; Column</li>
</ul>
<p>For example, to find all movies pairings that received the same (ignoring case) tags:</p>
<div id="986a0a07" class="cell" data-execution_count="575">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> movie_tags <span class="op">=</span> tags[<span class="st">"movieId"</span>, <span class="st">"tag"</span>]</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> view <span class="op">=</span> movie_tags.view()</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> movie_tags.join(</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>...     view,</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>...     [</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>...         movie_tags.movieId <span class="op">!=</span> view.movieId,</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>...         (_.tag.lower(), <span class="kw">lambda</span> t: t.tag.lower()),</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>...     ],</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>... ).head().order_by((<span class="st">"movieId"</span>, <span class="st">"movieId_right"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="575">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> movieId </span>┃<span style="font-weight: bold"> tag               </span>┃<span style="font-weight: bold"> movieId_right </span>┃<span style="font-weight: bold"> tag_right         </span>┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>            │
├─────────┼───────────────────┼───────────────┼───────────────────┤
│   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60756</span> │ <span style="color: #008000; text-decoration-color: #008000">funny            </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1732</span> │ <span style="color: #008000; text-decoration-color: #008000">funny            </span> │
│   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60756</span> │ <span style="color: #008000; text-decoration-color: #008000">Highly quotable  </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1732</span> │ <span style="color: #008000; text-decoration-color: #008000">Highly quotable  </span> │
│   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">89774</span> │ <span style="color: #008000; text-decoration-color: #008000">Tom Hardy        </span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">139385</span> │ <span style="color: #008000; text-decoration-color: #008000">tom hardy        </span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">106782</span> │ <span style="color: #008000; text-decoration-color: #008000">drugs            </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1732</span> │ <span style="color: #008000; text-decoration-color: #008000">drugs            </span> │
│  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">106782</span> │ <span style="color: #008000; text-decoration-color: #008000">Leonardo DiCaprio</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5989</span> │ <span style="color: #008000; text-decoration-color: #008000">Leonardo DiCaprio</span> │
└─────────┴───────────────────┴───────────────┴───────────────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.row_number" class="level1">
<h1>row_number</h1>
<p><code>ibis.row_number()</code></p>
<p>Return an analytic function expression for the current row number.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>row_number</code> is normalized across backends to start at 0</p>
</div>
</div>
<section id="returns-54" class="level2">
<h2 class="anchored" data-anchor-id="returns-54">Returns</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 47%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>IntegerColumn</code></td>
<td>A column expression enumerating rows</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-49" class="level2">
<h2 class="anchored" data-anchor-id="examples-49">Examples</h2>
<div id="91e98739" class="cell" data-execution_count="578">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"values"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>]})</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.mutate(rownum<span class="op">=</span>ibis.row_number())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="578">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━┓
┃<span style="font-weight: bold"> values </span>┃<span style="font-weight: bold"> rownum </span>┃
┡━━━━━━━━╇━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │
├────────┼────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
└────────┴────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.rank" class="level1">
<h1>rank</h1>
<p><code>ibis.rank()</code></p>
<p>Compute position of first element within each equal-value group in sorted order.</p>
<p>Equivalent to SQL’s <code>RANK()</code> window function.</p>
<section id="returns-55" class="level2">
<h2 class="anchored" data-anchor-id="returns-55">Returns</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Int64Column</code></td>
<td>The min rank</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-50" class="level2">
<h2 class="anchored" data-anchor-id="examples-50">Examples</h2>
<div id="3dd2d536" class="cell" data-execution_count="581">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"values"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>]})</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.mutate(rank<span class="op">=</span>ibis.rank().over(order_by<span class="op">=</span>t.values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="581">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> values </span>┃<span style="font-weight: bold"> rank  </span>┃
┡━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├────────┼───────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> │
└────────┴───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.dense_rank" class="level1">
<h1>dense_rank</h1>
<p><code>ibis.dense_rank()</code></p>
<p>Position of first element within each group of equal values.</p>
<p>Values are returned in sorted order and duplicate values are ignored.</p>
<p>Equivalent to SQL’s <code>DENSE_RANK()</code>.</p>
<section id="returns-56" class="level2">
<h2 class="anchored" data-anchor-id="returns-56">Returns</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>IntegerColumn</code></td>
<td>The rank</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-51" class="level2">
<h2 class="anchored" data-anchor-id="examples-51">Examples</h2>
<div id="99dbc277" class="cell" data-execution_count="584">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"values"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>]})</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.mutate(rank<span class="op">=</span>ibis.dense_rank().over(order_by<span class="op">=</span>t.values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="584">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> values </span>┃<span style="font-weight: bold"> rank  </span>┃
┡━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├────────┼───────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │
└────────┴───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.percent_rank" class="level1">
<h1>percent_rank</h1>
<p><code>ibis.percent_rank()</code></p>
<p>Return the relative rank of the values in the column.</p>
<section id="returns-57" class="level2">
<h2 class="anchored" data-anchor-id="returns-57">Returns</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>FloatingColumn</code></td>
<td>The percent rank</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-52" class="level2">
<h2 class="anchored" data-anchor-id="examples-52">Examples</h2>
<div id="915a3232" class="cell" data-execution_count="587">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"values"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>]})</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.mutate(pct_rank<span class="op">=</span>ibis.percent_rank().over(order_by<span class="op">=</span>t.values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="587">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━━┓
┃<span style="font-weight: bold"> values </span>┃<span style="font-weight: bold"> pct_rank </span>┃
┡━━━━━━━━╇━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │
├────────┼──────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.4</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.4</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.4</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │
└────────┴──────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.cume_dist" class="level1">
<h1>cume_dist</h1>
<p><code>ibis.cume_dist()</code></p>
<p>Return the cumulative distribution over a window.</p>
<section id="returns-58" class="level2">
<h2 class="anchored" data-anchor-id="returns-58">Returns</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>FloatingColumn</code></td>
<td>The cumulative distribution</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-53" class="level2">
<h2 class="anchored" data-anchor-id="examples-53">Examples</h2>
<div id="b9fc2072" class="cell" data-execution_count="590">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"values"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>]})</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.mutate(dist<span class="op">=</span>ibis.cume_dist().over(order_by<span class="op">=</span>t.values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="590">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━━━━┓
┃<span style="font-weight: bold"> values </span>┃<span style="font-weight: bold"> dist     </span>┃
┡━━━━━━━━╇━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>  │
├────────┼──────────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.333333</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.333333</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.833333</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.833333</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.833333</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.000000</span> │
└────────┴──────────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.ntile" class="level1">
<h1>ntile</h1>
<p><code>ibis.ntile(buckets)</code></p>
<p>Return the integer number of a partitioning of the column values.</p>
<section id="parameters-49" class="level2">
<h2 class="anchored" data-anchor-id="parameters-49">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>buckets</code></td>
<td><a href="https://docs.python.org/3/library/functions.html#int">int</a> | <code>ir</code>.<code>IntegerValue</code></td>
<td>Number of buckets to partition into</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-54" class="level2">
<h2 class="anchored" data-anchor-id="examples-54">Examples</h2>
<div id="90be03a8" class="cell" data-execution_count="593">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> ibis</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> ibis.memtable({<span class="st">"values"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>]})</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t.mutate(ntile<span class="op">=</span>ibis.ntile(<span class="dv">2</span>).over(order_by<span class="op">=</span>t.values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="593">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━┳━━━━━━━┓
┃<span style="font-weight: bold"> values </span>┃<span style="font-weight: bold"> ntile </span>┃
┡━━━━━━━━╇━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span> │
├────────┼───────┤
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
│      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │
└────────┴───────┘
</pre>
</div>
</div>
</section>
</section>
<section id="ibis.window" class="level1">
<h1>window</h1>
<p><code>ibis.window(preceding=None, following=None, order_by=None, group_by=None, *, rows=None, range=None, between=None)</code></p>
<p>Create a window clause for use with window functions.</p>
<p>The <code>ROWS</code> window clause includes peer rows based on differences in row <strong>number</strong> whereas <code>RANGE</code> includes rows based on the differences in row <strong>value</strong> of a single <code>order_by</code> expression.</p>
<p>All window frame bounds are inclusive.</p>
<section id="parameters-50" class="level2">
<h2 class="anchored" data-anchor-id="parameters-50">Parameters</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 65%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>preceding</code></td>
<td></td>
<td>Number of preceding rows in the window</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>following</code></td>
<td></td>
<td>Number of following rows in the window</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>group_by</code></td>
<td></td>
<td>Grouping key</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>order_by</code></td>
<td></td>
<td>Ordering key</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>rows</code></td>
<td></td>
<td>Whether to use the <code>ROWS</code> window clause</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>range</code></td>
<td></td>
<td>Whether to use the <code>RANGE</code> window clause</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>between</code></td>
<td></td>
<td>Automatically infer the window kind based on the boundaries</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-59" class="level2">
<h2 class="anchored" data-anchor-id="returns-59">Returns</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Window</code></td>
<td>A window frame</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.cumulative_window" class="level1">
<h1>cumulative_window</h1>
<p><code>ibis.cumulative_window(group_by=None, order_by=None)</code></p>
<p>Create a cumulative window for use with window functions.</p>
<p>All window frames / ranges are inclusive.</p>
<section id="parameters-51" class="level2">
<h2 class="anchored" data-anchor-id="parameters-51">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>group_by</code></td>
<td></td>
<td>Grouping key</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>order_by</code></td>
<td></td>
<td>Ordering key</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-60" class="level2">
<h2 class="anchored" data-anchor-id="returns-60">Returns</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Window</code></td>
<td>A window frame</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.range_window" class="level1">
<h1>range_window</h1>
<p><code>ibis.range_window(preceding=None, following=None, group_by=None, order_by=None)</code></p>
<p>Create a range-based window clause for use with window functions.</p>
<p>This RANGE window clause aggregates rows based upon differences in the value of the order-by expression.</p>
<p>All window frames / ranges are inclusive.</p>
<section id="parameters-52" class="level2">
<h2 class="anchored" data-anchor-id="parameters-52">Parameters</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 11%">
<col style="width: 55%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>preceding</code></td>
<td></td>
<td>Number of preceding rows in the window</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>following</code></td>
<td></td>
<td>Number of following rows in the window</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>group_by</code></td>
<td></td>
<td>Grouping key</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td><code>order_by</code></td>
<td></td>
<td>Ordering key</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-61" class="level2">
<h2 class="anchored" data-anchor-id="returns-61">Returns</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Window</code></td>
<td>A window frame</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.trailing_range_window" class="level1">
<h1>trailing_range_window</h1>
<p><code>ibis.trailing_range_window(preceding, order_by, group_by=None)</code></p>
<p>Create a trailing range window for use with window functions.</p>
<section id="parameters-53" class="level2">
<h2 class="anchored" data-anchor-id="parameters-53">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>preceding</code></td>
<td></td>
<td>A value expression</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>order_by</code></td>
<td></td>
<td>Ordering key</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td><code>group_by</code></td>
<td></td>
<td>Grouping key</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-62" class="level2">
<h2 class="anchored" data-anchor-id="returns-62">Returns</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Window</code></td>
<td>A window frame</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ibis.trailing_window" class="level1">
<h1>trailing_window</h1>
<p><code>ibis.trailing_window(preceding, group_by=None, order_by=None)</code></p>
<p>Create a trailing window for use with window functions.</p>
<section id="parameters-54" class="level2">
<h2 class="anchored" data-anchor-id="parameters-54">Parameters</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>preceding</code></td>
<td></td>
<td>The number of preceding rows</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td><code>group_by</code></td>
<td></td>
<td>Grouping key</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td><code>order_by</code></td>
<td></td>
<td>Ordering key</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-63" class="level2">
<h2 class="anchored" data-anchor-id="returns-63">Returns</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Window</code></td>
<td>A window frame</td>
</tr>
</tbody>
</table>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ibis-project\.org");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ibis-project/ibis/edit/main/docs/reference/expression-tables.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ibis-project/ibis/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ibis-project">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://ibis-project.zulipchat.com">
      <i class="bi bi-zulip" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://ibis-project.org/posts.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>