{
  "hash": "b777fdee8d50ae460617f4078c6145bf",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Snow IO: loading data from other DBs into Snowflake\"\nauthor: \"Phillip Cloud\"\nerror: false\ndate: \"2024-03-06\"\ncategories:\n  - blog\n  - snowflake\n  - io\n  - productivity\n---\n\n## Recap\n\nWe've [blogged about Snowflake IO before](../snowflake-io/index.qmd), in the\ncontext of getting local files into Snowflake as fast as possible.\n\nIn this post, we'll show how to insert query results from another system into\nSnowflake, using Ibis.\n\n## Setup\n\n### Connect to your non-Snowflake system\n\nWe'll connect to a postgres database running locally in a container. You\nshould be able to swap in your own connection details as needed.\n\n::: {#52dc2246 .cell execution_count=1}\n``` {.python .cell-code}\nfrom ibis.interactive import *  # <1>\n\npg_con = ibis.connect(\"postgres://postgres:postgres@localhost/postgres\")\n```\n:::\n\n\n1. Import Ibis for maximum productivity in interactive analysis.\n\nWe'll use a test dataset that contains some baseball batting statistics.\n\nIbis provides that example data, so we can dump that into postgres.\n\n::: {#c9ed5f4c .cell execution_count=2}\n``` {.python .cell-code}\npg_batting = pg_con.create_table(\n    \"batting\",\n    ibis.examples.Batting.fetch().to_pandas(),  # <1>\n    temp=True,  # <2>\n)\n```\n:::\n\n\n1. Yep, I'm using pandas here!\n2. Use a temporary table to avoid cluttering up the database.\n\n### Connect to Snowflake\n\n::: {#5f332c9a .cell execution_count=3}\n``` {.python .cell-code}\nimport os\n\n# snowflake://user:pass@account/database/schema?warehouse=my_warehouse\nsnow_con = ibis.connect(os.environ[\"SNOWFLAKE_URL\"])  # <1>\n```\n:::\n\n\n1. Set the `SNOWFLAKE_URL` environment variable to your Snowflake connection string.\n\n## Profit\n\n### Construct an Ibis expression from the postgres data\n\nLet's build an Ibis expression based on the `batting` table in our postgres database.\n\n::: {#842f6246 .cell execution_count=4}\n``` {.python .cell-code}\npg_batting\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> player_id </span>┃<span style=\"font-weight: bold\"> year_id </span>┃<span style=\"font-weight: bold\"> stint </span>┃<span style=\"font-weight: bold\"> team_id </span>┃<span style=\"font-weight: bold\"> lg_id  </span>┃<span style=\"font-weight: bold\"> g     </span>┃<span style=\"font-weight: bold\"> ab    </span>┃<span style=\"font-weight: bold\"> r     </span>┃<span style=\"font-weight: bold\"> h     </span>┃<span style=\"font-weight: bold\"> x2b   </span>┃<span style=\"font-weight: bold\"> x3b   </span>┃<span style=\"font-weight: bold\"> hr    </span>┃<span style=\"font-weight: bold\"> rbi     </span>┃<span style=\"font-weight: bold\"> sb      </span>┃<span style=\"font-weight: bold\"> cs      </span>┃<span style=\"font-weight: bold\"> bb    </span>┃<span style=\"font-weight: bold\"> so      </span>┃<span style=\"font-weight: bold\"> ibb     </span>┃<span style=\"font-weight: bold\"> hbp     </span>┃<span style=\"font-weight: bold\"> sh      </span>┃<span style=\"font-weight: bold\"> sf      </span>┃<span style=\"font-weight: bold\"> gidp    </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │\n├───────────┼─────────┼───────┼─────────┼────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼─────────┼─────────┼─────────┼───────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">abercda01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1871</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">TRO    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">NA    </span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">addybo01 </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1871</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">RC1    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">NA    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">25</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">118</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">30</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">allisar01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1871</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">CL1    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">NA    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">29</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">137</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">28</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">40</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">allisdo01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1871</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">WS3    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">NA    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">27</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">133</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">28</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">44</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">27.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ansonca01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1871</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">RC1    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">NA    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">25</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">120</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">29</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">armstbo01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1871</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">FW1    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">NA    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">49</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">barkeal01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1871</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">RC1    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">NA    </span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">barnero01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1871</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">BS1    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">NA    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">157</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">66</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">63</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">34.0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6.0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">barrebi01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1871</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">FW1    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">NA    </span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">barrofr01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1871</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">BS1    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">NA    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">86</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>      │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└───────────┴─────────┴───────┴─────────┴────────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴─────────┴─────────┴─────────┴───────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┘\n</pre>\n```\n:::\n:::\n\n\nWe can compute the average [RBI](https://en.wikipedia.org/wiki/Run_batted_in) per year per team.\n\n::: {#0fe95f00 .cell execution_count=5}\n``` {.python .cell-code}\npg_expr = pg_batting.group_by((\"year_id\", \"team_id\")).agg(avg_rbi=_.rbi.mean())\npg_expr\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> year_id </span>┃<span style=\"font-weight: bold\"> team_id </span>┃<span style=\"font-weight: bold\"> avg_rbi   </span>┃\n┡━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>   │\n├─────────┼─────────┼───────────┤\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1891</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">PIT    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22.782609</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1895</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">BSN    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">34.363636</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1940</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">SLA    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22.343750</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1981</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">HOU    </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.972973</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1913</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">CLE    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13.512821</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1971</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MON    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.181818</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">PIT    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.000000</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1895</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">WAS    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">23.096774</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2011</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">KCA    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16.785714</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MIL    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.350000</span> │\n│       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴─────────┴───────────┘\n</pre>\n```\n:::\n:::\n\n\nWe can also rename columns to be more consistent with typical Snowflake usage.\n\n::: {#c75c8ff3 .cell execution_count=6}\n``` {.python .cell-code}\npg_expr = pg_expr.rename(\"ALL_CAPS\")\npg_expr\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> YEAR_ID </span>┃<span style=\"font-weight: bold\"> TEAM_ID </span>┃<span style=\"font-weight: bold\"> AVG_RBI   </span>┃\n┡━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>   │\n├─────────┼─────────┼───────────┤\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1891</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">PIT    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22.782609</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1895</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">BSN    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">34.363636</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1940</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">SLA    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22.343750</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1981</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">HOU    </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.972973</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1913</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">CLE    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13.512821</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1971</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MON    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.181818</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">PIT    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.000000</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1895</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">WAS    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">23.096774</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2011</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">KCA    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16.785714</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MIL    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.350000</span> │\n│       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴─────────┴───────────┘\n</pre>\n```\n:::\n:::\n\n\nLet's show how many rows we have in the result.\n\n::: {#ac4befe6 .cell execution_count=7}\n``` {.python .cell-code}\npg_expr.count()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=8}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-cyan-fg ansi-bold\">3015</span></pre>\n```\n:::\n\n:::\n:::\n\n\n### Insert the computed results into Snowflake\n\nBecause all Ibis backends implement the `to_pyarrow()` method, we can\nget data out of another system and into Snowflake with a few lines of code.\n\nFirst we'll create a table in Snowflake to hold the data.\n\nIbis helps here by providing an API to access the schema from the\n**postgres**-based expression, and automatically translates postgres types into\nSnowflake types.\n\n::: {#22568a53 .cell execution_count=8}\n``` {.python .cell-code}\nsnow_table = snow_con.create_table(\"pg_batting\", schema=pg_expr.schema(), temp=True)  # <1>\n```\n:::\n\n\n1. By default the table will be created in the database and schema of the\n   current connection.\n\n   We create a temporary table for the same reason we do with postgres above.\n\n\nWe'll show that the table is empty to sanity check ourselves.\n\n::: {#dc8f71fa .cell execution_count=9}\n``` {.python .cell-code}\nsnow_table\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> YEAR_ID </span>┃<span style=\"font-weight: bold\"> TEAM_ID </span>┃<span style=\"font-weight: bold\"> AVG_RBI </span>┃\n┡━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │\n└─────────┴─────────┴─────────┘\n</pre>\n```\n:::\n:::\n\n\nInsert the expression's result table into Snowflake.\n\n::: {#01bcdc29 .cell execution_count=10}\n``` {.python .cell-code}\nsnow_con.insert(\"pg_batting\", pg_expr.to_pyarrow())\n```\n:::\n\n\nTo sanity check what we've done let's peek at the table.\n\n::: {#e7a29528 .cell execution_count=11}\n``` {.python .cell-code}\nsnow_table\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> YEAR_ID </span>┃<span style=\"font-weight: bold\"> TEAM_ID </span>┃<span style=\"font-weight: bold\"> AVG_RBI   </span>┃\n┡━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>   │\n├─────────┼─────────┼───────────┤\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1891</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">PIT    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22.782609</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1895</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">BSN    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">34.363636</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1940</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">SLA    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22.343750</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1981</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">HOU    </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.972973</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1913</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">CLE    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13.512821</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1971</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MON    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.181818</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">PIT    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.000000</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1895</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">WAS    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">23.096774</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2011</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">KCA    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16.785714</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MIL    </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.350000</span> │\n│       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴─────────┴───────────┘\n</pre>\n```\n:::\n:::\n\n\nWe'll count them too, to be extra sure.\n\n::: {#0b854a6c .cell execution_count=12}\n``` {.python .cell-code}\nsnow_table.count()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=13}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-cyan-fg ansi-bold\">3015</span></pre>\n```\n:::\n\n:::\n:::\n\n\n## Conclusion\n\nIn this post we show how easy it is to move data from one backend into Snowflake using Ibis.\n\nPlease try it out and get in touch on [Zulip](https://ibis-project.zulipchat.com/) or\n[GitHub](https://github.com/ibis-project/ibis), we'd love to hear from you!\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}