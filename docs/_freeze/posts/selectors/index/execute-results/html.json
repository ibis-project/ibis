{
  "hash": "f2bd6b42420644f3c1ab498e75534819",
  "result": {
    "markdown": "---\ntitle: \"Maximizing productivity with selectors\"\nauthor: Phillip Cloud\ndate: 2023-02-27\ncategories:\n    - blog\n    - new feature\n    - productivity\n    - duckdb\n---\n\nBefore Ibis 5.0 it's been challenging to concisely express whole-table\noperations with ibis. Happily this is no longer the case in ibis 5.0.\n\nLet's jump right in!\n\nWe'll look at selectors examples using the [`palmerpenguins` data\nset](https://allisonhorst.github.io/palmerpenguins/) with the [DuckDB\nbackend](../../backends/duckdb.qmd).\n\n## Setup\n\n::: {#ba6b57fd .cell execution_count=1}\n``` {.python .cell-code}\nfrom ibis.interactive import *\n\nt = ex.penguins.fetch()\nt\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island    </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.7</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">181</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3750</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.5</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.4</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">186</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3800</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">40.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.0</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">195</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3250</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">36.7</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.3</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">193</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3450</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3650</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38.9</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.8</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">181</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3625</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">195</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4675</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">34.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.1</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">193</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3475</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42.0</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20.2</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4250</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │             <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>      │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\n## Examples\n\n### Normalization\n\nLet's say you want to compute the\n[z-score](https://en.wikipedia.org/wiki/Standard_score) of every numeric column\nand replace the existing data with that normalized value. Here's how you'd do\nthat with selectors:\n\n::: {#c36a2829 .cell execution_count=2}\n``` {.python .cell-code}\nt.mutate(s.across(s.numeric(), (_ - _.mean()) / _.std()))\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island    </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year      </span>┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>   │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.883205</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.784300</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.416272</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.563317</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.257484</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.809939</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.126003</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.060696</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.500969</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.257484</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.663408</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.429833</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.420660</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.186793</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.257484</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.257484</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.322799</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.088129</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.562890</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.937403</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.257484</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.846572</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.746426</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.776236</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.688012</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.257484</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.919837</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.328556</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.416272</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.719186</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.257484</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.864888</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.240044</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.420660</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.590115</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.257484</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.799025</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.480471</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.562890</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.906229</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.257484</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.352029</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.543873</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.776236</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.060160</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.257484</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │             <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>      │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────────┘\n</pre>\n```\n:::\n:::\n\n\n### What's Up With the `year` Column?\n\nWhoops, looks like we included `year` in our normalization because it's an\n`int64` column (and therefore numeric) but normalizing the year doesn't make\nsense.\n\nWe can exclude `year` from the normalization using another selector:\n\n::: {#7c987863 .cell execution_count=3}\n``` {.python .cell-code}\nt.mutate(s.across(s.numeric() & ~s.c(\"year\"), (_ - _.mean()) / _.std()))\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island    </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.883205</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.784300</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.416272</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.563317</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.809939</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.126003</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.060696</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.500969</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.663408</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.429833</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.420660</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.186793</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.322799</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.088129</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.562890</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.937403</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.846572</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.746426</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.776236</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.688012</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.919837</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.328556</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.416272</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.719186</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.864888</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.240044</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.420660</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.590115</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.799025</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.480471</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.562890</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.906229</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.352029</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.543873</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.776236</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.060160</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │             <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>      │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\n`c` is short for \"column\" and the `~` means \"negate\". Combining those we get \"not the year column\"!\n\nPretty neat right?\n\n### Composable Group By\n\nThe power of this approach comes in when you want the grouped version. Perhaps\nwe think some of these columns vary by species.\n\nWith selectors, all you need to do is slap a `.group_by(\"species\")` onto `t`:\n\n::: {#fe399083 .cell execution_count=4}\n``` {.python .cell-code}\nt.group_by(\"species\").mutate(\n    s.across(s.numeric() & ~s.c(\"year\"), (_ - _.mean()) / _.std())\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island    </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.791697</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.270997</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.160007</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.001444</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe   </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.467524</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.038103</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.924596</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.816322</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2009</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream    </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.378692</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.619441</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.910418</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.070231</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream    </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.860324</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.284681</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.216254</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.200835</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.785232</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.783827</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.465843</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.546622</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.190962</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.852335</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.007089</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.110480</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.040778</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.449067</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.369172</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.164997</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.153416</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.030405</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.771678</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.124749</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.761426</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.202489</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.465843</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.492104</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.204702</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.523563</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.007089</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.197947</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │             <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>      │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\nSince ibis translates this into a run-of-the-mill selection as if you had\ncalled `select` or `mutate` without selectors, nothing special is needed for a\nbackend to work with these new constructs.\n\nLet's look at some more examples.\n\n### Min-max Normalization\n\nGrouped min/max normalization? Easy:\n\n::: {#f95a9fbf .cell execution_count=5}\n``` {.python .cell-code}\nt.group_by(\"species\").mutate(\n    s.across(s.numeric() & ~s.c(\"year\"), (_ - _.min()) / (_.max() - _.min()))\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island    </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.633094</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.216667</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.500000</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.441558</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe   </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.762590</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.466667</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.631579</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.636364</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2009</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream    </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.553957</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.600000</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.315789</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.935065</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream    </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.316547</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.416667</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.263158</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.155844</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.330935</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.633333</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.552632</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.311688</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.517986</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.850000</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.473684</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.415584</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.489209</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.383333</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.236842</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.402597</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.510791</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.683333</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.605263</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.948052</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.143885</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.433333</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.552632</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.324675</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.712230</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.783333</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.473684</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.727273</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │             <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>      │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\n### Casting and Munging\n\nHow about casting every column whose name ends with any of the strings `\"mm\"`\nor `\"g\"` to a `float32`? No problem!\n\n::: {#c1d8dafb .cell execution_count=6}\n``` {.python .cell-code}\nt.mutate(s.across(s.endswith((\"mm\", \"g\")), _.cast(\"float32\")))\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island    </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float32</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float32</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float32</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float32</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.099998</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.700001</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">181.0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3750.0</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.500000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.400000</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">186.0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3800.0</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">40.299999</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.000000</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">195.0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3250.0</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">36.700001</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.299999</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">193.0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3450.0</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.299999</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20.600000</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190.0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3650.0</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38.900002</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.799999</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">181.0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3625.0</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.200001</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.600000</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">195.0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4675.0</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">34.099998</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.100000</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">193.0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3475.0</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42.000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20.200001</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190.0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4250.0</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │             <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>      │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\nWe can make all string columns have the same case too!\n\n::: {#bb938f39 .cell execution_count=7}\n``` {.python .cell-code}\nt.mutate(s.across(s.of_type(\"string\"), _.lower()))\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island    </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.7</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">181</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3750</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.5</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.4</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">186</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3800</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">40.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.0</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">195</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3250</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">torgersen</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">36.7</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.3</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">193</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3450</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3650</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38.9</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.8</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">181</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3625</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">195</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4675</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">34.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.1</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">193</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3475</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42.0</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20.2</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4250</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │             <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>      │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\n### Multiple Computations per Column\n\nWhat if I want to compute multiple things? Heck yeah!\n\n::: {#d4c94ff9 .cell execution_count=8}\n``` {.python .cell-code}\nt.group_by(\"sex\").mutate(\n    s.across(\n        s.numeric() & ~s.c(\"year\"),\n        dict(centered=_ - _.mean(), zscore=(_ - _.mean()) / _.std()),\n    )\n).select(\"sex\", s.endswith((\"_centered\", \"_zscore\")))\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> bill_length_mm_centered </span>┃<span style=\"font-weight: bold\"> bill_depth_mm_centered </span>┃<span style=\"font-weight: bold\"> flipper_length_mm_centered </span>┃<span style=\"font-weight: bold\"> body_mass_g_centered </span>┃<span style=\"font-weight: bold\"> bill_length_mm_zscore </span>┃<span style=\"font-weight: bold\"> bill_depth_mm_zscore </span>┃<span style=\"font-weight: bold\"> flipper_length_mm_zscore </span>┃<span style=\"font-weight: bold\"> body_mass_g_zscore </span>┃\n┡━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>            │\n├────────┼─────────────────────────┼────────────────────────┼────────────────────────────┼──────────────────────┼───────────────────────┼──────────────────────┼──────────────────────────┼────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.10303</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.925455</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.636364</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">937.727273</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.836760</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.072270</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.930851</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.407635</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.20303</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-2.425455</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10.636364</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">712.727273</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.245342</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.350716</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.850856</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.069885</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-8.09697</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.674545</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-12.363636</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-462.272727</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.651271</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.375649</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.989030</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.693924</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-5.89697</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.874545</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-10.363636</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-562.272727</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.202610</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.487027</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.829039</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.844035</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.99697</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.174545</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-15.363636</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-662.272727</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.203319</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.654095</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.229015</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.994147</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-5.49697</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.374545</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-12.363636</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-162.272727</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.121035</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.765473</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.989030</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.243590</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-3.39697</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.574545</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-2.363636</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-412.272727</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.692768</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.433743</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.189079</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.618868</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-7.69697</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.974545</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-13.363636</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-537.272727</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.569697</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.099608</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.069025</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.806507</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-4.29697</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.874545</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-23.363636</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-462.272727</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.876311</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.043919</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.868975</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.693924</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-6.19697</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.774545</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-8.363636</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-62.272727</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.263791</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.545122</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.669049</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.093478</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>      │                       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                      <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                    <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                    <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└────────┴─────────────────────────┴────────────────────────┴────────────────────────────┴──────────────────────┴───────────────────────┴──────────────────────┴──────────────────────────┴────────────────────┘\n</pre>\n```\n:::\n:::\n\n\nDon't like the naming convention?\n\nPass a function to make your own name!\n\n::: {#aeb79ffa .cell execution_count=9}\n``` {.python .cell-code}\nt.select(s.startswith(\"bill\")).mutate(\n    s.across(\n        s.all(),\n        dict(x=_ - _.mean(), y=_.max()),\n        names=lambda col, fn: f\"{col}_{fn}_improved\",\n    )\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> bill_length_mm_x_improved </span>┃<span style=\"font-weight: bold\"> bill_depth_mm_x_improved </span>┃<span style=\"font-weight: bold\"> bill_length_mm_y_improved </span>┃<span style=\"font-weight: bold\"> bill_depth_mm_y_improved </span>┃\n┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                  │\n├────────────────┼───────────────┼───────────────────────────┼──────────────────────────┼───────────────────────────┼──────────────────────────┤\n│           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.7</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-4.82193</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.54883</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n│           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.5</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.4</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-4.42193</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.24883</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n│           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">40.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.0</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-3.62193</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.84883</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n│            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │                       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">nan</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n│           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">36.7</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.3</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-7.22193</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.14883</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n│           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20.6</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-4.62193</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.44883</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n│           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38.9</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.8</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-5.02193</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.64883</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n│           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.6</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-4.72193</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.44883</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n│           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">34.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.1</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-9.82193</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.94883</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n│           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42.0</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20.2</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.92193</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.04883</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n│              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │             <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└────────────────┴───────────────┴───────────────────────────┴──────────────────────────┴───────────────────────────┴──────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\nDon't like lambda functions? We support a format string too!\n\n::: {#5f3dd2c1 .cell execution_count=10}\n``` {.python .cell-code}\nt.select(s.startswith(\"bill\")).mutate(\n    s.across(\n        s.all(),\n        func=dict(x=_ - _.mean(), y=_.max()),\n        names=\"{col}_{fn}_improved\",\n    )\n).head(2)\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> bill_length_mm_x_improved </span>┃<span style=\"font-weight: bold\"> bill_depth_mm_x_improved </span>┃<span style=\"font-weight: bold\"> bill_length_mm_y_improved </span>┃<span style=\"font-weight: bold\"> bill_depth_mm_y_improved </span>┃\n┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                  │\n├────────────────┼───────────────┼───────────────────────────┼──────────────────────────┼───────────────────────────┼──────────────────────────┤\n│           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.7</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-4.82193</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.54883</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n│           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.5</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.4</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-4.42193</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.24883</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │\n└────────────────┴───────────────┴───────────────────────────┴──────────────────────────┴───────────────────────────┴──────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n### Working with other Ibis APIs\n\nWe've seen lots of mutate use, but selectors also work with `.agg`:\n\n::: {#6b61a552 .cell execution_count=11}\n``` {.python .cell-code}\nt.group_by(\"year\").agg(s.across(s.numeric() & ~s.c(\"year\"), _.mean())).order_by(\"year\")\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> year  </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃\n┡━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>     │\n├───────┼────────────────┼───────────────┼───────────────────┼─────────────┤\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">43.740367</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.427523</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">196.880734</span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4124.541284</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">43.541228</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16.914035</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">202.798246</span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4266.666667</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2009</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">44.452941</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.125210</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">202.806723</span> │ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4210.294118</span> │\n└───────┴────────────────┴───────────────┴───────────────────┴─────────────┘\n</pre>\n```\n:::\n:::\n\n\nNaturally, selectors work in grouping keys too, for even more convenience:\n\n::: {#4d5a0118 .cell execution_count=12}\n``` {.python .cell-code}\nt.group_by(~s.numeric() | s.c(\"year\")).mutate(\n    s.across(s.numeric() & ~s.c(\"year\"), dict(centered=_ - _.mean(), std=_.std()))\n).select(\"species\", s.endswith((\"_centered\", \"_std\")))\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> bill_length_mm_centered </span>┃<span style=\"font-weight: bold\"> bill_depth_mm_centered </span>┃<span style=\"font-weight: bold\"> flipper_length_mm_centered </span>┃<span style=\"font-weight: bold\"> body_mass_g_centered </span>┃<span style=\"font-weight: bold\"> bill_length_mm_std </span>┃<span style=\"font-weight: bold\"> bill_depth_mm_std </span>┃<span style=\"font-weight: bold\"> flipper_length_mm_std </span>┃<span style=\"font-weight: bold\"> body_mass_g_std </span>┃\n┡━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>         │\n├─────────┼─────────────────────────┼────────────────────────┼────────────────────────────┼──────────────────────┼────────────────────┼───────────────────┼───────────────────────┼─────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.46</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.400000</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.600000</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-170.000000</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.327780</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.681909</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.302173</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">189.076704</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.96</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.200000</span> │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.400000</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">180.000000</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.327780</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.681909</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.302173</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">189.076704</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.36</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.100000</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.600000</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">30.000000</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.327780</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.681909</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.302173</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">189.076704</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │                    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.44</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.300000</span> │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.400000</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-220.000000</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.327780</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.681909</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.302173</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">189.076704</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │                    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.34</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.600000</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.600000</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">180.000000</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.327780</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.681909</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.302173</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">189.076704</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │                    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.00</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.935294</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.117647</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">147.058824</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.056755</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.670766</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.973459</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">349.763576</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │                    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.00</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.164706</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.882353</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">147.058824</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.056755</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.670766</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.973459</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">349.763576</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.40</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.864706</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-3.882353</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-152.941176</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.056755</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.670766</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.973459</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">349.763576</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-2.30</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.064706</span> │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.117647</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-352.941176</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.056755</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.670766</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.973459</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">349.763576</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-2.20</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.035294</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-3.882353</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-402.941176</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.056755</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.670766</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.973459</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">349.763576</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │                       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                      <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                    <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │               <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴─────────────────────────┴────────────────────────┴────────────────────────────┴──────────────────────┴────────────────────┴───────────────────┴───────────────────────┴─────────────────┘\n</pre>\n```\n:::\n:::\n\n\n### Filtering Selectors\n\nYou can also express complex filters more concisely.\n\nLet's say we only want to keep rows where all the bill size z-score related\ncolumns' absolute values are greater than 2.\n\n::: {#c4a578ce .cell execution_count=13}\n``` {.python .cell-code}\nt.drop(\"year\").group_by(\"species\").mutate(\n    s.across(s.numeric(), dict(zscore=(_ - _.mean()) / _.std()))\n).filter(s.if_all(s.startswith(\"bill\") & s.endswith(\"_zscore\"), _.abs() > 2))\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island    </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> bill_length_mm_zscore </span>┃<span style=\"font-weight: bold\"> bill_depth_mm_zscore </span>┃<span style=\"font-weight: bold\"> flipper_length_mm_zscore </span>┃<span style=\"font-weight: bold\"> body_mass_g_zscore </span>┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>            │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────────────────────┼──────────────────────┼──────────────────────────┼────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">46.0</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.5</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">194</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4200</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.706539</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.592071</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.618760</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.088911</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream    </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.5</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">188</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3050</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-2.512345</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-2.339505</span> │                <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.298747</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.418906</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe   </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">55.9</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.0</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">228</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5600</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.724046</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.056508</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.667394</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.039411</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe   </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.6</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.0</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">230</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6050</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.924621</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.056508</span> │                 <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.975799</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.932062</span> │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────────────────────┴──────────────────────┴──────────────────────────┴────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n### Bonus: Generated SQL\n\nThe SQL for that last expression is pretty gnarly:\n\n::: {#9890792a .cell execution_count=14}\n``` {.python .cell-code}\nibis.to_sql(\n    t.drop(\"year\")\n    .group_by(\"species\")\n    .mutate(s.across(s.numeric(), dict(zscore=(_ - _.mean()) / _.std())))\n    .filter(s.if_all(s.startswith(\"bill\") & s.endswith(\"_zscore\"), _.abs() > 2))\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```sql\nWITH t0 AS (\n  SELECT\n    t2.species AS species,\n    t2.island AS island,\n    t2.bill_length_mm AS bill_length_mm,\n    t2.bill_depth_mm AS bill_depth_mm,\n    t2.flipper_length_mm AS flipper_length_mm,\n    t2.body_mass_g AS body_mass_g,\n    t2.sex AS sex\n  FROM main._ibis_examples_penguins_mqqdnfaydfbevoowdsf7djbsom AS t2\n), t1 AS (\n  SELECT\n    t0.species AS species,\n    t0.island AS island,\n    t0.bill_length_mm AS bill_length_mm,\n    t0.bill_depth_mm AS bill_depth_mm,\n    t0.flipper_length_mm AS flipper_length_mm,\n    t0.body_mass_g AS body_mass_g,\n    t0.sex AS sex,\n    (\n      t0.bill_length_mm - AVG(t0.bill_length_mm) OVER (PARTITION BY t0.species ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n    ) / STDDEV_SAMP(t0.bill_length_mm) OVER (PARTITION BY t0.species ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS bill_length_mm_zscore,\n    (\n      t0.bill_depth_mm - AVG(t0.bill_depth_mm) OVER (PARTITION BY t0.species ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n    ) / STDDEV_SAMP(t0.bill_depth_mm) OVER (PARTITION BY t0.species ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS bill_depth_mm_zscore,\n    (\n      t0.flipper_length_mm - AVG(t0.flipper_length_mm) OVER (PARTITION BY t0.species ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n    ) / STDDEV_SAMP(t0.flipper_length_mm) OVER (PARTITION BY t0.species ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS flipper_length_mm_zscore,\n    (\n      t0.body_mass_g - AVG(t0.body_mass_g) OVER (PARTITION BY t0.species ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n    ) / STDDEV_SAMP(t0.body_mass_g) OVER (PARTITION BY t0.species ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS body_mass_g_zscore\n  FROM t0\n)\nSELECT\n  t1.species,\n  t1.island,\n  t1.bill_length_mm,\n  t1.bill_depth_mm,\n  t1.flipper_length_mm,\n  t1.body_mass_g,\n  t1.sex,\n  t1.bill_length_mm_zscore,\n  t1.bill_depth_mm_zscore,\n  t1.flipper_length_mm_zscore,\n  t1.body_mass_g_zscore\nFROM t1\nWHERE\n  ABS(t1.bill_length_mm_zscore) > CAST(2 AS TINYINT)\n  AND ABS(t1.bill_depth_mm_zscore) > CAST(2 AS TINYINT)\n```\n:::\n:::\n\n\nGood thing you didn't have to write that by hand!\n\n## Summary\n\nThis blog post illustrates the ability to apply computations to many columns at\nonce and the power of ibis as a composable, expressive library for analytics.\n\n- [Get involved!](../../contribute/index.md)\n- [Report issues!](https://github.com/ibis-project/ibis/issues/new/choose)\n\n",
    "supporting": [
      "index_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}