{
  "hash": "47440a350432e93f85e6ed6553cc40f0",
  "result": {
    "markdown": "---\ntitle: Working with arrays in Google BigQuery\nauthor: \"Phillip Cloud\"\ndate: \"2023-09-12\"\ncategories:\n    - blog\n    - bigquery\n    - arrays\n    - cloud\n---\n\n## Introduction\n\nIbis and BigQuery have [worked well together for years](https://cloud.google.com/blog/products/data-analytics/ibis-and-bigquery-scalable-analytics-comfort-python).\n\nIn Ibis 7.0.0, they work even better together with the addition of array\nfunctionality for BigQuery.\n\nLet's look at some examples using BigQuery's [IMDB sample\ndata](https://developer.imdb.com/non-commercial-datasets/).\n\n## Basics\n\nFirst we'll connect to BigQuery and pluck out a table to work with.\n\nWe'll start with `from ibis.interactive import *` for maximum convenience.\n\n::: {#75a9d26f .cell execution_count=1}\n``` {.python .cell-code}\nfrom ibis.interactive import *\n\ncon = ibis.connect(\"bigquery://ibis-gbq\")  # <1>\ncon.set_database(\"bigquery-public-data.imdb\")  # <2>\n```\n:::\n\n\n1. Connect to the **billing** project. Compute (but not storage) is billed to\n   this project.\n2. Set the database to the project and dataset that we will use for analysis.\n\nLet's look at the tables in this dataset:\n\n::: {#203b6b28 .cell execution_count=2}\n``` {.python .cell-code}\ncon.list_tables()\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n['name_basics',\n 'reviews',\n 'title_akas',\n 'title_basics',\n 'title_crew',\n 'title_episode',\n 'title_principals',\n 'title_ratings']\n```\n:::\n:::\n\n\nLet's pull out the `name_basics` table, which contains names and metadata about\npeople listed on IMDB. We'll call this `ents` (short for `entities`), and remove some\ncolumns we won't need:\n\n::: {#6229c913 .cell execution_count=3}\n``` {.python .cell-code}\nents = con.tables.name_basics.drop(\"birth_year\", \"death_year\")\nents\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> nconst    </span>┃<span style=\"font-weight: bold\"> primary_name         </span>┃<span style=\"font-weight: bold\"> primary_profession </span>┃<span style=\"font-weight: bold\"> known_for_titles    </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>              │\n├───────────┼──────────────────────┼────────────────────┼─────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7200466</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Sam Townsend        </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>                │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7222639</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Marc Goula          </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"color: #008000; text-decoration-color: #008000\">tt3185588          </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7236451</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Charlie Furusho     </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"color: #008000; text-decoration-color: #008000\">tt4548374          </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7245943</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Cynthia Llanes      </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>                │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7252258</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Lance Hamner        </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"color: #008000; text-decoration-color: #008000\">tt0247882          </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7254706</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Paloma White        </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>                │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7256968</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Bart den Hartigh    </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"color: #008000; text-decoration-color: #008000\">tt3947934          </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7268314</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Don Cummings        </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"color: #008000; text-decoration-color: #008000\">tt4613692,tt0042078</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7286675</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Svitlana Banschukova</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"color: #008000; text-decoration-color: #008000\">tt4636896          </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7287050</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Glenn McCready      </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"color: #008000; text-decoration-color: #008000\">tt4637318          </span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                   │\n└───────────┴──────────────────────┴────────────────────┴─────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n### Splitting strings into arrays\n\nWe can see that `known_for_titles` looks sort of like an array, so let's call\nthe\n[`split`](../../reference/expression-strings.qmd#ibis.expr.types.strings.StringValue.split)\nmethod on that column and replace the existing column:\n\n::: {#1763a10e .cell execution_count=4}\n``` {.python .cell-code}\nents = ents.mutate(known_for_titles=_.known_for_titles.split(\",\"))\nents\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> nconst    </span>┃<span style=\"font-weight: bold\"> primary_name         </span>┃<span style=\"font-weight: bold\"> primary_profession </span>┃<span style=\"font-weight: bold\"> known_for_titles           </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>              │\n├───────────┼──────────────────────┼────────────────────┼────────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7200466</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Sam Townsend        </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"font-weight: bold\">[]</span>                         │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7222639</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Marc Goula          </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt3185588'</span><span style=\"font-weight: bold\">]</span>              │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7236451</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Charlie Furusho     </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4548374'</span><span style=\"font-weight: bold\">]</span>              │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7245943</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Cynthia Llanes      </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"font-weight: bold\">[]</span>                         │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7252258</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Lance Hamner        </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt0247882'</span><span style=\"font-weight: bold\">]</span>              │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7254706</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Paloma White        </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"font-weight: bold\">[]</span>                         │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7256968</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Bart den Hartigh    </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt3947934'</span><span style=\"font-weight: bold\">]</span>              │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7268314</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Don Cummings        </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4613692'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt0042078'</span><span style=\"font-weight: bold\">]</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7286675</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Svitlana Banschukova</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4636896'</span><span style=\"font-weight: bold\">]</span>              │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7287050</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Glenn McCready      </span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>               │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4637318'</span><span style=\"font-weight: bold\">]</span>              │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                          │\n└───────────┴──────────────────────┴────────────────────┴────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\nSimilarly for `primary_profession`, since people involved in show business often\nhave more than one responsibility on a project:\n\n::: {#398f73c9 .cell execution_count=5}\n``` {.python .cell-code}\nents = ents.mutate(primary_profession=_.primary_profession.split(\",\"))\n```\n:::\n\n\n### Array length\n\nLet's see how many titles each entity is known for, and then show the five\npeople with the largest number of titles they're known for:\n\nThis is computed using the\n[`length`](../../reference/expression-collections.qmd#ibis.expr.types.arrays.ArrayValue.length)\nAPI on array expressions:\n\n::: {#315e2b5c .cell execution_count=6}\n``` {.python .cell-code}\n(\n    ents.select(\"primary_name\", num_titles=_.known_for_titles.length())\n    .order_by(_.num_titles.desc())\n    .limit(5)\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> primary_name     </span>┃<span style=\"font-weight: bold\"> num_titles </span>┃\n┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │\n├──────────────────┼────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Marc Mayer      </span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Alex Koenigsmark</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Sally Sun       </span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Carrie Schnelker</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Henry Townsend  </span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span> │\n└──────────────────┴────────────┘\n</pre>\n```\n:::\n:::\n\n\nIt seems like the length of the `known_for_titles` might be capped at five!\n\n### Index\n\nWe can see the position of `\"actor\"` in `primary_profession`s:\n\n::: {#8f915d17 .cell execution_count=7}\n``` {.python .cell-code}\nents.primary_profession.index(\"actor\")\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> ArrayPosition(primary_profession, 'actor') </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>                                      │\n├────────────────────────────────────────────┤\n│                                         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │\n│                                         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │\n│                                         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │\n│                                         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │\n│                                         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │\n│                                         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │\n│                                         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │\n│                                         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │\n│                                         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │\n│                                         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │\n│                                          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└────────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\nA return value of `-1` indicates that `\"actor\"` is not present in the value:\n\nLet's look for entities that are not primarily actors:\n\nWe can do this using the\n[`index`](../../reference/expression-collections.qmd#ibis.expr.types.arrays.ArrayValue.index)\nmethod by checking whether the position of the string `\"actor\"` is greater than\nzero:\n\n::: {#4335351c .cell execution_count=8}\n``` {.python .cell-code}\nactor_index = ents.primary_profession.index(\"actor\")\nnot_primarily_actors = actor_index > 0\nnot_primarily_actors.mean()  # <1>\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=8}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-cyan-fg ansi-bold\">0.01947497010287973</span></pre>\n```\n:::\n\n:::\n:::\n\n\n1. The average of a `bool` column gives the percentage of `True` values\n\nWho are they?\n\n::: {#4bf604e5 .cell execution_count=9}\n``` {.python .cell-code}\nents[not_primarily_actors]\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> nconst     </span>┃<span style=\"font-weight: bold\"> primary_name            </span>┃<span style=\"font-weight: bold\"> primary_profession  </span>┃<span style=\"font-weight: bold\"> known_for_titles                    </span>┃\n┡━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>                       │\n├────────────┼─────────────────────────┼─────────────────────┼─────────────────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm14670573</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Jamie Young            </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>  │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt27216887'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm2320563 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Miguel Eraso           </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt1820556'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt0823256'</span><span style=\"font-weight: bold\">]</span>          │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm6050288 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Kyle Springford        </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt3260540'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt4353988'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">]</span>  │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm8606771 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Edward Wu              </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt0259354'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt4219258'</span><span style=\"font-weight: bold\">]</span>          │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm8159690 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Arash Maleki           </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt14888266'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt5783616'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">]</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm3700713 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Wendell Holland        </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt11546754'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt1554553'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">]</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm6531583 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Tomás Díez-Kith Atienza</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt3171042'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt3749248'</span><span style=\"font-weight: bold\">]</span>          │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm2456342 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Ed Cheesman            </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt13918214'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt9598592'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">]</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm0396397 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Thomas Houg            </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt0093176'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt13339954'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">]</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm2171019 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Larry Pena             </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt0831320'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt0800017'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span><span style=\"font-weight: bold\">]</span>  │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                   │\n└────────────┴─────────────────────────┴─────────────────────┴─────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\nIt's not 100% clear whether the order of elements in `primary_profession` matters here.\n\n### Containment\n\nWe can get people who are **not** actors using `contains`:\n\n::: {#510dc366 .cell execution_count=10}\n``` {.python .cell-code}\nnon_actors = ents[~ents.primary_profession.contains(\"actor\")]\nnon_actors\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> nconst     </span>┃<span style=\"font-weight: bold\"> primary_name      </span>┃<span style=\"font-weight: bold\"> primary_profession </span>┃<span style=\"font-weight: bold\"> known_for_titles </span>┃\n┡━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>    │\n├────────────┼───────────────────┼────────────────────┼──────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm13331027</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Robert Allen     </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[]</span>               │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm11516366</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Barney Given     </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[]</span>               │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7841847 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Natalia Utrera   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[]</span>               │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm14658368</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Amber Payne      </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[]</span>               │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm15199944</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Melanie Tomanov  </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[]</span>               │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm11529563</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">David Lazarus    </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[]</span>               │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm12224896</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Andrew Winston   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[]</span>               │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7591008 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Miles Metcoff    </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[]</span>               │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm11355058</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Sameer Oberoi    </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[]</span>               │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm15069831</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Skyler R. Peacock</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[]</span>               │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                │\n└────────────┴───────────────────┴────────────────────┴──────────────────┘\n</pre>\n```\n:::\n:::\n\n\n### Element removal\n\nWe can remove elements from arrays too.\n\n::: {.callout-note}\n## `remove()` does not mutate the underlying data\n:::\n\nLet's see who only has \"actor\" in the list of their primary professions:\n\n::: {#261a5744 .cell execution_count=11}\n``` {.python .cell-code}\nents.filter(\n    [\n        _.primary_profession.length() > 0,\n        _.primary_profession.remove(\"actor\").length() == 0,\n    ]\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> nconst    </span>┃<span style=\"font-weight: bold\"> primary_name          </span>┃<span style=\"font-weight: bold\"> primary_profession </span>┃<span style=\"font-weight: bold\"> known_for_titles                   </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>                      │\n├───────────┼───────────────────────┼────────────────────┼────────────────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7198867</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Danny Brown          </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4532788'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7199329</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">James Wyatt Fairbanks</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4494580'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7201687</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Tony Jelen           </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt2043887'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7203397</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Christian Petrucci   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4537722'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7205107</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Pablo Schollaert     </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4539222'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7207724</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Shigeru Jerry Endo   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt0043590'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7209610</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Paul Tugwell         </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt6185666'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt4544182'</span><span style=\"font-weight: bold\">]</span>         │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7213017</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Pancho               </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt2333598'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7228531</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Phillip Shinn        </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt1442462'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt2741602'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span><span style=\"font-weight: bold\">]</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7236342</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">José María Martínez  </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt2244891'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                  │\n└───────────┴───────────────────────┴────────────────────┴────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n### Slicing with square-bracket syntax\n\nLet's remove everyone's first profession from the list, but only if they have\nmore than one profession listed:\n\n::: {#c1137788 .cell execution_count=12}\n``` {.python .cell-code}\nents[_.primary_profession.length() > 1].mutate(\n    primary_profession=_.primary_profession[1:],\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> nconst     </span>┃<span style=\"font-weight: bold\"> primary_name    </span>┃<span style=\"font-weight: bold\"> primary_profession </span>┃<span style=\"font-weight: bold\"> known_for_titles                     </span>┃\n┡━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>                        │\n├────────────┼─────────────────┼────────────────────┼──────────────────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm0520425 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Doug Lord      </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt0086461'</span><span style=\"font-weight: bold\">]</span>                        │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7198767 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Martin Harry   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt5554916'</span><span style=\"font-weight: bold\">]</span>                        │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm2232471 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Lee Thomas     </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt0236124'</span><span style=\"font-weight: bold\">]</span>                        │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm5500775 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Stewart Hayes  </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'legal'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt2671192'</span><span style=\"font-weight: bold\">]</span>                        │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm2653478 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Aaron Rosenberg</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4218260'</span><span style=\"font-weight: bold\">]</span>                        │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm0701436 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dominic Pye    </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span><span style=\"font-weight: bold\">]</span>         │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt27329996'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt0195619'</span><span style=\"font-weight: bold\">]</span>          │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm12705514</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Okpata Henry   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span><span style=\"font-weight: bold\">]</span>         │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt28450328'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt15170142'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">]</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm8313644 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Jeff Landers   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span><span style=\"font-weight: bold\">]</span>         │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt0488302'</span><span style=\"font-weight: bold\">]</span>                        │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm0438282 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Joshua Kaplan  </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span><span style=\"font-weight: bold\">]</span>         │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt0110687'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt0329600'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span><span style=\"font-weight: bold\">]</span>   │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm2803821 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Glen Ring      </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'editor'</span><span style=\"font-weight: bold\">]</span>         │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt1579300'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt1126489'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span><span style=\"font-weight: bold\">]</span>   │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                    │\n└────────────┴─────────────────┴────────────────────┴──────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n## Set operations and sorting\n\nTreating arrays as sets is possible with the\n[`union`](../../reference/expression-collections.qmd#ibis.expr.types.arrays.ArrayValue.union)\nand\n[`intersect`](../../reference/expression-collections.qmd#ibis.expr.types.arrays.ArrayValue.intersect)\nAPIs.\n\n### Union\n\n### Intersection\n\nLet's see if we can use array intersection to figure which actors share\nknown-for titles and sort the result:\n\n::: {#b4e2a96d .cell execution_count=13}\n``` {.python .cell-code}\nleft = ents.filter(_.known_for_titles.length() > 0).limit(10_000)\nright = left.view()\nshared_titles = (\n    left\n    .join(right, left.nconst != right.nconst)\n    .select(\n        s.startswith(\"known_for_titles\"),\n        left_name=\"primary_name\",\n        right_name=\"primary_name_right\",\n    )\n    .filter(_.known_for_titles.intersect(_.known_for_titles_right).length() > 0)\n    .group_by(name=\"left_name\")\n    .agg(together_with=_.right_name.collect())\n    .mutate(together_with=_.together_with.unique().sort())\n)\nshared_titles\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> name              </span>┃<span style=\"font-weight: bold\"> together_with                                     </span>┃\n┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>                                     │\n├───────────────────┼───────────────────────────────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Sandra Murphy    </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'Andrew Brisk'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'Angus McLaren'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">41</span><span style=\"font-weight: bold\">]</span>        │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Espera           </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'Avena Campbell'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'Brenda James'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span><span style=\"font-weight: bold\">]</span>       │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Mamta Jajoo      </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'Barbara Buls'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'Bill Smoler'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">72</span><span style=\"font-weight: bold\">]</span>          │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Charles Ellis    </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'Cherri Moore'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'Dennis Montano'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span><span style=\"font-weight: bold\">]</span>       │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Chris Nicholus   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'Catherine Harrell'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'George Pounders'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span><span style=\"font-weight: bold\">]</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Paul Dembling    </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'Barbara Buls'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'Bill Smoler'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">72</span><span style=\"font-weight: bold\">]</span>          │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Dnyaneshwar Mulay</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'Avena Campbell'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'Brenda James'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span><span style=\"font-weight: bold\">]</span>       │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Daisy Boria      </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'Barbara Buls'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'Bill Smoler'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">72</span><span style=\"font-weight: bold\">]</span>          │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Brandon Staley   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'Beacon Light'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'Ben Emanuel'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">48</span><span style=\"font-weight: bold\">]</span>          │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Dwayne Carter Jr.</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'Bill Collis'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'Charlie Jones'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span><span style=\"font-weight: bold\">]</span>         │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                                 │\n└───────────────────┴───────────────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n## Advanced operations\n\n### `unnest`\n\nAs of version 7.0.0 Ibis does not support its native `unnest` API for BigQuery,\nbut we plan to add it in the future.\n\nFor now, you can use `con.sql` to construct an Ibis expression from a BigQuery\nSQL string that contains `UNNEST` calls:\n\nDespite lack of native `UNNEST` support, many use cases for `UNNEST` are met by\nthe\n[`filter`](../../reference/expression-collections.qmd#ibis.expr.types.arrays.ArrayValue.filter)\nand\n[`map`](../../reference/expression-collections.qmd#ibis.expr.types.arrays.ArrayValue.map)\noperations on array expressions.\n\n### Filtering array elements\n\nShow all people who are neither editors nor actors:\n\n::: {#331a9699 .cell execution_count=14}\n``` {.python .cell-code}\nents.mutate(\n    primary_profession=_.primary_profession.filter(\n        lambda pp: pp.isin((\"actor\", \"editor\"))\n    )\n).filter(_.primary_profession.length() > 0)\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> nconst    </span>┃<span style=\"font-weight: bold\"> primary_name          </span>┃<span style=\"font-weight: bold\"> primary_profession </span>┃<span style=\"font-weight: bold\"> known_for_titles                   </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>                      │\n├───────────┼───────────────────────┼────────────────────┼────────────────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7198867</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Danny Brown          </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4532788'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7199329</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">James Wyatt Fairbanks</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4494580'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7201687</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Tony Jelen           </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt2043887'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7203397</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Christian Petrucci   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4537722'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7205107</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Pablo Schollaert     </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4539222'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7207724</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Shigeru Jerry Endo   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt0043590'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7209610</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Paul Tugwell         </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt6185666'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt4544182'</span><span style=\"font-weight: bold\">]</span>         │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7213017</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Pancho               </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt2333598'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7228531</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Phillip Shinn        </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt1442462'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt2741602'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span><span style=\"font-weight: bold\">]</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7236342</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">José María Martínez  </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'actor'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt2244891'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                  │\n└───────────┴───────────────────────┴────────────────────┴────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n### Applying a function to array elements\n\nLet's normalize the case of primary_profession to upper case:\n\n::: {#1dd5c0b8 .cell execution_count=15}\n``` {.python .cell-code}\nents.mutate(\n    primary_profession=_.primary_profession.map(lambda pp: pp.upper())\n).filter(_.primary_profession.length() > 0)\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> nconst    </span>┃<span style=\"font-weight: bold\"> primary_name          </span>┃<span style=\"font-weight: bold\"> primary_profession </span>┃<span style=\"font-weight: bold\"> known_for_titles                   </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>                      │\n├───────────┼───────────────────────┼────────────────────┼────────────────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7198867</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Danny Brown          </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'ACTOR'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4532788'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7199329</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">James Wyatt Fairbanks</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'ACTOR'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4494580'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7201687</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Tony Jelen           </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'ACTOR'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt2043887'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7203397</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Christian Petrucci   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'ACTOR'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4537722'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7205107</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Pablo Schollaert     </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'ACTOR'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt4539222'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7207724</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Shigeru Jerry Endo   </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'ACTOR'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt0043590'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7209610</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Paul Tugwell         </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'ACTOR'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt6185666'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt4544182'</span><span style=\"font-weight: bold\">]</span>         │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7213017</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Pancho               </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'ACTOR'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt2333598'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7228531</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Phillip Shinn        </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'ACTOR'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt1442462'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'tt2741602'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span><span style=\"font-weight: bold\">]</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">nm7236342</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">José María Martínez  </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'ACTOR'</span><span style=\"font-weight: bold\">]</span>          │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'tt2244891'</span><span style=\"font-weight: bold\">]</span>                      │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                  │\n└───────────┴───────────────────────┴────────────────────┴────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n## Conclusion\n\nIbis has a sizable collection of array APIs that work with many different\nbackends and as of version 7.0.0, Ibis supports a much larger set of those APIs\nfor BigQuery!\n\nCheck out [the API\ndocumentation](../../reference/expression-collections.qmd#ibis.expr.types.arrays.ArrayValue)\nfor the full set of available methods.\n\nTry it out, and let us know what you think.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}