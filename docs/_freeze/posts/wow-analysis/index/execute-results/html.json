{
  "hash": "d15e3ab984ca4d227300f191eeef8118",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Analysis of World of Warcraft data\"\nauthor: \"Tyler White\"\nerror: false\ndate: \"2024-02-29\"\nimage: thumbnail.png\ncategories:\n  - blog\n  - data engineering\n  - duckdb\n---\n\n## Introduction\n\nI grew up playing games, and with the recent re-release of World of Warcraft Classic,\nit seems like a perfect time to analyze some in-game data!\n\nThis dataset is the product of a Horde player's diligent recording throughout 2008,\ncapturing the transitional phase between the Burning Crusade and Wrath of the Lich King\nexpansions. Notably, starting November 13, 2008, the data showcases numerous characters\nventuring into new territories and advancing beyond the former level cap of 70.\n\n## Analysis\n\nWe'll determine who logged in the most, who leveled from 70 to 80 the fastest, and\nwhat activities these players engaged with based on zones. Let's get to work.\n\n### Getting started\n\nIbis ships with an `examples` module, which includes this specific data. We'll use DuckDB\nhere, but this is possible with other backends, and we encourage you to experiment.\nDuckDB is the default Ibis backend, so it'll be easy to use with this example.\n\nYou can execute `pip install ibis-framework[duckdb,examples]` to work with Ibis and the\nexample data.\n\n::: {#cfdc9973 .cell execution_count=1}\n``` {.python .cell-code}\nfrom ibis.interactive import *\n\nwowah_data = ex.wowah_data_raw.fetch()\n\nwowah_data\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> char  </span>┃<span style=\"font-weight: bold\"> level </span>┃<span style=\"font-weight: bold\"> race   </span>┃<span style=\"font-weight: bold\"> charclass </span>┃<span style=\"font-weight: bold\"> zone                   </span>┃<span style=\"font-weight: bold\"> guild </span>┃<span style=\"font-weight: bold\"> timestamp           </span>┃\n┡━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">timestamp(6)</span>        │\n├───────┼───────┼────────┼───────────┼────────────────────────┼───────┼─────────────────────┤\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59425</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orc   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Rogue    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orgrimmar             </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">165</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-01 00:02:04</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">65494</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orc   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Hunter   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Durotar               </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-01 00:02:04</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">65325</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orc   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Warrior  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Ghostlands            </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-01 00:02:04</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">65490</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orc   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Hunter   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Ghostlands            </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-01 00:02:04</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2288</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">60</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orc   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Hunter   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Hellfire Peninsula    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-01 00:02:09</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2289</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">60</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orc   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Hunter   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Hellfire Peninsula    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-01 00:02:09</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">61239</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">68</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orc   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Hunter   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Blade's Edge Mountains</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">243</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-01 00:02:14</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59772</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">69</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orc   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Warrior  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Shadowmoon Valley     </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-01 00:02:14</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22937</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">69</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orc   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Rogue    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Warsong Gulch         </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">243</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-01 00:02:14</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">23062</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">69</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orc   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Shaman   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Shattrath City        </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">103</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-01 00:02:14</span> │\n│     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                      │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                   │\n└───────┴───────┴────────┴───────────┴────────────────────────┴───────┴─────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n### Getting table info\n\nLet's learn more about these fields. Are there any nulls we should consider? We can\nuse the [`info`](../../reference/expression-tables.qmd#ibis.expr.types.relations.Table.info)\nmethod on our Ibis expression.\n\n::: {#42d533ca .cell execution_count=2}\n``` {.python .cell-code}\nwowah_data.info()\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━┓\n┃<span style=\"font-weight: bold\"> name      </span>┃<span style=\"font-weight: bold\"> type         </span>┃<span style=\"font-weight: bold\"> nullable </span>┃<span style=\"font-weight: bold\"> nulls </span>┃<span style=\"font-weight: bold\"> non_nulls </span>┃<span style=\"font-weight: bold\"> null_frac </span>┃<span style=\"font-weight: bold\"> pos  </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">boolean</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int8</span> │\n├───────────┼──────────────┼──────────┼───────┼───────────┼───────────┼──────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">char     </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">int32       </span> │ True     │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10826734</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">level    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">int32       </span> │ True     │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10826734</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">race     </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">string      </span> │ True     │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10826734</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">charclass</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">string      </span> │ True     │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10826734</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">zone     </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">string      </span> │ True     │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10826734</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">guild    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">int32       </span> │ True     │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10826734</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">timestamp</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">timestamp(6)</span> │ True     │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10826734</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6</span> │\n└───────────┴──────────────┴──────────┴───────┴───────────┴───────────┴──────┘\n</pre>\n```\n:::\n:::\n\n\nWe can also use [`value_counts`](../../reference/expression-generic.qmd#ibis.expr.types.generic.Column.value_counts)\non specific columns if we want to learn more.\n\n::: {#f6925052 .cell execution_count=3}\n``` {.python .cell-code}\nwowah_data.race.value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> race      </span>┃<span style=\"font-weight: bold\"> race_count </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │\n├───────────┼────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Undead   </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2530156</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Orc      </span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">933056</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Troll    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1102409</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Blood Elf</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3929995</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Tauren   </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2331118</span> │\n└───────────┴────────────┘\n</pre>\n```\n:::\n:::\n\n\nWe don't have any missing values, and the data `value_counts` results match what I would\nexpect.\n\nHow about duplicates? We can check the count of unique rows against the total count.\n\n::: {#28d750b9 .cell execution_count=4}\n``` {.python .cell-code}\nprint(wowah_data.count())\nprint(wowah_data.nunique())\nprint(wowah_data.count() == wowah_data.nunique())\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n10826734\n10823177\nFalse\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n:::\n\n\nSo we have some duplicates. What could the duplicate rows be?\n\nWe can find them like this.\n\n::: {#47370405 .cell execution_count=5}\n``` {.python .cell-code}\nwowah_duplicates = wowah_data.mutate(\n    row_num=ibis.row_number().over(\n        ibis.window(group_by=wowah_data.columns, order_by=_.timestamp)\n    )\n).filter(_.row_num > 0)\n\nwowah_duplicates\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━┳━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> char  </span>┃<span style=\"font-weight: bold\"> level </span>┃<span style=\"font-weight: bold\"> race      </span>┃<span style=\"font-weight: bold\"> charclass </span>┃<span style=\"font-weight: bold\"> zone               </span>┃<span style=\"font-weight: bold\"> guild </span>┃<span style=\"font-weight: bold\"> timestamp           </span>┃<span style=\"font-weight: bold\"> row_num </span>┃\n┡━━━━━━━╇━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">timestamp(6)</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>   │\n├───────┼───────┼───────────┼───────────┼────────────────────┼───────┼─────────────────────┼─────────┤\n│   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">341</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Undead   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Rogue    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Terokkar Forest   </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">204</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-06-05 01:57:37</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">980</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orc      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Hunter   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Isle of Quel'Danas</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">79</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-10-25 05:05:03</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1321</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Tauren   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Druid    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Isle of Quel'Danas</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-04-17 15:38:46</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2866</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Undead   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Priest   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Nagrand           </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">103</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-10-23 21:01:32</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4318</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Undead   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Warrior  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Karazhan          </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-07-12 18:05:06</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11316</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Undead   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Mage     </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Alterac Valley    </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">104</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-03-22 00:30:48</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17774</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Blood Elf</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Hunter   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Shattrath City    </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">271</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-07-12 18:06:12</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19598</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Tauren   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Shaman   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">The Mechanar      </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">101</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-06-05 11:10:57</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21828</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Tauren   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Shaman   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Durotar           </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-10-23 19:10:31</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22484</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Tauren   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Hunter   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Warsong Gulch     </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">315</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-07-12 18:03:23</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                  │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                   │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└───────┴───────┴───────────┴───────────┴────────────────────┴───────┴─────────────────────┴─────────┘\n</pre>\n```\n:::\n:::\n\n\nI suspect this data was captured by a single player spamming “/who” in the game, most\nlikely using an AddOn, about every ten minutes. Some players could\nhave been captured twice, depending on how the command was being filtered.\n\nWe can go ahead and remove these duplicates.\n\n::: {#705c75eb .cell execution_count=6}\n``` {.python .cell-code}\nwowah_data = wowah_data.distinct()\n```\n:::\n\n\n### Which player logged in the most?\n\nWe mentioned that there was a single player likely capturing these results.\nLet's find out who that is.\n\n::: {#07bc46cc .cell execution_count=7}\n``` {.python .cell-code}\n(\n    wowah_data\n    .group_by([_.char, _.race, _.charclass])\n    .agg(sessions=_.count())\n    .order_by(_.sessions.desc())\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> char  </span>┃<span style=\"font-weight: bold\"> race      </span>┃<span style=\"font-weight: bold\"> charclass </span>┃<span style=\"font-weight: bold\"> sessions </span>┃\n┡━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>    │\n├───────┼───────────┼───────────┼──────────┤\n│   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">182</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Troll    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Hunter   </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42770</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">57741</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Undead   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Warlock  </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16237</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1384</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Undead   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Warlock  </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15878</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59489</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Blood Elf</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Priest   </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13977</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">62239</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Undead   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Mage     </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13776</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">62446</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Blood Elf</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Mage     </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13011</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31184</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Undead   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Rogue    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12019</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">24126</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Blood Elf</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Warlock  </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11791</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">61105</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Blood Elf</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Priest   </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11731</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35072</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Blood Elf</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Paladin  </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11399</span> │\n│     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└───────┴───────────┴───────────┴──────────┘\n</pre>\n```\n:::\n:::\n\n\nThat Troll Hunter that never exceeded level 1 is likely our person with 42,770 sessions.\n\n### Who leveled the fastest from 70–80?\n\nAt the end of the year, there were 884 level 80s. Who leveled the fastest?\n\nFinding this answer will involve filtering, grouping, and aggregating to compute\neach character's time taken to level from 70 to 80.\n\nLet's start by creating an expression to filter to only the level 80 characters, then\njoin it to filter and identify only where they were level 70 or 80. We're only concerned\nwith three columns so that we will select only those.\n\n::: {#c458d06e .cell execution_count=8}\n``` {.python .cell-code}\nmax_level_chars = wowah_data.filter(_.level == 80).select(_.char).distinct()\nwowah_data_filtered = (\n    wowah_data\n    .join(max_level_chars, \"char\", how=\"inner\")\n    .filter(_.level.isin([70, 80]))\n    .select(_.char, _.level, _.timestamp)\n)\nwowah_data_filtered\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> char  </span>┃<span style=\"font-weight: bold\"> level </span>┃<span style=\"font-weight: bold\"> timestamp           </span>┃\n┡━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">timestamp(6)</span>        │\n├───────┼───────┼─────────────────────┤\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">62226</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-09 22:00:20</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21828</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-09 22:00:30</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">62763</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-09 22:01:06</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">27547</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-09 22:01:51</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5730</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-09 22:02:07</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">34216</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-09 22:09:27</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">40951</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-09 22:09:32</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">45552</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-09 22:10:08</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19481</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-09 22:10:23</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19085</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-01-09 22:10:23</span> │\n│     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                   │\n└───────┴───────┴─────────────────────┘\n</pre>\n```\n:::\n:::\n\n\nLet's use the `where` option to help with the aggregation.\n\n::: {#20281bee .cell execution_count=9}\n``` {.python .cell-code}\nlevel_calc = (\n    wowah_data_filtered.group_by([\"char\"])\n    .mutate(\n        ts_70=_.timestamp.max(where=_.level == 70),\n        ts_80=_.timestamp.min(where=_.level == 80),\n    )\n    .drop([\"level\", \"timestamp\"])\n    .distinct()\n    .mutate(days_from_70_to_80=(_.ts_80.delta(_.ts_70, \"day\")))\n    .order_by(_.days_from_70_to_80)\n)\n```\n:::\n\n\nThe data is filtered and grouped by character, and two new columns are created to\nrepresent timestamps for levels 70 and 80. Then we drop what we no longer need, get the\ndistinct values, and calculate the time taken to level from 70 to 80. Then we sort it!\n\n::: {#d4eec6ef .cell execution_count=10}\n``` {.python .cell-code}\nlevel_calc\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> char  </span>┃<span style=\"font-weight: bold\"> ts_70               </span>┃<span style=\"font-weight: bold\"> ts_80               </span>┃<span style=\"font-weight: bold\"> days_from_70_to_80 </span>┃\n┡━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">timestamp(6)</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">timestamp(6)</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>              │\n├───────┼─────────────────────┼─────────────────────┼────────────────────┤\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">68544</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-27 01:58:13</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-30 16:19:04</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1450</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-18 02:46:37</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-21 11:45:35</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │\n│   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">399</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-18 00:02:40</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-22 20:23:57</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">86264</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-20 23:09:17</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-24 16:35:46</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">51738</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-12-03 20:10:00</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-12-07 11:26:08</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1003</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-18 00:29:25</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-22 23:47:06</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">40483</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-17 22:35:42</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-21 15:31:59</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">88331</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-12-12 01:47:57</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-12-16 10:19:23</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">86396</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-12-03 05:04:42</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-12-07 17:04:43</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">86265</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-20 23:28:40</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2008-11-24 07:47:08</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                   │                  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└───────┴─────────────────────┴─────────────────────┴────────────────────┘\n</pre>\n```\n:::\n:::\n\n\nThis isn't perfect, as I found a case where there was a player who seemed to have quit\nin March and then returned for the new expansion. They hit 71 before it looks like their\nlogin at 70 was captured later. If you're curious, take a look at **char=21951** for yourself.\n\n### How did they level?\n\nLet's grab all the details from the previous result and join it back to get the\ntimestamp and zone data.\n\n::: {#1bcde122 .cell execution_count=11}\n``` {.python .cell-code}\nleveler_zones = (\n    level_calc.join(wowah_data, \"char\", how=\"inner\")\n    .filter(_.timestamp.between(_.ts_70, _.ts_80))\n    .group_by([_.char, _.zone])\n    .agg(zone_count=_.zone.count())\n)\nleveler_zones\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> char  </span>┃<span style=\"font-weight: bold\"> zone              </span>┃<span style=\"font-weight: bold\"> zone_count </span>┃\n┡━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │\n├───────┼───────────────────┼────────────┤\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">40309</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Borean Tundra    </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">70</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">75845</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dragonblight     </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">57</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4175</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Halls of Stone   </span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">40309</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Undercity        </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">28</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">78122</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dalaran          </span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">75845</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Howling Fjord    </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">33</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35625</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Borean Tundra    </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">63</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">67626</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Shadowmoon Valley</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">54676</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Icecrown         </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span> │\n│  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2877</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Orgrimmar        </span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9</span> │\n│     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                 │          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└───────┴───────────────────┴────────────┘\n</pre>\n```\n:::\n:::\n\n\nThis code summarizes how often those characters appear in different zones while leveling\nup from level 70 to 80. It combines two sets of data based on character names, selects\nrecords within the leveling timeframe, groups data by character and zone, and counts the\nnumber of times each character was found in each zone.\n\nThere is another example table we can join to figure out the Zone information. I'm only\ninterested in two columns, so I'll filter this further and rename the columns.\n\n::: {#5af91920 .cell execution_count=12}\n``` {.python .cell-code}\nzones = ex.wowah_zones_raw.fetch()\nzones = zones.select(zone=_.Zone, zone_type=_.Type)\nzones\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> zone                 </span>┃<span style=\"font-weight: bold\"> zone_type </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │\n├──────────────────────┼───────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Durotar             </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Zone     </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">The Barrens         </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Zone     </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Silverpine Forest   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Zone     </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Stonetalon Mountains</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Zone     </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Thunder Bluff       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">City     </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Dustwallow Marsh    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Zone     </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Durotar             </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">City     </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Tirisfal Glades     </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">City     </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Ashenvale           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Zone     </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Stranglethorn Vale  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Zone     </span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │\n└──────────────────────┴───────────┘\n</pre>\n```\n:::\n:::\n\n\nMaking use of `pivot_wider` and joining back to our `leveler_zones` expression will make\nthis a breeze!\n\n::: {#56f73390 .cell execution_count=13}\n``` {.python .cell-code}\nzones_pivot = (\n    leveler_zones.join(zones, \"zone\")\n    .group_by([_.char, _.zone_type])\n    .agg(zone_type_count=_.zone.count())\n    .pivot_wider(names_from=\"zone_type\", values_from=\"zone_type_count\")\n)\nzones_pivot\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> char  </span>┃<span style=\"font-weight: bold\"> Zone  </span>┃<span style=\"font-weight: bold\"> City  </span>┃<span style=\"font-weight: bold\"> Sea   </span>┃<span style=\"font-weight: bold\"> Battleground </span>┃<span style=\"font-weight: bold\"> Dungeon </span>┃<span style=\"font-weight: bold\"> Arena </span>┃\n┡━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int32</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├───────┼───────┼───────┼───────┼──────────────┼─────────┼───────┤\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">30491</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">54357</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">24239</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59778</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13</span> │  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">71918</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">73557</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">87205</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31900</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">30</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">36</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">925</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span> │  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">86261</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span> │  <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │\n│     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└───────┴───────┴───────┴───────┴──────────────┴─────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\nIf they have a high value in the \"Zone\" column, they were likely questing. Other\nplayers opted to venture into dungeons.\n\n## Next steps\n\nIt's pretty easy to do complex analysis with Ibis. We churned through over 10 million rows\nin no time.\n\nGet in touch with us on [GitHub](https://github.com/ibis-project) or\n[Zulip](https://ibis-project.zulipchat.com/), we'd love to see more analyses of this\ndata set.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}