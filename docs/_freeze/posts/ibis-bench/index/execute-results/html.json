{
  "hash": "38222dbf2777098543b64f365bc0b0ee",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"DuckDB, DataFusion, Polars: a benchmark\"\nauthor: \"Cody Peterson\"\ndate: \"2024-06-17\"\nimage: \"figure1.png\"\ncategories:\n    - benchmark\n    - duckdb\n    - datafusion\n    - polars\n---\n\nThere are plenty of options for single-node data systems that easily beat\n[pandas](https://github.com/pandas-dev/pandas), the Python dataframe library Wes\nMcKinney created about 15 years ago, on standard benchmarks. But can they beat\n[the Python dataframe library Wes created nearly 10 years\nago](https://github.com/ibis-project/ibis)? (*Spoiler alert: it's a trick\nquestion!*)\n\nIn this post, we'll look at the big three single-node modern OLAP engines based\non [Apache Arrow](https://github.com/apache/arrow):\n[DuckDB](https://github.com/duckdb/duckdb),\n[DataFusion](https://github.com/apache/datafusion), and\n[Polars](https://github.com/pola-rs/polars). We'll see how they compare to each\nother on TPC-H queries and how [Ibis](https://github.com/ibis-project/ibis)\nprovides a unified API to work with all of them (and over a dozen more\nbackends).\n\n## Results and analysis\n\nLet's delve straight into the results. There are some visualizatoins provided\n[in a Streamlit app](https://ibis-bench.streamlit.app) that you can explore. For\nthe rest of this section, we'll walk through the data and some of the key\ntakeaways. The data is stored publicly and you can analyze it yourself, too!\n\n:::{.callout-note title=\"TLDR: takeaways\" collapse=\"true\"}\n\n### Ibis provides a unified API\n\nIbis can ideally be a standard Python dataframe library that decouples the API\nfrom the execution engine. This allows users or organizations to write queries\nonce and easily switch between the engine that is best for their use case. In\nthis benchmark, we see Ibis running on three great single-node options: DuckDB,\nDataFusion, and Polars.\n\n### DuckDB is impressive\n\nDuckDB is often the fastest in the results. More impressive was its ability to\ncomplete all queries operating on ~128GBs of data with only 8GBs of memory on a\ncompute instance. This was unexpected and particularly impressive.\n\n### Benchmarking is hard and specific\n\nThis benchmark is a point in time -- run on specific versions of each Python\npackage, specific hardware, and with various considerations. The primary ones\ninclude:\n\n- TPC-H data was generated via DuckDB and stored as compressed Parquet files\n- all data was downloaded to the compute instance on a local disk\n- decimals were converted to floats before running the queries for all systems\n- writing TPC-H SQL queries as dataframe code can be challenging; we tried to\n keep it fair between Ibis and Polars\n\n### Performance converges over time\n\nEverything in this benchmark is open source, actively maintained, and has\nthriving communities. Any issue identified or performance gap is likely to be\naddressed over time. Outside of architectural differences (which none of these\nexecution engines fundamentally have), performance is likely to converge over\ntime.\n\nSee the [performance converges over time](#performance-converges-over-time)\nsection for more discussion.\n:::\n\n\n\nTo follow along, install the required Python packages:\n\n```bash\npip install gcsfs 'ibis-framework[duckdb]' plotly\n```\n\nThe data is stored in a public Google Cloud Storage (GCS) bucket:\n\n::: {#92779d8c .cell execution_count=3}\n``` {.python .cell-code}\nimport os\nimport gcsfs\n\nBUCKET = \"ibis-bench\"\n\ndir_name = os.path.join(BUCKET, \"bench_logs_v2\", \"cache\")\n\nfs = gcsfs.GCSFileSystem()\nfs.ls(dir_name)[-5:]\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n['ibis-bench/bench_logs_v2/cache/file_id=b6236086-7fff-4569-8731-b97a635243bd.parquet',\n 'ibis-bench/bench_logs_v2/cache/file_id=cbc0c7b1-e659-4adb-8c80-4077cd4d39ab.parquet',\n 'ibis-bench/bench_logs_v2/cache/file_id=d91454ad-2ddd-408a-bbfd-6b159dd2132b.parquet',\n 'ibis-bench/bench_logs_v2/cache/file_id=debc7203-f366-44d2-94f1-2518e6f7425f.parquet',\n 'ibis-bench/bench_logs_v2/cache/file_id=e875d852-f7e7-473c-9440-92b8f2445f3a.parquet']\n```\n:::\n:::\n\n\nTo start exploring the data, let's import Ibis and Plotly, set some options, and\nregister the GCS filesystem with the default (DuckDB) backend:\n\n::: {#d72f8520 .cell execution_count=4}\n``` {.python .cell-code}\nimport ibis\nimport plotly.express as px\n\npx.defaults.template = \"plotly_dark\"\n\nibis.options.interactive = True\nibis.options.repr.interactive.max_rows = 40\nibis.options.repr.interactive.max_length = 22\nibis.options.repr.interactive.max_columns = None\n\ncon = ibis.get_backend()\ncon.register_filesystem(fs)\n```\n:::\n\n\n\n\nNow read the data and take a look at the first few rows:\n\n::: {#c7794d74 .cell execution_count=6}\n``` {.python .cell-code}\nt = (\n    ibis.read_parquet(f\"gs://{dir_name}/file_id=*.parquet\")\n    .mutate(\n        timestamp=ibis._[\"timestamp\"].cast(\"timestamp\"),\n    )\n    .relocate(\n        \"instance_type\",\n        \"system\",\n        \"sf\",\n        \"query_number\",\n        \"execution_seconds\",\n        \"timestamp\",\n    )\n    .cache()\n)\nt.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> instance_type </span>┃<span style=\"font-weight: bold\"> system          </span>┃<span style=\"font-weight: bold\"> sf    </span>┃<span style=\"font-weight: bold\"> query_number </span>┃<span style=\"font-weight: bold\"> execution_seconds </span>┃<span style=\"font-weight: bold\"> timestamp                  </span>┃<span style=\"font-weight: bold\"> session_id                           </span>┃<span style=\"font-weight: bold\"> n_partitions </span>┃<span style=\"font-weight: bold\"> file_type </span>┃<span style=\"font-weight: bold\"> file_id                                      </span>┃\n┡━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">timestamp(6)</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">uuid</span>                                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                       │\n├───────────────┼─────────────────┼───────┼──────────────┼───────────────────┼────────────────────────────┼──────────────────────────────────────┼──────────────┼───────────┼──────────────────────────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">polars-lazy    </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.503613</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2024-06-10 08:04:31.233704</span> │ 6708e5d3-2b8c-4ce0-adf8-65ce94e0bff1 │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">64</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35.826295</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2024-06-10 21:05:18.423375</span> │ 9a00385f-22b4-42df-ab3d-c63ed1a33a2e │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb    </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.376196</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2024-06-11 03:44:22.901852</span> │ acb56c6b-b0d5-4bbc-8791-3542b62bd193 │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.655290</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2024-06-09 20:29:31.833510</span> │ a07fe07d-7a08-4802-b8ae-918e66e2d868 │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb-sql</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.447325</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2024-06-10 08:11:31.244609</span> │ d523eec6-d2de-491d-b541-348c6b5bfc65 │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │\n└───────────────┴─────────────────┴───────┴──────────────┴───────────────────┴────────────────────────────┴──────────────────────────────────────┴──────────────┴───────────┴──────────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\nWe'll create a second table with details on each instance type including the CPU\ntype, number of cores, and memory in gigabytes:\n\n::: {#9073ad2b .cell execution_count=7}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show code to get instance details\"}\ncpu_type_cases = (\n    ibis.case()\n    .when(\n        ibis._[\"instance_type\"].startswith(\"n2d\"),\n        \"AMD EPYC\",\n    )\n    .when(\n        ibis._[\"instance_type\"].startswith(\"n2\"),\n        \"Intel Cascade and Ice Lake\",\n    )\n    .when(\n        ibis._[\"instance_type\"].startswith(\"c3\"),\n        \"Intel Sapphire Rapids\",\n    )\n    .when(\n        ibis._[\"instance_type\"] == \"work laptop\",\n        \"Apple M1 Max\",\n    )\n    .when(\n        ibis._[\"instance_type\"] == \"personal laptop\",\n        \"Apple M2 Max\",\n    )\n    .else_(\"unknown\")\n    .end()\n)\ncpu_num_cases = (\n    ibis.case()\n    .when(\n        ibis._[\"instance_type\"].contains(\"-\"),\n        ibis._[\"instance_type\"].split(\"-\")[-1].cast(\"int\"),\n    )\n    .when(ibis._[\"instance_type\"].contains(\"laptop\"), 12)\n    .else_(0)\n    .end()\n)\nmemory_gb_cases = (\n    ibis.case()\n    .when(\n        ibis._[\"instance_type\"].contains(\"-\"),\n        ibis._[\"instance_type\"].split(\"-\")[-1].cast(\"int\") * 4,\n    )\n    .when(ibis._[\"instance_type\"] == \"work laptop\", 32)\n    .when(ibis._[\"instance_type\"] == \"personal laptop\", 96)\n    .else_(0)\n    .end()\n)\n\ninstance_details = (\n    t.group_by(\"instance_type\")\n    .agg()\n    .mutate(\n        cpu_type=cpu_type_cases, cpu_cores=cpu_num_cases, memory_gbs=memory_gb_cases\n    )\n).order_by(\"memory_gbs\", \"cpu_cores\", \"instance_type\")\n\ncpu_types = sorted(\n    instance_details.distinct(on=\"cpu_type\")[\"cpu_type\"].to_pyarrow().to_pylist()\n)\n\ninstance_details\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> instance_type   </span>┃<span style=\"font-weight: bold\"> cpu_type                   </span>┃<span style=\"font-weight: bold\"> cpu_cores </span>┃<span style=\"font-weight: bold\"> memory_gbs </span>┃\n┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │\n├─────────────────┼────────────────────────────┼───────────┼────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-2  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2d-standard-2 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AMD EPYC                  </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-4  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Sapphire Rapids     </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2d-standard-4 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AMD EPYC                  </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-8  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Sapphire Rapids     </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-8  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2d-standard-8 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AMD EPYC                  </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">work laptop    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Apple M1 Max              </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-16 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">64</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2d-standard-16</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AMD EPYC                  </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">64</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-22 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Sapphire Rapids     </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">88</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">personal laptop</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Apple M2 Max              </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">96</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-32 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2d-standard-32</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AMD EPYC                  </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-44 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Sapphire Rapids     </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">44</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">176</span> │\n└─────────────────┴────────────────────────────┴───────────┴────────────┘\n</pre>\n```\n:::\n:::\n\n\n### What's in the data?\n\nWith the data, we can see we ran the benchmark on scale factors:\n\n::: {#1e8bb2dc .cell execution_count=8}\n``` {.python .cell-code}\nsfs = sorted(t.distinct(on=\"sf\")[\"sf\"].to_pyarrow().to_pylist())\nsfs\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\n[1, 8, 16, 32, 64, 128]\n```\n:::\n:::\n\n\n:::{.callout-note title=\"What is a scale factor?\" collapse=\"true\"}\nA scale factor is roughly the size of the data in memory in gigabytes. For\nexample, a scale factor of 1 means the data is roughly 1GB in memory.\n\nStored on disk in Parquet format, the data is smaller -- about 0.38GB for scale\nfactor 1 with the compression settings used in this benchmark.\n:::\n\nWe can look at the total execution time by scale factor:\n\n::: {#abc02807 .cell execution_count=9}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show bar plot code\"}\nc = px.bar(\n    t.group_by(\"sf\").agg(total_seconds=t[\"execution_seconds\"].sum()),\n    x=\"sf\",\n    y=\"total_seconds\",\n    category_orders={\"sf\": sfs},\n    title=\"total execution time by scale factor\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"744badd6-35fa-40b2-a056-fef72bd1c913\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"744badd6-35fa-40b2-a056-fef72bd1c913\")) {                    Plotly.newPlot(                        \"744badd6-35fa-40b2-a056-fef72bd1c913\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"sf=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"\",\"offsetgroup\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"textposition\":\"auto\",\"x\":[1,8,16,32,64,128],\"xaxis\":\"x\",\"y\":[1600.579779624939,10426.681049823761,19846.17095041275,38021.40961122513,74784.94995188713,164025.98512744904],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"sf\"},\"categoryorder\":\"array\",\"categoryarray\":[1,8,16,32,64,128]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"total_seconds\"}},\"legend\":{\"tracegroupgap\":0},\"title\":{\"text\":\"total execution time by scale factor\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('744badd6-35fa-40b2-a056-fef72bd1c913');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nWe ran on the following systems:\n\n::: {#f2c33bca .cell execution_count=10}\n``` {.python .cell-code}\nsystems = sorted(t.distinct(on=\"system\")[\"system\"].to_pyarrow().to_pylist())\nsystems\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\n['ibis-datafusion',\n 'ibis-datafusion-sql',\n 'ibis-duckdb',\n 'ibis-duckdb-sql',\n 'ibis-polars',\n 'polars-lazy']\n```\n:::\n:::\n\n\n:::{.callout-note title=\"What is a system?\" collapse=\"true\"}\nFor convenience in this benchmark, a 'system' is defined as a hyphen-separated\nnaming convention where:\n\n- `ibis-*`: Ibis was used\n    - `ibis-<backend>`: Ibis dataframe code was used with the given backend\n    - `ibis-<backend>-sql`: SQL code was used via Ibis on the given backend\n- `polars-*`: Polars was used\n    - `polars-lazy`: Polars was used with the LazyFrames API\n:::\n\nWe can look at the total execution time by system:\n\n::: {#020f4ffa .cell execution_count=11}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show bar plot code\"}\nc = px.bar(\n    t.group_by(\"system\").agg(total_seconds=t[\"execution_seconds\"].sum()),\n    x=\"system\",\n    y=\"total_seconds\",\n    color=\"system\",\n    category_orders={\"system\": systems},\n    title=\"total execution time by system\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"726cd46c-5f04-4d60-a59a-58eacc5addfa\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"726cd46c-5f04-4d60-a59a-58eacc5addfa\")) {                    Plotly.newPlot(                        \"726cd46c-5f04-4d60-a59a-58eacc5addfa\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion\",\"offsetgroup\":\"ibis-datafusion\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-datafusion\"],\"xaxis\":\"x\",\"y\":[58838.82606935501],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion-sql\",\"offsetgroup\":\"ibis-datafusion-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-datafusion-sql\"],\"xaxis\":\"x\",\"y\":[60297.199028253555],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb\",\"offsetgroup\":\"ibis-duckdb\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[57484.52195310593],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql\",\"offsetgroup\":\"ibis-duckdb-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-duckdb-sql\"],\"xaxis\":\"x\",\"y\":[57534.97966146469],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-polars\",\"offsetgroup\":\"ibis-polars\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\"],\"xaxis\":\"x\",\"y\":[30922.509821414948],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\"}},\"name\":\"polars-lazy\",\"offsetgroup\":\"polars-lazy\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"polars-lazy\"],\"xaxis\":\"x\",\"y\":[43627.73993682861],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"system\"},\"categoryorder\":\"array\",\"categoryarray\":[\"ibis-datafusion\",\"ibis-datafusion-sql\",\"ibis-duckdb\",\"ibis-duckdb-sql\",\"ibis-polars\",\"polars-lazy\"]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"total_seconds\"}},\"legend\":{\"title\":{\"text\":\"system\"},\"tracegroupgap\":0},\"title\":{\"text\":\"total execution time by system\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('726cd46c-5f04-4d60-a59a-58eacc5addfa');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nWe ran on the following instance types:\n\n::: {#3f302279 .cell execution_count=12}\n``` {.python .cell-code}\ninstance_types = sorted(\n    t.distinct(on=\"instance_type\")[\"instance_type\"].to_pyarrow().to_pylist(),\n    key=lambda x: (x.split(\"-\")[0], int(x.split(\"-\")[-1]))\n    if \"-\" in x\n    else (\"z\" + x[3], 0),\n)\ninstance_types\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```\n['c3-standard-4',\n 'c3-standard-8',\n 'c3-standard-22',\n 'c3-standard-44',\n 'n2-standard-2',\n 'n2-standard-4',\n 'n2-standard-8',\n 'n2-standard-16',\n 'n2-standard-32',\n 'n2d-standard-2',\n 'n2d-standard-4',\n 'n2d-standard-8',\n 'n2d-standard-16',\n 'n2d-standard-32',\n 'work laptop',\n 'personal laptop']\n```\n:::\n:::\n\n\n:::{.callout-note title=\"What is an instance type?\" collapse=\"true\"}\nAn instance type is the compute the benchmark was run on. This consists of two\nMacBook Pro laptops (one work and one personal) and a number of Google Cloud\nCompute Engine instances.\n\nFor cloud VMs, the instance type is in the form of `<family>-<type>-<cores>`,\nwhere:\n\n- `family` specifies the CPU architecture (Intel X, AMD Y)\n- `type` modifies the CPU to memory ratio (only `standard` is used with a 1:4)\n- `cores` is the number of vCPUs\n\nFor example, `n2d-standard-2` is a Google Cloud Compute Engine instance with an\nAMD EPYC processor, 2 vCPUs, and 8GB of memory.\n:::\n\nWe can look at the total execution time by instance type:\n\n::: {#4ce850c0 .cell execution_count=13}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show bar plot code\"}\nc = px.bar(\n    t.group_by(\"instance_type\")\n    .agg(total_seconds=t[\"execution_seconds\"].sum())\n    .join(instance_details, \"instance_type\"),\n    x=\"instance_type\",\n    y=\"total_seconds\",\n    color=\"cpu_type\",\n    hover_data=[\"cpu_cores\", \"memory_gbs\"],\n    # category_orders={\"instance_type\": instance_types},\n    category_orders={\n        \"instance_type\": instance_types,\n        \"cpu_type\": cpu_types,\n    },\n    title=\"total execution time by instance type\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"e0f1ce9c-0c15-423f-a191-8791f8001132\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"e0f1ce9c-0c15-423f-a191-8791f8001132\")) {                    Plotly.newPlot(                        \"e0f1ce9c-0c15-423f-a191-8791f8001132\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[8,32],[2,8],[4,16],[16,64],[32,128]],\"hovertemplate\":\"cpu_type=AMD EPYC\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"AMD EPYC\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"AMD EPYC\",\"offsetgroup\":\"AMD EPYC\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"n2d-standard-8\",\"n2d-standard-2\",\"n2d-standard-4\",\"n2d-standard-16\",\"n2d-standard-32\"],\"xaxis\":\"x\",\"y\":[12713.746816158295,44865.29464507103,27287.013442993164,8826.589931488037,7692.161742925644],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[12,32]],\"hovertemplate\":\"cpu_type=Apple M1 Max\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Apple M1 Max\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Apple M1 Max\",\"offsetgroup\":\"Apple M1 Max\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"work laptop\"],\"xaxis\":\"x\",\"y\":[18826.837838172913],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[12,96]],\"hovertemplate\":\"cpu_type=Apple M2 Max\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Apple M2 Max\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Apple M2 Max\",\"offsetgroup\":\"Apple M2 Max\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"personal laptop\"],\"xaxis\":\"x\",\"y\":[7762.792654275894],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[8,32],[16,64],[2,8],[4,16],[32,128]],\"hovertemplate\":\"cpu_type=Intel Cascade and Ice Lake\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Intel Cascade and Ice Lake\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Intel Cascade and Ice Lake\",\"offsetgroup\":\"Intel Cascade and Ice Lake\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"n2-standard-8\",\"n2-standard-16\",\"n2-standard-2\",\"n2-standard-4\",\"n2-standard-32\"],\"xaxis\":\"x\",\"y\":[16631.65527653694,11164.923608541489,54309.10380792618,32758.409986257553,9977.536410570145],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[44,176],[8,32],[4,16],[22,88]],\"hovertemplate\":\"cpu_type=Intel Sapphire Rapids\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Intel Sapphire Rapids\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Intel Sapphire Rapids\",\"offsetgroup\":\"Intel Sapphire Rapids\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"c3-standard-44\",\"c3-standard-8\",\"c3-standard-4\",\"c3-standard-22\"],\"xaxis\":\"x\",\"y\":[6403.986677646637,15898.618711233139,26386.615517616272,7200.489403009415],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"instance_type\"},\"categoryorder\":\"array\",\"categoryarray\":[\"c3-standard-4\",\"c3-standard-8\",\"c3-standard-22\",\"c3-standard-44\",\"n2-standard-2\",\"n2-standard-4\",\"n2-standard-8\",\"n2-standard-16\",\"n2-standard-32\",\"n2d-standard-2\",\"n2d-standard-4\",\"n2d-standard-8\",\"n2d-standard-16\",\"n2d-standard-32\",\"work laptop\",\"personal laptop\"]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"total_seconds\"}},\"legend\":{\"title\":{\"text\":\"cpu_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"total execution time by instance type\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('e0f1ce9c-0c15-423f-a191-8791f8001132');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nUnsurprisingly, this is inversely correlated with the number of CPU cores and\n(more importantly) memory for the instance type:\n\n::: {#1b1951f3 .cell execution_count=14}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show bar plot code\"}\nc = px.bar(\n    instance_details,\n    x=\"instance_type\",\n    y=\"memory_gbs\",\n    color=\"cpu_type\",\n    hover_data=[\"cpu_cores\", \"memory_gbs\"],\n    category_orders={\n        \"instance_type\": instance_types,\n        \"cpu_type\": cpu_types,\n    },\n    title=\"memory by instance type\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"29d662cd-44e1-42a6-9b69-5c97e16628a8\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"29d662cd-44e1-42a6-9b69-5c97e16628a8\")) {                    Plotly.newPlot(                        \"29d662cd-44e1-42a6-9b69-5c97e16628a8\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[2],[4],[8],[16],[32]],\"hovertemplate\":\"cpu_type=AMD EPYC\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003ememory_gbs=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"AMD EPYC\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"AMD EPYC\",\"offsetgroup\":\"AMD EPYC\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"n2d-standard-2\",\"n2d-standard-4\",\"n2d-standard-8\",\"n2d-standard-16\",\"n2d-standard-32\"],\"xaxis\":\"x\",\"y\":[8,16,32,64,128],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[12]],\"hovertemplate\":\"cpu_type=Apple M1 Max\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003ememory_gbs=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Apple M1 Max\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Apple M1 Max\",\"offsetgroup\":\"Apple M1 Max\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"work laptop\"],\"xaxis\":\"x\",\"y\":[32],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[12]],\"hovertemplate\":\"cpu_type=Apple M2 Max\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003ememory_gbs=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Apple M2 Max\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Apple M2 Max\",\"offsetgroup\":\"Apple M2 Max\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"personal laptop\"],\"xaxis\":\"x\",\"y\":[96],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[2],[4],[8],[16],[32]],\"hovertemplate\":\"cpu_type=Intel Cascade and Ice Lake\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003ememory_gbs=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Intel Cascade and Ice Lake\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Intel Cascade and Ice Lake\",\"offsetgroup\":\"Intel Cascade and Ice Lake\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"n2-standard-2\",\"n2-standard-4\",\"n2-standard-8\",\"n2-standard-16\",\"n2-standard-32\"],\"xaxis\":\"x\",\"y\":[8,16,32,64,128],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[4],[8],[22],[44]],\"hovertemplate\":\"cpu_type=Intel Sapphire Rapids\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003ememory_gbs=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Intel Sapphire Rapids\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Intel Sapphire Rapids\",\"offsetgroup\":\"Intel Sapphire Rapids\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"c3-standard-4\",\"c3-standard-8\",\"c3-standard-22\",\"c3-standard-44\"],\"xaxis\":\"x\",\"y\":[16,32,88,176],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"instance_type\"},\"categoryorder\":\"array\",\"categoryarray\":[\"c3-standard-4\",\"c3-standard-8\",\"c3-standard-22\",\"c3-standard-44\",\"n2-standard-2\",\"n2-standard-4\",\"n2-standard-8\",\"n2-standard-16\",\"n2-standard-32\",\"n2d-standard-2\",\"n2d-standard-4\",\"n2d-standard-8\",\"n2d-standard-16\",\"n2d-standard-32\",\"work laptop\",\"personal laptop\"]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"memory_gbs\"}},\"legend\":{\"title\":{\"text\":\"cpu_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"memory by instance type\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('29d662cd-44e1-42a6-9b69-5c97e16628a8');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nWe ran on the following queries:\n\n::: {#0015d58b .cell execution_count=15}\n``` {.python .cell-code}\nquery_numbers = sorted(\n    t.distinct(on=\"query_number\")[\"query_number\"].to_pyarrow().to_pylist()\n)\nquery_numbers\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```\n[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]\n```\n:::\n:::\n\n\n:::{.callout-note title=\"What is a query number?\" collapse=\"true\"}\nThe TPC-H benchmark defines 22 queries. See the [TPC-H benchmark\nspecification](https://www.tpc.org/TPC_Documents_Current_Versions/pdf/TPC-H_v3.0.1.pdf)\nfor more information.\n:::\n\nWe can look at the total execution time by query number:\n\n::: {#7b873089 .cell execution_count=16}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show bar plot code\"}\nc = px.bar(\n    t.group_by(\"query_number\").agg(total_seconds=t[\"execution_seconds\"].sum()),\n    x=\"query_number\",\n    y=\"total_seconds\",\n    category_orders={\"query_number\": query_numbers},\n    title=\"total execution time by query number\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"66d895bc-8bb6-42bb-b436-5a016e7eae07\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"66d895bc-8bb6-42bb-b436-5a016e7eae07\")) {                    Plotly.newPlot(                        \"66d895bc-8bb6-42bb-b436-5a016e7eae07\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"query_number=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"\",\"offsetgroup\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],\"xaxis\":\"x\",\"y\":[21056.510046720505,3685.074945449829,12819.760807991028,8480.374274730682,11834.102046251297,10688.606204509735,18887.29731631279,14052.494454860687,22051.161331176758,15887.331687450409,2990.691949367523,12739.110704421997,11047.851179599762,10706.916375398636,15876.686168670654,1247.1440830230713,18959.44294857979,37246.088896751404,18845.170838832855,12007.838083028793,25422.41154885292,2173.71057844162],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"},\"categoryorder\":\"array\",\"categoryarray\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"total_seconds\"}},\"legend\":{\"tracegroupgap\":0},\"title\":{\"text\":\"total execution time by query number\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('66d895bc-8bb6-42bb-b436-5a016e7eae07');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nIn theory, this should all lead to:\n\n::: {#e4e576cc .cell execution_count=17}\n``` {.python .cell-code}\nruns_per_query = 3\ntotal_runs_theoretical = (\n    runs_per_query * len(sfs) * len(systems) * len(instance_types) * len(query_numbers)\n)\nf\"total runs (theoretical): {total_runs_theoretical:,}\"\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```\n'total runs (theoretical): 38,016'\n```\n:::\n:::\n\n\n:::{.callout-note}\nTo reduce noise in the results, each query was run three times per\nconfiguration.\n:::\n\nBut we have:\n\n::: {#e483594f .cell execution_count=18}\n``` {.python .cell-code}\ntotal_runs_actual = t.count().to_pyarrow().as_py()\nf\"total runs (actual): {total_runs_actual:,}\"\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```\n'total runs (actual): 32,540'\n```\n:::\n:::\n\n\n::: {#ff0581ca .cell execution_count=19}\n``` {.python .cell-code}\nf\"missing runs: {total_runs_theoretical - total_runs_actual:,}\"\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```\n'missing runs: 5,476'\n```\n:::\n:::\n\n\nThese runs are not actually \"missing\", but rather failed.\n\n### Failing queries\n\nThe presence of a row of data indicates that the query ran successfully. It\nfollows the lack of a row of data means the query did not run successfully. This\ncan happen broadly for two reasons:\n\n1. The query doesn't work in the given system\n2. The query otherwise failed for the given system, scale factor, and instance type\n\nThe first may be an issue in Ibis or the backend. The second is usually due to memory pressure.\n\n#### Queries that don't work on a given system\n\nWe can look at the query numbers that never appear in the data for a given system:\n\n::: {#2a036846 .cell execution_count=20}\n``` {.python .cell-code}\nfailing = t.group_by(\"system\").agg(\n    present_queries=ibis._[\"query_number\"].collect().unique().sort()\n)\nfailing = (\n    failing.mutate(\n        failing_queries=t.distinct(on=\"query_number\")[\"query_number\"]\n        .collect()\n        .filter(lambda x: ~failing[\"present_queries\"].contains(x))\n    )\n    .mutate(\n        num_failing_queries=ibis._[\"failing_queries\"].length(),\n        num_successful_queries=ibis._[\"present_queries\"].length(),\n    )\n    .drop(\"present_queries\")\n    .order_by(\"num_failing_queries\", \"system\")\n)\nfailing\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> system              </span>┃<span style=\"font-weight: bold\"> failing_queries                      </span>┃<span style=\"font-weight: bold\"> num_failing_queries </span>┃<span style=\"font-weight: bold\"> num_successful_queries </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;int64&gt;</span>                         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>                  │\n├─────────────────────┼──────────────────────────────────────┼─────────────────────┼────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb        </span> │ <span style=\"font-weight: bold\">[]</span>                                   │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb-sql    </span> │ <span style=\"font-weight: bold\">[]</span>                                   │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">polars-lazy        </span> │ <span style=\"font-weight: bold\">[]</span>                                   │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span><span style=\"font-weight: bold\">]</span>                                 │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion    </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span><span style=\"font-weight: bold\">]</span>                         │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-polars        </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span><span style=\"font-weight: bold\">]</span> │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13</span> │\n└─────────────────────┴──────────────────────────────────────┴─────────────────────┴────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#2e14ad32 .cell execution_count=21}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show code to create a bar plot of the number of successful queries by system and instance type\"}\nc = px.bar(\n    failing,\n    x=\"system\",\n    y=\"num_successful_queries\",\n    category_orders={\n        \"system\": systems,\n        \"query_number\": query_numbers,\n    },\n    color=\"system\",\n    title=\"completed queries\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"b8c9ff36-18df-4237-8cfe-6970e0b086f9\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"b8c9ff36-18df-4237-8cfe-6970e0b086f9\")) {                    Plotly.newPlot(                        \"b8c9ff36-18df-4237-8cfe-6970e0b086f9\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion\",\"offsetgroup\":\"ibis-datafusion\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-datafusion\"],\"xaxis\":\"x\",\"y\":[19],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion-sql\",\"offsetgroup\":\"ibis-datafusion-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-datafusion-sql\"],\"xaxis\":\"x\",\"y\":[21],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb\",\"offsetgroup\":\"ibis-duckdb\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[22],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql\",\"offsetgroup\":\"ibis-duckdb-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-duckdb-sql\"],\"xaxis\":\"x\",\"y\":[22],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-polars\",\"offsetgroup\":\"ibis-polars\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\"],\"xaxis\":\"x\",\"y\":[13],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\"}},\"name\":\"polars-lazy\",\"offsetgroup\":\"polars-lazy\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"polars-lazy\"],\"xaxis\":\"x\",\"y\":[22],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"system\"},\"categoryorder\":\"array\",\"categoryarray\":[\"ibis-datafusion\",\"ibis-datafusion-sql\",\"ibis-duckdb\",\"ibis-duckdb-sql\",\"ibis-polars\",\"polars-lazy\"]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"num_successful_queries\"}},\"legend\":{\"title\":{\"text\":\"system\"},\"tracegroupgap\":0},\"title\":{\"text\":\"completed queries\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('b8c9ff36-18df-4237-8cfe-6970e0b086f9');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\n#### Queries that failed for a given system, scale factor, and instance type\n\n::: {#7ed6e48c .cell execution_count=22}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show code to create a bar plot of the number of successful queries by system and instance type\"}\nfailing = t.group_by(\"instance_type\", \"system\", \"sf\").agg(\n    total_time=t[\"execution_seconds\"].sum(),\n    present_queries=ibis._[\"query_number\"].collect().unique().sort(),\n)\nfailing = (\n    failing.mutate(\n        failing_queries=t.distinct(on=\"query_number\")[\"query_number\"]\n        .collect()\n        .filter(lambda x: ~failing[\"present_queries\"].contains(x)),\n    )\n    .mutate(\n        num_failing_queries=ibis._[\"failing_queries\"].length(),\n        num_successful_queries=ibis._[\"present_queries\"].length(),\n    )\n    .drop(\"present_queries\")\n    .relocate(\"instance_type\", \"system\", \"sf\", \"failing_queries\")\n    .order_by(\"num_failing_queries\", \"instance_type\", \"system\", \"sf\")\n)\nfailing = failing.join(instance_details, \"instance_type\")\nfailing = (\n    failing.filter(\n        (failing[\"sf\"] == 128) & (failing[\"instance_type\"].startswith(\"n2d-\"))\n    )\n).order_by(ibis.desc(\"memory_gbs\"))\n\nc = px.bar(\n    failing,\n    x=\"system\",\n    y=\"num_successful_queries\",\n    color=\"instance_type\",\n    barmode=\"group\",\n    hover_data=[\"cpu_cores\", \"memory_gbs\"],\n    category_orders={\n        \"system\": systems,\n        \"instance_type\": reversed(\n            [instance for instance in instance_types if instance.startswith(\"n2d\")]\n        ),\n    },\n    title=\"completed queries\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"406f6bec-599a-4b6e-bf72-743d362a1375\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"406f6bec-599a-4b6e-bf72-743d362a1375\")) {                    Plotly.newPlot(                        \"406f6bec-599a-4b6e-bf72-743d362a1375\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[32,128],[32,128],[32,128],[32,128],[32,128],[32,128]],\"hovertemplate\":\"instance_type=n2d-standard-32\\u003cbr\\u003esystem=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"n2d-standard-32\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"n2d-standard-32\",\"offsetgroup\":\"n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\",\"polars-lazy\",\"ibis-datafusion-sql\",\"ibis-datafusion\",\"ibis-duckdb-sql\",\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[11,21,21,19,22,22],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[16,64],[16,64],[16,64],[16,64],[16,64],[16,64]],\"hovertemplate\":\"instance_type=n2d-standard-16\\u003cbr\\u003esystem=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"n2d-standard-16\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"n2d-standard-16\",\"offsetgroup\":\"n2d-standard-16\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\",\"ibis-datafusion-sql\",\"polars-lazy\",\"ibis-datafusion\",\"ibis-duckdb-sql\",\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[7,21,17,18,22,22],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[8,32],[8,32],[8,32],[8,32],[8,32],[8,32]],\"hovertemplate\":\"instance_type=n2d-standard-8\\u003cbr\\u003esystem=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"n2d-standard-8\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"n2d-standard-8\",\"offsetgroup\":\"n2d-standard-8\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\",\"polars-lazy\",\"ibis-datafusion-sql\",\"ibis-duckdb-sql\",\"ibis-duckdb\",\"ibis-datafusion\"],\"xaxis\":\"x\",\"y\":[3,13,21,22,22,18],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[4,16],[4,16],[4,16],[4,16],[4,16],[4,16]],\"hovertemplate\":\"instance_type=n2d-standard-4\\u003cbr\\u003esystem=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"n2d-standard-4\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"n2d-standard-4\",\"offsetgroup\":\"n2d-standard-4\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"polars-lazy\",\"ibis-duckdb-sql\",\"ibis-polars\",\"ibis-datafusion\",\"ibis-datafusion-sql\",\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[8,22,2,17,18,22],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[2,8],[2,8],[2,8],[2,8],[2,8],[2,8]],\"hovertemplate\":\"instance_type=n2d-standard-2\\u003cbr\\u003esystem=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"n2d-standard-2\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"n2d-standard-2\",\"offsetgroup\":\"n2d-standard-2\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"polars-lazy\",\"ibis-datafusion\",\"ibis-polars\",\"ibis-datafusion-sql\",\"ibis-duckdb-sql\",\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[4,16,2,17,22,22],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"system\"},\"categoryorder\":\"array\",\"categoryarray\":[\"ibis-datafusion\",\"ibis-datafusion-sql\",\"ibis-duckdb\",\"ibis-duckdb-sql\",\"ibis-polars\",\"polars-lazy\"]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"num_successful_queries\"}},\"legend\":{\"title\":{\"text\":\"instance_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"completed queries\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('406f6bec-599a-4b6e-bf72-743d362a1375');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\n#### Average execution time by query, system, scale factor, and instance type\n\nLet's create an aggregated table with the mean execution time for each query, system, scale factor, and instance type:\n\n::: {#59360a04 .cell execution_count=23}\n``` {.python .cell-code}\nagg = (\n    t.group_by(\"instance_type\", \"system\", \"sf\", \"n_partitions\", \"query_number\")\n    .agg(\n        mean_execution_seconds=t[\"execution_seconds\"].mean(),\n    )\n    .order_by(\n        ibis.asc(\"instance_type\"),\n        ibis.desc(\"sf\"),\n        ibis.asc(\"query_number\"),\n        ibis.asc(\"system\"),\n        ibis.asc(\"mean_execution_seconds\"),\n    )\n)\nagg.head(6)\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> instance_type  </span>┃<span style=\"font-weight: bold\"> system              </span>┃<span style=\"font-weight: bold\"> sf    </span>┃<span style=\"font-weight: bold\"> n_partitions </span>┃<span style=\"font-weight: bold\"> query_number </span>┃<span style=\"font-weight: bold\"> mean_execution_seconds </span>┃\n┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                │\n├────────────────┼─────────────────────┼───────┼──────────────┼──────────────┼────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-22</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion    </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16.575746</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-22</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12.196440</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-22</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb        </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.504730</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-22</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb-sql    </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6.595881</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-22</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion    </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.205603</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-22</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.303854</span> │\n└────────────────┴─────────────────────┴───────┴──────────────┴──────────────┴────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#fbaf78e0 .cell execution_count=24}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show code to create a bar plot of the mean execution time by query\"}\ndef timings_plot(agg, sf, instance_type, max_query_number, log_y=True):\n    data = (\n        agg.filter(agg[\"sf\"] == sf)\n        .filter(agg[\"instance_type\"] == instance_type)\n        .filter(agg[\"query_number\"] <= max_query_number)\n    )\n\n    c = px.bar(\n        data,\n        x=\"query_number\",\n        y=\"mean_execution_seconds\",\n        log_y=log_y,\n        color=\"system\",\n        barmode=\"group\",\n        category_orders={\"system\": systems},\n        title=f\"sf: {sf}, instance_type: {instance_type}\",\n    )\n\n    return c\n```\n:::\n\n\n:::{.callout-note title=\"See the dashboard for more complete visualizations\"}\nBelow we'll zoom in on a single scale factor, compute instance, and limit\nourselves to the first 7 queries. This is primarily due to space limitations in\nthe blog post.\n\nThe [`ibis-bench` dashboard](https://ibis-bench.streamlit.app) has more complete\nvisualizations and allows you to explore the data in more detail.\n:::\n\nLet's look at how each system performed on my work laptop:\n\n::: {#f35e95c4 .cell execution_count=25}\n``` {.python .cell-code}\nsf = 128\ninstance_type = \"work laptop\"\nmax_query_number = 7\n\nc = timings_plot(agg, sf, instance_type, max_query_number)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"553406f1-dfd4-413f-9faa-686b0aad5860\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"553406f1-dfd4-413f-9faa-686b0aad5860\")) {                    Plotly.newPlot(                        \"553406f1-dfd4-413f-9faa-686b0aad5860\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion\",\"offsetgroup\":\"ibis-datafusion\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[15.396080017089844,1.4105884234110515,6.940809806187947,5.741453727086385,8.292623281478882,4.342297315597534,12.617551247278849],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion-sql\",\"offsetgroup\":\"ibis-datafusion-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[15.996194998423258,4.289955536524455,7.163947105407715,5.463071902592977,8.65388790766398,3.461572011311849,25.303852796554565],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb\",\"offsetgroup\":\"ibis-duckdb\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[11.816201368967691,1.0742097695668538,7.4447410106658936,4.322394371032715,7.119431972503662,5.06160036722819,15.063642740249634],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql\",\"offsetgroup\":\"ibis-duckdb-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[10.09945241610209,1.5465373198191326,6.933528900146484,5.009043614069621,6.48460594813029,5.4021016756693525,16.46793508529663],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-polars\",\"offsetgroup\":\"ibis-polars\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[432.73190569877625,3.3259663581848145,19.9964923063914,20.11745572090149,58.228812297185264,8.199389219284058,48.8675704797109],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\"}},\"name\":\"polars-lazy\",\"offsetgroup\":\"polars-lazy\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[205.77899734179178,1.4757316907246907,25.31752061843872,13.653836329778036,70.19453835487366,8.418299516042074,18.92843262354533],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"},\"type\":\"log\"},\"legend\":{\"title\":{\"text\":\"system\"},\"tracegroupgap\":0},\"title\":{\"text\":\"sf: 128, instance_type: work laptop\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('553406f1-dfd4-413f-9faa-686b0aad5860');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nAnd on a Google Cloud Compute Engine instance with 32 vCPUs and 128GB of memory:\n\n::: {#aecf5b05 .cell execution_count=26}\n``` {.python .cell-code}\ninstance_type = \"n2d-standard-32\"\n\nc = timings_plot(agg, sf, instance_type, max_query_number)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"72788eef-0842-4b72-a0da-b64060bef8f5\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"72788eef-0842-4b72-a0da-b64060bef8f5\")) {                    Plotly.newPlot(                        \"72788eef-0842-4b72-a0da-b64060bef8f5\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion\",\"offsetgroup\":\"ibis-datafusion\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[16.529266754786175,2.2544215520222983,9.200567960739136,7.482565720876058,7.471903959910075,3.4388548533121743,11.63159171740214],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion-sql\",\"offsetgroup\":\"ibis-datafusion-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[12.949114084243774,6.693936745325725,9.455447912216187,3.730076869328817,9.587421178817749,2.7630774974823,17.029499053955078],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb\",\"offsetgroup\":\"ibis-duckdb\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[5.938729286193848,0.6979877154032389,3.935547669728597,2.8200621604919434,3.9903443654378257,2.341557025909424,7.479643742243449],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql\",\"offsetgroup\":\"ibis-duckdb-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[5.2171577612559,1.0186904271443684,3.7939114570617676,3.0171448389689126,3.694347699483236,2.716411034266154,10.273284514745077],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-polars\",\"offsetgroup\":\"ibis-polars\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[62.19382929801941,5.905109326044719,27.108211437861126,11.461715777715048,13.99797248840332,4.244828224182129,12.255585193634033],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\"}},\"name\":\"polars-lazy\",\"offsetgroup\":\"polars-lazy\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[33.80695390701294,3.2517149448394775,13.268091122309366,10.389480113983154,13.94202979405721,3.6897570292154946,10.39676809310913],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"},\"type\":\"log\"},\"legend\":{\"title\":{\"text\":\"system\"},\"tracegroupgap\":0},\"title\":{\"text\":\"sf: 128, instance_type: n2d-standard-32\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('72788eef-0842-4b72-a0da-b64060bef8f5');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nAnd on a Google Cloud Compute Engine instance with 2 vCPUs and 8GB of memory:\n\n::: {#9267d76c .cell execution_count=27}\n``` {.python .cell-code}\ninstance_type = \"n2d-standard-2\"\n\nc = timings_plot(agg, sf, instance_type, max_query_number)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"4498ebab-3308-4697-8318-111fb51e2056\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"4498ebab-3308-4697-8318-111fb51e2056\")) {                    Plotly.newPlot(                        \"4498ebab-3308-4697-8318-111fb51e2056\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion\",\"offsetgroup\":\"ibis-datafusion\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[141.34012492497763,11.363901694615683,93.7709014415741,60.15771754582723,103.98395832379659,73.55492202440898,146.63673464457193],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion-sql\",\"offsetgroup\":\"ibis-datafusion-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6],\"xaxis\":\"x\",\"y\":[150.74161338806152,29.713732481002808,88.4080200990041,55.97467875480652,111.47976183891296,57.67109179496765],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb\",\"offsetgroup\":\"ibis-duckdb\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[111.81634593009949,9.01880407333374,76.22619962692261,53.14470879236857,79.99639010429382,49.7428944905599,167.6698002020518],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql\",\"offsetgroup\":\"ibis-duckdb-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7],\"xaxis\":\"x\",\"y\":[93.9455053806305,15.153176069259644,73.71186025937398,55.44052871068319,74.46631360054016,55.65792457262675,269.1292410691579],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-polars\",\"offsetgroup\":\"ibis-polars\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[2,6],\"xaxis\":\"x\",\"y\":[13.319883108139038,61.469714879989624],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"},\"type\":\"log\"},\"legend\":{\"title\":{\"text\":\"system\"},\"tracegroupgap\":0},\"title\":{\"text\":\"sf: 128, instance_type: n2d-standard-2\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('4498ebab-3308-4697-8318-111fb51e2056');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\n## Reproducing the benchmark\n\nThe source code for [`ibis-bench` is available on\nGitHub](https://github.com/lostmygithubaccount/ibis-bench/tree/v2.0.0).\n\n### A TPC-H benchmark on 6 systems in 3 commands\n\nFirst install `ibis-bench`:\n\n```bash\npip install ibis-bench\n```\n\nThen generate the TPC-H data:\n\n```bash\nbench gen-data -s 1\n```\n\nFinally run the benchmark:\n\n```bash\nbench run -s 1 ibis-duckdb ibis-duckdb-sql ibis-datafusion ibis-datafusion-sql ibis-polars polars-lazy\n```\n\nCongratulations! You've run a TPC-H benchmark on DuckDB (Ibis dataframe code and\nSQL), DataFusion (Ibis dataframe code and SQL), and Polars (dataframe code via\nIbis and native Polars).\n\n#### What just happened?\n\nThis will generate TPC-H data at scale factor 1 as Parquet files in the\n`tpch_data` directory:\n\n```bash\ntpch_data\n└── parquet\n    └── sf=1\n        └── n=1\n            ├── customer\n            │   └── 0000.parquet\n            ├── lineitem\n            │   └── 0000.parquet\n            ├── nation\n            │   └── 0000.parquet\n            ├── orders\n            │   └── 0000.parquet\n            ├── part\n            │   └── 0000.parquet\n            ├── partsupp\n            │   └── 0000.parquet\n            ├── region\n            │   └── 0000.parquet\n            └── supplier\n                └── 0000.parquet\n```\n\nThe scale factor is roughly the size of data **in memory** in gigabytes (GBs).\nThe size of data on disk, however, is smaller because Parquet is compressed. We\ncan take a look at the size of the data:\n\n```bash\n384M    tpch_data/parquet/sf=1/n=1\n262M    tpch_data/parquet/sf=1/n=1/lineitem\n 59M    tpch_data/parquet/sf=1/n=1/orders\n 12M    tpch_data/parquet/sf=1/n=1/customer\n 43M    tpch_data/parquet/sf=1/n=1/partsupp\n6.6M    tpch_data/parquet/sf=1/n=1/part\n788K    tpch_data/parquet/sf=1/n=1/supplier\n4.0K    tpch_data/parquet/sf=1/n=1/nation\n4.0K    tpch_data/parquet/sf=1/n=1/region\n```\n\nWe can see the total size is 0.38 GB and the size of the tables -- `lineitem` is\nby far the largest.\n\nUsing `bench run` results in a `results_data` directory with the results of the\nqueries and a `bench_logs_v2` directory with the logs of the benchmark run.\n\n### Analyzing the results\n\nWe can use Ibis to load and analyze the log data:\n\n::: {#e9f988c3 .cell execution_count=28}\n``` {.python .cell-code}\nimport ibis\n\nibis.options.interactive = True\nibis.options.repr.interactive.max_rows = 6\nibis.options.repr.interactive.max_columns = None\n\nt = ibis.read_json(\"bench_logs_v*/raw_json/file_id=*.json\").relocate(\n    \"system\", \"sf\", \"query_number\", \"execution_seconds\"\n)\nt\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> system              </span>┃<span style=\"font-weight: bold\"> sf    </span>┃<span style=\"font-weight: bold\"> query_number </span>┃<span style=\"font-weight: bold\"> execution_seconds </span>┃<span style=\"font-weight: bold\"> session_id                           </span>┃<span style=\"font-weight: bold\"> instance_type </span>┃<span style=\"font-weight: bold\"> timestamp                  </span>┃<span style=\"font-weight: bold\"> n_partitions </span>┃<span style=\"font-weight: bold\"> file_type </span>┃<span style=\"font-weight: bold\"> file_id                                   </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">uuid</span>                                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">json</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                    │\n├─────────────────────┼───────┼──────────────┼───────────────────┼──────────────────────────────────────┼───────────────┼────────────────────────────┼──────────────┼───────────┼───────────────────────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.076600</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:34.476397</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">00218347-a4cd-4590-a502-8cf79f4e87c9.json</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.165074</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:35.376753</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">01089668-608c-4551-ae65-6d98d69f959b.json</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-polars        </span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.075944</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:36.956001</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">02a991bd-797a-4c08-83de-c1b537f713fe.json</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion    </span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.144007</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:32.297647</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">02bd900a-3c0a-4871-b651-1690f11a81ab.json</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.067048</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:33.699368</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">08490a6b-e1ab-482c-83bc-85469c6b96a3.json</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb        </span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.160302</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:27.316339</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">08b92577-8150-4040-bceb-9316da7bfaf4.json</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                   │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                          │            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                         │\n└─────────────────────┴───────┴──────────────┴───────────────────┴──────────────────────────────────────┴───────────────┴────────────────────────────┴──────────────┴───────────┴───────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\nWe can check the total execution time for each system:\n\n::: {#53eaee75 .cell execution_count=29}\n``` {.python .cell-code}\nt.group_by(\"system\").agg(total_seconds=t[\"execution_seconds\"].sum()).order_by(\n    \"total_seconds\"\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> system              </span>┃<span style=\"font-weight: bold\"> total_seconds </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │\n├─────────────────────┼───────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.006620</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb-sql    </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.067606</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">polars-lazy        </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.086350</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-polars        </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.168417</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb        </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.495270</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion    </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.529014</span> │\n└─────────────────────┴───────────────┘\n</pre>\n```\n:::\n:::\n\n\nWe can visualize the results:\n\n::: {#ca3119c4 .cell execution_count=30}\n``` {.python .cell-code}\nimport plotly.express as px\n\npx.defaults.template = \"plotly_dark\"\n\nagg = t.group_by(\"system\", \"query_number\").agg(\n    mean_execution_seconds=t[\"execution_seconds\"].mean(),\n)\n\nchart = px.bar(\n    agg,\n    x=\"query_number\",\n    y=\"mean_execution_seconds\",\n    color=\"system\",\n    barmode=\"group\",\n    title=\"Mean execution time by query\",\n    category_orders={\n        \"system\": sorted(t.select(\"system\").distinct().to_pandas()[\"system\"].tolist())\n    },\n)\nchart\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"3f0a7575-aca9-4cb9-8bc5-d45e5be868c2\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"3f0a7575-aca9-4cb9-8bc5-d45e5be868c2\")) {                    Plotly.newPlot(                        \"3f0a7575-aca9-4cb9-8bc5-d45e5be868c2\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion\",\"offsetgroup\":\"ibis-datafusion\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[19,7,13,8,9,5,17,14,1,3,20,6,12,4,11,15,2,10,18],\"xaxis\":\"x\",\"y\":[0.18033623695373535,0.21130585670471191,0.08080005645751953,0.17679595947265625,0.25276899337768555,0.16351318359375,0.1508030891418457,0.05874824523925781,0.1856980323791504,0.11346817016601562,0.09459996223449707,0.060302019119262695,0.09185004234313965,0.08527374267578125,0.05636405944824219,0.09078383445739746,0.11647200584411621,0.14400672912597656,0.21512389183044434],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion-sql\",\"offsetgroup\":\"ibis-datafusion-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[3,6,20,12,4,8,7,19,13,21,1,10,2,18,22,15,11,14,17,9,5],\"xaxis\":\"x\",\"y\":[0.06704831123352051,0.04186129570007324,0.08157896995544434,0.0766000747680664,0.05468416213989258,0.10038995742797852,0.11693096160888672,0.10790419578552246,0.08853602409362793,0.16507411003112793,0.16572284698486328,0.11253213882446289,0.06422877311706543,0.16417670249938965,0.04712080955505371,0.08836483955383301,0.04051613807678223,0.05418872833251953,0.1384258270263672,0.14054203033447266,0.09019279479980469],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb\",\"offsetgroup\":\"ibis-duckdb\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[10,2,18,4,15,22,16,11,14,5,17,9,12,6,20,3,13,7,8,19,1,21],\"xaxis\":\"x\",\"y\":[0.16030216217041016,0.06649017333984375,0.19187211990356445,0.10530900955200195,0.10355687141418457,0.05627894401550293,0.050956010818481445,0.046521902084350586,0.07600784301757812,0.13889694213867188,0.0946509838104248,0.15702605247497559,0.08757591247558594,0.05837392807006836,0.09756278991699219,0.11275124549865723,0.08141613006591797,0.22138595581054688,0.17993402481079102,0.10899090766906738,0.11120414733886719,0.18820619583129883],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql\",\"offsetgroup\":\"ibis-duckdb-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[4,10,18,2,6,20,12,3,21,1,7,8,19,13,17,5,14,9,22,11,15,16],\"xaxis\":\"x\",\"y\":[0.06797170639038086,0.13234424591064453,0.14215707778930664,0.04390978813171387,0.0639650821685791,0.0834193229675293,0.1077890396118164,0.08614110946655273,0.18464303016662598,0.0995640754699707,0.1173713207244873,0.10016512870788574,0.10991191864013672,0.11796116828918457,0.0904390811920166,0.08590102195739746,0.07589483261108398,0.1208350658416748,0.052903175354003906,0.03215789794921875,0.11138105392456055,0.040780067443847656],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-polars\",\"offsetgroup\":\"ibis-polars\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,7,19,8,4,12,3,6,9,5,10,2,18],\"xaxis\":\"x\",\"y\":[0.2844810485839844,0.14421916007995605,0.24024128913879395,0.13718080520629883,0.061795949935913086,0.0759439468383789,0.08300375938415527,0.04763507843017578,0.375777006149292,0.0971367359161377,0.09395790100097656,0.062339067459106445,0.4647057056427002],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\"}},\"name\":\"polars-lazy\",\"offsetgroup\":\"polars-lazy\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[20,3,6,12,4,19,13,7,8,21,1,2,18,10,22,15,11,16,14,9,17,5],\"xaxis\":\"x\",\"y\":[0.06121683120727539,0.05814409255981445,0.04187202453613281,0.09165000915527344,0.04979085922241211,0.09669184684753418,0.07697010040283203,0.07666802406311035,0.08124113082885742,0.4784820079803467,0.14653277397155762,0.02666497230529785,0.10887598991394043,0.08218693733215332,0.034562110900878906,0.0383148193359375,0.060350894927978516,0.027947187423706055,0.04080796241760254,0.2673678398132324,0.07406091690063477,0.06595110893249512],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"}},\"legend\":{\"title\":{\"text\":\"system\"},\"tracegroupgap\":0},\"title\":{\"text\":\"Mean execution time by query\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('3f0a7575-aca9-4cb9-8bc5-d45e5be868c2');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\n### What did we run and measure, exactly?\n\nWe can import `ibis_bench` as a library and read in the TPC-H tables:\n\n::: {#bfafe6d8 .cell execution_count=31}\n``` {.python .cell-code}\nimport ibis\nimport polars as pl\n\nfrom datetime import date\nfrom ibis_bench.utils.read_data import get_ibis_tables, get_polars_tables\n\nsf = 1\n```\n:::\n\n\n:::{.panel-tabset}\n\n## Ibis (DuckDB)\n\n::: {#860717c2 .cell execution_count=32}\n``` {.python .cell-code}\ncon = ibis.connect(\"duckdb://\")\n\n(customer, lineitem, nation, orders, part, partsupp, region, supplier) = (\n    get_ibis_tables(sf=sf, con=con)\n)\n```\n:::\n\n\n\n\n::: {#6a824759 .cell execution_count=34}\n``` {.python .cell-code}\nlineitem.order_by(ibis.desc(\"l_orderkey\"), ibis.asc(\"l_partkey\"))\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> l_orderkey </span>┃<span style=\"font-weight: bold\"> l_partkey </span>┃<span style=\"font-weight: bold\"> l_suppkey </span>┃<span style=\"font-weight: bold\"> l_linenumber </span>┃<span style=\"font-weight: bold\"> l_quantity </span>┃<span style=\"font-weight: bold\"> l_extendedprice </span>┃<span style=\"font-weight: bold\"> l_discount </span>┃<span style=\"font-weight: bold\"> l_tax   </span>┃<span style=\"font-weight: bold\"> l_returnflag </span>┃<span style=\"font-weight: bold\"> l_linestatus </span>┃<span style=\"font-weight: bold\"> l_shipdate </span>┃<span style=\"font-weight: bold\"> l_commitdate </span>┃<span style=\"font-weight: bold\"> l_receiptdate </span>┃<span style=\"font-weight: bold\"> l_shipinstruct    </span>┃<span style=\"font-weight: bold\"> l_shipmode </span>┃<span style=\"font-weight: bold\"> l_comment                                </span>┃\n┡━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                   │\n├────────────┼───────────┼───────────┼──────────────┼────────────┼─────────────────┼────────────┼─────────┼──────────────┼──────────────┼────────────┼──────────────┼───────────────┼───────────────────┼────────────┼──────────────────────────────────────────┤\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32255</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2256</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.0</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5936.25</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.03</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-19</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-12-01</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">TAKE BACK RETURN </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">riously pe                              </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">96127</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">28.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31447.36</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.02</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-09-22</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-01</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">NONE             </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AIR       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">pecial excuses nag evenly f             </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6452</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1453</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.0</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9509.15</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.00</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-23</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-19</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">SHIP      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ffily along the sly                     </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7272</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2273</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37736.64</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.07</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-07</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-30</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">REG AIR   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ld deposits aga                         </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37131</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2138</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19226.34</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-17</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-08-28</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-12-08</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">FOB       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">counts cajole evenly? sly orbits boost f</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999974</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10463</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5466</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">46.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">63179.16</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.08</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.06</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-16</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-21</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-02</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">RAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">se slyly alo                            </span> │\n│          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │               <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                        │\n└────────────┴───────────┴───────────┴──────────────┴────────────┴─────────────────┴────────────┴─────────┴──────────────┴──────────────┴────────────┴──────────────┴───────────────┴───────────────────┴────────────┴──────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#82b5b585 .cell execution_count=35}\n``` {.python .cell-code}\nlineitem.count()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=34}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre>┌─────────┐\n│ <span class=\"ansi-cyan-fg ansi-bold\">6001215</span> │\n└─────────┘</pre>\n```\n:::\n\n:::\n:::\n\n\n## Ibis (DataFusion)\n\n::: {#75a6164b .cell execution_count=36}\n``` {.python .cell-code}\ncon = ibis.connect(\"datafusion://\")\n\n(customer, lineitem, nation, orders, part, partsupp, region, supplier) = (\n    get_ibis_tables(sf=sf, con=con)\n)\n```\n:::\n\n\n::: {#c5c43a8d .cell execution_count=37}\n``` {.python .cell-code}\nlineitem.order_by(ibis.desc(\"l_orderkey\"), ibis.asc(\"l_partkey\"))\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> l_orderkey </span>┃<span style=\"font-weight: bold\"> l_partkey </span>┃<span style=\"font-weight: bold\"> l_suppkey </span>┃<span style=\"font-weight: bold\"> l_linenumber </span>┃<span style=\"font-weight: bold\"> l_quantity </span>┃<span style=\"font-weight: bold\"> l_extendedprice </span>┃<span style=\"font-weight: bold\"> l_discount </span>┃<span style=\"font-weight: bold\"> l_tax   </span>┃<span style=\"font-weight: bold\"> l_returnflag </span>┃<span style=\"font-weight: bold\"> l_linestatus </span>┃<span style=\"font-weight: bold\"> l_shipdate </span>┃<span style=\"font-weight: bold\"> l_commitdate </span>┃<span style=\"font-weight: bold\"> l_receiptdate </span>┃<span style=\"font-weight: bold\"> l_shipinstruct    </span>┃<span style=\"font-weight: bold\"> l_shipmode </span>┃<span style=\"font-weight: bold\"> l_comment                                </span>┃\n┡━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                   │\n├────────────┼───────────┼───────────┼──────────────┼────────────┼─────────────────┼────────────┼─────────┼──────────────┼──────────────┼────────────┼──────────────┼───────────────┼───────────────────┼────────────┼──────────────────────────────────────────┤\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32255</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2256</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.0</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5936.25</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.03</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-19</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-12-01</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">TAKE BACK RETURN </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">riously pe                              </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">96127</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">28.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31447.36</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.02</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-09-22</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-01</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">NONE             </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AIR       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">pecial excuses nag evenly f             </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6452</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1453</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.0</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9509.15</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.00</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-23</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-19</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">SHIP      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ffily along the sly                     </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7272</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2273</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37736.64</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.07</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-07</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-30</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">REG AIR   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ld deposits aga                         </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37131</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2138</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19226.34</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-17</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-08-28</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-12-08</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">FOB       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">counts cajole evenly? sly orbits boost f</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999974</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10463</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5466</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">46.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">63179.16</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.08</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.06</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-16</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-21</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-02</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">RAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">se slyly alo                            </span> │\n│          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │               <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                        │\n└────────────┴───────────┴───────────┴──────────────┴────────────┴─────────────────┴────────────┴─────────┴──────────────┴──────────────┴────────────┴──────────────┴───────────────┴───────────────────┴────────────┴──────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#ca5b67d9 .cell execution_count=38}\n``` {.python .cell-code}\nlineitem.count()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=37}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre>┌─────────┐\n│ <span class=\"ansi-cyan-fg ansi-bold\">6001215</span> │\n└─────────┘</pre>\n```\n:::\n\n:::\n:::\n\n\n## Ibis (Polars)\n\n::: {#20f9e974 .cell execution_count=39}\n``` {.python .cell-code}\ncon = ibis.connect(\"polars://\")\n\n(customer, lineitem, nation, orders, part, partsupp, region, supplier) = (\n    get_ibis_tables(sf=sf, con=con)\n)\n```\n:::\n\n\n::: {#5181f619 .cell execution_count=40}\n``` {.python .cell-code}\nlineitem.order_by(ibis.desc(\"l_orderkey\"), ibis.asc(\"l_partkey\"))\n```\n\n::: {.cell-output .cell-output-display execution_count=39}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> l_orderkey </span>┃<span style=\"font-weight: bold\"> l_partkey </span>┃<span style=\"font-weight: bold\"> l_suppkey </span>┃<span style=\"font-weight: bold\"> l_linenumber </span>┃<span style=\"font-weight: bold\"> l_quantity </span>┃<span style=\"font-weight: bold\"> l_extendedprice </span>┃<span style=\"font-weight: bold\"> l_discount </span>┃<span style=\"font-weight: bold\"> l_tax   </span>┃<span style=\"font-weight: bold\"> l_returnflag </span>┃<span style=\"font-weight: bold\"> l_linestatus </span>┃<span style=\"font-weight: bold\"> l_shipdate </span>┃<span style=\"font-weight: bold\"> l_commitdate </span>┃<span style=\"font-weight: bold\"> l_receiptdate </span>┃<span style=\"font-weight: bold\"> l_shipinstruct    </span>┃<span style=\"font-weight: bold\"> l_shipmode </span>┃<span style=\"font-weight: bold\"> l_comment                                </span>┃\n┡━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                   │\n├────────────┼───────────┼───────────┼──────────────┼────────────┼─────────────────┼────────────┼─────────┼──────────────┼──────────────┼────────────┼──────────────┼───────────────┼───────────────────┼────────────┼──────────────────────────────────────────┤\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32255</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2256</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.0</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5936.25</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.03</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-19</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-12-01</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">TAKE BACK RETURN </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">riously pe                              </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">96127</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">28.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31447.36</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.02</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-09-22</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-01</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">NONE             </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AIR       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">pecial excuses nag evenly f             </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6452</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1453</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.0</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9509.15</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.00</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-23</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-19</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">SHIP      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ffily along the sly                     </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7272</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2273</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37736.64</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.07</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-07</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-30</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">REG AIR   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ld deposits aga                         </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37131</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2138</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19226.34</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-17</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-08-28</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-12-08</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">FOB       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">counts cajole evenly? sly orbits boost f</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999974</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10463</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5466</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">46.0</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">63179.16</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.08</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.06</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-16</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-21</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-02</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">RAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">se slyly alo                            </span> │\n│          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │               <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                        │\n└────────────┴───────────┴───────────┴──────────────┴────────────┴─────────────────┴────────────┴─────────┴──────────────┴──────────────┴────────────┴──────────────┴───────────────┴───────────────────┴────────────┴──────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#40ad515b .cell execution_count=41}\n``` {.python .cell-code}\nlineitem.count()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=40}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre>┌─────────┐\n│ <span class=\"ansi-cyan-fg ansi-bold\">6001215</span> │\n└─────────┘</pre>\n```\n:::\n\n:::\n:::\n\n\n:::\n\n\n\nThe queries are also defined in `ibis_bench.queries`. Let's look at query 4 as\nan example for Ibis dataframe code, Polars dataframe code, and SQL code via\nIbis:\n\n:::{.panel-tabset}\n\n## Ibis (dataframe)\n\nDefine query 4:\n\n::: {#c685805b .cell execution_count=43}\n``` {.python .cell-code}\ndef q4(lineitem, orders, **kwargs):\n    var1 = date(1993, 7, 1)\n    var2 = date(1993, 10, 1)\n\n    q_final = (\n        lineitem.join(orders, lineitem[\"l_orderkey\"] == orders[\"o_orderkey\"])\n        .filter((orders[\"o_orderdate\"] >= var1) & (orders[\"o_orderdate\"] < var2))\n        .filter(lineitem[\"l_commitdate\"] < lineitem[\"l_receiptdate\"])\n        .distinct(on=[\"o_orderpriority\", \"l_orderkey\"])\n        .group_by(\"o_orderpriority\")\n        .agg(order_count=ibis._.count())\n        .order_by(\"o_orderpriority\")\n    )\n\n    return q_final\n```\n:::\n\n\nRun query 4:\n\n::: {#23c5a729 .cell execution_count=44}\n``` {.python .cell-code}\nres = q4(lineitem, orders)\nres\n```\n\n::: {.cell-output .cell-output-display execution_count=43}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> o_orderpriority </span>┃<span style=\"font-weight: bold\"> order_count </span>┃\n┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │\n├─────────────────┼─────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">1-URGENT       </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10594</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">2-HIGH         </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10476</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">3-MEDIUM       </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10410</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">4-NOT SPECIFIED</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10556</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">5-LOW          </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10487</span> │\n└─────────────────┴─────────────┘\n</pre>\n```\n:::\n:::\n\n\n## Polars (dataframe)\n\nDefine query 4:\n\n::: {#e62fe1d3 .cell execution_count=45}\n``` {.python .cell-code}\ndef q4(lineitem, orders, **kwargs):\n    var1 = date(1993, 7, 1)\n    var2 = date(1993, 10, 1)\n\n    q_final = (\n        lineitem.join(orders, left_on=\"l_orderkey\", right_on=\"o_orderkey\")\n        .filter(pl.col(\"o_orderdate\").is_between(var1, var2, closed=\"left\"))\n        .filter(pl.col(\"l_commitdate\") < pl.col(\"l_receiptdate\"))\n        .unique(subset=[\"o_orderpriority\", \"l_orderkey\"])\n        .group_by(\"o_orderpriority\")\n        .agg(pl.len().alias(\"order_count\"))\n        .sort(\"o_orderpriority\")\n    )\n\n    return q_final\n```\n:::\n\n\nRun query 4:\n\n::: {#233e271d .cell execution_count=46}\n``` {.python .cell-code}\nres = q4(lineitem.to_polars().lazy(), orders.to_polars().lazy()).collect()\nres\n```\n\n::: {.cell-output .cell-output-display execution_count=45}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>o_orderpriority</th><th>order_count</th></tr><tr><td>str</td><td>u32</td></tr></thead><tbody><tr><td>&quot;1-URGENT&quot;</td><td>10594</td></tr><tr><td>&quot;2-HIGH&quot;</td><td>10476</td></tr><tr><td>&quot;3-MEDIUM&quot;</td><td>10410</td></tr><tr><td>&quot;4-NOT SPECIFIED&quot;</td><td>10556</td></tr><tr><td>&quot;5-LOW&quot;</td><td>10487</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## Ibis (SQL)\n\nDefine query 4:\n\n::: {#71e269f0 .cell execution_count=47}\n``` {.python .cell-code}\nq4_sql = \"\"\"\nSELECT\n    o_orderpriority,\n    count(*) AS order_count\nFROM\n    orders\nWHERE\n    o_orderdate >= CAST('1993-07-01' AS date)\n    AND o_orderdate < CAST('1993-10-01' AS date)\n    AND EXISTS (\n        SELECT\n            *\n        FROM\n            lineitem\n        WHERE\n            l_orderkey = o_orderkey\n            AND l_commitdate < l_receiptdate)\nGROUP BY\n    o_orderpriority\nORDER BY\n    o_orderpriority;\n\"\"\"\nq4_sql = q4_sql.strip().strip(\";\")\n\n\ndef q4(lineitem, orders, dialect=\"duckdb\", **kwargs):\n    return orders.sql(q4_sql, dialect=dialect)\n```\n:::\n\n\nRun query 4:\n\n::: {#40ab1aec .cell execution_count=48}\n``` {.python .cell-code}\nres = q4(lineitem, orders)\nres\n```\n\n::: {.cell-output .cell-output-display execution_count=47}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> o_orderpriority </span>┃<span style=\"font-weight: bold\"> order_count </span>┃\n┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │\n├─────────────────┼─────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">1-URGENT       </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10594</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">2-HIGH         </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10476</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">3-MEDIUM       </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10410</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">4-NOT SPECIFIED</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10556</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">5-LOW          </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10487</span> │\n└─────────────────┴─────────────┘\n</pre>\n```\n:::\n:::\n\n\n:::\n\nFinally, we write the result to a Parquet file. We are measuring the\nexecution time in seconds of calling the query and writing the results to disk.\n\n## Methodology review, considerations, and discussion\n\nBenchmarking is fraught: it's easy to get wrong and ship your bias in the\nresults. We don't want to end up as [Figure 1 in \"Fair Benchmarking Considered\nDifficult: Common Pitfalls In Database Performance\nTesting\"](https://hannes.muehleisen.org/publications/DBTEST2018-performance-testing.pdf):\n\n![Figure 1](figure1.png)\n\nTo do this, we'll:\n\n- acknowledge our (my) biases and background\n- explain our goals with this benchmark\n- point to existing benchmarks and discuss differences\n\n### My background and biases\n\nWe'll switch to singular pronouns for this section: my name is Cody and I'm a\nSenior Technical Product Manager at Voltron Data to work on the Ibis project.\nVoltron Data is a venture-backed series A startup that supports several open\nsource projects (namely Apache Arrow, Ibis, and Substrait), provides commercial\nsupport for these projects, and offers a distributed GPU-accelerated query\nengine named Theseus.\n\nThe Ibis project is a self-governed open source project, with several\nmaintainers employed by Voltron Data but contributors various organizations. I\nam a contributor to Ibis and paid by Voltron Data to work on it -- I am very\nheavily biased toward Ibis.\n\n:::{.callout-note title=\"Additional Voltron Data biases\" collapse=\"true\"}\nSomething something [Voltron Data has written its benchmarking\nmethodology](https://voltrondata.com/benchmarks/methodology)...\n\nIt's not uncommon to receive some skepticism around Voltron Data's support for\nIbis -- are we building a SaaS platform that will lock users into our query\nengine?\n\nThe short answer is no, and hopefully it's a convincing one for a few reasons:\n\n1. Wes McKinney, a cofounder (and former CTO) of Voltron Data, created Ibis and\n is a strong advocate for the composable data ecossytem.\n2. Voltron Data itself is a strong advocate for the composable data ecosystem\n and invests heavily in open source projects throughout it.\n3. Voltron Data's Theseus query engine **is not for 99.9% of Ibis users**\n\nThe last point is the big one that explains the financial incentives: it would\nnot make sense for Voltron Data to try to lock users into Theseus via Ibis\nbecause Theseus is a distributed GPU query engine for the biggest of big data\nworkloads. Rather than create yet another Python dataframe library that only\nworks with Theseus, Voltron Data invests in Ibis as a standard that can work on\nany query engine at any scale -- DuckDB, DataFusion, Polars, etc. at the <1TB\nscale, Trino, PySpark, Snowflake, etc. at the 1TB-10TB scale, and Theseus at the\n10TB+ scale.\n\nYou can read a longer answer in [\"Why does Voltron Data support\nIbis?\"](../why-voda-supports-ibis/index.qmd)\n\nFurther, **Voltron Data does not own the Ibis project**. It is a self-governed\nopen source project. While 3/5 of the streering committee members are employed\nby Voltron Data, we are actively seeking to diversify the project's governance.\n:::\n\n### Our goals\n\n1. Easy to reproduce\n2. Measure performance of best single-node modern OLAP engines\n3. Identify Ibis and backend performance or feature gaps\n\n### The TPC-H benchmark\n\nFrom the [TPC-H benchmark website](http://www.tpc.org/tpch):\n\n> The TPC-H is a decision support benchmark. It consists of a suite of business\n> oriented ad-hoc queries and concurrent data modifications. The queries and the\n> data populating the database have been chosen to have broad industry-wide\n> relevance. This benchmark illustrates decision support systems that examine\n> large volumes of data, execute queries with a high degree of complexity, and\n> give answers to critical business questions.\n\nThe data consists of eight tables (customer, lineitem, nation, orders, part,\npartsupp, region, supplier) and 22 queries. The queries are designed to test a\ndatabase's performance on a variety of tasks, including filtering, aggregation,\nand joins.\n\n#### Other benchmarks\n\nThe [Polars company ran the TPC-H benchmark with results published on their\nblog](https://pola.rs/posts/benchmarks/). They compare DuckDB, Polars, pandas,\nDask, and Modin on a couple of compute instances and one scale factor.\n\n[Coiled ran the TPC-H benchmark on Spark, Dask, DuckDB, and\nPolars](https://docs.coiled.io/blog/tpch.html). They \"run benchmarks derived\nfrom the TPC-H benchmark suite on a variety of scales, hardware architectures,\nand dataframe projects, notably Apache Spark, Dask, DuckDB, and Polars. No\nproject wins.\"\n\nThey use much higher scales and distributed engines. We focus on single-node\nOLAP engines that can run through Ibis.\n\n### Why DuckDB, DataFusion, and Polars?\n\nFor this benchmark, we'll focus on three single-node modern OLAP engines based\non Apache Arrow: DuckDB, DataFusion, and Polars. Each has slightly different use\ncases and goals, with all providing great options as backends for Ibis.\nBenchmarking these three should be relatively \"apples to apples\": none are\ndistributed engines (like PySpark) or single-thread and limited to in-memory\ndata (like pandas).\n\n:::{.callout-note title=\"Honorable mention: chDB\" collapse=\"true\"}\n\"[chDB](https://github.com/chdb-io/chdb) is an in-process SQL OLAP Engine\npowered by ClickHouse\". While ClickHouse isn't based on Apache Arrow, this would\nbe another great single-node OLAP engine to benchmark. We don't because it's not\ncurrently a backend for Ibis, though [there has been work done to make it\none](https://github.com/ibis-project/ibis/pull/8497).\n\nIf you're interested in contributing to Ibis, a new backend like chDB could be a\ngreat project for you!\n:::\n\n#### DuckDB\n\n\"DuckDB is a high-performance analytical database system. It is designed to be\nfast, reliable, portable, and easy to use. DuckDB provides a rich SQL dialect,\nwith support far beyond basic SQL.\"\n\n#### DataFusion\n\n\"Apache DataFusion is a very fast, extensible query engine for building\nhigh-quality data-centric systems in Rust, using the Apache Arrow in-memory\nformat.\"\n\n#### Polars\n\n\"Polars is a DataFrame interface on top of an OLAP Query Engine implemented in\nRust using Apache Arrow Columnar Format as the memory model.\"\n\n### Which system is the best?\n\nWhile each can be used as an Ibis backend, they have different priorities use\ncases. DuckDB is a full database with an on-disk format -- sometimes referred to\nas sqlite for OLAP. DataFusion is a composable set of Rust libraries often used\nfor building other query engines, databases, or libraries. Polars is an OLAP\nquery engine with a Rust and Python dataframe APIs aimed at replacing pandas\nworkloads with much better performance.\n\nDuckDB and DataFusion have Python clients but are primarily used via SQL.\n\n### Performance converges over time\n\nLet's look at some quotes from [\"Perf is not\nenough\"](https://motherduck.com/blog/perf-is-not-enough) by Jordan Tigani of\nMotherDuck:\n\n> If you take a bunch of databases, all actively maintained, and iterate them\n> out a few years, **performance is going to converge**. If Clickhouse is applying\n> a technique that gives it an advantage for scan speed today, Snowflake will\n> likely have that within a year or two. If Snowflake adds incrementally\n> materialized views, BigQuery will soon follow. It is unlikely that important\n> performance differences will persist over time.\n>\n> As clever as the engineers working for any of these companies are, none of\n> them possess any magic incantations or things that cannot be replicated\n> elsewhere. Each database uses a different bag of tricks in order to get good\n> performance. One might compile queries to machine code, another might cache data\n> on local SSDs, and a third might use specialized network hardware to do\n> shuffles. **Given time, all of these techniques can be implemented by anyone. If\n> they work well, they likely will show up everywhere.**\n\nThis is extra true for open source databases (or query engines), especially when\nthey're in part based on the same underlying technology (e.g. Apache Arrow). If\nDuckDB adds a feature that improves performance, it's likely that DataFusion and\nPolars will follow suit -- they can go read the source code and specific commits\nto see how it was done.\n\n## Next steps\n\nWe'll re-run this benchmark soon with updated Polars TPC-H queries and using\nnewer versions. Polars v1.0.0 should release soon.\n\nIf you spot anything wrong, have any questions, or want to share your own\nanalysis, feel free to share below!\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script type=\"text/javascript\">\nwindow.PlotlyConfig = {MathJaxConfig: 'local'};\nif (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\nif (typeof require !== 'undefined') {\nrequire.undef(\"plotly\");\nrequirejs.config({\n    paths: {\n        'plotly': ['https://cdn.plot.ly/plotly-2.32.0.min']\n    }\n});\nrequire(['plotly'], function(Plotly) {\n    window._Plotly = Plotly;\n});\n}\n</script>\n\n"
      ]
    }
  }
}