{
  "hash": "84c11f7a94f44cea4d874f46e2c8d075",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Ibis benchmarking: DuckDB, DataFusion, Polars\"\nauthor: \"Cody Peterson\"\ndate: \"2024-06-24\"\nimage: \"figure1.png\"\ncategories:\n    - benchmark\n    - duckdb\n    - datafusion\n    - polars\n---\n\n*The best benchmark is your own workload on your own data*.\n\n## Key considerations\n\nThe purpose of this post is to explore some benchmarking data with Ibis. We'll\ncompare three modern single-node query engines, explore the Ibis API as a great\nchoice for each of them, and discuss the results.\n\n### The benchmark\n\n:::{.callout-important title=\"Not an official TPC-H benchmark\"}\nThis is not an [official TPC-H benchmark](https://www.tpc.org/tpch). We ran a\nderivate of the TPC-H benchmark.\n:::\n\n[The TPC-H benchmark](https://www.tpc.org/tpch) is a benchmark for databases\nand, [increasingly](https://docs.coiled.io/blog/tpch),\n[dataframes](https://pola.rs/posts/benchmarks)! It consists of 22 queries\nacross 8 tables. The SQL (or dataframe) code representing the queries is\ndesigned to test the performance of a query engine on a variety of tasks\nincluding filtering, aggregation, and joins. SQL queries are defined by the\nTPC-H benchmark. We run the SQL queries and equivalent dataframe code via Ibis\nand Polars APIs.\n\nThe data for the benchmark can be generated at any scale factor, which roughly\ncorresponds to the size of the data in memory in gigabytes. For instance, a\nscale factor of 10 would be about 10GB of data in memory.\n\n### The engines, the API, the code\n\nWe'll use three modern single-node OLAP engines\n([DuckDB](https://github.com/duckdb/duckdb),\n[DataFusion](https://github.com/apache/datafusion),\n[Polars](https://github.com/pola-rs/polars)) with the Ibis API via two coding\nparadigms (dataframe and SQL). Ibis provides a consistent API across 20+\nbackends, including these three. We run [SQL\ncode](https://github.com/lostmygithubaccount/ibis-bench/blob/v2.0.0/src/ibis_bench/queries/sql.py)\nthrough Ibis in addition to [dataframe\ncode](https://github.com/lostmygithubaccount/ibis-bench/blob/v2.0.0/src/ibis_bench/queries/ibis.py)\nto get a sense of any overhead in Ibis dataframe code.\n\n:::{.callout-note}\nIbis dataframe code generates SQL for the DuckDB and DataFusion backends and\ngenerates Polars API dataframe code for the Polars backend.\n:::\n\n:::{.callout-note title=\"Honorable mention: chDB\" collapse=\"true\"}\n[chDB](https://github.com/chdb-io/chdb) would be another great single-node OLAP\nengine to benchmark. We don't because it's not currently a backend for Ibis,\nthough [there has been work done to make it\none](https://github.com/ibis-project/ibis/pull/8497).\n\nIf you're interested in contributing to Ibis, a new backend like chDB could be a\ngreat project for you!\n:::\n\n9/22 queries for Ibis with the Polars backend fail from [lack of scalar subquery\nsupport](#failing-polars-queries). Due to this and relatively experimental SQL\nsupport in Polars, we've opted to run on [the Polars API\ndirectly](https://github.com/lostmygithubaccount/ibis-bench/blob/v2.0.0/src/ibis_bench/queries/polars.py)\nin this iteration of the benchmark. This is done with the LazyFrames API **and\nno streaming engine** ([per the Polars team's\nrecommendation](https://github.com/pola-rs/polars/issues/16694#issuecomment-2146668559)).\nThis also allows us to compare the performance of the Polars backend through\nIbis with the Polars API directly for the queries that do succeed.\n\n#### Failing queries\n\nQueries fail for one of two reasons:\n\n1. The query doesn't work in the given system\n2. The query otherwise failed on a given run\n\nWe'll note the cases of the first below. The second is usually due to memory\npressure and [will be seen at higher scale\nfactors](#failing-queries-due-to-memory-pressure) throughout the data.\n\n#### Failing DataFusion queries\n\nQueries 16, 21, and 22 fail for the DataFusion backend via Ibis dataframe code,\nand query 16 fails through SQL. Note that [all TPC-H SQL queries successfully\nrun through DataFusion\ndirectly](https://github.com/apache/datafusion-benchmarks) -- Ibis generates SQL\nthat [hits a bug with DataFusion that has already been\nfixed](https://github.com/apache/datafusion/issues/10830). We expect these\nqueries to work in the next iteration of this benchmark coming soon.\n\n#### Failing Polars queries\n\nQueries 11, 13-17, and 20-22 fail for the Polars backend via Ibis dataframe\ncode. These all fail due to lack of scalar subquery support in the backend. I've\n[opened an issue](https://github.com/ibis-project/ibis/issues/9422) for tracking\nand discussion.\n\n:::{.callout-tip title=\"Interested in contributing?\"}\nIncreasing coverage of operations for a backend is a great place to start!\n:::\n\n### How queries are written\n\nSee [the source\ncode](https://github.com/lostmygithubaccount/ibis-bench/tree/v2.0.0/src/ibis_bench/queries)\nfor the exact queries used in this iteration of the benchmark. Polars recently\nupdated their TPC-H queries, so the next iteration of this benchmark would use\nthose.\n\nQueries were adapted from [Ibis TPC-H\nqueries](https://github.com/ibis-project/ibis/tree/main/ibis/backends/tests/tpch)\nand [Polars TPC-H queries](https://github.com/pola-rs/tpch). The first 10 Ibis\ndataframe queries were translated from the Polars dataframe queries, while the\nrest were directly adapted from the Ibis repository. The SQL strings were\nadapted from the Ibis repository.\n\n### How queries are run\n\nSee [the source\ncode](https://github.com/lostmygithubaccount/ibis-bench/tree/v2.0.0) and\n[methodology](https://ibis-bench.streamlit.app/methodology) for more details. In\nshort:\n\n- data is generated as a Parquet file per table\n    - standard DuckDB Parquet writer is used\n    - data is always downloaded onto a compute instance (no cloud storage reads)\n- decimal types are converted to floats after reading\n    - works around several issues\n    - in the next iteration of this benchmark, we'll use the `decimal` type\n- each query is run three times per configuration (system, scale factor, instance type)\n- we measure the time to write the results of the query to a Parquet file\n    - this includes reading the Parquet file(s) and executing the query\n\n### Biases\n\nMy name is Cody and I'm a Senior Technical Product Manager at [Voltron\nData](https://voltrondata.com). I am a contributor to the Ibis project and\nemployed to work on it -- I'm biased in favor of Ibis and the composable data\necosystem.\n\nIbis is [an independently governed open source\nproject](https://github.com/ibis-project/governance) that **is not owned by\nVoltron Data**, though several steering committee members are employed by\nVoltron Data. You can [read more about why Voltron Data supports\nIbis](../why-voda-supports-ibis/index.qmd), in addition to open source projects\nlike [Apache Arrow](https://github.com/apache/arrow) and\n[Substrait](https://github.com/substrait-io/substrait).\n\nVoltron Data is a [Gold Supporter of the DuckDB\nFoundation](https://duckdb.org/foundation) and [has a commercial relationship\nwith DuckDB Labs](https://duckdblabs.com) with regular syncs I tend to attend.\nI also use [MotherDuck](https://motherduck.com) to host our [Ibis analytics\ndashboard data](https://ibis-analytics.streamlit.app).\n\n## Results and analysis\n\nWe'll use Ibis to analyze some of the benchmarking data.\n\n:::{.callout-tip}\nWe'll only look at a small subset of the data in this post.\n\nAll the data is public, so you can follow along with the code and explore the\ndata yourself. You can also see the [Ibis benchmarking Streamlit\napp](https://ibis-bench.streamlit.app) for further analysis.\n:::\n\n\n\n### Reading the data\n\nTo follow along, install the required Python packages:\n\n```bash\npip install gcsfs 'ibis-framework[duckdb]' plotly\n```\n\nThe data is stored in a public Google Cloud Storage (GCS) bucket:\n\n::: {#c340210d .cell execution_count=2}\n``` {.python .cell-code}\nimport os  # <1>\nimport gcsfs  # <1>\n\nBUCKET = \"ibis-bench\"  # <2>\n\ndir_name = os.path.join(BUCKET, \"bench_logs_v2\", \"cache\")  # <3>\n\nfs = gcsfs.GCSFileSystem()  # <4>\nfs.ls(dir_name)[-5:]  # <5>\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n['ibis-bench/bench_logs_v2/cache/file_id=b6236086-7fff-4569-8731-b97a635243bd.parquet',\n 'ibis-bench/bench_logs_v2/cache/file_id=cbc0c7b1-e659-4adb-8c80-4077cd4d39ab.parquet',\n 'ibis-bench/bench_logs_v2/cache/file_id=d91454ad-2ddd-408a-bbfd-6b159dd2132b.parquet',\n 'ibis-bench/bench_logs_v2/cache/file_id=debc7203-f366-44d2-94f1-2518e6f7425f.parquet',\n 'ibis-bench/bench_logs_v2/cache/file_id=e875d852-f7e7-473c-9440-92b8f2445f3a.parquet']\n```\n:::\n:::\n\n\n1. Imports\n2. The public GCS bucket name\n3. The directory in the bucket where the data is stored\n4. Create a GCS filesystem object\n5. List the last 5 files in the directory\n\nTo start exploring the data, let's import Ibis and Plotly, set some options, and\nregister the GCS filesystem with the default (DuckDB) backend:\n\n::: {#d19e0ac4 .cell execution_count=3}\n``` {.python .cell-code}\nimport ibis # <1>\nimport plotly.express as px # <2>\n\npx.defaults.template = \"plotly_dark\" # <3>\n\nibis.options.interactive = True # <4>\nibis.options.repr.interactive.max_rows = 22 # <5>\nibis.options.repr.interactive.max_length = 22 # <6>\nibis.options.repr.interactive.max_columns = None # <7>\n\ncon = ibis.get_backend()    # <8>\ncon.register_filesystem(fs) # <9>\n```\n:::\n\n\n1. Import Ibis\n2. Import Plotly\n3. Set the Plotly template to dark\n4. Enable interactive mode for Ibis\n5. Set the maximum number of rows to display in interactive mode\n6. Set the maximum length of nested types to display in interactive mode\n7. Set the maximum number of columns to display in interactive mode\n8. Get the default (DuckDB) backend\n9. Register the GCS filesystem with the default backend\n\n\n\nNow read the data and take a look at the first few rows:\n\n::: {#a7724589 .cell execution_count=5}\n``` {.python .cell-code}\nt = (  # <1>\n    ibis.read_parquet(f\"gs://{dir_name}/file_id=*.parquet\")  # <2>\n    .mutate(  # <3>\n        timestamp=ibis._[\"timestamp\"].cast(\"timestamp\"),\n    )  # <3>\n    .relocate(  # <4>\n        \"instance_type\",\n        \"system\",\n        \"sf\",\n        \"query_number\",\n        \"execution_seconds\",\n        \"timestamp\",\n    )  # <4>\n    .cache()  # <5>\n)\nt.head()  # <6>\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> instance_type </span>┃<span style=\"font-weight: bold\"> system          </span>┃<span style=\"font-weight: bold\"> sf    </span>┃<span style=\"font-weight: bold\"> query_number </span>┃<span style=\"font-weight: bold\"> execution_seconds </span>┃<span style=\"font-weight: bold\"> timestamp                  </span>┃<span style=\"font-weight: bold\"> session_id                           </span>┃<span style=\"font-weight: bold\"> n_partitions </span>┃<span style=\"font-weight: bold\"> file_type </span>┃<span style=\"font-weight: bold\"> file_id                                      </span>┃\n┡━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">timestamp(6)</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">uuid</span>                                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                       │\n├───────────────┼─────────────────┼───────┼──────────────┼───────────────────┼────────────────────────────┼──────────────────────────────────────┼──────────────┼───────────┼──────────────────────────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">polars-lazy    </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.503613</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2024-06-10 08:04:31.233704</span> │ 6708e5d3-2b8c-4ce0-adf8-65ce94e0bff1 │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">64</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35.826295</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2024-06-10 21:05:18.423375</span> │ 9a00385f-22b4-42df-ab3d-c63ed1a33a2e │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb    </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.376196</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2024-06-11 03:44:22.901852</span> │ acb56c6b-b0d5-4bbc-8791-3542b62bd193 │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.655290</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2024-06-09 20:29:31.833510</span> │ a07fe07d-7a08-4802-b8ae-918e66e2d868 │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb-sql</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.447325</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">2024-06-10 08:11:31.244609</span> │ d523eec6-d2de-491d-b541-348c6b5bfc65 │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">0949deaf-5f8f-4c29-b2ca-934e07173223.parquet</span> │\n└───────────────┴─────────────────┴───────┴──────────────┴───────────────────┴────────────────────────────┴──────────────────────────────────────┴──────────────┴───────────┴──────────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n1. Assign the table to a variable\n2. Read the Parquet files from GCS\n3. Cast the `timestamp` column to a timestamp type\n4. Reorder the columns\n5. Cache the table to avoid re-reading cloud data\n6. Display the first few rows\n\nWe'll also create a table with details on each instance type including the CPU\ntype, number of cores, and memory in gigabytes:\n\n::: {#0ac835d9 .cell execution_count=6}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show code to get instance details\"}\ncpu_type_cases = (\n    ibis.case()\n    .when(\n        ibis._[\"instance_type\"].startswith(\"n2d\"),\n        \"AMD EPYC\",\n    )\n    .when(\n        ibis._[\"instance_type\"].startswith(\"n2\"),\n        \"Intel Cascade and Ice Lake\",\n    )\n    .when(\n        ibis._[\"instance_type\"].startswith(\"c3\"),\n        \"Intel Sapphire Rapids\",\n    )\n    .when(\n        ibis._[\"instance_type\"] == \"work laptop\",\n        \"Apple M1 Max\",\n    )\n    .when(\n        ibis._[\"instance_type\"] == \"personal laptop\",\n        \"Apple M2 Max\",\n    )\n    .else_(\"unknown\")\n    .end()\n)\ncpu_num_cases = (\n    ibis.case()\n    .when(\n        ibis._[\"instance_type\"].contains(\"-\"),\n        ibis._[\"instance_type\"].split(\"-\")[-1].cast(\"int\"),\n    )\n    .when(ibis._[\"instance_type\"].contains(\"laptop\"), 12)\n    .else_(0)\n    .end()\n)\nmemory_gb_cases = (\n    ibis.case()\n    .when(\n        ibis._[\"instance_type\"].contains(\"-\"),\n        ibis._[\"instance_type\"].split(\"-\")[-1].cast(\"int\") * 4,\n    )\n    .when(ibis._[\"instance_type\"] == \"work laptop\", 32)\n    .when(ibis._[\"instance_type\"] == \"personal laptop\", 96)\n    .else_(0)\n    .end()\n)\n\ninstance_details = (\n    t.group_by(\"instance_type\")\n    .agg()\n    .mutate(\n        cpu_type=cpu_type_cases, cpu_cores=cpu_num_cases, memory_gbs=memory_gb_cases\n    )\n).order_by(\"memory_gbs\", \"cpu_cores\", \"instance_type\")\n\ncpu_types = sorted(\n    instance_details.distinct(on=\"cpu_type\")[\"cpu_type\"].to_pyarrow().to_pylist()\n)\n\ninstance_details\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> instance_type   </span>┃<span style=\"font-weight: bold\"> cpu_type                   </span>┃<span style=\"font-weight: bold\"> cpu_cores </span>┃<span style=\"font-weight: bold\"> memory_gbs </span>┃\n┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │\n├─────────────────┼────────────────────────────┼───────────┼────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-2  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2d-standard-2 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AMD EPYC                  </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-4  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Sapphire Rapids     </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2d-standard-4 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AMD EPYC                  </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-8  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Sapphire Rapids     </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-8  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2d-standard-8 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AMD EPYC                  </span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">work laptop    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Apple M1 Max              </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-16 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">64</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2d-standard-16</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AMD EPYC                  </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">64</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-22 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Sapphire Rapids     </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">88</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">personal laptop</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Apple M2 Max              </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">96</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-32 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2d-standard-32</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AMD EPYC                  </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">c3-standard-44 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Sapphire Rapids     </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">44</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">176</span> │\n└─────────────────┴────────────────────────────┴───────────┴────────────┘\n</pre>\n```\n:::\n:::\n\n\n### What's in the data?\n\nWith the data, we can see we ran the benchmark on scale factors:\n\n::: {#08b389fe .cell execution_count=7}\n``` {.python .cell-code}\nsfs = sorted(t.distinct(on=\"sf\")[\"sf\"].to_pyarrow().to_pylist())\nsfs\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\n[1, 8, 16, 32, 64, 128]\n```\n:::\n:::\n\n\n:::{.callout-note title=\"What is a scale factor?\" collapse=\"true\"}\nA scale factor is roughly the size of the data in memory in gigabytes. For\nexample, a scale factor of 1 means the data is roughly 1GB in memory.\n\nStored on disk in (compressed) Parquet format, the data is smaller -- about\n0.38GB for scale factor 1 with the compression settings used in this benchmark.\n:::\n\nWe can look at the total execution time by scale factor:\n\n::: {#f6efea9d .cell execution_count=8}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show bar plot code\"}\nc = px.bar(\n    t.group_by(\"sf\").agg(total_seconds=t[\"execution_seconds\"].sum()),\n    x=\"sf\",\n    y=\"total_seconds\",\n    category_orders={\"sf\": sfs},\n    title=\"total execution time by scale factor\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"288d4514-11ea-4463-b6e6-b5a381a37841\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"288d4514-11ea-4463-b6e6-b5a381a37841\")) {                    Plotly.newPlot(                        \"288d4514-11ea-4463-b6e6-b5a381a37841\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"sf=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"\",\"offsetgroup\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"textposition\":\"auto\",\"x\":[1,8,16,32,64,128],\"xaxis\":\"x\",\"y\":[1600.579779624939,10426.681049823761,19846.17095041275,38021.40961122513,74784.94995188713,164025.98512744904],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"sf\"},\"categoryorder\":\"array\",\"categoryarray\":[1,8,16,32,64,128]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"total_seconds\"}},\"legend\":{\"tracegroupgap\":0},\"title\":{\"text\":\"total execution time by scale factor\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('288d4514-11ea-4463-b6e6-b5a381a37841');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nYou can see this is roughly linear as expected.\n\nWe ran on the following queries:\n\n::: {#030280cb .cell execution_count=9}\n``` {.python .cell-code}\nquery_numbers = sorted(\n    t.distinct(on=\"query_number\")[\"query_number\"].to_pyarrow().to_pylist()\n)\nquery_numbers\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\n[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]\n```\n:::\n:::\n\n\n:::{.callout-note title=\"What is a query number?\" collapse=\"true\"}\nThe TPC-H benchmark defines 22 queries. See the [TPC-H benchmark\nspecification](https://www.tpc.org/TPC_Documents_Current_Versions/pdf/TPC-H_v3.0.1.pdf)\nfor more information.\n:::\n\nWe can look at the total execution time by query number:\n\n::: {#4d9d3cb4 .cell execution_count=10}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show bar plot code\"}\nc = px.bar(\n    t.group_by(\"query_number\").agg(total_seconds=t[\"execution_seconds\"].sum()),\n    x=\"query_number\",\n    y=\"total_seconds\",\n    category_orders={\"query_number\": query_numbers},\n    title=\"total execution time by query number\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"f349a1b0-78b1-4527-aed6-d30e3c80003d\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"f349a1b0-78b1-4527-aed6-d30e3c80003d\")) {                    Plotly.newPlot(                        \"f349a1b0-78b1-4527-aed6-d30e3c80003d\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"query_number=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"\",\"offsetgroup\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],\"xaxis\":\"x\",\"y\":[21056.510046720505,3685.074945449829,12819.760807991028,8480.374274730682,11834.102046251297,10688.606204509735,18887.29731631279,14052.494454860687,22051.161331176758,15887.331687450409,2990.691949367523,12739.110704421997,11047.851179599762,10706.916375398636,15876.686168670654,1247.1440830230713,18959.44294857979,37246.088896751404,18845.170838832855,12007.838083028793,25422.41154885292,2173.71057844162],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"},\"categoryorder\":\"array\",\"categoryarray\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"total_seconds\"}},\"legend\":{\"tracegroupgap\":0},\"title\":{\"text\":\"total execution time by query number\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('f349a1b0-78b1-4527-aed6-d30e3c80003d');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nThis gives us a sense of the relative complexity of the queries.\n\nWe ran on the following instance types:\n\n::: {#9329b1d8 .cell execution_count=11}\n``` {.python .cell-code}\ninstance_types = sorted(\n    t.distinct(on=\"instance_type\")[\"instance_type\"].to_pyarrow().to_pylist(),\n    key=lambda x: (x.split(\"-\")[0], int(x.split(\"-\")[-1])) # <1>\n    if \"-\" in x # <1>\n    else (\"z\" + x[3], 0), # <2>\n)\ninstance_types\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```\n['c3-standard-4',\n 'c3-standard-8',\n 'c3-standard-22',\n 'c3-standard-44',\n 'n2-standard-2',\n 'n2-standard-4',\n 'n2-standard-8',\n 'n2-standard-16',\n 'n2-standard-32',\n 'n2d-standard-2',\n 'n2d-standard-4',\n 'n2d-standard-8',\n 'n2d-standard-16',\n 'n2d-standard-32',\n 'work laptop',\n 'personal laptop']\n```\n:::\n:::\n\n\n1. This is to sort the instance types by CPU architecture and number of cores\n2. This is to sort \"personal laptop\" after \"work laptop\"\n\n:::{.callout-note title=\"What is an instance type?\" collapse=\"true\"}\nAn instance type is the compute the benchmark was run on. This consists of two\nMacBook Pro laptops (one work and one personal) and a number of Google Cloud\nCompute Engine instances.\n\nFor cloud VMs, the instance type is in the form of `<family>-<type>-<cores>`,\nwhere:\n\n- `<family>` specifies the CPU architecture (Intel X, AMD Y)\n- `<type>` modifies the CPU to memory ratio (only `standard` is used with a 1:4)\n- `<cores>` is the number of vCPUs\n\nFor example, `n2d-standard-2` is a Google Cloud Compute Engine instance with an\nAMD EPYC processor, 2 vCPUs, and 8GB of memory.\n:::\n\nWe can look at the total execution time by instance type:\n\n::: {#6e4b3589 .cell execution_count=12}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show bar plot code\"}\nc = px.bar(\n    t.group_by(\"instance_type\")\n    .agg(total_seconds=t[\"execution_seconds\"].sum())\n    .join(instance_details, \"instance_type\"),\n    x=\"instance_type\",\n    y=\"total_seconds\",\n    color=\"cpu_type\",\n    hover_data=[\"cpu_cores\", \"memory_gbs\"],\n    category_orders={\n        \"instance_type\": instance_types,\n        \"cpu_type\": cpu_types,\n    },\n    title=\"total execution time by instance type\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"d244475b-f426-4489-bcd5-5f7039a9a060\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"d244475b-f426-4489-bcd5-5f7039a9a060\")) {                    Plotly.newPlot(                        \"d244475b-f426-4489-bcd5-5f7039a9a060\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[8,32],[16,64],[32,128],[2,8],[4,16]],\"hovertemplate\":\"cpu_type=AMD EPYC\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"AMD EPYC\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"AMD EPYC\",\"offsetgroup\":\"AMD EPYC\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"n2d-standard-8\",\"n2d-standard-16\",\"n2d-standard-32\",\"n2d-standard-2\",\"n2d-standard-4\"],\"xaxis\":\"x\",\"y\":[12713.746816158295,8826.589931488037,7692.161742925644,44865.29464507103,27287.013442993164],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[12,32]],\"hovertemplate\":\"cpu_type=Apple M1 Max\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Apple M1 Max\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Apple M1 Max\",\"offsetgroup\":\"Apple M1 Max\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"work laptop\"],\"xaxis\":\"x\",\"y\":[18826.837838172913],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[12,96]],\"hovertemplate\":\"cpu_type=Apple M2 Max\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Apple M2 Max\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Apple M2 Max\",\"offsetgroup\":\"Apple M2 Max\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"personal laptop\"],\"xaxis\":\"x\",\"y\":[7762.792654275894],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[8,32],[16,64],[32,128],[2,8],[4,16]],\"hovertemplate\":\"cpu_type=Intel Cascade and Ice Lake\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Intel Cascade and Ice Lake\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Intel Cascade and Ice Lake\",\"offsetgroup\":\"Intel Cascade and Ice Lake\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"n2-standard-8\",\"n2-standard-16\",\"n2-standard-32\",\"n2-standard-2\",\"n2-standard-4\"],\"xaxis\":\"x\",\"y\":[16631.65527653694,11164.923608541489,9977.536410570145,54309.10380792618,32758.409986257553],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[22,88],[44,176],[4,16],[8,32]],\"hovertemplate\":\"cpu_type=Intel Sapphire Rapids\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Intel Sapphire Rapids\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Intel Sapphire Rapids\",\"offsetgroup\":\"Intel Sapphire Rapids\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"c3-standard-22\",\"c3-standard-44\",\"c3-standard-4\",\"c3-standard-8\"],\"xaxis\":\"x\",\"y\":[7200.489403009415,6403.986677646637,26386.615517616272,15898.618711233139],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"instance_type\"},\"categoryorder\":\"array\",\"categoryarray\":[\"c3-standard-4\",\"c3-standard-8\",\"c3-standard-22\",\"c3-standard-44\",\"n2-standard-2\",\"n2-standard-4\",\"n2-standard-8\",\"n2-standard-16\",\"n2-standard-32\",\"n2d-standard-2\",\"n2d-standard-4\",\"n2d-standard-8\",\"n2d-standard-16\",\"n2d-standard-32\",\"work laptop\",\"personal laptop\"]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"total_seconds\"}},\"legend\":{\"title\":{\"text\":\"cpu_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"total execution time by instance type\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('d244475b-f426-4489-bcd5-5f7039a9a060');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nUnsurprisingly, this is inversely correlated with the number of CPU cores and\n(crucially) memory:\n\n::: {#3ce1f8a5 .cell execution_count=13}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show bar plot code\"}\nc = px.bar(\n    instance_details,\n    x=\"instance_type\",\n    y=\"memory_gbs\",\n    color=\"cpu_type\",\n    hover_data=[\"cpu_cores\", \"memory_gbs\"],\n    category_orders={\n        \"instance_type\": instance_types,\n        \"cpu_type\": cpu_types,\n    },\n    title=\"memory by instance type\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"24f0519b-1c8a-44ff-9ecb-a14d0d0869fe\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"24f0519b-1c8a-44ff-9ecb-a14d0d0869fe\")) {                    Plotly.newPlot(                        \"24f0519b-1c8a-44ff-9ecb-a14d0d0869fe\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[2],[4],[8],[16],[32]],\"hovertemplate\":\"cpu_type=AMD EPYC\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003ememory_gbs=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"AMD EPYC\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"AMD EPYC\",\"offsetgroup\":\"AMD EPYC\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"n2d-standard-2\",\"n2d-standard-4\",\"n2d-standard-8\",\"n2d-standard-16\",\"n2d-standard-32\"],\"xaxis\":\"x\",\"y\":[8,16,32,64,128],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[12]],\"hovertemplate\":\"cpu_type=Apple M1 Max\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003ememory_gbs=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Apple M1 Max\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Apple M1 Max\",\"offsetgroup\":\"Apple M1 Max\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"work laptop\"],\"xaxis\":\"x\",\"y\":[32],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[12]],\"hovertemplate\":\"cpu_type=Apple M2 Max\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003ememory_gbs=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Apple M2 Max\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Apple M2 Max\",\"offsetgroup\":\"Apple M2 Max\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"personal laptop\"],\"xaxis\":\"x\",\"y\":[96],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[2],[4],[8],[16],[32]],\"hovertemplate\":\"cpu_type=Intel Cascade and Ice Lake\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003ememory_gbs=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Intel Cascade and Ice Lake\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Intel Cascade and Ice Lake\",\"offsetgroup\":\"Intel Cascade and Ice Lake\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"n2-standard-2\",\"n2-standard-4\",\"n2-standard-8\",\"n2-standard-16\",\"n2-standard-32\"],\"xaxis\":\"x\",\"y\":[8,16,32,64,128],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[4],[8],[22],[44]],\"hovertemplate\":\"cpu_type=Intel Sapphire Rapids\\u003cbr\\u003einstance_type=%{x}\\u003cbr\\u003ememory_gbs=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Intel Sapphire Rapids\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Intel Sapphire Rapids\",\"offsetgroup\":\"Intel Sapphire Rapids\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"c3-standard-4\",\"c3-standard-8\",\"c3-standard-22\",\"c3-standard-44\"],\"xaxis\":\"x\",\"y\":[16,32,88,176],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"instance_type\"},\"categoryorder\":\"array\",\"categoryarray\":[\"c3-standard-4\",\"c3-standard-8\",\"c3-standard-22\",\"c3-standard-44\",\"n2-standard-2\",\"n2-standard-4\",\"n2-standard-8\",\"n2-standard-16\",\"n2-standard-32\",\"n2d-standard-2\",\"n2d-standard-4\",\"n2d-standard-8\",\"n2d-standard-16\",\"n2d-standard-32\",\"work laptop\",\"personal laptop\"]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"memory_gbs\"}},\"legend\":{\"title\":{\"text\":\"cpu_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"memory by instance type\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('24f0519b-1c8a-44ff-9ecb-a14d0d0869fe');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nWe ran on the following systems:\n\n::: {#44a6d0d4 .cell execution_count=14}\n``` {.python .cell-code}\nsystems = sorted(t.distinct(on=\"system\")[\"system\"].to_pyarrow().to_pylist())\nsystems\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```\n['ibis-datafusion',\n 'ibis-datafusion-sql',\n 'ibis-duckdb',\n 'ibis-duckdb-sql',\n 'ibis-polars',\n 'polars-lazy']\n```\n:::\n:::\n\n\n:::{.callout-note title=\"What is a system?\" collapse=\"true\"}\nFor convenience in this benchmark, a 'system' is defined as a hyphen-separated\nnaming convention where:\n\n- `ibis-*`: Ibis API was used\n    - `ibis-<backend>`: Ibis dataframe code was used with the given backend\n    - `ibis-<backend>-sql`: SQL code was used via Ibis on the given backend\n- `polars-*`: Polars API was used\n    - `polars-lazy`: Polars was used with the LazyFrames API\n:::\n\nWe can look at the total execution time by system:\n\n::: {#bc71358f .cell execution_count=15}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show bar plot code\"}\nc = px.bar(\n    t.group_by(\"system\").agg(\n        total_seconds=t[\"execution_seconds\"].sum(),\n        seconds_per_query=t[\"execution_seconds\"].mean(),\n    ),\n    x=\"system\",\n    y=\"total_seconds\",\n    color=\"system\",\n    category_orders={\"system\": systems},\n    title=\"total execution time by system\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"e780956d-98e3-4574-bb8a-8a7984ac620d\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"e780956d-98e3-4574-bb8a-8a7984ac620d\")) {                    Plotly.newPlot(                        \"e780956d-98e3-4574-bb8a-8a7984ac620d\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion\",\"offsetgroup\":\"ibis-datafusion\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-datafusion\"],\"xaxis\":\"x\",\"y\":[58838.82606935501],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion-sql\",\"offsetgroup\":\"ibis-datafusion-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-datafusion-sql\"],\"xaxis\":\"x\",\"y\":[60297.199028253555],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb\",\"offsetgroup\":\"ibis-duckdb\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[57484.52195310593],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql\",\"offsetgroup\":\"ibis-duckdb-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-duckdb-sql\"],\"xaxis\":\"x\",\"y\":[57534.97966146469],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-polars\",\"offsetgroup\":\"ibis-polars\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\"],\"xaxis\":\"x\",\"y\":[30922.509821414948],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003etotal_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\"}},\"name\":\"polars-lazy\",\"offsetgroup\":\"polars-lazy\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"polars-lazy\"],\"xaxis\":\"x\",\"y\":[43627.73993682861],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"system\"},\"categoryorder\":\"array\",\"categoryarray\":[\"ibis-datafusion\",\"ibis-datafusion-sql\",\"ibis-duckdb\",\"ibis-duckdb-sql\",\"ibis-polars\",\"polars-lazy\"]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"total_seconds\"}},\"legend\":{\"title\":{\"text\":\"system\"},\"tracegroupgap\":0},\"title\":{\"text\":\"total execution time by system\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('e780956d-98e3-4574-bb8a-8a7984ac620d');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\n:::{.callout-warning title=\"This can be misleading!\"}\nAt this point, we have to dig deeper into the data to understand the takeaways.\nYou might look at the above and think `ibis-polars` is the fastest all-around,\nbut it's not! Recall [9/22 queries for the Polars backend are\nfailing](#failing-polars-queries), and at larger scale factors we start to see\nseveral systems fail queries due to memory pressure.\n:::\n\n### Execution time by system, scale factor, instance type, and query\n\nWe'll aggregate the data over the dimensions we care about:\n\n::: {#fd4c21d3 .cell execution_count=16}\n``` {.python .cell-code}\nagg = (\n    t.group_by(\"instance_type\", \"system\", \"sf\", \"n_partitions\", \"query_number\")\n    .agg(\n        mean_execution_seconds=t[\"execution_seconds\"].mean(),\n    )\n    .join(instance_details, \"instance_type\")\n)\nagg.head(3)\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> instance_type </span>┃<span style=\"font-weight: bold\"> system              </span>┃<span style=\"font-weight: bold\"> sf    </span>┃<span style=\"font-weight: bold\"> n_partitions </span>┃<span style=\"font-weight: bold\"> query_number </span>┃<span style=\"font-weight: bold\"> mean_execution_seconds </span>┃<span style=\"font-weight: bold\"> cpu_type                   </span>┃<span style=\"font-weight: bold\"> cpu_cores </span>┃<span style=\"font-weight: bold\"> memory_gbs </span>┃\n┡━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │\n├───────────────┼─────────────────────┼───────┼──────────────┼──────────────┼────────────────────────┼────────────────────────────┼───────────┼────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb-sql    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.730084</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">polars-lazy        </span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.062605</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">n2-standard-4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">53.188349</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Intel Cascade and Ice Lake</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │\n└───────────────┴─────────────────────┴───────┴──────────────┴──────────────┴────────────────────────┴────────────────────────────┴───────────┴────────────┘\n</pre>\n```\n:::\n:::\n\n\nThere's a lot of data and it's difficult to visualize all at once. We'll build\nup our understanding with a few plots.\n\n::: {#3ac6b5b0 .cell execution_count=17}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show code for timings_plot\"}\ndef timings_plot(\n    agg,\n    sf_filter=128,\n    systems_filter=systems,\n    instances_filter=[instance for instance in instance_types if \"laptop\" in instance],\n    queries_filter=query_numbers,\n    log_y=True,\n):\n    data = (\n        agg.filter(agg[\"sf\"] == sf_filter)\n        .filter(agg[\"system\"].isin(systems_filter))\n        .filter(agg[\"instance_type\"].isin(instances_filter))\n        .filter(agg[\"query_number\"].isin(queries_filter))\n    )\n\n    c = px.bar(\n        data,\n        x=\"query_number\",\n        y=\"mean_execution_seconds\",\n        log_y=log_y,\n        color=\"system\",\n        barmode=\"group\",\n        pattern_shape=\"instance_type\",\n        category_orders={\n            \"system\": systems,\n            \"instance_type\": instance_types,\n        },\n        hover_data=[\"cpu_type\", \"cpu_cores\", \"memory_gbs\"],\n        title=f\"sf: {sf_filter}\",\n    )\n\n    return c\n```\n:::\n\n\nFirst, let's visualize execution time for a given scale factor, system, query,\nand family of instance types:\n\n::: {#500bfedc .cell execution_count=18}\n``` {.python .cell-code}\nsf_filter = 128\nsystems_filter = [\"ibis-duckdb\"]\ninstances_filter = [\n    instance for instance in instance_types if instance.startswith(\"n2d\")\n]\nqueries_filter = [1]\nlog_y = False\n\ntimings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"5540e1a0-bf17-47f8-8632-3b60d79cdf8a\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"5540e1a0-bf17-47f8-8632-3b60d79cdf8a\")) {                    Plotly.newPlot(                        \"5540e1a0-bf17-47f8-8632-3b60d79cdf8a\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",2,8]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-2\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-2\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"x\"}},\"name\":\"ibis-duckdb, n2d-standard-2\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-2\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[111.81634593009949],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",4,16]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-4\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-4\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"+\"}},\"name\":\"ibis-duckdb, n2d-standard-4\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-4\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[52.48048988978068],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",8,32]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-8\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-8\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\".\"}},\"name\":\"ibis-duckdb, n2d-standard-8\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-8\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[23.785067558288574],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",16,64]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-16\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-16\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb, n2d-standard-16\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-16\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[11.582529067993164],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-32\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-duckdb, n2d-standard-32\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[5.938729286193848],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"}},\"legend\":{\"title\":{\"text\":\"system, instance_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"sf: 128\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('5540e1a0-bf17-47f8-8632-3b60d79cdf8a');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nFrom left to right, we have increasing instance resources (CPU cores and memory\n-- you can hover over the data to see the details). You can also zoom and select\nspecific labels to focus on. We notice that, as expected, queries execute faster\nwhen given more resources.\n\nNow let's add a second system:\n\n::: {#ada0fc97 .cell execution_count=19}\n``` {.python .cell-code}\nsystems_filter = [\"ibis-duckdb\", \"ibis-duckdb-sql\"]\n\ntimings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"7e977938-be45-48df-add5-308d949629a6\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"7e977938-be45-48df-add5-308d949629a6\")) {                    Plotly.newPlot(                        \"7e977938-be45-48df-add5-308d949629a6\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",2,8]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-2\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-2\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"x\"}},\"name\":\"ibis-duckdb, n2d-standard-2\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-2\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[111.81634593009949],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",4,16]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-4\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-4\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"+\"}},\"name\":\"ibis-duckdb, n2d-standard-4\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-4\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[52.48048988978068],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",8,32]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-8\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-8\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\".\"}},\"name\":\"ibis-duckdb, n2d-standard-8\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-8\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[23.785067558288574],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",16,64]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-16\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-16\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb, n2d-standard-16\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-16\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[11.582529067993164],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-32\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-duckdb, n2d-standard-32\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[5.938729286193848],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",2,8]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-2\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-2\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"x\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-2\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-2\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[93.9455053806305],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",4,16]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-4\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-4\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"+\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-4\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-4\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[50.23033595085144],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",8,32]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-8\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-8\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\".\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-8\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-8\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[20.659324566523235],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",16,64]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-16\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-16\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-16\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-16\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[9.83419426282247],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-32\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-32\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[5.2171577612559],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"}},\"legend\":{\"title\":{\"text\":\"system, instance_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"sf: 128\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('7e977938-be45-48df-add5-308d949629a6');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\n:::{.callout-note title=\"Ibis dataframe code vs Ibis SQL code\" collapse=\"true\"}\n`ibis-duckdb` is running the TPC-H queries written as Ibis dataframe code. The\n`ibis-duckdb-sql` system is running the same queries but written as SQL code\npassed into `.sql()` in Ibis as strings. The intent is to see if Ibis dataframe\ncode is introducing any significant overhead. While ideally we'd run on the\nbackend's Python client without Ibis in the mix, this keeps the benchmarking\nprocess simple and should serve as a decent proxy.\n:::\n\nIn this case, we do see that Ibis dataframe code is adding some overhead. But,\nthis is a single data point -- let's expand to the first 7 queries:\n\n:::{.callout-note title=\"Logging the y-axis\"}\nFrom here, we'll set `log_y=True` due to the wide range of execution times.\n\nWe also look at the first 7 queries due to limited horizontal space on this\nwebsite. Analyze and visualize the data yourself for all 22 queries! Or [see\nthe Ibis benchmarking Streamlit app](https://ibis-bench.streamlit.app).\n:::\n\n::: {#e6a2c602 .cell execution_count=20}\n``` {.python .cell-code}\nlog_y = True\nqueries_filter = range(1, 7+1)\n\ntimings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"d9a828c8-e422-4272-b41f-75bb6dd64c2f\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"d9a828c8-e422-4272-b41f-75bb6dd64c2f\")) {                    Plotly.newPlot(                        \"d9a828c8-e422-4272-b41f-75bb6dd64c2f\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-2\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-2\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"x\"}},\"name\":\"ibis-duckdb, n2d-standard-2\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-2\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[6,1,5,7,4,3,2],\"xaxis\":\"x\",\"y\":[49.7428944905599,111.81634593009949,79.99639010429382,167.6698002020518,53.14470879236857,76.22619962692261,9.01880407333374],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-4\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-4\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"+\"}},\"name\":\"ibis-duckdb, n2d-standard-4\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-4\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[3,1,6,7,4,5,2],\"xaxis\":\"x\",\"y\":[57.629031817118324,52.48048988978068,45.321753899256386,82.24646361668904,29.308464288711548,53.63263535499573,6.6205854415893555],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-8\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-8\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\".\"}},\"name\":\"ibis-duckdb, n2d-standard-8\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-8\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[7,4,5,1,6,2,3],\"xaxis\":\"x\",\"y\":[26.38829843203227,9.234363794326782,13.609139839808146,23.785067558288574,8.34712823232015,1.9450260798136394,13.816275278727213],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-16\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-16\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb, n2d-standard-16\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-16\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[5,2,3,1,7,4,6],\"xaxis\":\"x\",\"y\":[7.192176500956218,1.038861910502116,6.893320242563884,11.582529067993164,13.814172585805258,4.962450901667277,4.339909315109253],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-32\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-duckdb, n2d-standard-32\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[5,2,3,1,4,7,6],\"xaxis\":\"x\",\"y\":[3.9903443654378257,0.6979877154032389,3.935547669728597,5.938729286193848,2.8200621604919434,7.479643742243449,2.341557025909424],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-2\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-2\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"x\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-2\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-2\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,3,2,5,6,7,4],\"xaxis\":\"x\",\"y\":[93.9455053806305,73.71186025937398,15.153176069259644,74.46631360054016,55.65792457262675,269.1292410691579,55.44052871068319],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-4\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-4\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"+\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-4\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-4\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[4,7,2,3,6,5,1],\"xaxis\":\"x\",\"y\":[31.415818214416504,121.47943234443665,11.380781571070353,54.54566089312235,39.74296442667643,52.16614373524984,50.23033595085144],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-8\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-8\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\".\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-8\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-8\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[6,1,5,7,4,3,2],\"xaxis\":\"x\",\"y\":[9.49041755994161,20.659324566523235,11.995146989822388,34.449400901794434,9.439269463221232,13.072817166646322,3.2307483355204263],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-16\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-16\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-16\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-16\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[4,7,5,1,6,2,3],\"xaxis\":\"x\",\"y\":[5.0534547964731855,15.544215122858683,6.304445346196492,9.83419426282247,4.930152336756389,1.6244436105092366,6.493680874506633],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-32\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-32\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[5,2,3,1,7,4,6],\"xaxis\":\"x\",\"y\":[3.694347699483236,1.0186904271443684,3.7939114570617676,5.2171577612559,10.273284514745077,3.0171448389689126,2.716411034266154],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"},\"type\":\"log\"},\"legend\":{\"title\":{\"text\":\"system, instance_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"sf: 128\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('d9a828c8-e422-4272-b41f-75bb6dd64c2f');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nThis tells a different story. Sometimes Ibis dataframe code is a bit faster,\nsometimes a bit slower. Let's compute the totals:\n\n::: {#22489703 .cell execution_count=21}\n``` {.python .cell-code}\n(\n    agg.filter(agg[\"sf\"] == sf_filter)\n    .filter(agg[\"system\"].isin(systems_filter))\n    .filter(agg[\"instance_type\"].isin(instances_filter))\n    .filter(agg[\"query_number\"].isin(queries_filter))\n    .group_by(\"system\")\n    .agg(\n        total_execution_seconds=agg[\"mean_execution_seconds\"].sum(),\n        total_queries=ibis._.count(),\n    )\n    .mutate(\n        seconds_per_query=ibis._[\"total_execution_seconds\"] / ibis._[\"total_queries\"]\n    )\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> system          </span>┃<span style=\"font-weight: bold\"> total_execution_seconds </span>┃<span style=\"font-weight: bold\"> total_queries </span>┃<span style=\"font-weight: bold\"> seconds_per_query </span>┃\n┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │\n├─────────────────┼─────────────────────────┼───────────────┼───────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb    </span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1049.007159</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">29.971633</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb-sql</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1180.318346</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">33.723381</span> │\n└─────────────────┴─────────────────────────┴───────────────┴───────────────────┘\n</pre>\n```\n:::\n:::\n\n\nIbis dataframe code is a little faster overall, but this is on a subset of\nqueries and scale factors and instance types. More analysis and profiling would\nbe needed to make a definitive statement, but in general we can be happy that\nDuckDB does a great job optimizing the SQL Ibis generates and that Ibis\ndataframe code isn't adding significant overhead.\n\nLet's repeat this for DataFusion:\n\n::: {#e50a97ce .cell execution_count=22}\n``` {.python .cell-code}\nsystems_filter = [\"ibis-datafusion\", \"ibis-datafusion-sql\"]\n\ntimings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"72b6748e-95f5-4ec6-877c-aeaedb0206fe\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"72b6748e-95f5-4ec6-877c-aeaedb0206fe\")) {                    Plotly.newPlot(                        \"72b6748e-95f5-4ec6-877c-aeaedb0206fe\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8]],\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003einstance_type=n2d-standard-2\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion, n2d-standard-2\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"x\"}},\"name\":\"ibis-datafusion, n2d-standard-2\",\"offsetgroup\":\"ibis-datafusion, n2d-standard-2\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[2,7,4,1,5,3,6],\"xaxis\":\"x\",\"y\":[11.363901694615683,146.63673464457193,60.15771754582723,141.34012492497763,103.98395832379659,93.7709014415741,73.55492202440898],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16]],\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003einstance_type=n2d-standard-4\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion, n2d-standard-4\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"+\"}},\"name\":\"ibis-datafusion, n2d-standard-4\",\"offsetgroup\":\"ibis-datafusion, n2d-standard-4\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[7,4,2,1,5,6,3],\"xaxis\":\"x\",\"y\":[64.4235285917918,25.11102867126465,7.114913145701091,66.99990622202556,54.826802810033165,29.97126046816508,63.446453332901],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32]],\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003einstance_type=n2d-standard-8\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion, n2d-standard-8\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\".\"}},\"name\":\"ibis-datafusion, n2d-standard-8\",\"offsetgroup\":\"ibis-datafusion, n2d-standard-8\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[6,3,5,1,7,4,2],\"xaxis\":\"x\",\"y\":[15.808083295822144,17.678866863250732,19.327382644017536,33.89225927988688,28.73931161562602,10.578797340393066,3.1191936333974204],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64]],\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003einstance_type=n2d-standard-16\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion, n2d-standard-16\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion, n2d-standard-16\",\"offsetgroup\":\"ibis-datafusion, n2d-standard-16\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[5,3,2,6,7,4,1],\"xaxis\":\"x\",\"y\":[10.493077993392944,11.601869583129883,2.4326950709025064,6.173372507095337,15.978981018066406,7.893036524454753,17.721132198969524],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion, n2d-standard-32\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-datafusion, n2d-standard-32\",\"offsetgroup\":\"ibis-datafusion, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[7,4,2,1,5,6,3],\"xaxis\":\"x\",\"y\":[11.63159171740214,7.482565720876058,2.2544215520222983,16.529266754786175,7.471903959910075,3.4388548533121743,9.200567960739136],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8]],\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003einstance_type=n2d-standard-2\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql, n2d-standard-2\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"x\"}},\"name\":\"ibis-datafusion-sql, n2d-standard-2\",\"offsetgroup\":\"ibis-datafusion-sql, n2d-standard-2\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,4,6,2,3,5],\"xaxis\":\"x\",\"y\":[150.74161338806152,55.97467875480652,57.67109179496765,29.713732481002808,88.4080200990041,111.47976183891296],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16]],\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003einstance_type=n2d-standard-4\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql, n2d-standard-4\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"+\"}},\"name\":\"ibis-datafusion-sql, n2d-standard-4\",\"offsetgroup\":\"ibis-datafusion-sql, n2d-standard-4\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[5,6,4,3,2,1],\"xaxis\":\"x\",\"y\":[55.346779664357506,37.8270780245463,26.76049606005351,61.042712370554604,17.599053780237835,69.05837146441142],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32]],\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003einstance_type=n2d-standard-8\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql, n2d-standard-8\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\".\"}},\"name\":\"ibis-datafusion-sql, n2d-standard-8\",\"offsetgroup\":\"ibis-datafusion-sql, n2d-standard-8\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[3,6,5,1,2,4,7],\"xaxis\":\"x\",\"y\":[16.597763617833454,8.179972171783447,21.060061931610107,33.04584511121114,8.765077829360962,9.519487619400024,40.027138233184814],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64]],\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003einstance_type=n2d-standard-16\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql, n2d-standard-16\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion-sql, n2d-standard-16\",\"offsetgroup\":\"ibis-datafusion-sql, n2d-standard-16\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[5,3,2,6,7,4,1],\"xaxis\":\"x\",\"y\":[12.02802308400472,11.203579425811768,6.750166734059651,4.181100845336914,24.014207124710083,5.670323610305786,16.38461971282959],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql, n2d-standard-32\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-datafusion-sql, n2d-standard-32\",\"offsetgroup\":\"ibis-datafusion-sql, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,2,3,4,7,6,5],\"xaxis\":\"x\",\"y\":[12.949114084243774,6.693936745325725,9.455447912216187,3.730076869328817,17.029499053955078,2.7630774974823,9.587421178817749],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"},\"type\":\"log\"},\"legend\":{\"title\":{\"text\":\"system, instance_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"sf: 128\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('72b6748e-95f5-4ec6-877c-aeaedb0206fe');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nWe see a similar story. Let's confirm with a table:\n\n::: {#206c8807 .cell execution_count=23}\n``` {.python .cell-code}\n(\n    agg.filter(agg[\"sf\"] == sf_filter)\n    .filter(agg[\"system\"].isin(systems_filter))\n    .filter(agg[\"instance_type\"].isin(instances_filter))\n    .filter(agg[\"query_number\"].isin(queries_filter))\n    .group_by(\"system\")\n    .agg(\n        total_execution_seconds=agg[\"mean_execution_seconds\"].sum(),\n        total_queries=ibis._.count(),\n    )\n    .mutate(\n        seconds_per_query=ibis._[\"total_execution_seconds\"] / ibis._[\"total_queries\"]\n    )\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> system              </span>┃<span style=\"font-weight: bold\"> total_execution_seconds </span>┃<span style=\"font-weight: bold\"> total_queries </span>┃<span style=\"font-weight: bold\"> seconds_per_query </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │\n├─────────────────────┼─────────────────────────┼───────────────┼───────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1041.259330</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">33</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31.553313</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion    </span> │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1202.149386</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">34.347125</span> │\n└─────────────────────┴─────────────────────────┴───────────────┴───────────────────┘\n</pre>\n```\n:::\n:::\n\n\nThis time Ibis dataframe code is a bit slower overall. **However, also notice\ntwo queries are missing from `ibis-datafusion-sql`**. These are query 7 on\n`n2d-standard-2` and `n2d-standard-4` (the two instances with the least memory).\nWe'll investigate failing queries more thoroughly in the next section.\n\nFirst, let's look at Polars:\n\n::: {#3540c1c6 .cell execution_count=24}\n``` {.python .cell-code}\nsystems_filter = [\"ibis-polars\", \"polars-lazy\"]\n\ntimings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"a1de20d0-c0b7-4571-8d23-d360d1ac8ff4\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"a1de20d0-c0b7-4571-8d23-d360d1ac8ff4\")) {                    Plotly.newPlot(                        \"a1de20d0-c0b7-4571-8d23-d360d1ac8ff4\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",2,8],[\"AMD EPYC\",2,8]],\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003einstance_type=n2d-standard-2\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars, n2d-standard-2\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"x\"}},\"name\":\"ibis-polars, n2d-standard-2\",\"offsetgroup\":\"ibis-polars, n2d-standard-2\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[6,2],\"xaxis\":\"x\",\"y\":[61.469714879989624,13.319883108139038],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16]],\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003einstance_type=n2d-standard-4\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars, n2d-standard-4\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"+\"}},\"name\":\"ibis-polars, n2d-standard-4\",\"offsetgroup\":\"ibis-polars, n2d-standard-4\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[6,2],\"xaxis\":\"x\",\"y\":[52.33062720298767,9.546661615371704],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32]],\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003einstance_type=n2d-standard-8\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars, n2d-standard-8\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\".\"}},\"name\":\"ibis-polars, n2d-standard-8\",\"offsetgroup\":\"ibis-polars, n2d-standard-8\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[2,6],\"xaxis\":\"x\",\"y\":[6.598418553670247,18.069969574610393],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64]],\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003einstance_type=n2d-standard-16\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars, n2d-standard-16\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-polars, n2d-standard-16\",\"offsetgroup\":\"ibis-polars, n2d-standard-16\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[2,3,4,7,6],\"xaxis\":\"x\",\"y\":[10.44108772277832,27.571980555852253,13.035804430643717,22.919936974843342,17.985748132069904],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars, n2d-standard-32\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-polars, n2d-standard-32\",\"offsetgroup\":\"ibis-polars, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[3,5,1,2,6,4,7],\"xaxis\":\"x\",\"y\":[27.108211437861126,13.99797248840332,62.19382929801941,5.905109326044719,4.244828224182129,11.461715777715048,12.255585193634033],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",4,16],[\"AMD EPYC\",4,16]],\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003einstance_type=n2d-standard-4\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy, n2d-standard-4\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"+\"}},\"name\":\"polars-lazy, n2d-standard-4\",\"offsetgroup\":\"polars-lazy, n2d-standard-4\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[6,2],\"xaxis\":\"x\",\"y\":[54.12349343299866,8.95040512084961],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32],[\"AMD EPYC\",8,32]],\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003einstance_type=n2d-standard-8\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy, n2d-standard-8\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\".\"}},\"name\":\"polars-lazy, n2d-standard-8\",\"offsetgroup\":\"polars-lazy, n2d-standard-8\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[7,4,2,6],\"xaxis\":\"x\",\"y\":[32.36805748939514,21.888363758722942,3.828543742497762,18.953997373580933],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64],[\"AMD EPYC\",16,64]],\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003einstance_type=n2d-standard-16\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy, n2d-standard-16\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\"}},\"name\":\"polars-lazy, n2d-standard-16\",\"offsetgroup\":\"polars-lazy, n2d-standard-16\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[4,7,6,2,3],\"xaxis\":\"x\",\"y\":[11.27583646774292,19.500889619191486,18.51408116022746,3.3814821243286133,28.86030451456706],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy, n2d-standard-32\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"polars-lazy, n2d-standard-32\",\"offsetgroup\":\"polars-lazy, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[7,4,5,6,1,2,3],\"xaxis\":\"x\",\"y\":[10.39676809310913,10.389480113983154,13.94202979405721,3.6897570292154946,33.80695390701294,3.2517149448394775,13.268091122309366],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"},\"type\":\"log\"},\"legend\":{\"title\":{\"text\":\"system, instance_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"sf: 128\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('a1de20d0-c0b7-4571-8d23-d360d1ac8ff4');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nA lot of queries are missing from `ibis-polars` and `polars-lazy`. These are\nfailing due to the high scale factor and limited memory on the instances.\n\nLet's look at a lower scale factor and my MacBooks (Polars tended to perform\nbetter on these):\n\n::: {#b8fd41a0 .cell execution_count=25}\n``` {.python .cell-code}\nsf_filter = 64\ninstances_filter = [\n    instance for instance in instance_types if \"laptop\" in instance\n]\n\ntimings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"550f718b-ff8e-41e0-8484-21a26c47642b\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"550f718b-ff8e-41e0-8484-21a26c47642b\")) {                    Plotly.newPlot(                        \"550f718b-ff8e-41e0-8484-21a26c47642b\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32]],\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003einstance_type=work laptop\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars, work laptop\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\\\\\"}},\"name\":\"ibis-polars, work laptop\",\"offsetgroup\":\"ibis-polars, work laptop\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[5,6,7,4,1,2,3],\"xaxis\":\"x\",\"y\":[13.21927841504415,4.801118771235148,9.317765474319458,5.086873133977254,110.36613933245341,1.3930803140004475,6.99468731880188],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96]],\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003einstance_type=personal laptop\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars, personal laptop\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"x\"}},\"name\":\"ibis-polars, personal laptop\",\"offsetgroup\":\"ibis-polars, personal laptop\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[5,3,2,1,7,4,6],\"xaxis\":\"x\",\"y\":[3.8612585067749023,3.482304255167643,1.8289570808410645,16.727041323979694,4.213795344034831,2.521452267964681,1.7339130242665608],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32],[\"Apple M1 Max\",12,32]],\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003einstance_type=work laptop\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy, work laptop\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\\\\\"}},\"name\":\"polars-lazy, work laptop\",\"offsetgroup\":\"polars-lazy, work laptop\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[6,3,2,7,4,1,5],\"xaxis\":\"x\",\"y\":[5.319633324940999,8.647685130437216,0.707722028096517,6.241333723068237,4.381483236948649,45.943869272867836,18.01548933982849],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96],[\"Apple M2 Max\",12,96]],\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003einstance_type=personal laptop\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy, personal laptop\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"x\"}},\"name\":\"polars-lazy, personal laptop\",\"offsetgroup\":\"polars-lazy, personal laptop\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,7,4,6,5,3,2],\"xaxis\":\"x\",\"y\":[9.250827312469482,3.789229154586792,2.843586047490438,1.7952766418457031,4.006711959838867,3.5790963172912598,0.6358058452606201],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"},\"type\":\"log\"},\"legend\":{\"title\":{\"text\":\"system, instance_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"sf: 64\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('550f718b-ff8e-41e0-8484-21a26c47642b');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nWe see a similar pattern as above -- some queries are a little faster on\n`ibis-polars`, though some are **much** slower. In particular queries 1 and 2\ntend to have a lot of overhead.\n\n::: {#7661cf77 .cell execution_count=26}\n``` {.python .cell-code}\n(\n    agg.filter(agg[\"sf\"] == sf_filter)\n    .filter(agg[\"system\"].isin(systems_filter))\n    .filter(agg[\"instance_type\"].isin(instances_filter))\n    .filter(agg[\"query_number\"].isin(queries_filter))\n    .group_by(\"system\")\n    .agg(\n        total_execution_seconds=agg[\"mean_execution_seconds\"].sum(),\n        total_queries=ibis._.count(),\n    )\n    .mutate(\n        seconds_per_query=ibis._[\"total_execution_seconds\"] / ibis._[\"total_queries\"]\n    )\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> system      </span>┃<span style=\"font-weight: bold\"> total_execution_seconds </span>┃<span style=\"font-weight: bold\"> total_queries </span>┃<span style=\"font-weight: bold\"> seconds_per_query </span>┃\n┡━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │\n├─────────────┼─────────────────────────┼───────────────┼───────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-polars</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">185.547665</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13.253405</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">polars-lazy</span> │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">115.157749</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.225554</span> │\n└─────────────┴─────────────────────────┴───────────────┴───────────────────┘\n</pre>\n```\n:::\n:::\n\n\nLet's now compare all systems across a single instance type and query:\n\n::: {#782928a6 .cell execution_count=27}\n``` {.python .cell-code}\nsf_filter = 128\ninstances_filter = [\"n2d-standard-32\"]\nsystems_filter = systems\nqueries_filter = [1]\n\ntimings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"3df91817-773e-4036-9857-6b7d743e9563\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"3df91817-773e-4036-9857-6b7d743e9563\")) {                    Plotly.newPlot(                        \"3df91817-773e-4036-9857-6b7d743e9563\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion, n2d-standard-32\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-datafusion, n2d-standard-32\",\"offsetgroup\":\"ibis-datafusion, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[16.529266754786175],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql, n2d-standard-32\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-datafusion-sql, n2d-standard-32\",\"offsetgroup\":\"ibis-datafusion-sql, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[12.949114084243774],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-32\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-duckdb, n2d-standard-32\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[5.938729286193848],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-32\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-32\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[5.2171577612559],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars, n2d-standard-32\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-polars, n2d-standard-32\",\"offsetgroup\":\"ibis-polars, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[62.19382929801941],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy, n2d-standard-32\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"polars-lazy, n2d-standard-32\",\"offsetgroup\":\"polars-lazy, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1],\"xaxis\":\"x\",\"y\":[33.80695390701294],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"},\"type\":\"log\"},\"legend\":{\"title\":{\"text\":\"system, instance_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"sf: 128\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('3df91817-773e-4036-9857-6b7d743e9563');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nAnd then the first 7 queries:\n\n::: {#0d936a1c .cell execution_count=28}\n``` {.python .cell-code}\nqueries_filter = range(1, 7+1)\n\ntimings_plot(agg, sf_filter, systems_filter, instances_filter, queries_filter, log_y)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"e09b85a5-ca55-41b9-8cc1-77d0f5785239\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"e09b85a5-ca55-41b9-8cc1-77d0f5785239\")) {                    Plotly.newPlot(                        \"e09b85a5-ca55-41b9-8cc1-77d0f5785239\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion, n2d-standard-32\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-datafusion, n2d-standard-32\",\"offsetgroup\":\"ibis-datafusion, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[5,2,1,7,4,3,6],\"xaxis\":\"x\",\"y\":[7.471903959910075,2.2544215520222983,16.529266754786175,11.63159171740214,7.482565720876058,9.200567960739136,3.4388548533121743],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql, n2d-standard-32\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-datafusion-sql, n2d-standard-32\",\"offsetgroup\":\"ibis-datafusion-sql, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[6,4,7,1,3,2,5],\"xaxis\":\"x\",\"y\":[2.7630774974823,3.730076869328817,17.029499053955078,12.949114084243774,9.455447912216187,6.693936745325725,9.587421178817749],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb, n2d-standard-32\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-duckdb, n2d-standard-32\",\"offsetgroup\":\"ibis-duckdb, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[4,7,2,5,6,1,3],\"xaxis\":\"x\",\"y\":[2.8200621604919434,7.479643742243449,0.6979877154032389,3.9903443654378257,2.341557025909424,5.938729286193848,3.935547669728597],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql, n2d-standard-32\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-duckdb-sql, n2d-standard-32\",\"offsetgroup\":\"ibis-duckdb-sql, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[7,4,2,5,6,1,3],\"xaxis\":\"x\",\"y\":[10.273284514745077,3.0171448389689126,1.0186904271443684,3.694347699483236,2.716411034266154,5.2171577612559,3.7939114570617676],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars, n2d-standard-32\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"ibis-polars, n2d-standard-32\",\"offsetgroup\":\"ibis-polars, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[6,4,7,1,3,2,5],\"xaxis\":\"x\",\"y\":[4.244828224182129,11.461715777715048,12.255585193634033,62.19382929801941,27.108211437861126,5.905109326044719,13.99797248840332],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128],[\"AMD EPYC\",32,128]],\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003einstance_type=n2d-standard-32\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cbr\\u003ecpu_type=%{customdata[0]}\\u003cbr\\u003ecpu_cores=%{customdata[1]}\\u003cbr\\u003ememory_gbs=%{customdata[2]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy, n2d-standard-32\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\\u002f\"}},\"name\":\"polars-lazy, n2d-standard-32\",\"offsetgroup\":\"polars-lazy, n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[2,5,3,7,4,1,6],\"xaxis\":\"x\",\"y\":[3.2517149448394775,13.94202979405721,13.268091122309366,10.39676809310913,10.389480113983154,33.80695390701294,3.6897570292154946],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"},\"type\":\"log\"},\"legend\":{\"title\":{\"text\":\"system, instance_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"sf: 128\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('e09b85a5-ca55-41b9-8cc1-77d0f5785239');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\n:::{.callout-warning title=\"Lots of data, lots of takeaways\"}\nThere is a lot of data and it's easy to summarize and visualize it in a way that\nfavors a given system. There's a lot of missing data that needs to be accounted\nfor, as it often indicates a query that failed due to memory pressure.\n\nEach system has strengths and weaknesses. See [the discussion section\nbelow](#which-system-is-best).\n\nSee the [Ibis benchmarking Streamlit app](https://ibis-bench.streamlit.app) for\nfurther analysis, or query the data yourself!\n:::\n\n### Failing queries due to memory pressure\n\nMany queries fail due to memory pressure at higher scale factors with\ninsufficient resources. Impressively, the exception here is DuckDB.\n\n::: {#2da2acc0 .cell execution_count=29}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show code to get table of failing queries\"}\ndef failing_queries(agg, sf, instance_type):\n    failing = (\n        t.filter(t[\"sf\"] == sf)\n        .filter(t[\"instance_type\"] == instance_type)\n        .group_by(\"system\")\n        .agg(present_queries=ibis._[\"query_number\"].collect().unique().sort())\n    )\n    failing = (\n        failing.mutate(\n            failing_queries=t.distinct(on=\"query_number\")[\"query_number\"]\n            .collect()\n            .filter(lambda x: ~failing[\"present_queries\"].contains(x))\n        )\n        .mutate(\n            num_failing_queries=ibis._[\"failing_queries\"].length(),\n            num_successful_queries=ibis._[\"present_queries\"].length(),\n        )\n        .drop(\"present_queries\")\n        .order_by(\"num_failing_queries\", \"system\")\n    )\n\n    return failing\n```\n:::\n\n\nLet's look at the failing queries on the largest `n2d` instance::\n\n::: {#e2d0bd3f .cell execution_count=30}\n``` {.python .cell-code}\nsf = 128\ninstance_type = \"n2d-standard-32\"\n\nfailing = failing_queries(agg, sf, instance_type)\nfailing\n```\n\n::: {.cell-output .cell-output-display execution_count=30}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> system              </span>┃<span style=\"font-weight: bold\"> failing_queries                             </span>┃<span style=\"font-weight: bold\"> num_failing_queries </span>┃<span style=\"font-weight: bold\"> num_successful_queries </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;int64&gt;</span>                                │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>                  │\n├─────────────────────┼─────────────────────────────────────────────┼─────────────────────┼────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb        </span> │ <span style=\"font-weight: bold\">[]</span>                                          │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb-sql    </span> │ <span style=\"font-weight: bold\">[]</span>                                          │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span><span style=\"font-weight: bold\">]</span>                                        │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">polars-lazy        </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9</span><span style=\"font-weight: bold\">]</span>                                         │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion    </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span><span style=\"font-weight: bold\">]</span>                                │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-polars        </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span><span style=\"font-weight: bold\">]</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span> │\n└─────────────────────┴─────────────────────────────────────────────┴─────────────────────┴────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#dda4267f .cell execution_count=31}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show code to create a bar plot of the number of successful queries by system\"}\nc = px.bar(\n    failing,\n    x=\"system\",\n    y=\"num_successful_queries\",\n    category_orders={\n        \"system\": systems,\n        \"query_number\": query_numbers,\n    },\n    color=\"system\",\n    title=\"completed queries\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"77fc68e0-065b-431f-b1e2-1e3b63632056\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"77fc68e0-065b-431f-b1e2-1e3b63632056\")) {                    Plotly.newPlot(                        \"77fc68e0-065b-431f-b1e2-1e3b63632056\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion\",\"offsetgroup\":\"ibis-datafusion\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-datafusion\"],\"xaxis\":\"x\",\"y\":[19],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion-sql\",\"offsetgroup\":\"ibis-datafusion-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-datafusion-sql\"],\"xaxis\":\"x\",\"y\":[21],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb\",\"offsetgroup\":\"ibis-duckdb\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[22],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql\",\"offsetgroup\":\"ibis-duckdb-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-duckdb-sql\"],\"xaxis\":\"x\",\"y\":[22],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-polars\",\"offsetgroup\":\"ibis-polars\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\"],\"xaxis\":\"x\",\"y\":[11],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\"}},\"name\":\"polars-lazy\",\"offsetgroup\":\"polars-lazy\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"polars-lazy\"],\"xaxis\":\"x\",\"y\":[21],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"system\"},\"categoryorder\":\"array\",\"categoryarray\":[\"ibis-datafusion\",\"ibis-datafusion-sql\",\"ibis-duckdb\",\"ibis-duckdb-sql\",\"ibis-polars\",\"polars-lazy\"]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"num_successful_queries\"}},\"legend\":{\"title\":{\"text\":\"system\"},\"tracegroupgap\":0},\"title\":{\"text\":\"completed queries\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('77fc68e0-065b-431f-b1e2-1e3b63632056');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nAnd the smallest:\n\n::: {#46ef36c2 .cell execution_count=32}\n``` {.python .cell-code}\ninstance_type = \"n2d-standard-2\"\n\nfailing = failing_queries(agg, sf, instance_type)\nfailing\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> system              </span>┃<span style=\"font-weight: bold\"> failing_queries                                                           </span>┃<span style=\"font-weight: bold\"> num_failing_queries </span>┃<span style=\"font-weight: bold\"> num_successful_queries </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;int64&gt;</span>                                                              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>               │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>                  │\n├─────────────────────┼───────────────────────────────────────────────────────────────────────────┼─────────────────────┼────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb        </span> │ <span style=\"font-weight: bold\">[]</span>                                                                        │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb-sql    </span> │ <span style=\"font-weight: bold\">[]</span>                                                                        │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20</span><span style=\"font-weight: bold\">]</span>                                                        │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion    </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span><span style=\"font-weight: bold\">]</span>                                                   │                   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6</span> │                     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">polars-lazy        </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span><span style=\"font-weight: bold\">]</span>           │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-polars        </span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">16</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">22</span><span style=\"font-weight: bold\">]</span> │                  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20</span> │                      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │\n└─────────────────────┴───────────────────────────────────────────────────────────────────────────┴─────────────────────┴────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#ca4f11e4 .cell execution_count=33}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show code to create a bar plot of the number of successful queries by system\"}\nc = px.bar(\n    failing,\n    x=\"system\",\n    y=\"num_successful_queries\",\n    category_orders={\n        \"system\": systems,\n        \"query_number\": query_numbers,\n    },\n    color=\"system\",\n    title=\"completed queries\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"e6b603e8-b0ba-4967-921d-e5f9bbc13247\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"e6b603e8-b0ba-4967-921d-e5f9bbc13247\")) {                    Plotly.newPlot(                        \"e6b603e8-b0ba-4967-921d-e5f9bbc13247\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion\",\"offsetgroup\":\"ibis-datafusion\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-datafusion\"],\"xaxis\":\"x\",\"y\":[16],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion-sql\",\"offsetgroup\":\"ibis-datafusion-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-datafusion-sql\"],\"xaxis\":\"x\",\"y\":[17],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb\",\"offsetgroup\":\"ibis-duckdb\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[22],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql\",\"offsetgroup\":\"ibis-duckdb-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-duckdb-sql\"],\"xaxis\":\"x\",\"y\":[22],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-polars\",\"offsetgroup\":\"ibis-polars\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\"],\"xaxis\":\"x\",\"y\":[2],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\"}},\"name\":\"polars-lazy\",\"offsetgroup\":\"polars-lazy\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"polars-lazy\"],\"xaxis\":\"x\",\"y\":[4],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"system\"},\"categoryorder\":\"array\",\"categoryarray\":[\"ibis-datafusion\",\"ibis-datafusion-sql\",\"ibis-duckdb\",\"ibis-duckdb-sql\",\"ibis-polars\",\"polars-lazy\"]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"num_successful_queries\"}},\"legend\":{\"title\":{\"text\":\"system\"},\"tracegroupgap\":0},\"title\":{\"text\":\"completed queries\"},\"barmode\":\"relative\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('e6b603e8-b0ba-4967-921d-e5f9bbc13247');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nA lot of queries are failing on the smallest instance due to memory pressure.\n\nWe can create a single visualization across the `n2d` instances:\n\n::: {#2a2f3a58 .cell execution_count=34}\n``` {.python .cell-code code-fold=\"true\" code-summary=\"Show code to create a bar plot of the number of successful queries by system and instance type\"}\nfailing = t.group_by(\"instance_type\", \"system\", \"sf\").agg(\n    total_time=t[\"execution_seconds\"].sum(),\n    present_queries=ibis._[\"query_number\"].collect().unique().sort(),\n)\nfailing = (\n    failing.mutate(\n        failing_queries=t.distinct(on=\"query_number\")[\"query_number\"]\n        .collect()\n        .filter(lambda x: ~failing[\"present_queries\"].contains(x)),\n    )\n    .mutate(\n        num_failing_queries=ibis._[\"failing_queries\"].length(),\n        num_successful_queries=ibis._[\"present_queries\"].length(),\n    )\n    .drop(\"present_queries\")\n    .relocate(\"instance_type\", \"system\", \"sf\", \"failing_queries\")\n    .order_by(\"num_failing_queries\", \"instance_type\", \"system\", \"sf\")\n)\nfailing = failing.join(instance_details, \"instance_type\")\nfailing = (\n    failing.filter(\n        (failing[\"sf\"] == 128) & (failing[\"instance_type\"].startswith(\"n2d-\"))\n    )\n).order_by(ibis.desc(\"memory_gbs\"))\n\nc = px.bar(\n    failing,\n    x=\"system\",\n    y=\"num_successful_queries\",\n    color=\"instance_type\",\n    barmode=\"group\",\n    hover_data=[\"cpu_cores\", \"memory_gbs\"],\n    category_orders={\n        \"system\": systems,\n        \"instance_type\": reversed(\n            [instance for instance in instance_types if instance.startswith(\"n2d\")]\n        ),\n    },\n    title=\"completed queries\",\n)\nc\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"c9948a0d-c7cf-4ac9-90f9-69eb1595d232\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"c9948a0d-c7cf-4ac9-90f9-69eb1595d232\")) {                    Plotly.newPlot(                        \"c9948a0d-c7cf-4ac9-90f9-69eb1595d232\",                        [{\"alignmentgroup\":\"True\",\"customdata\":[[32,128],[32,128],[32,128],[32,128],[32,128],[32,128]],\"hovertemplate\":\"instance_type=n2d-standard-32\\u003cbr\\u003esystem=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"n2d-standard-32\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"n2d-standard-32\",\"offsetgroup\":\"n2d-standard-32\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\",\"ibis-duckdb-sql\",\"ibis-duckdb\",\"ibis-datafusion\",\"polars-lazy\",\"ibis-datafusion-sql\"],\"xaxis\":\"x\",\"y\":[11,22,22,19,21,21],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[16,64],[16,64],[16,64],[16,64],[16,64],[16,64]],\"hovertemplate\":\"instance_type=n2d-standard-16\\u003cbr\\u003esystem=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"n2d-standard-16\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"n2d-standard-16\",\"offsetgroup\":\"n2d-standard-16\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\",\"polars-lazy\",\"ibis-duckdb-sql\",\"ibis-duckdb\",\"ibis-datafusion\",\"ibis-datafusion-sql\"],\"xaxis\":\"x\",\"y\":[7,17,22,22,18,21],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[8,32],[8,32],[8,32],[8,32],[8,32],[8,32]],\"hovertemplate\":\"instance_type=n2d-standard-8\\u003cbr\\u003esystem=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"n2d-standard-8\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"n2d-standard-8\",\"offsetgroup\":\"n2d-standard-8\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\",\"polars-lazy\",\"ibis-datafusion\",\"ibis-datafusion-sql\",\"ibis-duckdb-sql\",\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[3,13,18,21,22,22],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[4,16],[4,16],[4,16],[4,16],[4,16],[4,16]],\"hovertemplate\":\"instance_type=n2d-standard-4\\u003cbr\\u003esystem=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"n2d-standard-4\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"n2d-standard-4\",\"offsetgroup\":\"n2d-standard-4\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\",\"polars-lazy\",\"ibis-datafusion\",\"ibis-datafusion-sql\",\"ibis-duckdb-sql\",\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[2,8,17,18,22,22],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"customdata\":[[2,8],[2,8],[2,8],[2,8],[2,8],[2,8]],\"hovertemplate\":\"instance_type=n2d-standard-2\\u003cbr\\u003esystem=%{x}\\u003cbr\\u003enum_successful_queries=%{y}\\u003cbr\\u003ecpu_cores=%{customdata[0]}\\u003cbr\\u003ememory_gbs=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"n2d-standard-2\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"n2d-standard-2\",\"offsetgroup\":\"n2d-standard-2\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[\"ibis-polars\",\"polars-lazy\",\"ibis-datafusion\",\"ibis-datafusion-sql\",\"ibis-duckdb-sql\",\"ibis-duckdb\"],\"xaxis\":\"x\",\"y\":[2,4,16,17,22,22],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"system\"},\"categoryorder\":\"array\",\"categoryarray\":[\"ibis-datafusion\",\"ibis-datafusion-sql\",\"ibis-duckdb\",\"ibis-duckdb-sql\",\"ibis-polars\",\"polars-lazy\"]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"num_successful_queries\"}},\"legend\":{\"title\":{\"text\":\"instance_type\"},\"tracegroupgap\":0},\"title\":{\"text\":\"completed queries\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('c9948a0d-c7cf-4ac9-90f9-69eb1595d232');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nWithin each system, from left to right, we have decreasing resources (vCPUs and\nmemory). We can see how each system performs on the same queries with different\nresources.\n\n:::{.callout-warning title=\"Data is aggregated\"}\nKeep in mind data is aggregated over three runs of each query. For DuckDB, there\nwas actually a single failure on the smallest instance for query 9, out of six\nruns across the two systems, but this does not appear above because we are\nchecking for the success of the query in any of the three runs per\nconfiguration.\n:::\n\n## Discussion and reproducibility\n\nBenchmarking is fraught: it's easy to get wrong and ship your bias in the\nresults. We don't want to end up as [Figure 1 in \"Fair Benchmarking Considered\nDifficult: Common Pitfalls In Database Performance\nTesting\"](https://hannes.muehleisen.org/publications/DBTEST2018-performance-testing.pdf):\n\n![Figure 1](figure1.png)\n\nIf you have any questions or concerns, feel free to [open an\nissue](https://github.com/lostmygithubaccount/ibis-bench/issues/new) or comment\non this post below.\n\n### Which system is best?\n\nTrick question! It depends on your use case. DuckDB is a simple, performant\nin-process database with an on-disk file format (SQLite for OLAP). DataFusion is\nan extensible query engine and is often used for building databases or query\nengines. Polars is an OLAP query engine with a Python dataframe API that can be\nused as a more performant alternative to pandas.\n\nAll three make great Ibis backends and you can switch between them in a single\nline of code. This lets you write your code once and run it on the engine that's\nbest for your use case. If a better engine comes along you'll likely be able to\nuse that too. And you can scale up and out across the 20+ backends Ibis supports\nas needed.\n\nTPC-H is a decent benchmark *for what it benchmarks, which is limited*. We're\nnot running window functions, doing timeseries analysis, or feature engineering\nfor machine learning. We're not using nested data types. We're not performing\nregexes or using LLMs in UDFs...\n\nIt's easy to summarize and visualize benchmarking data in a way that favors a\ngiven system. You should favor the system that works best for your use case.\n\n### Performance converges over time\n\nLet's look at some quotes from [\"Perf is not\nenough\"](https://motherduck.com/blog/perf-is-not-enough) by Jordan Tigani of\nMotherDuck:\n\n> If you take a bunch of databases, all actively maintained, and iterate them\n> out a few years, **performance is going to converge**. If Clickhouse is applying\n> a technique that gives it an advantage for scan speed today, Snowflake will\n> likely have that within a year or two. If Snowflake adds incrementally\n> materialized views, BigQuery will soon follow. It is unlikely that important\n> performance differences will persist over time.\n>\n> As clever as the engineers working for any of these companies are, none of\n> them possess any magic incantations or things that cannot be replicated\n> elsewhere. Each database uses a different bag of tricks in order to get good\n> performance. One might compile queries to machine code, another might cache data\n> on local SSDs, and a third might use specialized network hardware to do\n> shuffles. **Given time, all of these techniques can be implemented by anyone. If\n> they work well, they likely will show up everywhere.**\n\nThis is extra true for open source databases (or query engines). If DuckDB adds\na feature that improves performance, it's likely that DataFusion and Polars will\nfollow suit -- they can go read the source code and specific commits to see how\nit was done.\n\n### Reproducing the benchmark\n\nThe source code for [is available on\nGitHub](https://github.com/lostmygithubaccount/ibis-bench/tree/v2.0.0).\n\n#### A TPC-H benchmark on 6 systems in 3 commands\n\nFirst install `ibis-bench`:\n\n```bash\npip install ibis-bench\n```\n\nThen generate the TPC-H data:\n\n```bash\nbench gen-data -s 1\n```\n\nFinally run the benchmark:\n\n```bash\nbench run -s 1 ibis-duckdb ibis-duckdb-sql ibis-datafusion ibis-datafusion-sql ibis-polars polars-lazy\n```\n\nCongratulations! You've run a TPC-H benchmark on DuckDB (Ibis dataframe code and\nSQL), DataFusion (Ibis dataframe code and SQL), and Polars (dataframe code via\nIbis and native Polars).\n\n#### What just happened?\n\nThis will generate TPC-H data at scale factor 1 as Parquet files in the\n`tpch_data` directory:\n\n```bash\ntpch_data\n└── parquet\n    └── sf=1\n        └── n=1\n            ├── customer\n            │   └── 0000.parquet\n            ├── lineitem\n            │   └── 0000.parquet\n            ├── nation\n            │   └── 0000.parquet\n            ├── orders\n            │   └── 0000.parquet\n            ├── part\n            │   └── 0000.parquet\n            ├── partsupp\n            │   └── 0000.parquet\n            ├── region\n            │   └── 0000.parquet\n            └── supplier\n                └── 0000.parquet\n```\n\nThe scale factor is roughly the size of data **in memory** in gigabytes (GBs).\nThe size of data on disk, however, is smaller because Parquet is compressed. We\ncan take a look at the size of the data:\n\n```bash\n384M    tpch_data/parquet/sf=1/n=1\n262M    tpch_data/parquet/sf=1/n=1/lineitem\n 59M    tpch_data/parquet/sf=1/n=1/orders\n 12M    tpch_data/parquet/sf=1/n=1/customer\n 43M    tpch_data/parquet/sf=1/n=1/partsupp\n6.6M    tpch_data/parquet/sf=1/n=1/part\n788K    tpch_data/parquet/sf=1/n=1/supplier\n4.0K    tpch_data/parquet/sf=1/n=1/nation\n4.0K    tpch_data/parquet/sf=1/n=1/region\n```\n\nWe can see the total size is 0.38 GB and the size of the tables -- `lineitem` is\nby far the largest.\n\nUsing `bench run` results in a `results_data` directory with the results of the\nqueries and a `bench_logs_v2` directory with the logs of the benchmark run.\n\n#### Analyzing the results\n\nWe can use Ibis to load and analyze the log data:\n\n::: {#b71f6e75 .cell execution_count=35}\n``` {.python .cell-code}\nimport ibis\n\nibis.options.interactive = True\nibis.options.repr.interactive.max_rows = 6\nibis.options.repr.interactive.max_columns = None\n\nt = ibis.read_json(\"bench_logs_v*/raw_json/file_id=*.json\").relocate(\n    \"system\", \"sf\", \"query_number\", \"execution_seconds\"\n)\nt\n```\n\n::: {.cell-output .cell-output-display execution_count=35}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> system              </span>┃<span style=\"font-weight: bold\"> sf    </span>┃<span style=\"font-weight: bold\"> query_number </span>┃<span style=\"font-weight: bold\"> execution_seconds </span>┃<span style=\"font-weight: bold\"> session_id                           </span>┃<span style=\"font-weight: bold\"> instance_type </span>┃<span style=\"font-weight: bold\"> timestamp                  </span>┃<span style=\"font-weight: bold\"> n_partitions </span>┃<span style=\"font-weight: bold\"> file_type </span>┃<span style=\"font-weight: bold\"> file_id                                   </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">uuid</span>                                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">json</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                    │\n├─────────────────────┼───────┼──────────────┼───────────────────┼──────────────────────────────────────┼───────────────┼────────────────────────────┼──────────────┼───────────┼───────────────────────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.076600</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:34.476397</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">00218347-a4cd-4590-a502-8cf79f4e87c9.json</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.165074</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:35.376753</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">01089668-608c-4551-ae65-6d98d69f959b.json</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-polars        </span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.075944</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:36.956001</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">02a991bd-797a-4c08-83de-c1b537f713fe.json</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion    </span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.144007</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:32.297647</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">02bd900a-3c0a-4871-b651-1690f11a81ab.json</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.067048</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:33.699368</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">08490a6b-e1ab-482c-83bc-85469c6b96a3.json</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb        </span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.160302</span> │ 0b931439-5670-4a77-89b0-d8b7c45e6eb7 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>          │ <span style=\"color: #008000; text-decoration-color: #008000\">2024-06-13T16:09:27.316339</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">parquet  </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">08b92577-8150-4040-bceb-9316da7bfaf4.json</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                   │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                          │            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                         │\n└─────────────────────┴───────┴──────────────┴───────────────────┴──────────────────────────────────────┴───────────────┴────────────────────────────┴──────────────┴───────────┴───────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\nWe can check the total execution time for each system:\n\n::: {#a00b0895 .cell execution_count=36}\n``` {.python .cell-code}\nt.group_by(\"system\").agg(total_seconds=t[\"execution_seconds\"].sum()).order_by(\n    \"total_seconds\"\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> system              </span>┃<span style=\"font-weight: bold\"> total_seconds </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>              │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │\n├─────────────────────┼───────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion-sql</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.006620</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb-sql    </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.067606</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">polars-lazy        </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.086350</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-polars        </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.168417</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-duckdb        </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.495270</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">ibis-datafusion    </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.529014</span> │\n└─────────────────────┴───────────────┘\n</pre>\n```\n:::\n:::\n\n\nWe can visualize the results:\n\n::: {#2fa3f9cb .cell execution_count=37}\n``` {.python .cell-code}\nimport plotly.express as px\n\npx.defaults.template = \"plotly_dark\"\n\nagg = t.group_by(\"system\", \"query_number\").agg(\n    mean_execution_seconds=t[\"execution_seconds\"].mean(),\n)\n\nchart = px.bar(\n    agg,\n    x=\"query_number\",\n    y=\"mean_execution_seconds\",\n    color=\"system\",\n    barmode=\"group\",\n    title=\"Mean execution time by query\",\n    category_orders={\n        \"system\": sorted(t.select(\"system\").distinct().to_pandas()[\"system\"].tolist())\n    },\n)\nchart\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"a420bdb4-635f-4cce-8c67-be1f489fed54\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"a420bdb4-635f-4cce-8c67-be1f489fed54\")) {                    Plotly.newPlot(                        \"a420bdb4-635f-4cce-8c67-be1f489fed54\",                        [{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-datafusion\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion\",\"marker\":{\"color\":\"#636efa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion\",\"offsetgroup\":\"ibis-datafusion\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[4,1,20,12,3,6,2,18,10,9,5,17,14,11,15,8,7,19,13],\"xaxis\":\"x\",\"y\":[0.08527374267578125,0.1856980323791504,0.09459996223449707,0.09185004234313965,0.11346817016601562,0.060302019119262695,0.11647200584411621,0.21512389183044434,0.14400672912597656,0.25276899337768555,0.16351318359375,0.1508030891418457,0.05874824523925781,0.05636405944824219,0.09078383445739746,0.17679595947265625,0.21130585670471191,0.18033623695373535,0.08080005645751953],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-datafusion-sql\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-datafusion-sql\",\"marker\":{\"color\":\"#EF553B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-datafusion-sql\",\"offsetgroup\":\"ibis-datafusion-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,21,4,8,7,13,19,11,22,15,5,17,14,9,10,18,2,12,20,6,3],\"xaxis\":\"x\",\"y\":[0.16572284698486328,0.16507411003112793,0.05468416213989258,0.10038995742797852,0.11693096160888672,0.08853602409362793,0.10790419578552246,0.04051613807678223,0.04712080955505371,0.08836483955383301,0.09019279479980469,0.1384258270263672,0.05418872833251953,0.14054203033447266,0.11253213882446289,0.16417670249938965,0.06422877311706543,0.0766000747680664,0.08157896995544434,0.04186129570007324,0.06704831123352051],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-duckdb\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb\",\"marker\":{\"color\":\"#00cc96\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb\",\"offsetgroup\":\"ibis-duckdb\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[17,14,9,5,22,16,11,15,8,13,19,7,1,21,4,3,6,20,12,10,18,2],\"xaxis\":\"x\",\"y\":[0.0946509838104248,0.07600784301757812,0.15702605247497559,0.13889694213867188,0.05627894401550293,0.050956010818481445,0.046521902084350586,0.10355687141418457,0.17993402481079102,0.08141613006591797,0.10899090766906738,0.22138595581054688,0.11120414733886719,0.18820619583129883,0.10530900955200195,0.11275124549865723,0.05837392807006836,0.09756278991699219,0.08757591247558594,0.16030216217041016,0.19187211990356445,0.06649017333984375],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-duckdb-sql\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-duckdb-sql\",\"marker\":{\"color\":\"#ab63fa\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-duckdb-sql\",\"offsetgroup\":\"ibis-duckdb-sql\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[7,19,8,13,20,6,12,3,1,21,14,5,17,9,11,16,15,22,2,18,10,4],\"xaxis\":\"x\",\"y\":[0.1173713207244873,0.10991191864013672,0.10016512870788574,0.11796116828918457,0.0834193229675293,0.0639650821685791,0.1077890396118164,0.08614110946655273,0.0995640754699707,0.18464303016662598,0.07589483261108398,0.08590102195739746,0.0904390811920166,0.1208350658416748,0.03215789794921875,0.040780067443847656,0.11138105392456055,0.052903175354003906,0.04390978813171387,0.14215707778930664,0.13234424591064453,0.06797170639038086],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=ibis-polars\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"ibis-polars\",\"marker\":{\"color\":\"#FFA15A\",\"pattern\":{\"shape\":\"\"}},\"name\":\"ibis-polars\",\"offsetgroup\":\"ibis-polars\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[12,3,6,8,7,19,4,18,2,10,9,5,1],\"xaxis\":\"x\",\"y\":[0.0759439468383789,0.08300375938415527,0.04763507843017578,0.13718080520629883,0.14421916007995605,0.24024128913879395,0.061795949935913086,0.4647057056427002,0.062339067459106445,0.09395790100097656,0.375777006149292,0.0971367359161377,0.2844810485839844],\"yaxis\":\"y\",\"type\":\"bar\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"system=polars-lazy\\u003cbr\\u003equery_number=%{x}\\u003cbr\\u003emean_execution_seconds=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"polars-lazy\",\"marker\":{\"color\":\"#19d3f3\",\"pattern\":{\"shape\":\"\"}},\"name\":\"polars-lazy\",\"offsetgroup\":\"polars-lazy\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"x\":[1,21,4,13,8,19,7,11,15,16,22,14,9,17,5,10,18,2,6,12,3,20],\"xaxis\":\"x\",\"y\":[0.14653277397155762,0.4784820079803467,0.04979085922241211,0.07697010040283203,0.08124113082885742,0.09669184684753418,0.07666802406311035,0.060350894927978516,0.0383148193359375,0.027947187423706055,0.034562110900878906,0.04080796241760254,0.2673678398132324,0.07406091690063477,0.06595110893249512,0.08218693733215332,0.10887598991394043,0.02666497230529785,0.04187202453613281,0.09165000915527344,0.05814409255981445,0.06121683120727539],\"yaxis\":\"y\",\"type\":\"bar\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#283442\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#f2f5fa\"},\"geo\":{\"bgcolor\":\"rgb(17,17,17)\",\"lakecolor\":\"rgb(17,17,17)\",\"landcolor\":\"rgb(17,17,17)\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"rgb(17,17,17)\",\"plot_bgcolor\":\"rgb(17,17,17)\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#283442\",\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#283442\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"query_number\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"mean_execution_seconds\"}},\"legend\":{\"title\":{\"text\":\"system\"},\"tracegroupgap\":0},\"title\":{\"text\":\"Mean execution time by query\"},\"barmode\":\"group\"},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('a420bdb4-635f-4cce-8c67-be1f489fed54');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\n#### What did we run and measure, exactly?\n\nWe can import `ibis_bench` as a library and read in the TPC-H tables:\n\n::: {#1a13c9ac .cell execution_count=38}\n``` {.python .cell-code}\nimport ibis\nimport polars as pl\n\nfrom datetime import date\nfrom ibis_bench.utils.read_data import get_ibis_tables, get_polars_tables\n\nsf = 1\n```\n:::\n\n\n:::{.panel-tabset}\n\n## Ibis (DuckDB)\n\n::: {#433ef1b7 .cell execution_count=39}\n``` {.python .cell-code}\ncon = ibis.connect(\"duckdb://\")\n\n(customer, lineitem, nation, orders, part, partsupp, region, supplier) = (\n    get_ibis_tables(sf=sf, con=con)\n)\n```\n:::\n\n\n\n\n::: {#158ed122 .cell execution_count=41}\n``` {.python .cell-code}\nlineitem.order_by(ibis.desc(\"l_orderkey\"), ibis.asc(\"l_partkey\"))\n```\n\n::: {.cell-output .cell-output-display execution_count=41}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> l_orderkey </span>┃<span style=\"font-weight: bold\"> l_partkey </span>┃<span style=\"font-weight: bold\"> l_suppkey </span>┃<span style=\"font-weight: bold\"> l_linenumber </span>┃<span style=\"font-weight: bold\"> l_quantity     </span>┃<span style=\"font-weight: bold\"> l_extendedprice </span>┃<span style=\"font-weight: bold\"> l_discount     </span>┃<span style=\"font-weight: bold\"> l_tax          </span>┃<span style=\"font-weight: bold\"> l_returnflag </span>┃<span style=\"font-weight: bold\"> l_linestatus </span>┃<span style=\"font-weight: bold\"> l_shipdate </span>┃<span style=\"font-weight: bold\"> l_commitdate </span>┃<span style=\"font-weight: bold\"> l_receiptdate </span>┃<span style=\"font-weight: bold\"> l_shipinstruct    </span>┃<span style=\"font-weight: bold\"> l_shipmode </span>┃<span style=\"font-weight: bold\"> l_comment                                </span>┃\n┡━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                   │\n├────────────┼───────────┼───────────┼──────────────┼────────────────┼─────────────────┼────────────────┼────────────────┼──────────────┼──────────────┼────────────┼──────────────┼───────────────┼───────────────────┼────────────┼──────────────────────────────────────────┤\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32255</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2256</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.00</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5936.25</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.03</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-19</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-12-01</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">TAKE BACK RETURN </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">riously pe                              </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">96127</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">28.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31447.36</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.02</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-09-22</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-01</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">NONE             </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AIR       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">pecial excuses nag evenly f             </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6452</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1453</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.00</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9509.15</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.00</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-23</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-19</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">SHIP      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ffily along the sly                     </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7272</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2273</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37736.64</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.07</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-07</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-30</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">REG AIR   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ld deposits aga                         </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37131</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2138</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19226.34</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-17</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-08-28</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-12-08</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">FOB       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">counts cajole evenly? sly orbits boost f</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999974</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10463</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5466</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">46.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">63179.16</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.08</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.06</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-16</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-21</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-02</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">RAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">se slyly alo                            </span> │\n│          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │               <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                        │\n└────────────┴───────────┴───────────┴──────────────┴────────────────┴─────────────────┴────────────────┴────────────────┴──────────────┴──────────────┴────────────┴──────────────┴───────────────┴───────────────────┴────────────┴──────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#fa046a2f .cell execution_count=42}\n``` {.python .cell-code}\nlineitem.count()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=42}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre>┌─────────┐\n│ <span class=\"ansi-cyan-fg ansi-bold\">6001215</span> │\n└─────────┘</pre>\n```\n:::\n\n:::\n:::\n\n\n## Ibis (DataFusion)\n\n::: {#f55bfce4 .cell execution_count=43}\n``` {.python .cell-code}\ncon = ibis.connect(\"datafusion://\")\n\n(customer, lineitem, nation, orders, part, partsupp, region, supplier) = (\n    get_ibis_tables(sf=sf, con=con)\n)\n```\n:::\n\n\n::: {#a44a2da2 .cell execution_count=44}\n``` {.python .cell-code}\nlineitem.order_by(ibis.desc(\"l_orderkey\"), ibis.asc(\"l_partkey\"))\n```\n\n::: {.cell-output .cell-output-display execution_count=44}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> l_orderkey </span>┃<span style=\"font-weight: bold\"> l_partkey </span>┃<span style=\"font-weight: bold\"> l_suppkey </span>┃<span style=\"font-weight: bold\"> l_linenumber </span>┃<span style=\"font-weight: bold\"> l_quantity     </span>┃<span style=\"font-weight: bold\"> l_extendedprice </span>┃<span style=\"font-weight: bold\"> l_discount     </span>┃<span style=\"font-weight: bold\"> l_tax          </span>┃<span style=\"font-weight: bold\"> l_returnflag </span>┃<span style=\"font-weight: bold\"> l_linestatus </span>┃<span style=\"font-weight: bold\"> l_shipdate </span>┃<span style=\"font-weight: bold\"> l_commitdate </span>┃<span style=\"font-weight: bold\"> l_receiptdate </span>┃<span style=\"font-weight: bold\"> l_shipinstruct    </span>┃<span style=\"font-weight: bold\"> l_shipmode </span>┃<span style=\"font-weight: bold\"> l_comment                                </span>┃\n┡━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                   │\n├────────────┼───────────┼───────────┼──────────────┼────────────────┼─────────────────┼────────────────┼────────────────┼──────────────┼──────────────┼────────────┼──────────────┼───────────────┼───────────────────┼────────────┼──────────────────────────────────────────┤\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32255</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2256</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.00</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5936.25</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.03</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-19</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-12-01</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">TAKE BACK RETURN </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">riously pe                              </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">96127</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">28.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31447.36</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.02</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-09-22</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-01</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">NONE             </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AIR       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">pecial excuses nag evenly f             </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6452</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1453</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.00</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9509.15</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.00</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-23</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-19</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">SHIP      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ffily along the sly                     </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7272</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2273</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37736.64</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.07</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-07</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-30</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">REG AIR   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ld deposits aga                         </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37131</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2138</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19226.34</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-17</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-08-28</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-12-08</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">FOB       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">counts cajole evenly? sly orbits boost f</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999974</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10463</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5466</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">46.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">63179.16</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.08</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.06</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-16</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-21</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-02</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">RAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">se slyly alo                            </span> │\n│          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │               <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                        │\n└────────────┴───────────┴───────────┴──────────────┴────────────────┴─────────────────┴────────────────┴────────────────┴──────────────┴──────────────┴────────────┴──────────────┴───────────────┴───────────────────┴────────────┴──────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#dede606b .cell execution_count=45}\n``` {.python .cell-code}\nlineitem.count()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=45}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre>┌─────────┐\n│ <span class=\"ansi-cyan-fg ansi-bold\">6001215</span> │\n└─────────┘</pre>\n```\n:::\n\n:::\n:::\n\n\n## Ibis (Polars)\n\n::: {#f5311d71 .cell execution_count=46}\n``` {.python .cell-code}\ncon = ibis.connect(\"polars://\")\n\n(customer, lineitem, nation, orders, part, partsupp, region, supplier) = (\n    get_ibis_tables(sf=sf, con=con)\n)\n```\n:::\n\n\n::: {#22d64fa7 .cell execution_count=47}\n``` {.python .cell-code}\nlineitem.order_by(ibis.desc(\"l_orderkey\"), ibis.asc(\"l_partkey\"))\n```\n\n::: {.cell-output .cell-output-display execution_count=47}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> l_orderkey </span>┃<span style=\"font-weight: bold\"> l_partkey </span>┃<span style=\"font-weight: bold\"> l_suppkey </span>┃<span style=\"font-weight: bold\"> l_linenumber </span>┃<span style=\"font-weight: bold\"> l_quantity     </span>┃<span style=\"font-weight: bold\"> l_extendedprice </span>┃<span style=\"font-weight: bold\"> l_discount     </span>┃<span style=\"font-weight: bold\"> l_tax          </span>┃<span style=\"font-weight: bold\"> l_returnflag </span>┃<span style=\"font-weight: bold\"> l_linestatus </span>┃<span style=\"font-weight: bold\"> l_shipdate </span>┃<span style=\"font-weight: bold\"> l_commitdate </span>┃<span style=\"font-weight: bold\"> l_receiptdate </span>┃<span style=\"font-weight: bold\"> l_shipinstruct    </span>┃<span style=\"font-weight: bold\"> l_shipmode </span>┃<span style=\"font-weight: bold\"> l_comment                                </span>┃\n┡━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">decimal(15, 2)</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">date</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                   │\n├────────────┼───────────┼───────────┼──────────────┼────────────────┼─────────────────┼────────────────┼────────────────┼──────────────┼──────────────┼────────────┼──────────────┼───────────────┼───────────────────┼────────────┼──────────────────────────────────────────┤\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32255</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2256</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.00</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5936.25</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.03</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-11-19</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-12-01</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">TAKE BACK RETURN </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">MAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">riously pe                              </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6000000</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">96127</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6128</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">28.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31447.36</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.02</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">N           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">O           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-09-22</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-01</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1996-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">NONE             </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">AIR       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">pecial excuses nag evenly f             </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6452</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1453</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.00</span> │         <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9509.15</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.00</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-02</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-23</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-19</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">SHIP      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ffily along the sly                     </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7272</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2273</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37736.64</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.07</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-07</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-30</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-21</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">REG AIR   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">ld deposits aga                         </span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999975</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37131</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2138</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19226.34</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.04</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.01</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">A           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-11-17</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-08-28</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-12-08</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">DELIVER IN PERSON</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">FOB       </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">counts cajole evenly? sly orbits boost f</span> │\n│    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5999974</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10463</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5466</span> │            <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">46.00</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">63179.16</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.08</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.06</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">R           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">F           </span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-16</span> │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-09-21</span>   │ <span style=\"color: #800080; text-decoration-color: #800080\">1993-10-02</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">COLLECT COD      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">RAIL      </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">se slyly alo                            </span> │\n│          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │               <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                 │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                        │\n└────────────┴───────────┴───────────┴──────────────┴────────────────┴─────────────────┴────────────────┴────────────────┴──────────────┴──────────────┴────────────┴──────────────┴───────────────┴───────────────────┴────────────┴──────────────────────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#748af914 .cell execution_count=48}\n``` {.python .cell-code}\nlineitem.count()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=48}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre>┌─────────┐\n│ <span class=\"ansi-cyan-fg ansi-bold\">6001215</span> │\n└─────────┘</pre>\n```\n:::\n\n:::\n:::\n\n\n:::\n\n\n\nThe queries are also defined in `ibis_bench.queries`. Let's look at query 4 as\nan example for Ibis dataframe code, Polars dataframe code, and SQL code via\nIbis:\n\n:::{.panel-tabset}\n\n## Ibis (dataframe)\n\nDefine query 4:\n\n::: {#7453444c .cell execution_count=50}\n``` {.python .cell-code}\ndef q4(lineitem, orders, **kwargs):\n    var1 = date(1993, 7, 1)\n    var2 = date(1993, 10, 1)\n\n    q_final = (\n        lineitem.join(orders, lineitem[\"l_orderkey\"] == orders[\"o_orderkey\"])\n        .filter((orders[\"o_orderdate\"] >= var1) & (orders[\"o_orderdate\"] < var2))\n        .filter(lineitem[\"l_commitdate\"] < lineitem[\"l_receiptdate\"])\n        .distinct(on=[\"o_orderpriority\", \"l_orderkey\"])\n        .group_by(\"o_orderpriority\")\n        .agg(order_count=ibis._.count())\n        .order_by(\"o_orderpriority\")\n    )\n\n    return q_final\n```\n:::\n\n\nRun query 4:\n\n::: {#f0eccdcd .cell execution_count=51}\n``` {.python .cell-code}\nres = q4(lineitem, orders)\nres\n```\n\n::: {.cell-output .cell-output-display execution_count=51}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> o_orderpriority </span>┃<span style=\"font-weight: bold\"> order_count </span>┃\n┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │\n├─────────────────┼─────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">1-URGENT       </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10594</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">2-HIGH         </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10476</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">3-MEDIUM       </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10410</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">4-NOT SPECIFIED</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10556</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">5-LOW          </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10487</span> │\n└─────────────────┴─────────────┘\n</pre>\n```\n:::\n:::\n\n\n## Polars (dataframe)\n\nDefine query 4:\n\n::: {#29462da9 .cell execution_count=52}\n``` {.python .cell-code}\ndef q4(lineitem, orders, **kwargs):\n    var1 = date(1993, 7, 1)\n    var2 = date(1993, 10, 1)\n\n    q_final = (\n        lineitem.join(orders, left_on=\"l_orderkey\", right_on=\"o_orderkey\")\n        .filter(pl.col(\"o_orderdate\").is_between(var1, var2, closed=\"left\"))\n        .filter(pl.col(\"l_commitdate\") < pl.col(\"l_receiptdate\"))\n        .unique(subset=[\"o_orderpriority\", \"l_orderkey\"])\n        .group_by(\"o_orderpriority\")\n        .agg(pl.len().alias(\"order_count\"))\n        .sort(\"o_orderpriority\")\n    )\n\n    return q_final\n```\n:::\n\n\nRun query 4:\n\n::: {#413c54da .cell execution_count=53}\n``` {.python .cell-code}\nres = q4(lineitem.to_polars().lazy(), orders.to_polars().lazy()).collect()\nres\n```\n\n::: {.cell-output .cell-output-display execution_count=53}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>o_orderpriority</th><th>order_count</th></tr><tr><td>str</td><td>u32</td></tr></thead><tbody><tr><td>&quot;1-URGENT&quot;</td><td>10594</td></tr><tr><td>&quot;2-HIGH&quot;</td><td>10476</td></tr><tr><td>&quot;3-MEDIUM&quot;</td><td>10410</td></tr><tr><td>&quot;4-NOT SPECIFIED&quot;</td><td>10556</td></tr><tr><td>&quot;5-LOW&quot;</td><td>10487</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## Ibis (SQL)\n\nDefine query 4:\n\n::: {#e5b9eefb .cell execution_count=54}\n``` {.python .cell-code}\nq4_sql = \"\"\"\nSELECT\n    o_orderpriority,\n    count(*) AS order_count\nFROM\n    orders\nWHERE\n    o_orderdate >= CAST('1993-07-01' AS date)\n    AND o_orderdate < CAST('1993-10-01' AS date)\n    AND EXISTS (\n        SELECT\n            *\n        FROM\n            lineitem\n        WHERE\n            l_orderkey = o_orderkey\n            AND l_commitdate < l_receiptdate)\nGROUP BY\n    o_orderpriority\nORDER BY\n    o_orderpriority;\n\"\"\"\nq4_sql = q4_sql.strip().strip(\";\")\n\n\ndef q4(lineitem, orders, dialect=\"duckdb\", **kwargs):\n    return orders.sql(q4_sql, dialect=dialect)\n```\n:::\n\n\nRun query 4:\n\n::: {#b9d83a87 .cell execution_count=55}\n``` {.python .cell-code}\nres = q4(lineitem, orders)\nres\n```\n\n::: {.cell-output .cell-output-display execution_count=55}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> o_orderpriority </span>┃<span style=\"font-weight: bold\"> order_count </span>┃\n┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │\n├─────────────────┼─────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">1-URGENT       </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10594</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">2-HIGH         </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10476</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">3-MEDIUM       </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10410</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">4-NOT SPECIFIED</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10556</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">5-LOW          </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10487</span> │\n└─────────────────┴─────────────┘\n</pre>\n```\n:::\n:::\n\n\n:::\n\nFinally, we write the result to a Parquet file. We are measuring the\nexecution time in seconds of calling the query and writing the results to disk.\n\n## Next steps\n\nWe'll publish the next iteration of this benchmark soon with updated Polars\nTPC-H queries and using newer versions of all libraries. Polars v1.0.0 should\nrelease soon. A new DataFusion version that fixes the remaining failing queries\nis also expected soon.\n\nIf you spot anything wrong, have any questions, or want to share your own\nanalysis, feel free to share below!\n\n",
    "supporting": [
      "index_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script type=\"text/javascript\">\nwindow.PlotlyConfig = {MathJaxConfig: 'local'};\nif (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\nif (typeof require !== 'undefined') {\nrequire.undef(\"plotly\");\nrequirejs.config({\n    paths: {\n        'plotly': ['https://cdn.plot.ly/plotly-2.32.0.min']\n    }\n});\nrequire(['plotly'], function(Plotly) {\n    window._Plotly = Plotly;\n});\n}\n</script>\n\n"
      ]
    }
  }
}