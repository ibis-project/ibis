{
  "hash": "1c14785a2d952367f86a09fd08c44144",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Language models for data\"\nauthor: \"Cody Peterson\"\ndate: \"2024-02-15\"\ncategories:\n    - blog\n    - llms\n    - duckdb\n---\n\n## Overview\n\nThis post will give an overview of how (large) language models (LMs) fit into\ndata engineering, analyst, and science workflows.\n\n## Use cases for LMs in data\n\nThere are three main use cases for language models for data practitioners:\n\n1. Synthetic data generation\n2. Natural language processing\n3. Writing code\n\nWe'll describe each in this section and see them in action in the following\nsections.\n\n### Synthetic data generation\n\nLanguage models can be used to generate synthetic data. This is useful for\ntesting, training, and other purposes. For example, you can use a language model\nto generate synthetic data for a machine learning model.\n\n:::{.callout-tip}\nThis post was re-inspired by the [1 billion row challenge we recently solved\nwith Ibis on three local backends](../1brc/index.qmd), in which synthetic data\ngenerated from a seed file was used to generate a billion rows.\n\nWith language models, we can reproduce this synthetic data and customize the\ndata produced with natural language! We'll demonstrate this in a section below.\n:::\n\n### Natural language processing\n\nThis includes tasks like:\n\n- sentiment analysis\n- named entity recognition\n- part of speech tagging\n- summarization\n- translation\n- question answering\n\nEach of these tasks can be, to some extent, solved by traditional natural\nlanguage processing (NLP) techniques. However, modern-day LMs can solve these\ntasks with a single model, and often with state-of-the-art performance. This\ndrastically simplifies what a single engineer, who doesn't need a deep\nunderstanding of NLP or ML in general, can accomplish.\n\n### Writing code\n\nFinally, language models can be used to write code. This is more useful with\nsystems around them to execute code, feed back error messages, make adjustments,\nand so on. There are numerous pitfalls with language models writing code, but\nthey're fairly good at SQL.\n\n## Demonstrating LMs with data\n\nWe'll use [Marvin](https://askmarvin.ai), the AI engineering toolkit, alongside\n[Ibis](https://ibis-project.org), the data engineering toolkit, to demonstrate\nthe capabilities of language models for data using the default DuckDB backend.\n\n:::{.callout-tip}\nWe'll use a cloud service provider (OpenAI) to demonstrate these capabilities.\nIn a follow-up post, we'll explore using local \"open source\" language models to\nachieve the same results.\n:::\n\nWith Marvin and Ibis, you can replicate the workflows below using other AI service providers, local language models, and over 20+ data backends!\n\nLet's start by importing and setting up our code:\n\n::: {#3ba22680 .cell execution_count=1}\n``` {.python .cell-code}\nimport ibis  # <1>\nimport marvin  # <2>\n\nfrom pydantic import BaseModel, Field  # <3>\n\nibis.options.interactive = True  # <4>\n```\n:::\n\n\n1. Import Ibis, the data engineering toolkit\n2. Import Marvin, the AI engineering toolkit\n3. Import Pydantic, used to define data models for Marvin\n4. Set Ibis to interactive mode to display the results of our queries\n\n## Synthetic data generation\n\nWe'll start by replicating the data in the one billion row challenge, then move\nover to our favorite penguins demo dataset to augment existing data with\nsynthetic data.\n\n### Weather stations\n\nWe can generate synthetic weather stations:\n\n::: {#477cf88b .cell execution_count=2}\n``` {.python .cell-code}\nclass WeatherStation(BaseModel):\n    station: str = Field(\n        ..., description=\"The weather station name\", example=\"Sandy Silicon\"\n    )\n    temperature: float = Field(\n        ..., description=\"The average temperature in Fahrenheit\", example=72.5\n    )\n\nstations = marvin.generate(\n    target=WeatherStation,\n    instructions=\"Generate fictitious but plausible-sounding weather stations with names that excite data nerds\",\n    n=3,\n)\nstations\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```\n[WeatherStation(station='Quantum Quasar Climate Query', temperature=68.4),\n WeatherStation(station='Neural Net Nimbus Network', temperature=59.1),\n WeatherStation(station='Fractal Frost Forecast Foundation', temperature=32.0)]\n```\n:::\n:::\n\n\nAnd then load that data into an Ibis table:\n\n:::{.callout-tip}\nYou could also use a user-defined function (UDF) to directly generate this data\nin a table. We'll demonstrate UDFs throughout this post.\n:::\n\n::: {#a2eacb91 .cell execution_count=3}\n``` {.python .cell-code}\ns = ibis.memtable([station.model_dump() for station in stations])\ns\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> station                           </span>┃<span style=\"font-weight: bold\"> temperature </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>     │\n├───────────────────────────────────┼─────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Quantum Quasar Climate Query     </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">68.4</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Neural Net Nimbus Network        </span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">59.1</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Fractal Frost Forecast Foundation</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">32.0</span> │\n└───────────────────────────────────┴─────────────┘\n</pre>\n```\n:::\n:::\n\n\n### Penguin poems\n\nWe can augment existing data with synthetic data. First, let's load the penguins dataset:\n\n::: {#5b2e18cc .cell execution_count=4}\n``` {.python .cell-code}\npenguins = ibis.examples.penguins.fetch()\npenguins\n```\n\n::: {.cell-output .cell-output-display execution_count=24}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island    </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.7</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">181</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3750</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.5</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.4</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">186</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3800</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">40.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.0</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">195</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3250</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">36.7</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.3</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">193</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3450</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3650</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38.9</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.8</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">181</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3625</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">195</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4675</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">34.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.1</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">193</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3475</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42.0</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">20.2</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4250</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>   │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │             <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │                 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>      │     <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\nAnd take a sample of five rows to reduce our AI service costs:\n\n::: {#76284863 .cell execution_count=5}\n``` {.python .cell-code}\nt = penguins.sample(fraction=0.03).limit(5)\nt\n```\n\n::: {.cell-output .cell-output-display execution_count=25}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island    </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38.6</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">21.2</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">191</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3800</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe   </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35.0</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17.9</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3450</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">19.1</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">195</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4000</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream    </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38.9</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.8</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3600</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">41.1</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">189</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3325</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2009</span> │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\nNow we define a UDF to generate a poem to describe each penguin:\n\n::: {#b65c3aea .cell execution_count=6}\n``` {.python .cell-code}\n@ibis.udf.scalar.python\ndef penguin_poem(\n    species: str,\n    island: str,\n    bill_length_mm: float,\n    bill_depth_mm: float,\n    flipper_length_mm: float,\n    body_mass_g: float,\n) -> str:\n    instructions = f\"\"\"Provide a whimsical poem that rhymes for a penguin.\n\n    You have the following information about the penguins:\n        species {species}\n        island of {island}\n        bill length of {bill_length_mm} mm\n        bill depth of {bill_depth_mm} mm\n        flipper length of {flipper_length_mm} mm\n        body mass of {body_mass_g} g.\n\n    You must reference the penguin's size in addition to its species and island.\n    \"\"\"\n\n    poem = marvin.generate(\n        n=1,\n        instructions=instructions,\n    )\n\n    return poem[0]\n```\n:::\n\n\nAnd apply that UDF to our penguins table:\n\n::: {#b3b780a9 .cell execution_count=7}\n``` {.python .cell-code}\nt = (\n    t.mutate(\n        poem=penguin_poem(\n            t.species,\n            t.island,\n            t.bill_length_mm,\n            t.bill_depth_mm,\n            t.flipper_length_mm,\n            t.body_mass_g,\n        )\n    )\n    .relocate(\"species\", \"island\", \"poem\")\n    .cache()\n)\nt\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"91cd05e09ff546aa991767f1b2ef9c62\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=27}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island </span>┃<span style=\"font-weight: bold\"> poem                                                                               </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                                                             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼────────┼────────────────────────────────────────────────────────────────────────────────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">In the realm of Dream where the icebergs gleam,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">There waddles an Adelie, a sigh… </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4250</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2009</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's isle, so chilly and free,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Lives a penguin, a Gentoo, so plump as ca… </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">50.0</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.2</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">218</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5700</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's frosty speckled shore,                                                </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">45.4</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">211</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4800</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">In Biscoe's land where sea winds blow,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">A Gentoo of stats quite apropos:</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Bill li…</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">45.5</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13.9</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">210</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4200</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's shores, the Gentoos play,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Where ice and sky meet the ocean's sway,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">…</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">54.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.7</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">231</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5650</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n└─────────┴────────┴────────────────────────────────────────────────────────────────────────────────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\nNice! While not particularly useful in this case, the same process can be used\nfor generating product descriptions or other practical applications.\n\n## Natural language processing\n\n### Sentiment analysis\n\nWe can use a language model to perform sentiment analysis on the penguin poems:\n\n::: {#7be0be5f .cell execution_count=8}\n``` {.python .cell-code}\n@marvin.fn\ndef _sentiment_analysis(text: str) -> float:\n    \"\"\"Returns a sentiment score for `text`\n    between -1 (negative) and 1 (positive).\"\"\"\n\n\n@ibis.udf.scalar.python\ndef sentiment_analysis(text: str) -> float:\n    return _sentiment_analysis(text)\n```\n:::\n\n\nAnd apply that UDF to our penguins table:\n\n::: {#7f6a5066 .cell execution_count=9}\n``` {.python .cell-code}\nt = (\n    t.mutate(sentiment=sentiment_analysis(t.poem))\n    .relocate(t.columns[:3], \"sentiment\")\n    .cache()\n)\nt\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"b0b565774ecc4f83a5e971d867a98a71\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=29}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island </span>┃<span style=\"font-weight: bold\"> poem                                                                               </span>┃<span style=\"font-weight: bold\"> sentiment </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                                                             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼────────┼────────────────────────────────────────────────────────────────────────────────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">In the realm of Dream where the icebergs gleam,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">There waddles an Adelie, a sigh… </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.8</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4250</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2009</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's isle, so chilly and free,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Lives a penguin, a Gentoo, so plump as ca… </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.8</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">50.0</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.2</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">218</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5700</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's frosty speckled shore,                                                </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.1</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">45.4</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">211</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4800</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">In Biscoe's land where sea winds blow,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">A Gentoo of stats quite apropos:</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Bill li…</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">45.5</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13.9</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">210</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4200</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's shores, the Gentoos play,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Where ice and sky meet the ocean's sway,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">…</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.5</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">54.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.7</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">231</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5650</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n└─────────┴────────┴────────────────────────────────────────────────────────────────────────────────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\n### Entity extraction\n\nWhile not exactly named entity recognition, we can extract arbitrary entities from text. In this case, we'll extract a list of words that rhyme from the poem:\n\n::: {#ca63fcee .cell execution_count=10}\n``` {.python .cell-code}\n@ibis.udf.scalar.python\ndef extract_rhyming_words(text: str) -> list[str]:\n    words = marvin.extract(\n        text,\n        instructions=\"Extract the primary rhyming words from the text\",\n    )\n\n    return words\n```\n:::\n\n\nAnd apply that UDF to our penguins table:\n\n::: {#6854ce1f .cell execution_count=11}\n``` {.python .cell-code}\nt = (\n    t.mutate(rhyming_words=extract_rhyming_words(t.poem))\n    .relocate(t.columns[:4], \"rhyming_words\")\n    .cache()\n)\nt\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"fee02c2979914dfa95c5a082beed7055\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=31}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island </span>┃<span style=\"font-weight: bold\"> poem                                                                               </span>┃<span style=\"font-weight: bold\"> sentiment </span>┃<span style=\"font-weight: bold\"> rhyming_words                </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                                                             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>                │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼────────┼────────────────────────────────────────────────────────────────────────────────────┼───────────┼──────────────────────────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">In the realm of Dream where the icebergs gleam,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">There waddles an Adelie, a sigh… </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.8</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'gleam'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'seen'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span><span style=\"font-weight: bold\">]</span>   │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4250</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2009</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's isle, so chilly and free,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Lives a penguin, a Gentoo, so plump as ca… </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.8</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'free'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'be'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span><span style=\"font-weight: bold\">]</span>      │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">50.0</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.2</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">218</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5700</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's frosty speckled shore,                                                </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.1</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'shore'</span><span style=\"font-weight: bold\">]</span>                    │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">45.4</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">211</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4800</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">In Biscoe's land where sea winds blow,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">A Gentoo of stats quite apropos:</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Bill li…</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'blow'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'apropos'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span><span style=\"font-weight: bold\">]</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">45.5</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13.9</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">210</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4200</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's shores, the Gentoos play,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Where ice and sky meet the ocean's sway,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">…</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.5</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'play'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'sway'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span><span style=\"font-weight: bold\">]</span>    │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">54.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.7</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">231</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5650</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n└─────────┴────────┴────────────────────────────────────────────────────────────────────────────────────┴───────────┴──────────────────────────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\n### Translation\n\nWe can translate the penguin poems:\n\n::: {#4e1db34d .cell execution_count=12}\n``` {.python .cell-code}\n@marvin.fn\ndef _translate_text(text: str, target_language: str = \"spanish\") -> str:\n    \"\"\"Translate `text` to `target_language`.\"\"\"\n\n\n@ibis.udf.scalar.python\ndef translate_text(text: str, target_language: str = \"spanish\") -> str:\n    return _translate_text(text, target_language)\n```\n:::\n\n\nAnd apply that UDF to our penguins table:\n\n::: {#602df09e .cell execution_count=13}\n``` {.python .cell-code}\nt = (\n    t.mutate(translated_poem=translate_text(t.poem))\n    .relocate(t.columns[:5], \"translated_poem\")\n    .cache()\n)\nt\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"fff5a93116dd4001bc2a329106821573\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=33}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species </span>┃<span style=\"font-weight: bold\"> island </span>┃<span style=\"font-weight: bold\"> poem                                                                               </span>┃<span style=\"font-weight: bold\"> sentiment </span>┃<span style=\"font-weight: bold\"> rhyming_words                </span>┃<span style=\"font-weight: bold\"> translated_poem                                                                   </span>┃<span style=\"font-weight: bold\"> bill_length_mm </span>┃<span style=\"font-weight: bold\"> bill_depth_mm </span>┃<span style=\"font-weight: bold\"> flipper_length_mm </span>┃<span style=\"font-weight: bold\"> body_mass_g </span>┃<span style=\"font-weight: bold\"> sex    </span>┃<span style=\"font-weight: bold\"> year  </span>┃\n┡━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                                                             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">array&lt;string&gt;</span>                │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                                                            │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>             │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├─────────┼────────┼────────────────────────────────────────────────────────────────────────────────────┼───────────┼──────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">In the realm of Dream where the icebergs gleam,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">There waddles an Adelie, a sigh… </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.8</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'gleam'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'seen'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span><span style=\"font-weight: bold\">]</span>   │ <span style=\"color: #008000; text-decoration-color: #008000\">En el reino de los sue\\u00f1os donde brillan los icebergs,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Hay un Adelie que se…</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39.2</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">190</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4250</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2009</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's isle, so chilly and free,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Lives a penguin, a Gentoo, so plump as ca… </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.8</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'free'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'be'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span><span style=\"font-weight: bold\">]</span>      │ <span style=\"color: #008000; text-decoration-color: #008000\">En la isla de Biscoe, tan fría y libre,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Vive un pingüino, un Gentoo, tan rechon…</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">50.0</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.2</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">218</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5700</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's frosty speckled shore,                                                </span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.1</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'shore'</span><span style=\"font-weight: bold\">]</span>                    │ <span style=\"color: #008000; text-decoration-color: #008000\">En la costa helada y moteada de Biscoe,                                          </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">45.4</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14.6</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">211</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4800</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2007</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">In Biscoe's land where sea winds blow,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">A Gentoo of stats quite apropos:</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Bill li…</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'blow'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'apropos'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span><span style=\"font-weight: bold\">]</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">En la tierra de Biscoe donde soplan los vientos marinos,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Un Gentoo de estadísti…</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">45.5</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13.9</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">210</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4200</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">female</span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">On Biscoe's shores, the Gentoos play,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">Where ice and sky meet the ocean's sway,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">…</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.5</span> │ <span style=\"font-weight: bold\">[</span><span style=\"color: #008000; text-decoration-color: #008000\">'play'</span>, <span style=\"color: #008000; text-decoration-color: #008000\">'sway'</span>, <span style=\"color: #808000; text-decoration-color: #808000\">...</span> +<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span><span style=\"font-weight: bold\">]</span>    │ <span style=\"color: #008000; text-decoration-color: #008000\">En las costas de Biscoe, juegan los gentoos,</span><span style=\"color: #d78700; text-decoration-color: #d78700\">\\n</span><span style=\"color: #008000; text-decoration-color: #008000\">donde el hielo y el cielo se encue…</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">54.3</span> │          <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.7</span> │               <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">231</span> │        <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5650</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">male  </span> │  <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2008</span> │\n└─────────┴────────┴────────────────────────────────────────────────────────────────────────────────────┴───────────┴──────────────────────────────┴───────────────────────────────────────────────────────────────────────────────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\n## Writing code\n\nFinally, we can use a language model to write code. Let's define a function that\noutputs SQL:\n\n::: {#77be8c93 .cell execution_count=14}\n``` {.python .cell-code}\n@marvin.fn\ndef _text_to_sql(\n    text: str,\n    table_names: list[str],\n    table_schemas: list[str],\n    table_previews: list[str],\n) -> str:\n    \"\"\"Writes a SQL SELECT statement for the `text` given the provided `table_names`, `table_schemas`, and `table_previews`.\"\"\"\n\n\ndef text_to_sql(\n    text: str,\n    table_names: list[str],\n    table_schemas: list[str],\n    table_previews: list[str],\n) -> str:\n    return _text_to_sql(text, table_names, table_schemas, table_previews).strip(\";\")\n```\n:::\n\n\nWe can try that out on our penguins table:\n\n::: {#dc7617a5 .cell execution_count=15}\n``` {.python .cell-code}\ntext = \"the count of penguins by species, from highest to lowest, per each island\"\n\ntable_names = [\"penguins\"]\ntable_schemas = [str(penguins.schema())]\ntable_previews = [str(penguins.limit(5))]\n\nsql = text_to_sql(text, table_names, table_schemas, table_previews)\nprint(sql)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nSELECT species, island, COUNT(*) AS count FROM penguins GROUP BY island, species ORDER BY count DESC, island, species\n```\n:::\n:::\n\n\nAnd execute the SQL:\n\n::: {#d447a76c .cell execution_count=16}\n``` {.python .cell-code}\nr = penguins.sql(sql)\nr\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━┓\n┃<span style=\"font-weight: bold\"> species   </span>┃<span style=\"font-weight: bold\"> island    </span>┃<span style=\"font-weight: bold\"> count </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span> │\n├───────────┼───────────┼───────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Gentoo   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe   </span> │   <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">124</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Chinstrap</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">68</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Dream    </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">56</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Torgersen</span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">52</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">Adelie   </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Biscoe   </span> │    <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">44</span> │\n└───────────┴───────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\n### A more complex example\n\nLet's see how this works on a query that requires joining two tables. We'll load in some IMDB data:\n\n::: {#98eb2709 .cell execution_count=17}\n``` {.python .cell-code}\nimdb_title_basics = ibis.examples.imdb_title_basics.fetch()\nimdb_title_basics\n```\n\n::: {.cell-output .cell-output-display execution_count=37}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> tconst    </span>┃<span style=\"font-weight: bold\"> titleType </span>┃<span style=\"font-weight: bold\"> primaryTitle                                </span>┃<span style=\"font-weight: bold\"> originalTitle                               </span>┃<span style=\"font-weight: bold\"> isAdult </span>┃<span style=\"font-weight: bold\"> startYear </span>┃<span style=\"font-weight: bold\"> endYear </span>┃<span style=\"font-weight: bold\"> runtimeMinutes </span>┃<span style=\"font-weight: bold\"> genres                   </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                      │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>   │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>     │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>  │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>          │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                   │\n├───────────┼───────────┼─────────────────────────────────────────────┼─────────────────────────────────────────────┼─────────┼───────────┼─────────┼────────────────┼──────────────────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000001</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">short    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Carmencita                                 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Carmencita                                 </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1894</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>    │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Documentary,Short       </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000002</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">short    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Le clown et ses chiens                     </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Le clown et ses chiens                     </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1892</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>    │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Animation,Short         </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000003</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">short    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Pauvre Pierrot                             </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Pauvre Pierrot                             </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1892</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>    │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Animation,Comedy,Romance</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000004</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">short    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Un bon bock                                </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Un bon bock                                </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1892</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>    │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Animation,Short         </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000005</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">short    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Blacksmith Scene                           </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Blacksmith Scene                           </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1893</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>    │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Comedy,Short            </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000006</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">short    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Chinese Opium Den                          </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Chinese Opium Den                          </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1894</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>    │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Short                   </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000007</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">short    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Corbett and Courtney Before the Kinetograph</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Corbett and Courtney Before the Kinetograph</span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1894</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>    │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Short,Sport             </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000008</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">short    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Edison Kinetoscopic Record of a Sneeze     </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Edison Kinetoscopic Record of a Sneeze     </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1894</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>    │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Documentary,Short       </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000009</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">movie    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Miss Jerry                                 </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Miss Jerry                                 </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1894</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>    │             <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">45</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Romance                 </span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000010</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">short    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Leaving the Factory                        </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">La sortie de l'usine Lumière à Lyon        </span> │       <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1895</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">NULL</span>    │              <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Documentary,Short       </span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                           │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                           │       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>       │              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                        │\n└───────────┴───────────┴─────────────────────────────────────────────┴─────────────────────────────────────────────┴─────────┴───────────┴─────────┴────────────────┴──────────────────────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#215fa482 .cell execution_count=18}\n``` {.python .cell-code}\nimdb_title_ratings = ibis.examples.imdb_title_ratings.fetch()\nimdb_title_ratings\n```\n\n::: {.cell-output .cell-output-display execution_count=38}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> tconst    </span>┃<span style=\"font-weight: bold\"> averageRating </span>┃<span style=\"font-weight: bold\"> numVotes </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">int64</span>    │\n├───────────┼───────────────┼──────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000001</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.7</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1990</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000002</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.8</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">265</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000003</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6.5</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1869</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000004</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.5</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">177</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000005</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6.2</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2655</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000006</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.0</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">182</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000007</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.4</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">831</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000008</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.4</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2132</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000009</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.3</span> │      <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">206</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">tt0000010</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6.9</span> │     <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7268</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │             <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└───────────┴───────────────┴──────────┘\n</pre>\n```\n:::\n:::\n\n\n::: {#c3df5be0 .cell execution_count=19}\n``` {.python .cell-code}\ntext = \"the highest rated movies w/ over 100k ratings -- movies only\"\n\ntable_names = [\"imdb_title_basics\", \"imdb_title_ratings\"]\ntable_schemas = [str(imdb_title_basics.schema()), str(imdb_title_ratings.schema())]\ntable_previews = [str(imdb_title_basics.limit(5)), str(imdb_title_ratings.limit(5))]\n\nsql = text_to_sql(text, table_names, table_schemas, table_previews)\nprint(sql)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nSELECT \n  ib.titleType, \n  ib.primaryTitle, \n  ir.averageRating \nFROM \n  imdb_title_basics AS ib \n  INNER JOIN imdb_title_ratings AS ir ON ib.tconst = ir.tconst \nWHERE \n  ib.titleType = 'movie' AND \n  ir.numVotes > 100000 \nORDER BY \n  ir.averageRating DESC\n```\n:::\n:::\n\n\n::: {#dc05d88e .cell execution_count=20}\n``` {.python .cell-code}\nimdb_title_basics.sql(sql)\n```\n\n::: {.cell-output .cell-output-display execution_count=40}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> titleType </span>┃<span style=\"font-weight: bold\"> primaryTitle                                  </span>┃<span style=\"font-weight: bold\"> averageRating </span>┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>    │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">string</span>                                        │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">float64</span>       │\n├───────────┼───────────────────────────────────────────────┼───────────────┤\n│ <span style=\"color: #008000; text-decoration-color: #008000\">movie    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">The Shawshank Redemption                     </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.3</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">movie    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">The Godfather                                </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.2</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">movie    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">12 Angry Men                                 </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">movie    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">The Godfather Part II                        </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">movie    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Schindler's List                             </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">movie    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">The Dark Knight                              </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">movie    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">The Lord of the Rings: The Return of the King</span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.0</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">movie    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Pulp Fiction                                 </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.9</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">movie    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">Jai Bhim                                     </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.8</span> │\n│ <span style=\"color: #008000; text-decoration-color: #008000\">movie    </span> │ <span style=\"color: #008000; text-decoration-color: #008000\">The Good, the Bad and the Ugly               </span> │           <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.8</span> │\n│ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>         │ <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span>                                             │             <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">…</span> │\n└───────────┴───────────────────────────────────────────────┴───────────────┘\n</pre>\n```\n:::\n:::\n\n\n## Issues with LMs today\n\n## Looking forward\n\n## Next steps\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script src=\"https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js\" crossorigin=\"anonymous\"></script>\n"
      ],
      "include-after-body": [
        "<script type=application/vnd.jupyter.widget-state+json>\n{\"state\":{\"2193d988298043fe81943e585f372734\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":\"auto\"}},\"28f21a20de334105b944320af2979556\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":\"auto\"}},\"2f817b937f93421ea824afb977cbe7a6\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":\"auto\"}},\"439961282c9d4a008497b3fc832c07fb\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":\"auto\"}},\"58ed07eb51294c4db848ba9b389f835f\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":\"auto\"}},\"597f9ed8a4984e29be32121d5bcc0c41\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":\"black\",\"description_width\":\"\"}},\"5bf3e95480014b7794d1e06e772ed054\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":\"black\",\"description_width\":\"\"}},\"67fb7ce7e7dc42f78fd42b82c4164534\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":\"auto\"}},\"6caccd5c9ed44dcb8cc5768fa9926eb9\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_28f21a20de334105b944320af2979556\",\"max\":100,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_fbe4ddf0269e48478f6577e7b060921e\",\"tabbable\":null,\"tooltip\":null,\"value\":100}},\"6eb898963f0440438b367fa6e91e2a19\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_935299f36b6143918daa1d18c2585ba0\",\"max\":100,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_eabfe4052fa54b73b4985c9c9edab005\",\"tabbable\":null,\"tooltip\":null,\"value\":100}},\"6ef3380e6de0465fb199b95b3c6f5d98\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":\"black\",\"description_width\":\"\"}},\"7a506edb8e29479a904ece128f3d2423\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":\"black\",\"description_width\":\"\"}},\"7bbffb715f2c4bd2b8f76f37914e5f4c\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":\"black\",\"description_width\":\"\"}},\"91cd05e09ff546aa991767f1b2ef9c62\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_2193d988298043fe81943e585f372734\",\"max\":100,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_6ef3380e6de0465fb199b95b3c6f5d98\",\"tabbable\":null,\"tooltip\":null,\"value\":100}},\"935299f36b6143918daa1d18c2585ba0\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":\"auto\"}},\"94c5f5dc88dc44fabaeb405aa06a5eec\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_58ed07eb51294c4db848ba9b389f835f\",\"max\":100,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_f847c54b110d4e7ebd1d2c83ce4b0579\",\"tabbable\":null,\"tooltip\":null,\"value\":100}},\"b0b565774ecc4f83a5e971d867a98a71\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_67fb7ce7e7dc42f78fd42b82c4164534\",\"max\":100,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_597f9ed8a4984e29be32121d5bcc0c41\",\"tabbable\":null,\"tooltip\":null,\"value\":100}},\"c88d8e0ca7ba49e1acbc1311969f9d96\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":\"auto\"}},\"ca4885cc1d9346bc97f35081729ccc6e\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_439961282c9d4a008497b3fc832c07fb\",\"max\":100,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_5bf3e95480014b7794d1e06e772ed054\",\"tabbable\":null,\"tooltip\":null,\"value\":100}},\"eabfe4052fa54b73b4985c9c9edab005\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":\"black\",\"description_width\":\"\"}},\"f847c54b110d4e7ebd1d2c83ce4b0579\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":\"black\",\"description_width\":\"\"}},\"fbe4ddf0269e48478f6577e7b060921e\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":\"black\",\"description_width\":\"\"}},\"fee02c2979914dfa95c5a082beed7055\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_c88d8e0ca7ba49e1acbc1311969f9d96\",\"max\":100,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_7a506edb8e29479a904ece128f3d2423\",\"tabbable\":null,\"tooltip\":null,\"value\":100}},\"fff5a93116dd4001bc2a329106821573\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_2f817b937f93421ea824afb977cbe7a6\",\"max\":100,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_7bbffb715f2c4bd2b8f76f37914e5f4c\",\"tabbable\":null,\"tooltip\":null,\"value\":100}}},\"version_major\":2,\"version_minor\":0}\n</script>\n"
      ]
    }
  }
}