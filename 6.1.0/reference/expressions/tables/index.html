
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ibis-project.github.io/ibis/6.1.0/reference/expressions/tables/">
      
      
        <link rel="prev" href="../top_level/">
      
      
        <link rel="next" href="../generic/">
      
      <link rel="icon" href="../../../static/icons/ibis/logo.svg">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Tables - Ibis Project</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/code_select.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Tables - Ibis Project" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://ibis-project.github.io/ibis/6.1.0/assets/images/social/reference/expressions/tables.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://ibis-project.github.io/ibis/6.1.0/reference/expressions/tables/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Tables - Ibis Project" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://ibis-project.github.io/ibis/6.1.0/assets/images/social/reference/expressions/tables.png" >
      
    
    
<meta name="google-site-verification" content="IVqzkYiD5E35oD4kkVOcTYCTfqWKU1f6zOHCnLIPkUU">
<script data-goatcounter="https://ibis.goatcounter.com/count"
        async src="https://gc.zgo.at/count.js"></script>

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#table-expressions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Ibis Project" class="md-header__button md-logo" aria-label="Ibis Project" data-md-component="logo">
      
  <img src="../../../static/icons/ibis/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ibis Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tables
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ibis-project/ibis/tree/6.1.0" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../install/" class="md-tabs__link">
      Install
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../concept/why_ibis/" class="md-tabs__link">
        Concepts
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../backends/" class="md-tabs__link">
        Backends
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../tutorial/" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../how_to/configuration/" class="md-tabs__link">
        How-to guides
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Reference
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../blog/rendered/ibis-version-6.0.0-release/" class="md-tabs__link">
        Blog
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../community/" class="md-tabs__link">
        Community
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Ibis Project" class="md-nav__button md-logo" aria-label="Ibis Project" data-md-component="logo">
      
  <img src="../../../static/icons/ibis/logo.svg" alt="logo">

    </a>
    Ibis Project
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ibis-project/ibis/tree/6.1.0" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../install/" class="md-nav__link">
        Install
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Concepts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../concept/why_ibis/" class="md-nav__link">
        Why Ibis?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../concept/design/" class="md-nav__link">
        Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../concept/backends/" class="md-nav__link">
        Backends
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../backends/">Backends</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Backends
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/_support_matrix/" class="md-nav__link">
        Operation support matrix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/bigquery/" class="md-nav__link">
        BigQuery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/clickhouse/" class="md-nav__link">
        ClickHouse
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/dask/" class="md-nav__link">
        Dask
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/datafusion/" class="md-nav__link">
        DataFusion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/druid/" class="md-nav__link">
        Druid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/duckdb/" class="md-nav__link">
        DuckDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/impala/" class="md-nav__link">
        Impala
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/mssql/" class="md-nav__link">
        MSSQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/mysql/" class="md-nav__link">
        MySQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/oracle/" class="md-nav__link">
        Oracle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/pandas/" class="md-nav__link">
        Pandas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/polars/" class="md-nav__link">
        Polars
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/postgresql/" class="md-nav__link">
        PostgreSQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/pyspark/" class="md-nav__link">
        PySpark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/snowflake/" class="md-nav__link">
        Snowflake
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/sqlite/" class="md-nav__link">
        SQLite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../backends/trino/" class="md-nav__link">
        Trino
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../tutorial/">Tutorials</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/getting_started/" class="md-nav__link">
        Getting started with Ibis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/ibis-for-sql-users/" class="md-nav__link">
        Ibis for SQL users
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/ibis-for-pandas-users/" class="md-nav__link">
        Ibis for pandas users
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/ibis-for-dplyr-users/" class="md-nav__link">
        Ibis for dplyr users
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          How-to guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          How-to guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/configuration/" class="md-nav__link">
        Configure Ibis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/chain_expressions/" class="md-nav__link">
        Chain expressions with the underscore API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/ffill_bfill_w_window/" class="md-nav__link">
        Fill data using window functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/self_joins/" class="md-nav__link">
        Perform self joins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/sessionize/" class="md-nav__link">
        Sessionize a log of events
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/topk/" class="md-nav__link">
        Compute the top K records
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/memtable_join/" class="md-nav__link">
        Join an in-memory DataFrame to a TableExpression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/duckdb_register/" class="md-nav__link">
        Load external data files with the DuckDB backend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/streamlit/" class="md-nav__link">
        Write a Streamlit app with Ibis
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_10" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_10" id="__nav_6_10_label" tabindex="0">
          Extend with custom operations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_10">
          <span class="md-nav__icon md-icon"></span>
          Extend with custom operations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/extending/elementwise/" class="md-nav__link">
        Add an elementwise operation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/extending/reduction/" class="md-nav__link">
        Add a reduction operation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" checked>
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Expressions</a>
          
            <label for="__nav_7_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Expressions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../top_level/" class="md-nav__link">
        Top level
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Tables
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Tables
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table" class="md-nav__link">
    Table
  </a>
  
    <nav class="md-nav" aria-label="Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.columns" class="md-nav__link">
    columns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.aggregate" class="md-nav__link">
    aggregate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.alias" class="md-nav__link">
    alias()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.as_table" class="md-nav__link">
    as_table()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.asof_join" class="md-nav__link">
    asof_join()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.cache" class="md-nav__link">
    cache()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.cast" class="md-nav__link">
    cast()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.count" class="md-nav__link">
    count()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.cross_join" class="md-nav__link">
    cross_join()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.difference" class="md-nav__link">
    difference()
  </a>
  
    <nav class="md-nav" aria-label="difference()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.difference--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.distinct" class="md-nav__link">
    distinct()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.drop" class="md-nav__link">
    drop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.dropna" class="md-nav__link">
    dropna()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.fillna" class="md-nav__link">
    fillna()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.filter" class="md-nav__link">
    filter()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.group_by" class="md-nav__link">
    group_by()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.head" class="md-nav__link">
    head()
  </a>
  
    <nav class="md-nav" aria-label="head()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.head--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.info" class="md-nav__link">
    info()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.intersect" class="md-nav__link">
    intersect()
  </a>
  
    <nav class="md-nav" aria-label="intersect()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.intersect--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.join" class="md-nav__link">
    join()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.limit" class="md-nav__link">
    limit()
  </a>
  
    <nav class="md-nav" aria-label="limit()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.limit--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.mutate" class="md-nav__link">
    mutate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.nunique" class="md-nav__link">
    nunique()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.order_by" class="md-nav__link">
    order_by()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.pivot_longer" class="md-nav__link">
    pivot_longer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.pivot_wider" class="md-nav__link">
    pivot_wider()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.relabel" class="md-nav__link">
    relabel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.rowid" class="md-nav__link">
    rowid()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.schema" class="md-nav__link">
    schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.select" class="md-nav__link">
    select()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.sql" class="md-nav__link">
    sql()
  </a>
  
    <nav class="md-nav" aria-label="sql()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.sql--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.to_array" class="md-nav__link">
    to_array()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.to_pandas" class="md-nav__link">
    to_pandas()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.try_cast" class="md-nav__link">
    try_cast()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.union" class="md-nav__link">
    union()
  </a>
  
    <nav class="md-nav" aria-label="union()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.union--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.unpack" class="md-nav__link">
    unpack()
  </a>
  
    <nav class="md-nav" aria-label="unpack()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.unpack--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.view" class="md-nav__link">
    view()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable" class="md-nav__link">
    GroupedTable
  </a>
  
    <nav class="md-nav" aria-label="GroupedTable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.aggregate" class="md-nav__link">
    aggregate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.count" class="md-nav__link">
    count()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.having" class="md-nav__link">
    having()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.mutate" class="md-nav__link">
    mutate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.order_by" class="md-nav__link">
    order_by()
  </a>
  
    <nav class="md-nav" aria-label="order_by()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.order_by--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.over" class="md-nav__link">
    over()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.select" class="md-nav__link">
    select()
  </a>
  
    <nav class="md-nav" aria-label="select()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.select--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../generic/" class="md-nav__link">
        Generic Values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../numeric/" class="md-nav__link">
        Numeric and boolean
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../strings/" class="md-nav__link">
        Strings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../timestamps/" class="md-nav__link">
        Timestamps, dates, and times
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../collections/" class="md-nav__link">
        Collections
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geospatial/" class="md-nav__link">
        Geospatial
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../selectors/" class="md-nav__link">
        Column selectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../datatypes/" class="md-nav__link">
        Data types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/" class="md-nav__link">
        Schemas
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
          Backend interfaces
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Backend interfaces
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backends/base/" class="md-nav__link">
        Backend Base Classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backends/pandas/" class="md-nav__link">
        pandas-like Backend Base Classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backends/sql/" class="md-nav__link">
        SQL Backend Base Classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backends/sqlalchemy/" class="md-nav__link">
        SQLAlchemy Backend Base Classes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../versioning/" class="md-nav__link">
        Versioning Policy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../release_notes/" class="md-nav__link">
        Release notes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Blog
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Blog
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/rendered/ibis-version-6.0.0-release/" class="md-nav__link">
        Ibis v6.0.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/rendered/torch/" class="md-nav__link">
        Ibis on &#x1F525;: Supercharge Your Workflow with DuckDB and PyTorch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/rendered/campaign-finance/" class="md-nav__link">
        Exploring Campaign Finance Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/ibis-to-file/" class="md-nav__link">
        Ibis sneak peek: writing to files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/ibis-examples/" class="md-nav__link">
        Ibis sneak peek: examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/selectors/" class="md-nav__link">
        Maximizing productivity with selectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/ibis_substrait_to_duckdb/" class="md-nav__link">
        Ibis + DuckDB + Substrait
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/ibis-version-4.0.0-release/" class="md-nav__link">
        Ibis v4.0.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/rendered/ci-analysis/" class="md-nav__link">
        Analysis of Ibis's CI Performance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/ffill-and-bfill-using-ibis/" class="md-nav__link">
        ffill and bfill using ibis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/Ibis-version-3.1.0-release/" class="md-nav__link">
        Ibis v3.1.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/Ibis-version-3.0.0-release/" class="md-nav__link">
        Ibis v3.0.0
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../community/">Community</a>
          
            <label for="__nav_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Community
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../community/contribute/">Contribute</a>
          
            <label for="__nav_9_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9_2">
          <span class="md-nav__icon md-icon"></span>
          Contribute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/contribute/01_environment/" class="md-nav__link">
        Setting Up a Development Environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/contribute/02_workflow/" class="md-nav__link">
        Contribute to the Ibis Codebase
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/contribute/03_style/" class="md-nav__link">
        Style and Formatting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/contribute/05_maintainers_guide/" class="md-nav__link">
        Maintaining the Codebase
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table" class="md-nav__link">
    Table
  </a>
  
    <nav class="md-nav" aria-label="Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.columns" class="md-nav__link">
    columns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.aggregate" class="md-nav__link">
    aggregate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.alias" class="md-nav__link">
    alias()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.as_table" class="md-nav__link">
    as_table()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.asof_join" class="md-nav__link">
    asof_join()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.cache" class="md-nav__link">
    cache()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.cast" class="md-nav__link">
    cast()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.count" class="md-nav__link">
    count()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.cross_join" class="md-nav__link">
    cross_join()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.difference" class="md-nav__link">
    difference()
  </a>
  
    <nav class="md-nav" aria-label="difference()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.difference--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.distinct" class="md-nav__link">
    distinct()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.drop" class="md-nav__link">
    drop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.dropna" class="md-nav__link">
    dropna()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.fillna" class="md-nav__link">
    fillna()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.filter" class="md-nav__link">
    filter()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.group_by" class="md-nav__link">
    group_by()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.head" class="md-nav__link">
    head()
  </a>
  
    <nav class="md-nav" aria-label="head()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.head--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.info" class="md-nav__link">
    info()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.intersect" class="md-nav__link">
    intersect()
  </a>
  
    <nav class="md-nav" aria-label="intersect()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.intersect--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.join" class="md-nav__link">
    join()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.limit" class="md-nav__link">
    limit()
  </a>
  
    <nav class="md-nav" aria-label="limit()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.limit--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.mutate" class="md-nav__link">
    mutate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.nunique" class="md-nav__link">
    nunique()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.order_by" class="md-nav__link">
    order_by()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.pivot_longer" class="md-nav__link">
    pivot_longer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.pivot_wider" class="md-nav__link">
    pivot_wider()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.relabel" class="md-nav__link">
    relabel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.rowid" class="md-nav__link">
    rowid()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.schema" class="md-nav__link">
    schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.select" class="md-nav__link">
    select()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.sql" class="md-nav__link">
    sql()
  </a>
  
    <nav class="md-nav" aria-label="sql()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.sql--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.to_array" class="md-nav__link">
    to_array()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.to_pandas" class="md-nav__link">
    to_pandas()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.try_cast" class="md-nav__link">
    try_cast()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.union" class="md-nav__link">
    union()
  </a>
  
    <nav class="md-nav" aria-label="union()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.union--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.unpack" class="md-nav__link">
    unpack()
  </a>
  
    <nav class="md-nav" aria-label="unpack()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.unpack--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.relations.Table.view" class="md-nav__link">
    view()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable" class="md-nav__link">
    GroupedTable
  </a>
  
    <nav class="md-nav" aria-label="GroupedTable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.aggregate" class="md-nav__link">
    aggregate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.count" class="md-nav__link">
    count()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.having" class="md-nav__link">
    having()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.mutate" class="md-nav__link">
    mutate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.order_by" class="md-nav__link">
    order_by()
  </a>
  
    <nav class="md-nav" aria-label="order_by()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.order_by--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.over" class="md-nav__link">
    over()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.select" class="md-nav__link">
    select()
  </a>
  
    <nav class="md-nav" aria-label="select()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ibis.expr.types.groupby.GroupedTable.select--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  


<h1 id="table-expressions">Table Expressions<a class="headerlink" href="#table-expressions" title="Anchor link to this section for reference">&para;</a></h1>
<p>Table expressions form the basis for most Ibis expressions.</p>
<!-- prettier-ignore-start -->


<div class="doc doc-object doc-class">



<h2 id="ibis.expr.types.relations.Table" class="doc doc-heading">
          <code>Table</code>


<a href="#ibis.expr.types.relations.Table" class="headerlink" title="Anchor link to this section for reference">&para;</a></h2>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="ibis.expr.types.core.Expr" href="../#ibis.expr.types.core.Expr">Expr</a></code>, <code><span title="ibis.expr.types.core._FixedTextJupyterMixin">_FixedTextJupyterMixin</span></code></p>


            <details class="quote">
              <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span>
<span class="normal">2871</span>
<span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span>
<span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span>
<span class="normal">2997</span>
<span class="normal">2998</span>
<span class="normal">2999</span>
<span class="normal">3000</span>
<span class="normal">3001</span>
<span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span>
<span class="normal">3005</span>
<span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span>
<span class="normal">3031</span>
<span class="normal">3032</span>
<span class="normal">3033</span>
<span class="normal">3034</span>
<span class="normal">3035</span>
<span class="normal">3036</span>
<span class="normal">3037</span>
<span class="normal">3038</span>
<span class="normal">3039</span>
<span class="normal">3040</span>
<span class="normal">3041</span>
<span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span>
<span class="normal">3057</span>
<span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span>
<span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span>
<span class="normal">3080</span>
<span class="normal">3081</span>
<span class="normal">3082</span>
<span class="normal">3083</span>
<span class="normal">3084</span>
<span class="normal">3085</span>
<span class="normal">3086</span>
<span class="normal">3087</span>
<span class="normal">3088</span>
<span class="normal">3089</span>
<span class="normal">3090</span>
<span class="normal">3091</span>
<span class="normal">3092</span>
<span class="normal">3093</span>
<span class="normal">3094</span>
<span class="normal">3095</span>
<span class="normal">3096</span>
<span class="normal">3097</span>
<span class="normal">3098</span>
<span class="normal">3099</span>
<span class="normal">3100</span>
<span class="normal">3101</span>
<span class="normal">3102</span>
<span class="normal">3103</span>
<span class="normal">3104</span>
<span class="normal">3105</span>
<span class="normal">3106</span>
<span class="normal">3107</span>
<span class="normal">3108</span>
<span class="normal">3109</span>
<span class="normal">3110</span>
<span class="normal">3111</span>
<span class="normal">3112</span>
<span class="normal">3113</span>
<span class="normal">3114</span>
<span class="normal">3115</span>
<span class="normal">3116</span>
<span class="normal">3117</span>
<span class="normal">3118</span>
<span class="normal">3119</span>
<span class="normal">3120</span>
<span class="normal">3121</span>
<span class="normal">3122</span>
<span class="normal">3123</span>
<span class="normal">3124</span>
<span class="normal">3125</span>
<span class="normal">3126</span>
<span class="normal">3127</span>
<span class="normal">3128</span>
<span class="normal">3129</span>
<span class="normal">3130</span>
<span class="normal">3131</span>
<span class="normal">3132</span>
<span class="normal">3133</span>
<span class="normal">3134</span>
<span class="normal">3135</span>
<span class="normal">3136</span>
<span class="normal">3137</span>
<span class="normal">3138</span>
<span class="normal">3139</span>
<span class="normal">3140</span>
<span class="normal">3141</span>
<span class="normal">3142</span>
<span class="normal">3143</span>
<span class="normal">3144</span>
<span class="normal">3145</span>
<span class="normal">3146</span>
<span class="normal">3147</span>
<span class="normal">3148</span>
<span class="normal">3149</span>
<span class="normal">3150</span>
<span class="normal">3151</span>
<span class="normal">3152</span>
<span class="normal">3153</span>
<span class="normal">3154</span>
<span class="normal">3155</span>
<span class="normal">3156</span>
<span class="normal">3157</span>
<span class="normal">3158</span>
<span class="normal">3159</span>
<span class="normal">3160</span>
<span class="normal">3161</span>
<span class="normal">3162</span>
<span class="normal">3163</span>
<span class="normal">3164</span>
<span class="normal">3165</span>
<span class="normal">3166</span>
<span class="normal">3167</span>
<span class="normal">3168</span>
<span class="normal">3169</span>
<span class="normal">3170</span>
<span class="normal">3171</span>
<span class="normal">3172</span>
<span class="normal">3173</span>
<span class="normal">3174</span>
<span class="normal">3175</span>
<span class="normal">3176</span>
<span class="normal">3177</span>
<span class="normal">3178</span>
<span class="normal">3179</span>
<span class="normal">3180</span>
<span class="normal">3181</span>
<span class="normal">3182</span>
<span class="normal">3183</span>
<span class="normal">3184</span>
<span class="normal">3185</span>
<span class="normal">3186</span>
<span class="normal">3187</span>
<span class="normal">3188</span>
<span class="normal">3189</span>
<span class="normal">3190</span>
<span class="normal">3191</span>
<span class="normal">3192</span>
<span class="normal">3193</span>
<span class="normal">3194</span>
<span class="normal">3195</span>
<span class="normal">3196</span>
<span class="normal">3197</span>
<span class="normal">3198</span>
<span class="normal">3199</span>
<span class="normal">3200</span>
<span class="normal">3201</span>
<span class="normal">3202</span>
<span class="normal">3203</span>
<span class="normal">3204</span>
<span class="normal">3205</span>
<span class="normal">3206</span>
<span class="normal">3207</span>
<span class="normal">3208</span>
<span class="normal">3209</span>
<span class="normal">3210</span>
<span class="normal">3211</span>
<span class="normal">3212</span>
<span class="normal">3213</span>
<span class="normal">3214</span>
<span class="normal">3215</span>
<span class="normal">3216</span>
<span class="normal">3217</span>
<span class="normal">3218</span>
<span class="normal">3219</span>
<span class="normal">3220</span>
<span class="normal">3221</span>
<span class="normal">3222</span>
<span class="normal">3223</span>
<span class="normal">3224</span>
<span class="normal">3225</span>
<span class="normal">3226</span>
<span class="normal">3227</span>
<span class="normal">3228</span>
<span class="normal">3229</span>
<span class="normal">3230</span>
<span class="normal">3231</span>
<span class="normal">3232</span>
<span class="normal">3233</span>
<span class="normal">3234</span>
<span class="normal">3235</span>
<span class="normal">3236</span>
<span class="normal">3237</span>
<span class="normal">3238</span>
<span class="normal">3239</span>
<span class="normal">3240</span>
<span class="normal">3241</span>
<span class="normal">3242</span>
<span class="normal">3243</span>
<span class="normal">3244</span>
<span class="normal">3245</span>
<span class="normal">3246</span>
<span class="normal">3247</span>
<span class="normal">3248</span>
<span class="normal">3249</span>
<span class="normal">3250</span>
<span class="normal">3251</span>
<span class="normal">3252</span>
<span class="normal">3253</span>
<span class="normal">3254</span>
<span class="normal">3255</span>
<span class="normal">3256</span>
<span class="normal">3257</span>
<span class="normal">3258</span>
<span class="normal">3259</span>
<span class="normal">3260</span>
<span class="normal">3261</span>
<span class="normal">3262</span>
<span class="normal">3263</span>
<span class="normal">3264</span>
<span class="normal">3265</span>
<span class="normal">3266</span>
<span class="normal">3267</span>
<span class="normal">3268</span>
<span class="normal">3269</span>
<span class="normal">3270</span>
<span class="normal">3271</span>
<span class="normal">3272</span>
<span class="normal">3273</span>
<span class="normal">3274</span>
<span class="normal">3275</span>
<span class="normal">3276</span>
<span class="normal">3277</span>
<span class="normal">3278</span>
<span class="normal">3279</span>
<span class="normal">3280</span>
<span class="normal">3281</span>
<span class="normal">3282</span>
<span class="normal">3283</span>
<span class="normal">3284</span>
<span class="normal">3285</span>
<span class="normal">3286</span>
<span class="normal">3287</span>
<span class="normal">3288</span>
<span class="normal">3289</span>
<span class="normal">3290</span>
<span class="normal">3291</span>
<span class="normal">3292</span>
<span class="normal">3293</span>
<span class="normal">3294</span>
<span class="normal">3295</span>
<span class="normal">3296</span>
<span class="normal">3297</span>
<span class="normal">3298</span>
<span class="normal">3299</span>
<span class="normal">3300</span>
<span class="normal">3301</span>
<span class="normal">3302</span>
<span class="normal">3303</span>
<span class="normal">3304</span>
<span class="normal">3305</span>
<span class="normal">3306</span>
<span class="normal">3307</span>
<span class="normal">3308</span>
<span class="normal">3309</span>
<span class="normal">3310</span>
<span class="normal">3311</span>
<span class="normal">3312</span>
<span class="normal">3313</span>
<span class="normal">3314</span>
<span class="normal">3315</span>
<span class="normal">3316</span>
<span class="normal">3317</span>
<span class="normal">3318</span>
<span class="normal">3319</span>
<span class="normal">3320</span>
<span class="normal">3321</span>
<span class="normal">3322</span>
<span class="normal">3323</span>
<span class="normal">3324</span>
<span class="normal">3325</span>
<span class="normal">3326</span>
<span class="normal">3327</span>
<span class="normal">3328</span>
<span class="normal">3329</span>
<span class="normal">3330</span>
<span class="normal">3331</span>
<span class="normal">3332</span>
<span class="normal">3333</span>
<span class="normal">3334</span>
<span class="normal">3335</span>
<span class="normal">3336</span>
<span class="normal">3337</span>
<span class="normal">3338</span>
<span class="normal">3339</span>
<span class="normal">3340</span>
<span class="normal">3341</span>
<span class="normal">3342</span>
<span class="normal">3343</span>
<span class="normal">3344</span>
<span class="normal">3345</span>
<span class="normal">3346</span>
<span class="normal">3347</span>
<span class="normal">3348</span>
<span class="normal">3349</span>
<span class="normal">3350</span>
<span class="normal">3351</span>
<span class="normal">3352</span>
<span class="normal">3353</span>
<span class="normal">3354</span>
<span class="normal">3355</span>
<span class="normal">3356</span>
<span class="normal">3357</span>
<span class="normal">3358</span>
<span class="normal">3359</span>
<span class="normal">3360</span>
<span class="normal">3361</span>
<span class="normal">3362</span>
<span class="normal">3363</span>
<span class="normal">3364</span>
<span class="normal">3365</span>
<span class="normal">3366</span>
<span class="normal">3367</span>
<span class="normal">3368</span>
<span class="normal">3369</span>
<span class="normal">3370</span>
<span class="normal">3371</span>
<span class="normal">3372</span>
<span class="normal">3373</span>
<span class="normal">3374</span>
<span class="normal">3375</span>
<span class="normal">3376</span>
<span class="normal">3377</span>
<span class="normal">3378</span>
<span class="normal">3379</span>
<span class="normal">3380</span>
<span class="normal">3381</span>
<span class="normal">3382</span>
<span class="normal">3383</span>
<span class="normal">3384</span>
<span class="normal">3385</span>
<span class="normal">3386</span>
<span class="normal">3387</span>
<span class="normal">3388</span>
<span class="normal">3389</span>
<span class="normal">3390</span>
<span class="normal">3391</span>
<span class="normal">3392</span>
<span class="normal">3393</span>
<span class="normal">3394</span>
<span class="normal">3395</span>
<span class="normal">3396</span>
<span class="normal">3397</span>
<span class="normal">3398</span>
<span class="normal">3399</span>
<span class="normal">3400</span>
<span class="normal">3401</span>
<span class="normal">3402</span>
<span class="normal">3403</span>
<span class="normal">3404</span>
<span class="normal">3405</span>
<span class="normal">3406</span>
<span class="normal">3407</span>
<span class="normal">3408</span>
<span class="normal">3409</span>
<span class="normal">3410</span>
<span class="normal">3411</span>
<span class="normal">3412</span>
<span class="normal">3413</span>
<span class="normal">3414</span>
<span class="normal">3415</span>
<span class="normal">3416</span>
<span class="normal">3417</span>
<span class="normal">3418</span>
<span class="normal">3419</span>
<span class="normal">3420</span>
<span class="normal">3421</span>
<span class="normal">3422</span>
<span class="normal">3423</span>
<span class="normal">3424</span>
<span class="normal">3425</span>
<span class="normal">3426</span>
<span class="normal">3427</span>
<span class="normal">3428</span>
<span class="normal">3429</span>
<span class="normal">3430</span>
<span class="normal">3431</span>
<span class="normal">3432</span>
<span class="normal">3433</span>
<span class="normal">3434</span>
<span class="normal">3435</span>
<span class="normal">3436</span>
<span class="normal">3437</span>
<span class="normal">3438</span>
<span class="normal">3439</span>
<span class="normal">3440</span>
<span class="normal">3441</span>
<span class="normal">3442</span>
<span class="normal">3443</span>
<span class="normal">3444</span>
<span class="normal">3445</span>
<span class="normal">3446</span>
<span class="normal">3447</span>
<span class="normal">3448</span>
<span class="normal">3449</span>
<span class="normal">3450</span>
<span class="normal">3451</span>
<span class="normal">3452</span>
<span class="normal">3453</span>
<span class="normal">3454</span>
<span class="normal">3455</span>
<span class="normal">3456</span>
<span class="normal">3457</span>
<span class="normal">3458</span>
<span class="normal">3459</span>
<span class="normal">3460</span>
<span class="normal">3461</span>
<span class="normal">3462</span>
<span class="normal">3463</span>
<span class="normal">3464</span>
<span class="normal">3465</span>
<span class="normal">3466</span>
<span class="normal">3467</span>
<span class="normal">3468</span>
<span class="normal">3469</span>
<span class="normal">3470</span>
<span class="normal">3471</span>
<span class="normal">3472</span>
<span class="normal">3473</span>
<span class="normal">3474</span>
<span class="normal">3475</span>
<span class="normal">3476</span>
<span class="normal">3477</span>
<span class="normal">3478</span>
<span class="normal">3479</span>
<span class="normal">3480</span>
<span class="normal">3481</span>
<span class="normal">3482</span>
<span class="normal">3483</span>
<span class="normal">3484</span>
<span class="normal">3485</span>
<span class="normal">3486</span>
<span class="normal">3487</span>
<span class="normal">3488</span>
<span class="normal">3489</span>
<span class="normal">3490</span>
<span class="normal">3491</span>
<span class="normal">3492</span>
<span class="normal">3493</span>
<span class="normal">3494</span>
<span class="normal">3495</span>
<span class="normal">3496</span>
<span class="normal">3497</span>
<span class="normal">3498</span>
<span class="normal">3499</span>
<span class="normal">3500</span>
<span class="normal">3501</span>
<span class="normal">3502</span>
<span class="normal">3503</span>
<span class="normal">3504</span>
<span class="normal">3505</span>
<span class="normal">3506</span>
<span class="normal">3507</span>
<span class="normal">3508</span>
<span class="normal">3509</span>
<span class="normal">3510</span>
<span class="normal">3511</span>
<span class="normal">3512</span>
<span class="normal">3513</span>
<span class="normal">3514</span>
<span class="normal">3515</span>
<span class="normal">3516</span>
<span class="normal">3517</span>
<span class="normal">3518</span>
<span class="normal">3519</span>
<span class="normal">3520</span>
<span class="normal">3521</span>
<span class="normal">3522</span>
<span class="normal">3523</span>
<span class="normal">3524</span>
<span class="normal">3525</span>
<span class="normal">3526</span>
<span class="normal">3527</span>
<span class="normal">3528</span>
<span class="normal">3529</span>
<span class="normal">3530</span>
<span class="normal">3531</span>
<span class="normal">3532</span>
<span class="normal">3533</span>
<span class="normal">3534</span>
<span class="normal">3535</span>
<span class="normal">3536</span>
<span class="normal">3537</span>
<span class="normal">3538</span>
<span class="normal">3539</span>
<span class="normal">3540</span>
<span class="normal">3541</span>
<span class="normal">3542</span>
<span class="normal">3543</span>
<span class="normal">3544</span>
<span class="normal">3545</span>
<span class="normal">3546</span>
<span class="normal">3547</span>
<span class="normal">3548</span>
<span class="normal">3549</span>
<span class="normal">3550</span>
<span class="normal">3551</span>
<span class="normal">3552</span>
<span class="normal">3553</span>
<span class="normal">3554</span>
<span class="normal">3555</span>
<span class="normal">3556</span>
<span class="normal">3557</span>
<span class="normal">3558</span>
<span class="normal">3559</span>
<span class="normal">3560</span>
<span class="normal">3561</span>
<span class="normal">3562</span>
<span class="normal">3563</span>
<span class="normal">3564</span>
<span class="normal">3565</span>
<span class="normal">3566</span>
<span class="normal">3567</span>
<span class="normal">3568</span>
<span class="normal">3569</span>
<span class="normal">3570</span>
<span class="normal">3571</span>
<span class="normal">3572</span>
<span class="normal">3573</span>
<span class="normal">3574</span>
<span class="normal">3575</span>
<span class="normal">3576</span>
<span class="normal">3577</span>
<span class="normal">3578</span>
<span class="normal">3579</span>
<span class="normal">3580</span>
<span class="normal">3581</span>
<span class="normal">3582</span>
<span class="normal">3583</span>
<span class="normal">3584</span>
<span class="normal">3585</span>
<span class="normal">3586</span>
<span class="normal">3587</span>
<span class="normal">3588</span>
<span class="normal">3589</span>
<span class="normal">3590</span>
<span class="normal">3591</span>
<span class="normal">3592</span>
<span class="normal">3593</span>
<span class="normal">3594</span>
<span class="normal">3595</span>
<span class="normal">3596</span>
<span class="normal">3597</span>
<span class="normal">3598</span>
<span class="normal">3599</span>
<span class="normal">3600</span>
<span class="normal">3601</span>
<span class="normal">3602</span>
<span class="normal">3603</span>
<span class="normal">3604</span>
<span class="normal">3605</span>
<span class="normal">3606</span>
<span class="normal">3607</span>
<span class="normal">3608</span>
<span class="normal">3609</span>
<span class="normal">3610</span>
<span class="normal">3611</span>
<span class="normal">3612</span>
<span class="normal">3613</span>
<span class="normal">3614</span>
<span class="normal">3615</span>
<span class="normal">3616</span>
<span class="normal">3617</span>
<span class="normal">3618</span>
<span class="normal">3619</span>
<span class="normal">3620</span>
<span class="normal">3621</span>
<span class="normal">3622</span>
<span class="normal">3623</span>
<span class="normal">3624</span>
<span class="normal">3625</span>
<span class="normal">3626</span>
<span class="normal">3627</span>
<span class="normal">3628</span>
<span class="normal">3629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@public</span>
<span class="k">class</span> <span class="nc">Table</span><span class="p">(</span><span class="n">Expr</span><span class="p">,</span> <span class="n">_FixedTextJupyterMixin</span><span class="p">):</span>
    <span class="c1"># Higher than numpy &amp; dask objects</span>
    <span class="n">__array_priority__</span> <span class="o">=</span> <span class="mi">20</span>

    <span class="n">__array_ufunc__</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__array__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span><span class="o">.</span><span class="n">__array__</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__dataframe__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nan_as_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">allow_copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">ibis.expr.types.dataframe_interchange</span> <span class="kn">import</span> <span class="n">IbisDataFrame</span>

        <span class="k">return</span> <span class="n">IbisDataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nan_as_null</span><span class="o">=</span><span class="n">nan_as_null</span><span class="p">,</span> <span class="n">allow_copy</span><span class="o">=</span><span class="n">allow_copy</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__pyarrow_result__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">ibis.formats.pyarrow</span> <span class="kn">import</span> <span class="n">PyArrowData</span>

        <span class="k">return</span> <span class="n">PyArrowData</span><span class="o">.</span><span class="n">convert_table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">__pandas_result__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">ibis.formats.pandas</span> <span class="kn">import</span> <span class="n">PandasData</span>

        <span class="k">return</span> <span class="n">PandasData</span><span class="o">.</span><span class="n">convert_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">as_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Promote the expression to a table.</span>

<span class="sd">        This method is a no-op for table expressions.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            A table expression</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.table(dict(a=&quot;int&quot;), name=&quot;t&quot;)</span>
<span class="sd">        &gt;&gt;&gt; s = t.as_table()</span>
<span class="sd">        &gt;&gt;&gt; t is s</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether `name` is a column in the table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name</span>
<span class="sd">            Possible column name</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether `name` is a column in `self`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.table(dict(a=&quot;string&quot;, b=&quot;float&quot;), name=&quot;t&quot;)</span>
<span class="sd">        &gt;&gt;&gt; &quot;a&quot; in t</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; &quot;c&quot; in t</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">cast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">SupportsSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cast the columns of a table.</span>

<span class="sd">        !!! note &quot;If you need to cast columns to a single type, use [selectors](https://ibis-project.org/blog/selectors/).&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        schema</span>
<span class="sd">            Mapping, schema or iterable of pairs to use for casting</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Casted table</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t.schema()</span>
<span class="sd">        ibis.Schema {</span>
<span class="sd">          species            string</span>
<span class="sd">          island             string</span>
<span class="sd">          bill_length_mm     float64</span>
<span class="sd">          bill_depth_mm      float64</span>
<span class="sd">          flipper_length_mm  int64</span>
<span class="sd">          body_mass_g        int64</span>
<span class="sd">          sex                string</span>
<span class="sd">          year               int64</span>
<span class="sd">        }</span>
<span class="sd">        &gt;&gt;&gt; cols = [&quot;body_mass_g&quot;, &quot;bill_length_mm&quot;]</span>
<span class="sd">        &gt;&gt;&gt; t[cols].head()</span>
<span class="sd">        </span>
<span class="sd">         body_mass_g  bill_length_mm </span>
<span class="sd">        </span>
<span class="sd">         int64        float64        </span>
<span class="sd">        </span>
<span class="sd">                3750            39.1 </span>
<span class="sd">                3800            39.5 </span>
<span class="sd">                3250            40.3 </span>
<span class="sd">                NULL             nan </span>
<span class="sd">                3450            36.7 </span>
<span class="sd">        </span>

<span class="sd">        Columns not present in the input schema will be passed through unchanged</span>

<span class="sd">        &gt;&gt;&gt; t.columns</span>
<span class="sd">        [&#39;species&#39;, &#39;island&#39;, &#39;bill_length_mm&#39;, &#39;bill_depth_mm&#39;, &#39;flipper_length_mm&#39;, &#39;body_mass_g&#39;, &#39;sex&#39;, &#39;year&#39;]</span>
<span class="sd">        &gt;&gt;&gt; expr = t.cast({&quot;body_mass_g&quot;: &quot;float64&quot;, &quot;bill_length_mm&quot;: &quot;int&quot;})</span>
<span class="sd">        &gt;&gt;&gt; expr.select(*cols).head()</span>
<span class="sd">        </span>
<span class="sd">         body_mass_g  bill_length_mm </span>
<span class="sd">        </span>
<span class="sd">         float64      int64          </span>
<span class="sd">        </span>
<span class="sd">              3750.0              39 </span>
<span class="sd">              3800.0              40 </span>
<span class="sd">              3250.0              40 </span>
<span class="sd">                 nan            NULL </span>
<span class="sd">              3450.0              37 </span>
<span class="sd">        </span>

<span class="sd">        Columns that are in the input `schema` but not in the table raise an error</span>

<span class="sd">        &gt;&gt;&gt; t.cast({&quot;foo&quot;: &quot;string&quot;})</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ibis.common.exceptions.IbisError: Cast schema has fields that are not in the table: [&#39;foo&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">cast_method</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">try_cast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">SupportsSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cast the columns of a table.</span>

<span class="sd">        If the cast fails for a row, the value is returned</span>
<span class="sd">        as `NULL` or `NaN` depending on backend behavior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        schema</span>
<span class="sd">            Mapping, schema or iterable of pairs to use for casting</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Casted table</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;], &quot;b&quot;: [&quot;2.2&quot;, &quot;3.3&quot;, &quot;book&quot;]})</span>
<span class="sd">        &gt;&gt;&gt; t.try_cast({&quot;a&quot;: &quot;int&quot;, &quot;b&quot;: &quot;float&quot;})</span>
<span class="sd">        </span>
<span class="sd">         a      b       </span>
<span class="sd">        </span>
<span class="sd">         int64  float64 </span>
<span class="sd">        </span>
<span class="sd">             1      2.2 </span>
<span class="sd">             2      3.3 </span>
<span class="sd">             3      nan </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">cast_method</span><span class="o">=</span><span class="s2">&quot;try_cast&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">SupportsSchema</span><span class="p">,</span> <span class="n">cast_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cast&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">sch</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

        <span class="n">cols</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="n">missing_fields</span> <span class="o">:=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cast schema has fields that are not in the table: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">missing_fields</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">new_type</span> <span class="o">:=</span> <span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_col</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">cast_method</span><span class="p">)(</span><span class="n">new_type</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_col</span> <span class="o">=</span> <span class="n">col</span>
            <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_col</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rich_console__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">console</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">rich.text</span> <span class="kn">import</span> <span class="n">Text</span>

        <span class="kn">from</span> <span class="nn">ibis.expr.types.pretty</span> <span class="kn">import</span> <span class="n">to_rich_table</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">console</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">Text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_repr</span><span class="p">()),</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">console</span><span class="o">.</span><span class="n">is_jupyter</span><span class="p">:</span>
            <span class="c1"># Rich infers a console width in jupyter notebooks, but since</span>
            <span class="c1"># notebooks can use horizontal scroll bars we don&#39;t want to apply a</span>
            <span class="c1"># limit here. Since rich requires an integer for max_width, we</span>
            <span class="c1"># choose an arbitrarily large integer bound. Note that we need to</span>
            <span class="c1"># handle this here rather than in `to_rich_table`, as this setting</span>
            <span class="c1"># also needs to be forwarded to `console.render`.</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">max_width</span><span class="o">=</span><span class="mi">1_000_000</span><span class="p">)</span>
            <span class="n">width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">max_width</span>

        <span class="n">table</span> <span class="o">=</span> <span class="n">to_rich_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">console</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select items from a table expression.</span>

<span class="sd">        This method implements square bracket syntax for table expressions,</span>
<span class="sd">        including various forms of projection and filtering.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        what</span>
<span class="sd">            Selection object. This can be a variety of types including strings, ints, lists.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table | Column</span>
<span class="sd">            The return type depends on the input. For a single string or int</span>
<span class="sd">            input a column is returned, otherwise a table is returned.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">        &gt;&gt;&gt; from ibis import _</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">         Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">         Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">         Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">         Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">         Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                           </span>
<span class="sd">        </span>

<span class="sd">        Return a column by name</span>

<span class="sd">        &gt;&gt;&gt; t[&quot;island&quot;]</span>
<span class="sd">        </span>
<span class="sd">         island    </span>
<span class="sd">        </span>
<span class="sd">         string    </span>
<span class="sd">        </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">                  </span>
<span class="sd">        </span>

<span class="sd">        Return the second column, starting from index 0</span>

<span class="sd">        &gt;&gt;&gt; t.columns[1]</span>
<span class="sd">        &#39;island&#39;</span>
<span class="sd">        &gt;&gt;&gt; t[1]</span>
<span class="sd">        </span>
<span class="sd">         island    </span>
<span class="sd">        </span>
<span class="sd">         string    </span>
<span class="sd">        </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">                  </span>
<span class="sd">        </span>

<span class="sd">        Extract a range of rows</span>

<span class="sd">        &gt;&gt;&gt; t[:2]</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t[:5]</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t[2:5]</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">        </span>

<span class="sd">        Select columns</span>

<span class="sd">        &gt;&gt;&gt; t[[&quot;island&quot;, &quot;bill_length_mm&quot;]].head()</span>
<span class="sd">        </span>
<span class="sd">         island     bill_length_mm </span>
<span class="sd">        </span>
<span class="sd">         string     float64        </span>
<span class="sd">        </span>
<span class="sd">         Torgersen            39.1 </span>
<span class="sd">         Torgersen            39.5 </span>
<span class="sd">         Torgersen            40.3 </span>
<span class="sd">         Torgersen             nan </span>
<span class="sd">         Torgersen            36.7 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t[&quot;island&quot;, &quot;bill_length_mm&quot;].head()</span>
<span class="sd">        </span>
<span class="sd">         island     bill_length_mm </span>
<span class="sd">        </span>
<span class="sd">         string     float64        </span>
<span class="sd">        </span>
<span class="sd">         Torgersen            39.1 </span>
<span class="sd">         Torgersen            39.5 </span>
<span class="sd">         Torgersen            40.3 </span>
<span class="sd">         Torgersen             nan </span>
<span class="sd">         Torgersen            36.7 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t[_.island, _.bill_length_mm].head()</span>
<span class="sd">        </span>
<span class="sd">         island     bill_length_mm </span>
<span class="sd">        </span>
<span class="sd">         string     float64        </span>
<span class="sd">        </span>
<span class="sd">         Torgersen            39.1 </span>
<span class="sd">         Torgersen            39.5 </span>
<span class="sd">         Torgersen            40.3 </span>
<span class="sd">         Torgersen             nan </span>
<span class="sd">         Torgersen            36.7 </span>
<span class="sd">        </span>

<span class="sd">        Filtering</span>

<span class="sd">        &gt;&gt;&gt; t[t.island.lower() != &quot;torgersen&quot;].head()</span>
<span class="sd">        </span>
<span class="sd">         species  island  bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string  float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Biscoe            37.8           18.3                174   </span>
<span class="sd">         Adelie   Biscoe            37.7           18.7                180   </span>
<span class="sd">         Adelie   Biscoe            35.9           19.2                189   </span>
<span class="sd">         Adelie   Biscoe            38.2           18.1                185   </span>
<span class="sd">         Adelie   Biscoe            38.8           17.2                180   </span>
<span class="sd">        </span>

<span class="sd">        Selectors</span>

<span class="sd">        &gt;&gt;&gt; t[~s.numeric() | (s.numeric() &amp; ~s.c(&quot;year&quot;))].head()</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t[s.r[&quot;bill_length_mm&quot;:&quot;body_mass_g&quot;]].head()</span>
<span class="sd">        </span>
<span class="sd">         bill_length_mm  bill_depth_mm  flipper_length_mm  body_mass_g </span>
<span class="sd">        </span>
<span class="sd">         float64         float64        int64              int64       </span>
<span class="sd">        </span>
<span class="sd">                   39.1           18.7                181         3750 </span>
<span class="sd">                   39.5           17.4                186         3800 </span>
<span class="sd">                   40.3           18.0                195         3250 </span>
<span class="sd">                    nan            nan               NULL         NULL </span>
<span class="sd">                   36.7           19.3                193         3450 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">ibis.expr.types.generic</span> <span class="kn">import</span> <span class="n">Column</span>
        <span class="kn">from</span> <span class="nn">ibis.expr.types.logical</span> <span class="kn">import</span> <span class="n">BooleanValue</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">TableColumn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">what</span><span class="o">.</span><span class="n">step</span>
            <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">step</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Slice step can only be 1&#39;</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">what</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="mi">0</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">what</span><span class="o">.</span><span class="n">stop</span>

            <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">stop</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;End index must be a positive number&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Start index must be a positive number&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">stop</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">start</span><span class="p">)</span>

        <span class="n">what</span> <span class="o">=</span> <span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">Table</span><span class="p">)):</span>
            <span class="c1"># Projection case</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">what</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">BooleanValue</span><span class="p">):</span>
            <span class="c1"># Boolean predicate</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">([</span><span class="n">what</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">Column</span><span class="p">):</span>
            <span class="c1"># Projection convenience</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">what</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s1">&#39;Selection rows or columns with </span><span class="si">{}</span><span class="s1"> objects is not &#39;</span>
                <span class="s1">&#39;supported&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">what</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">ExpressionError</span><span class="p">(</span><span class="s1">&#39;Use .count() instead&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the column name of a table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key</span>
<span class="sd">            Column name</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Column</span>
<span class="sd">            Column expression with name `key`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t.island</span>
<span class="sd">        </span>
<span class="sd">         island    </span>
<span class="sd">        </span>
<span class="sd">         string    </span>
<span class="sd">        </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">         Torgersen </span>
<span class="sd">                  </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">TableColumn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

        <span class="c1"># A mapping of common attribute typos, mapping them to the proper name</span>
        <span class="n">common_typos</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="s2">&quot;order_by&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sort_by&quot;</span><span class="p">:</span> <span class="s2">&quot;order_by&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sortby&quot;</span><span class="p">:</span> <span class="s2">&quot;order_by&quot;</span><span class="p">,</span>
            <span class="s2">&quot;orderby&quot;</span><span class="p">:</span> <span class="s2">&quot;order_by&quot;</span><span class="p">,</span>
            <span class="s2">&quot;groupby&quot;</span><span class="p">:</span> <span class="s2">&quot;group_by&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">common_typos</span><span class="p">:</span>
            <span class="n">hint</span> <span class="o">=</span> <span class="n">common_typos</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> object has no attribute </span><span class="si">{</span><span class="n">key</span><span class="si">!r}</span><span class="s2">, did you mean </span><span class="si">{</span><span class="n">hint</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;Table&#39; object has no attribute </span><span class="si">{</span><span class="n">key</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="n">out</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isidentifier</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">iskeyword</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ipython_key_completions_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>

    <span class="k">def</span> <span class="nf">_ensure_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

        <span class="kn">from</span> <span class="nn">ibis.selectors</span> <span class="kn">import</span> <span class="n">Selector</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># treat strings as column names</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">expr</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="c1"># treat Python integers as a column index</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span><span class="o">.</span><span class="n">name_at_position</span><span class="p">(</span><span class="n">expr</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Deferred</span><span class="p">):</span>
            <span class="c1"># resolve deferred expressions</span>
            <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Selector</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">expr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">expr</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The list of columns in this table.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t.columns</span>
<span class="sd">        [&#39;species&#39;,</span>
<span class="sd">         &#39;island&#39;,</span>
<span class="sd">         &#39;bill_length_mm&#39;,</span>
<span class="sd">         &#39;bill_depth_mm&#39;,</span>
<span class="sd">         &#39;flipper_length_mm&#39;,</span>
<span class="sd">         &#39;body_mass_g&#39;,</span>
<span class="sd">         &#39;sex&#39;,</span>
<span class="sd">         &#39;year&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sch</span><span class="o">.</span><span class="n">Schema</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the schema for this table.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Schema</span>
<span class="sd">            The table&#39;s schema.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t.schema()</span>
<span class="sd">        ibis.Schema {</span>
<span class="sd">          species            string</span>
<span class="sd">          island             string</span>
<span class="sd">          bill_length_mm     float64</span>
<span class="sd">          bill_depth_mm      float64</span>
<span class="sd">          flipper_length_mm  int64</span>
<span class="sd">          body_mass_g        int64</span>
<span class="sd">          sex                string</span>
<span class="sd">          year               int64</span>
<span class="sd">        }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">schema</span>

    <span class="k">def</span> <span class="nf">group_by</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">key_exprs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GroupedTable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a grouped table expression.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        by</span>
<span class="sd">            Grouping expressions</span>
<span class="sd">        key_exprs</span>
<span class="sd">            Named grouping expressions</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GroupedTable</span>
<span class="sd">            A grouped table expression</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; from ibis import _</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.memtable({&quot;fruit&quot;: [&quot;apple&quot;, &quot;apple&quot;, &quot;banana&quot;, &quot;orange&quot;], &quot;price&quot;: [0.5, 0.5, 0.25, 0.33]})</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         fruit   price   </span>
<span class="sd">        </span>
<span class="sd">         string  float64 </span>
<span class="sd">        </span>
<span class="sd">         apple      0.50 </span>
<span class="sd">         apple      0.50 </span>
<span class="sd">         banana     0.25 </span>
<span class="sd">         orange     0.33 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.group_by(&quot;fruit&quot;).agg(total_cost=_.price.sum(), avg_cost=_.price.mean())</span>
<span class="sd">        </span>
<span class="sd">         fruit   total_cost  avg_cost </span>
<span class="sd">        </span>
<span class="sd">         string  float64     float64  </span>
<span class="sd">        </span>
<span class="sd">         apple         1.00      0.50 </span>
<span class="sd">         banana        0.25      0.25 </span>
<span class="sd">         orange        0.33      0.33 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">ibis.expr.types.groupby</span> <span class="kn">import</span> <span class="n">GroupedTable</span>

        <span class="k">return</span> <span class="n">GroupedTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="o">**</span><span class="n">key_exprs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">rowid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">IntegerValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A unique integer per row.</span>

<span class="sd">        !!! note &quot;This operation is only valid on physical tables&quot;</span>

<span class="sd">            Any further meaning behind this expression is backend dependent.</span>
<span class="sd">            Generally this corresponds to some index into the database storage</span>
<span class="sd">            (for example, sqlite or duckdb&#39;s `rowid`).</span>

<span class="sd">        For a monotonically increasing row number, see `ibis.row_number`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        IntegerColumn</span>
<span class="sd">            An integer column</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(),</span> <span class="n">ops</span><span class="o">.</span><span class="n">PhysicalTable</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
                <span class="s2">&quot;rowid() is only valid for physical tables, not for generic &quot;</span>
                <span class="s2">&quot;table expressions&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">RowID</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new table expression distinct from the current one.</span>

<span class="sd">        Use this API for any self-referencing operations like a self-join.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Table expression</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">SelfReference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">distinct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the set difference of multiple table expressions.</span>

<span class="sd">        The input tables must have identical schemas.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table:</span>
<span class="sd">            A table expression</span>
<span class="sd">        *rest:</span>
<span class="sd">            Additional table expressions</span>
<span class="sd">        distinct</span>
<span class="sd">            Only diff distinct rows not occurring in the calling table</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        [`ibis.difference`][ibis.difference]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            The rows present in `self` that are not present in `tables`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t1 = ibis.memtable({&quot;a&quot;: [1, 2]})</span>
<span class="sd">        &gt;&gt;&gt; t1</span>
<span class="sd">        </span>
<span class="sd">         a     </span>
<span class="sd">        </span>
<span class="sd">         int64 </span>
<span class="sd">        </span>
<span class="sd">             1 </span>
<span class="sd">             2 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t2 = ibis.memtable({&quot;a&quot;: [2, 3]})</span>
<span class="sd">        &gt;&gt;&gt; t2</span>
<span class="sd">        </span>
<span class="sd">         a     </span>
<span class="sd">        </span>
<span class="sd">         int64 </span>
<span class="sd">        </span>
<span class="sd">             2 </span>
<span class="sd">             3 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t1.difference(t2)</span>
<span class="sd">        </span>
<span class="sd">         a     </span>
<span class="sd">        </span>
<span class="sd">         int64 </span>
<span class="sd">        </span>
<span class="sd">             1 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">rest</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Difference</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">metrics</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Scalar</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">by</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">having</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">BooleanValue</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Aggregate a table with a given set of reductions grouping by `by`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        metrics</span>
<span class="sd">            Aggregate expressions. These can be any scalar-producing</span>
<span class="sd">            expression, including aggregation functions like `sum` or literal</span>
<span class="sd">            values like `ibis.literal(1)`.</span>
<span class="sd">        by</span>
<span class="sd">            Grouping expressions.</span>
<span class="sd">        having</span>
<span class="sd">            Post-aggregation filters. The shape requirements are the same</span>
<span class="sd">            `metrics`, but the output type for `having` is `boolean`.</span>

<span class="sd">            !!! warning &quot;Expressions like `x is None` return `bool` and **will not** generate a SQL comparison to `NULL`&quot;</span>
<span class="sd">        kwargs</span>
<span class="sd">            Named aggregate expressions</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            An aggregate table expression</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; from ibis import _</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.memtable({&quot;fruit&quot;: [&quot;apple&quot;, &quot;apple&quot;, &quot;banana&quot;, &quot;orange&quot;], &quot;price&quot;: [0.5, 0.5, 0.25, 0.33]})</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         fruit   price   </span>
<span class="sd">        </span>
<span class="sd">         string  float64 </span>
<span class="sd">        </span>
<span class="sd">         apple      0.50 </span>
<span class="sd">         apple      0.50 </span>
<span class="sd">         banana     0.25 </span>
<span class="sd">         orange     0.33 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.aggregate(by=[&quot;fruit&quot;], total_cost=_.price.sum(), avg_cost=_.price.mean(), having=_.price.sum() &lt; 0.5)</span>
<span class="sd">        </span>
<span class="sd">         fruit   total_cost  avg_cost </span>
<span class="sd">        </span>
<span class="sd">         string  float64     float64  </span>
<span class="sd">        </span>
<span class="sd">         banana        0.25      0.25 </span>
<span class="sd">         orange        0.33      0.33 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">ibis.expr.analysis</span> <span class="k">as</span> <span class="nn">an</span>

        <span class="n">metrics</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="p">(</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metric</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span>
                    <span class="k">else</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric</span><span class="p">))</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">))</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="n">agg</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Aggregation</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">metrics</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">metrics</span><span class="p">),</span>
            <span class="n">by</span><span class="o">=</span><span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">by</span><span class="p">)),</span>
            <span class="n">having</span><span class="o">=</span><span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">having</span><span class="p">)),</span>
        <span class="p">)</span>
        <span class="n">agg</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">simplify_aggregation</span><span class="p">(</span><span class="n">agg</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">agg</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="n">agg</span> <span class="o">=</span> <span class="n">aggregate</span>

    <span class="k">def</span> <span class="nf">distinct</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">keep</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;last&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;first&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Table with duplicate rows removed.</span>

<span class="sd">        Similar to `pandas.DataFrame.drop_duplicates()`.</span>

<span class="sd">        !!! note &quot;Some backends do not support `keep=&#39;last&#39;`&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        on</span>
<span class="sd">            Only consider certain columns for identifying duplicates.</span>
<span class="sd">            By default deduplicate all of the columns.</span>
<span class="sd">        keep</span>
<span class="sd">            Determines which duplicates to keep.</span>

<span class="sd">            - `&quot;first&quot;`: Drop duplicates except for the first occurrence.</span>
<span class="sd">            - `&quot;last&quot;`: Drop duplicates except for the last occurrence.</span>
<span class="sd">            - `None`: Drop all duplicates</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; import ibis.examples as ex</span>
<span class="sd">        &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ex.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">         Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">         Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">         Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">         Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">         Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                           </span>
<span class="sd">        </span>

<span class="sd">        Compute the distinct rows of a subset of columns</span>

<span class="sd">        &gt;&gt;&gt; t[[&quot;species&quot;, &quot;island&quot;]].distinct()</span>
<span class="sd">        </span>
<span class="sd">         species    island    </span>
<span class="sd">        </span>
<span class="sd">         string     string    </span>
<span class="sd">        </span>
<span class="sd">         Adelie     Torgersen </span>
<span class="sd">         Adelie     Biscoe    </span>
<span class="sd">         Adelie     Dream     </span>
<span class="sd">         Gentoo     Biscoe    </span>
<span class="sd">         Chinstrap  Dream     </span>
<span class="sd">        </span>

<span class="sd">        Drop all duplicate rows except the first</span>

<span class="sd">        &gt;&gt;&gt; t.distinct(on=[&quot;species&quot;, &quot;island&quot;], keep=&quot;first&quot;)</span>
<span class="sd">        </span>
<span class="sd">         species    island     bill_length_mm  bill_depth_  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string     string     float64         float64       int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie     Torgersen            39.1          18.7                181   </span>
<span class="sd">         Adelie     Biscoe               37.8          18.3                174   </span>
<span class="sd">         Adelie     Dream                39.5          16.7                178   </span>
<span class="sd">         Gentoo     Biscoe               46.1          13.2                211   </span>
<span class="sd">         Chinstrap  Dream                46.5          17.9                192   </span>
<span class="sd">        </span>

<span class="sd">        Drop all duplicate rows except the last</span>

<span class="sd">        &gt;&gt;&gt; t.distinct(on=[&quot;species&quot;, &quot;island&quot;], keep=&quot;last&quot;)</span>
<span class="sd">        </span>
<span class="sd">         species    island     bill_length_mm  bill_depth_  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string     string     float64         float64       int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie     Torgersen            43.1          19.2                197   </span>
<span class="sd">         Adelie     Biscoe               42.7          18.3                196   </span>
<span class="sd">         Adelie     Dream                41.5          18.5                201   </span>
<span class="sd">         Gentoo     Biscoe               49.9          16.1                213   </span>
<span class="sd">         Chinstrap  Dream                50.2          18.7                198   </span>
<span class="sd">        </span>

<span class="sd">        Drop all duplicated rows</span>

<span class="sd">        &gt;&gt;&gt; expr = t.distinct(on=[&quot;species&quot;, &quot;island&quot;, &quot;year&quot;, &quot;bill_length_mm&quot;], keep=None)</span>
<span class="sd">        &gt;&gt;&gt; expr.count()</span>
<span class="sd">        273</span>
<span class="sd">        &gt;&gt;&gt; t.count()</span>
<span class="sd">        344</span>

<span class="sd">        You can pass [`selectors`][ibis.selectors] to `on`</span>

<span class="sd">        &gt;&gt;&gt; t.distinct(on=~s.numeric())</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Biscoe               37.8           18.3                174   </span>
<span class="sd">         Adelie   Biscoe               37.7           18.7                180   </span>
<span class="sd">         Adelie   Dream                39.5           16.7                178   </span>
<span class="sd">         Adelie   Dream                37.2           18.1                178   </span>
<span class="sd">         Adelie   Dream                37.5           18.9                179   </span>
<span class="sd">         Gentoo   Biscoe               46.1           13.2                211   </span>
<span class="sd">         Gentoo   Biscoe               50.0           16.3                230   </span>
<span class="sd">                                                                           </span>
<span class="sd">        </span>

<span class="sd">        The only valid values of `keep` are `&quot;first&quot;`, `&quot;last&quot;` and [`None][None]</span>

<span class="sd">        &gt;&gt;&gt; t.distinct(on=&quot;species&quot;, keep=&quot;second&quot;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">          ...</span>
<span class="sd">        ibis.common.exceptions.IbisError: Invalid value for keep: &#39;second&#39; ...</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>

        <span class="k">if</span> <span class="n">on</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># dedup everything</span>
            <span class="k">if</span> <span class="n">keep</span> <span class="o">!=</span> <span class="s2">&quot;first&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Only keep=&#39;first&#39; (the default) makes sense when deduplicating all columns; got keep=</span><span class="si">{</span><span class="n">keep</span><span class="si">!r}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">Distinct</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span><span class="p">):</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="o">*</span><span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">on</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">keep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">having</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;first&quot;</span>
        <span class="k">elif</span> <span class="n">keep</span> <span class="o">==</span> <span class="s2">&quot;first&quot;</span> <span class="ow">or</span> <span class="n">keep</span> <span class="o">==</span> <span class="s2">&quot;last&quot;</span><span class="p">:</span>
            <span class="n">having</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">how</span> <span class="o">=</span> <span class="n">keep</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid value for `keep`: </span><span class="si">{</span><span class="n">keep</span><span class="si">!r}</span><span class="s2">, must be &#39;first&#39;, &#39;last&#39; or None&quot;</span>
            <span class="p">)</span>

        <span class="n">aggs</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="o">.</span><span class="n">get_name</span><span class="p">():</span> <span class="n">col</span><span class="o">.</span><span class="n">arbitrary</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">(</span><span class="o">~</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)}</span>

        <span class="n">gb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">having</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gb</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">having</span><span class="p">(</span><span class="n">having</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="o">**</span><span class="n">aggs</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select `n` rows from `self` starting at `offset`.</span>

<span class="sd">        !!! note &quot;The result set is not deterministic without a call to [`order_by`][ibis.expr.types.relations.Table.order_by].&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n</span>
<span class="sd">            Number of rows to include</span>
<span class="sd">        offset</span>
<span class="sd">            Number of rows to skip first</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            The first `n` rows of `self` starting at `offset`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [1, 1, 2], &quot;b&quot;: [&quot;c&quot;, &quot;a&quot;, &quot;a&quot;]})</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         a      b      </span>
<span class="sd">        </span>
<span class="sd">         int64  string </span>
<span class="sd">        </span>
<span class="sd">             1  c      </span>
<span class="sd">             1  a      </span>
<span class="sd">             2  a      </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.limit(2)</span>
<span class="sd">        </span>
<span class="sd">         a      b      </span>
<span class="sd">        </span>
<span class="sd">         int64  string </span>
<span class="sd">        </span>
<span class="sd">             1  c      </span>
<span class="sd">             1  a      </span>
<span class="sd">        </span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        [`Table.order_by`][ibis.expr.types.relations.Table.order_by]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">Limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select the first `n` rows of a table.</span>

<span class="sd">        !!! note &quot;The result set is not deterministic without a call to [`order_by`][ibis.expr.types.relations.Table.order_by].&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n</span>
<span class="sd">            Number of rows to include</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            `self` limited to `n` rows</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [1, 1, 2], &quot;b&quot;: [&quot;c&quot;, &quot;a&quot;, &quot;a&quot;]})</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         a      b      </span>
<span class="sd">        </span>
<span class="sd">         int64  string </span>
<span class="sd">        </span>
<span class="sd">             1  c      </span>
<span class="sd">             1  a      </span>
<span class="sd">             2  a      </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.head(2)</span>
<span class="sd">        </span>
<span class="sd">         a      b      </span>
<span class="sd">        </span>
<span class="sd">         int64  string </span>
<span class="sd">        </span>
<span class="sd">             1  c      </span>
<span class="sd">             1  a      </span>
<span class="sd">        </span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        [`Table.limit`][ibis.expr.types.relations.Table.limit]</span>
<span class="sd">        [`Table.order_by`][ibis.expr.types.relations.Table.order_by]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">order_by</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">by</span><span class="p">:</span> <span class="nb">str</span>
        <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span>
        <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">]</span>
        <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]</span>
        <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort a table by one or more expressions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        by</span>
<span class="sd">            Expressions to sort the table by.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Sorted table</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [1, 2, 3], &quot;b&quot;: [&quot;c&quot;, &quot;b&quot;, &quot;a&quot;], &quot;c&quot;: [4, 6, 5]})</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         a      b       c     </span>
<span class="sd">        </span>
<span class="sd">         int64  string  int64 </span>
<span class="sd">        </span>
<span class="sd">             1  c           4 </span>
<span class="sd">             2  b           6 </span>
<span class="sd">             3  a           5 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.order_by(&quot;b&quot;)</span>
<span class="sd">        </span>
<span class="sd">         a      b       c     </span>
<span class="sd">        </span>
<span class="sd">         int64  string  int64 </span>
<span class="sd">        </span>
<span class="sd">             3  a           5 </span>
<span class="sd">             2  b           6 </span>
<span class="sd">             1  c           4 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.order_by(ibis.desc(&quot;c&quot;))</span>
<span class="sd">        </span>
<span class="sd">         a      b       c     </span>
<span class="sd">        </span>
<span class="sd">         int64  string  int64 </span>
<span class="sd">        </span>
<span class="sd">             2  b           6 </span>
<span class="sd">             3  a           5 </span>
<span class="sd">             1  c           4 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">used_tuple_syntax</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="n">by</span><span class="p">]</span>
            <span class="n">used_tuple_syntax</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">sort_keys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">by</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Tuple must be of length 2, got </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
                    <span class="p">)</span>
                <span class="n">item</span> <span class="o">=</span> <span class="p">(</span><span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">used_tuple_syntax</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="n">sort_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">used_tuple_syntax</span><span class="p">:</span>
            <span class="n">util</span><span class="o">.</span><span class="n">warn_deprecated</span><span class="p">(</span>
                <span class="s2">&quot;table.order_by((key, True)) and table.order_by((key, False)) syntax&quot;</span><span class="p">,</span>
                <span class="n">as_of</span><span class="o">=</span><span class="s2">&quot;6.0&quot;</span><span class="p">,</span>
                <span class="n">removed_in</span><span class="o">=</span><span class="s2">&quot;7.0&quot;</span><span class="p">,</span>
                <span class="n">instead</span><span class="o">=</span><span class="s2">&quot;Use ibis.desc(key) or ibis.asc(key) instead&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">sort_keys</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">distinct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the set union of multiple table expressions.</span>

<span class="sd">        The input tables must have identical schemas.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table</span>
<span class="sd">            A table expression</span>
<span class="sd">        *rest</span>
<span class="sd">            Additional table expressions</span>
<span class="sd">        distinct</span>
<span class="sd">            Only return distinct rows</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            A new table containing the union of all input tables.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        [`ibis.union`][ibis.union]</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t1 = ibis.memtable({&quot;a&quot;: [1, 2]})</span>
<span class="sd">        &gt;&gt;&gt; t1</span>
<span class="sd">        </span>
<span class="sd">         a     </span>
<span class="sd">        </span>
<span class="sd">         int64 </span>
<span class="sd">        </span>
<span class="sd">             1 </span>
<span class="sd">             2 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t2 = ibis.memtable({&quot;a&quot;: [2, 3]})</span>
<span class="sd">        &gt;&gt;&gt; t2</span>
<span class="sd">        </span>
<span class="sd">         a     </span>
<span class="sd">        </span>
<span class="sd">         int64 </span>
<span class="sd">        </span>
<span class="sd">             2 </span>
<span class="sd">             3 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t1.union(t2)  # union all by default</span>
<span class="sd">        </span>
<span class="sd">         a     </span>
<span class="sd">        </span>
<span class="sd">         int64 </span>
<span class="sd">        </span>
<span class="sd">             1 </span>
<span class="sd">             2 </span>
<span class="sd">             2 </span>
<span class="sd">             3 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t1.union(t2, distinct=True).order_by(&quot;a&quot;)</span>
<span class="sd">        </span>
<span class="sd">         a     </span>
<span class="sd">        </span>
<span class="sd">         int64 </span>
<span class="sd">        </span>
<span class="sd">             1 </span>
<span class="sd">             2 </span>
<span class="sd">             3 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">rest</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Union</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">distinct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the set intersection of multiple table expressions.</span>

<span class="sd">        The input tables must have identical schemas.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table</span>
<span class="sd">            A table expression</span>
<span class="sd">        *rest</span>
<span class="sd">            Additional table expressions</span>
<span class="sd">        distinct</span>
<span class="sd">            Only return distinct rows</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            A new table containing the intersection of all input tables.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        [`ibis.intersect`][ibis.intersect]</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t1 = ibis.memtable({&quot;a&quot;: [1, 2]})</span>
<span class="sd">        &gt;&gt;&gt; t1</span>
<span class="sd">        </span>
<span class="sd">         a     </span>
<span class="sd">        </span>
<span class="sd">         int64 </span>
<span class="sd">        </span>
<span class="sd">             1 </span>
<span class="sd">             2 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t2 = ibis.memtable({&quot;a&quot;: [2, 3]})</span>
<span class="sd">        &gt;&gt;&gt; t2</span>
<span class="sd">        </span>
<span class="sd">         a     </span>
<span class="sd">        </span>
<span class="sd">         int64 </span>
<span class="sd">        </span>
<span class="sd">             2 </span>
<span class="sd">             3 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t1.intersect(t2)</span>
<span class="sd">        </span>
<span class="sd">         a     </span>
<span class="sd">        </span>
<span class="sd">         int64 </span>
<span class="sd">        </span>
<span class="sd">             2 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Intersection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">rest</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Intersection</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;View a single column table as an array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Value</span>
<span class="sd">            A single column view of a table</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">ExpressionError</span><span class="p">(</span>
                <span class="s1">&#39;Table must have exactly one column when viewed as array&#39;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">TableArrayView</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">exprs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Expr</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">mutations</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add columns to a table expression.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        exprs</span>
<span class="sd">            List of named expressions to add as columns</span>
<span class="sd">        mutations</span>
<span class="sd">            Named expressions using keyword arguments</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Table expression with additional columns</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">        &gt;&gt;&gt; from ibis import _</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch().select(&quot;species&quot;, &quot;year&quot;, &quot;bill_length_mm&quot;)</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         species  year   bill_length_mm </span>
<span class="sd">        </span>
<span class="sd">         string   int64  float64        </span>
<span class="sd">        </span>
<span class="sd">         Adelie    2007            39.1 </span>
<span class="sd">         Adelie    2007            39.5 </span>
<span class="sd">         Adelie    2007            40.3 </span>
<span class="sd">         Adelie    2007             nan </span>
<span class="sd">         Adelie    2007            36.7 </span>
<span class="sd">         Adelie    2007            39.3 </span>
<span class="sd">         Adelie    2007            38.9 </span>
<span class="sd">         Adelie    2007            39.2 </span>
<span class="sd">         Adelie    2007            34.1 </span>
<span class="sd">         Adelie    2007            42.0 </span>
<span class="sd">                                     </span>
<span class="sd">        </span>

<span class="sd">        Add a new column from a per-element expression</span>

<span class="sd">        &gt;&gt;&gt; t.mutate(next_year=_.year + 1).head()</span>
<span class="sd">        </span>
<span class="sd">         species  year   bill_length_mm  next_year </span>
<span class="sd">        </span>
<span class="sd">         string   int64  float64         int64     </span>
<span class="sd">        </span>
<span class="sd">         Adelie    2007            39.1       2008 </span>
<span class="sd">         Adelie    2007            39.5       2008 </span>
<span class="sd">         Adelie    2007            40.3       2008 </span>
<span class="sd">         Adelie    2007             nan       2008 </span>
<span class="sd">         Adelie    2007            36.7       2008 </span>
<span class="sd">        </span>

<span class="sd">        Add a new column based on an aggregation. Note the automatic broadcasting.</span>

<span class="sd">        &gt;&gt;&gt; t.select(&quot;species&quot;, bill_demean=_.bill_length_mm - _.bill_length_mm.mean()).head()</span>
<span class="sd">        </span>
<span class="sd">         species  bill_demean </span>
<span class="sd">        </span>
<span class="sd">         string   float64     </span>
<span class="sd">        </span>
<span class="sd">         Adelie      -4.82193 </span>
<span class="sd">         Adelie      -4.42193 </span>
<span class="sd">         Adelie      -3.62193 </span>
<span class="sd">         Adelie           nan </span>
<span class="sd">         Adelie      -7.22193 </span>
<span class="sd">        </span>

<span class="sd">        Mutate across multiple columns</span>

<span class="sd">        &gt;&gt;&gt; t.mutate(s.across(s.numeric() &amp; ~s.c(&quot;year&quot;), _ - _.mean())).head()</span>
<span class="sd">        </span>
<span class="sd">         species  year   bill_length_mm </span>
<span class="sd">        </span>
<span class="sd">         string   int64  float64        </span>
<span class="sd">        </span>
<span class="sd">         Adelie    2007        -4.82193 </span>
<span class="sd">         Adelie    2007        -4.42193 </span>
<span class="sd">         Adelie    2007        -3.62193 </span>
<span class="sd">         Adelie    2007             nan </span>
<span class="sd">         Adelie    2007        -7.22193 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">ibis.expr.analysis</span> <span class="k">as</span> <span class="nn">an</span>

        <span class="n">exprs</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">exprs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">exprs</span><span class="p">)</span>
        <span class="n">exprs</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">))</span> <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">exprs</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">mutations</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">))</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="n">mutation_exprs</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">get_mutation_exprs</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">exprs</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mutation_exprs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">exprs</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span>
        <span class="o">**</span><span class="n">named_exprs</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute a new table expression using `exprs` and `named_exprs`.</span>

<span class="sd">        Passing an aggregate function to this method will broadcast the</span>
<span class="sd">        aggregate&#39;s value over the number of rows in the table and</span>
<span class="sd">        automatically constructs a window function expression. See the examples</span>
<span class="sd">        section for more details.</span>

<span class="sd">        For backwards compatibility the keyword argument `exprs` is reserved</span>
<span class="sd">        and cannot be used to name an expression. This behavior will be removed</span>
<span class="sd">        in v4.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        exprs</span>
<span class="sd">            Column expression, string, or list of column expressions and</span>
<span class="sd">            strings.</span>
<span class="sd">        named_exprs</span>
<span class="sd">            Column expressions</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Table expression</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">         Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">         Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">         Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">         Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">         Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                           </span>
<span class="sd">        </span>

<span class="sd">        Simple projection</span>

<span class="sd">        &gt;&gt;&gt; t.select(&quot;island&quot;, &quot;bill_length_mm&quot;).head()</span>
<span class="sd">        </span>
<span class="sd">         island     bill_length_mm </span>
<span class="sd">        </span>
<span class="sd">         string     float64        </span>
<span class="sd">        </span>
<span class="sd">         Torgersen            39.1 </span>
<span class="sd">         Torgersen            39.5 </span>
<span class="sd">         Torgersen            40.3 </span>
<span class="sd">         Torgersen             nan </span>
<span class="sd">         Torgersen            36.7 </span>
<span class="sd">        </span>

<span class="sd">        Projection by zero-indexed column position</span>

<span class="sd">        &gt;&gt;&gt; t.select(0, 4).head()</span>
<span class="sd">        </span>
<span class="sd">         species  flipper_length_mm </span>
<span class="sd">        </span>
<span class="sd">         string   int64             </span>
<span class="sd">        </span>
<span class="sd">         Adelie                 181 </span>
<span class="sd">         Adelie                 186 </span>
<span class="sd">         Adelie                 195 </span>
<span class="sd">         Adelie                NULL </span>
<span class="sd">         Adelie                 193 </span>
<span class="sd">        </span>

<span class="sd">        Projection with renaming and compute in one call</span>

<span class="sd">        &gt;&gt;&gt; t.select(next_year=t.year + 1).head()</span>
<span class="sd">        </span>
<span class="sd">         next_year </span>
<span class="sd">        </span>
<span class="sd">         int64     </span>
<span class="sd">        </span>
<span class="sd">              2008 </span>
<span class="sd">              2008 </span>
<span class="sd">              2008 </span>
<span class="sd">              2008 </span>
<span class="sd">              2008 </span>
<span class="sd">        </span>

<span class="sd">        Projection with aggregation expressions</span>

<span class="sd">        &gt;&gt;&gt; t.select(&quot;island&quot;, bill_mean=t.bill_length_mm.mean()).head()</span>
<span class="sd">        </span>
<span class="sd">         island     bill_mean </span>
<span class="sd">        </span>
<span class="sd">         string     float64   </span>
<span class="sd">        </span>
<span class="sd">         Torgersen   43.92193 </span>
<span class="sd">         Torgersen   43.92193 </span>
<span class="sd">         Torgersen   43.92193 </span>
<span class="sd">         Torgersen   43.92193 </span>
<span class="sd">         Torgersen   43.92193 </span>
<span class="sd">        </span>

<span class="sd">        Projection with a selector</span>

<span class="sd">        &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">        &gt;&gt;&gt; t.select(s.numeric() &amp; ~s.c(&quot;year&quot;)).head()</span>
<span class="sd">        </span>
<span class="sd">         bill_length_mm  bill_depth_mm  flipper_length_mm  body_mass_g </span>
<span class="sd">        </span>
<span class="sd">         float64         float64        int64              int64       </span>
<span class="sd">        </span>
<span class="sd">                   39.1           18.7                181         3750 </span>
<span class="sd">                   39.5           17.4                186         3800 </span>
<span class="sd">                   40.3           18.0                195         3250 </span>
<span class="sd">                    nan            nan               NULL         NULL </span>
<span class="sd">                   36.7           19.3                193         3450 </span>
<span class="sd">        </span>

<span class="sd">        Projection + aggregation across multiple columns</span>

<span class="sd">        &gt;&gt;&gt; from ibis import _</span>
<span class="sd">        &gt;&gt;&gt; t.select(s.across(s.numeric() &amp; ~s.c(&quot;year&quot;), _.mean())).head()</span>
<span class="sd">        </span>
<span class="sd">         bill_length_mm  bill_depth_mm  flipper_length_mm  body_mass_g </span>
<span class="sd">        </span>
<span class="sd">         float64         float64        float64            float64     </span>
<span class="sd">        </span>
<span class="sd">               43.92193       17.15117         200.915205  4201.754386 </span>
<span class="sd">               43.92193       17.15117         200.915205  4201.754386 </span>
<span class="sd">               43.92193       17.15117         200.915205  4201.754386 </span>
<span class="sd">               43.92193       17.15117         200.915205  4201.754386 </span>
<span class="sd">               43.92193       17.15117         200.915205  4201.754386 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">ibis.expr.analysis</span> <span class="k">as</span> <span class="nn">an</span>
        <span class="kn">from</span> <span class="nn">ibis.selectors</span> <span class="kn">import</span> <span class="n">Selector</span>

        <span class="n">exprs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
                <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                    <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Selector</span><span class="p">)</span> <span class="k">else</span> <span class="n">e</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">exprs</span>
                <span class="p">),</span>
                <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">named_exprs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">exprs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
                <span class="s2">&quot;You must select at least one column for a valid projection&quot;</span>
            <span class="p">)</span>

        <span class="n">op</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">Projector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exprs</span><span class="p">)</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="n">projection</span> <span class="o">=</span> <span class="n">select</span>

    <span class="k">def</span> <span class="nf">relabel</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">substitutions</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
        <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
        <span class="o">|</span> <span class="nb">str</span>
        <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;snake_case&quot;</span><span class="p">,</span> <span class="s2">&quot;ALL_CAPS&quot;</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rename columns in the table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        substitutions</span>
<span class="sd">            A mapping, function, or format string mapping old to new column</span>
<span class="sd">            names. If a column isn&#39;t in the mapping (or if the callable returns</span>
<span class="sd">            None) it is left with its original name. May also pass a format</span>
<span class="sd">            string to rename all columns, like ``&quot;prefix_{name}&quot;``. Also</span>
<span class="sd">            accepts the literal string ``&quot;snake_case&quot;`` or ``&quot;ALL_CAPS&quot;`` which</span>
<span class="sd">            will relabel all columns to use a ``snake_case`` or ``&quot;ALL_CAPS&quot;``</span>
<span class="sd">            naming convention.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            A relabeled table expression</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; first3 = s.r[:3]  # first 3 columns</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins_raw_raw.fetch().select(first3)</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         studyName  Sample Number  Species                             </span>
<span class="sd">        </span>
<span class="sd">         string     int64          string                              </span>
<span class="sd">        </span>
<span class="sd">         PAL0708                1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">         PAL0708                2  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">         PAL0708                3  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">         PAL0708                4  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">         PAL0708                5  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">         PAL0708                6  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">         PAL0708                7  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">         PAL0708                8  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">         PAL0708                9  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">         PAL0708               10  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">                                                                    </span>
<span class="sd">        </span>

<span class="sd">        Relabel column names using a mapping from old name to new name</span>

<span class="sd">        &gt;&gt;&gt; t.relabel({&quot;studyName&quot;: &quot;study_name&quot;}).head(1)</span>
<span class="sd">        </span>
<span class="sd">         study_name  Sample Number  Species                             </span>
<span class="sd">        </span>
<span class="sd">         string      int64          string                              </span>
<span class="sd">        </span>
<span class="sd">         PAL0708                 1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">        </span>

<span class="sd">        Relabel column names using a snake_case convention</span>

<span class="sd">        &gt;&gt;&gt; t.relabel(&quot;snake_case&quot;).head(1)</span>
<span class="sd">        </span>
<span class="sd">         study_name  sample_number  species                             </span>
<span class="sd">        </span>
<span class="sd">         string      int64          string                              </span>
<span class="sd">        </span>
<span class="sd">         PAL0708                 1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">        </span>

<span class="sd">        Relabel column names using a ALL_CAPS convention</span>

<span class="sd">        &gt;&gt;&gt; t.relabel(&quot;ALL_CAPS&quot;).head(1)</span>
<span class="sd">        </span>
<span class="sd">         STUDY_NAME  SAMPLE_NUMBER  SPECIES                             </span>
<span class="sd">        </span>
<span class="sd">         string      int64          string                              </span>
<span class="sd">        </span>
<span class="sd">         PAL0708                 1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">        </span>

<span class="sd">        Relabel columns using a format string</span>

<span class="sd">        &gt;&gt;&gt; t.relabel(&quot;p_{name}&quot;).head(1)</span>
<span class="sd">        </span>
<span class="sd">         p_studyName  p_Sample Number  p_Species                           </span>
<span class="sd">        </span>
<span class="sd">         string       int64            string                              </span>
<span class="sd">        </span>
<span class="sd">         PAL0708                    1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">        </span>

<span class="sd">        Relabel column names using a callable</span>

<span class="sd">        &gt;&gt;&gt; t.relabel(str.upper).head(1)</span>
<span class="sd">        </span>
<span class="sd">         STUDYNAME  SAMPLE NUMBER  SPECIES                             </span>
<span class="sd">        </span>
<span class="sd">         string     int64          string                              </span>
<span class="sd">        </span>
<span class="sd">         PAL0708                1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">observed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">substitutions</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
            <span class="n">rename</span> <span class="o">=</span> <span class="n">substitutions</span><span class="o">.</span><span class="n">get</span>
        <span class="k">elif</span> <span class="n">substitutions</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;snake_case&quot;</span><span class="p">,</span> <span class="s2">&quot;ALL_CAPS&quot;</span><span class="p">}:</span>

            <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
                    <span class="c1"># Handle &quot;space case possibly with-hyphens&quot;</span>
                    <span class="k">if</span> <span class="n">substitutions</span> <span class="o">==</span> <span class="s2">&quot;snake_case&quot;</span><span class="p">:</span>
                        <span class="k">return</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">substitutions</span> <span class="o">==</span> <span class="s2">&quot;ALL_CAPS&quot;</span><span class="p">:</span>
                        <span class="k">return</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="c1"># Handle PascalCase, camelCase, and kebab-case</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([A-Z]+)([A-Z][a-z])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\1_\2&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([a-z\d])([A-Z])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\1_\2&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">substitutions</span> <span class="o">==</span> <span class="s2">&quot;snake_case&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">substitutions</span> <span class="o">==</span> <span class="s2">&quot;ALL_CAPS&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">substitutions</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>

            <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">substitutions</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

            <span class="c1"># Detect the case of missing or extra format string parameters</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dummy_name1</span> <span class="o">=</span> <span class="s2">&quot;_unlikely_column_name_1_&quot;</span>
                <span class="n">dummy_name2</span> <span class="o">=</span> <span class="s2">&quot;_unlikely_column_name_2_&quot;</span>
                <span class="n">invalid</span> <span class="o">=</span> <span class="n">rename</span><span class="p">(</span><span class="n">dummy_name1</span><span class="p">)</span> <span class="o">==</span> <span class="n">rename</span><span class="p">(</span><span class="n">dummy_name2</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">invalid</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">invalid</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Format strings must take a single parameter `name`&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rename</span> <span class="o">=</span> <span class="n">substitutions</span>

        <span class="n">exprs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">:=</span> <span class="n">rename</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">observed</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">exprs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">substitutions</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">substitutions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">observed</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">c</span><span class="si">!r}</span><span class="s2"> is not an existing column&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">exprs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Selector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove fields from a table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fields</span>
<span class="sd">            Fields to drop. Strings and selectors are accepted.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            A table with all columns matching `fields` removed.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">         Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">         Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">         Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">         Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">         Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                           </span>
<span class="sd">        </span>

<span class="sd">        Drop one or more columns</span>

<span class="sd">        &gt;&gt;&gt; t.drop(&quot;species&quot;).head()</span>
<span class="sd">        </span>
<span class="sd">         island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Torgersen            39.1           18.7                181   </span>
<span class="sd">         Torgersen            39.5           17.4                186   </span>
<span class="sd">         Torgersen            40.3           18.0                195   </span>
<span class="sd">         Torgersen             nan            nan               NULL   </span>
<span class="sd">         Torgersen            36.7           19.3                193   </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.drop(&quot;species&quot;, &quot;bill_length_mm&quot;).head()</span>
<span class="sd">        </span>
<span class="sd">         island     bill_depth_mm  flipper_length_mm  body_mass_g  sex      </span>
<span class="sd">        </span>
<span class="sd">         string     float64        int64              int64        string   </span>
<span class="sd">        </span>
<span class="sd">         Torgersen           18.7                181         3750  male     </span>
<span class="sd">         Torgersen           17.4                186         3800  female   </span>
<span class="sd">         Torgersen           18.0                195         3250  female   </span>
<span class="sd">         Torgersen            nan               NULL         NULL  NULL     </span>
<span class="sd">         Torgersen           19.3                193         3450  female   </span>
<span class="sd">        </span>

<span class="sd">        Drop with selectors, mix and match</span>

<span class="sd">        &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">        &gt;&gt;&gt; t.drop(&quot;species&quot;, s.startswith(&quot;bill_&quot;)).head()</span>
<span class="sd">        </span>
<span class="sd">         island     flipper_length_mm  body_mass_g  sex     year  </span>
<span class="sd">        </span>
<span class="sd">         string     int64              int64        string  int64 </span>
<span class="sd">        </span>
<span class="sd">         Torgersen                181         3750  male     2007 </span>
<span class="sd">         Torgersen                186         3800  female   2007 </span>
<span class="sd">         Torgersen                195         3250  female   2007 </span>
<span class="sd">         Torgersen               NULL         NULL  NULL     2007 </span>
<span class="sd">         Torgersen                193         3450  female   2007 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">selectors</span> <span class="k">as</span> <span class="n">s</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">fields</span><span class="p">:</span>
            <span class="c1"># no-op if nothing to be dropped</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="n">missing_fields</span> <span class="o">:=</span> <span class="p">{</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">str</span><span class="p">)}</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span><span class="o">.</span><span class="n">names</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fields not in table: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">missing_fields</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">sels</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">~</span><span class="n">s</span><span class="o">.</span><span class="n">any_of</span><span class="p">(</span><span class="o">*</span><span class="n">sels</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">predicates</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanValue</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">BooleanValue</span><span class="p">]</span> <span class="o">|</span> <span class="n">IfAnyAll</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select rows from `table` based on `predicates`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        predicates</span>
<span class="sd">            Boolean value expressions used to select rows in `table`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Filtered table expression</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">         Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">         Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">         Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">         Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">         Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                           </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.filter([t.species == &quot;Adelie&quot;, t.body_mass_g &gt; 3500]).sex.value_counts().dropna(&quot;sex&quot;)</span>
<span class="sd">        </span>
<span class="sd">         sex     sex_count </span>
<span class="sd">        </span>
<span class="sd">         string  int64     </span>
<span class="sd">        </span>
<span class="sd">         male           68 </span>
<span class="sd">         female         22 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">ibis.expr.analysis</span> <span class="k">as</span> <span class="nn">an</span>

        <span class="n">resolved_predicates</span> <span class="o">=</span> <span class="n">_resolve_predicates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicates</span><span class="p">)</span>
        <span class="n">predicates</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">an</span><span class="o">.</span><span class="n">_rewrite_filter</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">op</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">Expr</span><span class="p">)</span> <span class="k">else</span> <span class="n">pred</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">resolved_predicates</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">an</span><span class="o">.</span><span class="n">apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(),</span> <span class="n">predicates</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">nunique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanValue</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">IntegerScalar</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the number of unique rows in the table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        where</span>
<span class="sd">            Optional boolean expression to filter rows when counting.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        IntegerScalar</span>
<span class="sd">            Number of unique rows in the table</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [&quot;foo&quot;, &quot;bar&quot;, &quot;bar&quot;]})</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         a      </span>
<span class="sd">        </span>
<span class="sd">         string </span>
<span class="sd">        </span>
<span class="sd">         foo    </span>
<span class="sd">         bar    </span>
<span class="sd">         bar    </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.nunique()</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; t.nunique(t.a != &quot;foo&quot;)</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">CountDistinctStar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanValue</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">IntegerScalar</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the number of rows in the table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        where</span>
<span class="sd">            Optional boolean expression to filter rows when counting.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        IntegerScalar</span>
<span class="sd">            Number of rows in the table</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;]})</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         a      </span>
<span class="sd">        </span>
<span class="sd">         string </span>
<span class="sd">        </span>
<span class="sd">         foo    </span>
<span class="sd">         bar    </span>
<span class="sd">         baz    </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.count()</span>
<span class="sd">        3</span>
<span class="sd">        &gt;&gt;&gt; t.count(t.a != &quot;foo&quot;)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; type(t.count())</span>
<span class="sd">        &lt;class &#39;ibis.expr.types.numeric.IntegerScalar&#39;&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">CountStar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">dropna</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">subset</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">how</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;any&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;any&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove rows with null values from the table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        subset</span>
<span class="sd">            Columns names to consider when dropping nulls. By default all columns</span>
<span class="sd">            are considered.</span>
<span class="sd">        how</span>
<span class="sd">            Determine whether a row is removed if there is **at least one null</span>
<span class="sd">            value in the row** (`&#39;any&#39;`), or if **all** row values are null</span>
<span class="sd">            (`&#39;all&#39;`).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Table expression</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">         Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">         Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">         Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">         Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">         Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                           </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.count()</span>
<span class="sd">        344</span>
<span class="sd">        &gt;&gt;&gt; t.dropna([&quot;bill_length_mm&quot;, &quot;body_mass_g&quot;]).count()</span>
<span class="sd">        342</span>
<span class="sd">        &gt;&gt;&gt; t.dropna(how=&quot;all&quot;).count()  # no rows where all columns are null</span>
<span class="sd">        344</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">subset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subset</span> <span class="o">=</span> <span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">subset</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">DropNa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">subset</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">fillna</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">replacements</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Scalar</span> <span class="o">|</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ir</span><span class="o">.</span><span class="n">Scalar</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fill null values in a table expression.</span>

<span class="sd">        !!! note &quot;There is potential lack of type stability with the `fillna` API&quot;</span>

<span class="sd">            For example, different library versions may impact whether a given</span>
<span class="sd">            backend promotes integer replacement values to floats.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        replacements</span>
<span class="sd">            Value with which to fill nulls. If `replacements` is a mapping, the</span>
<span class="sd">            keys are column names that map to their replacement value. If</span>
<span class="sd">            passed as a scalar all columns are filled with that value.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t.sex</span>
<span class="sd">        </span>
<span class="sd">         sex    </span>
<span class="sd">        </span>
<span class="sd">         string </span>
<span class="sd">        </span>
<span class="sd">         male   </span>
<span class="sd">         female </span>
<span class="sd">         female </span>
<span class="sd">         NULL   </span>
<span class="sd">         female </span>
<span class="sd">         male   </span>
<span class="sd">         female </span>
<span class="sd">         male   </span>
<span class="sd">         NULL   </span>
<span class="sd">         NULL   </span>
<span class="sd">               </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.fillna({&quot;sex&quot;: &quot;unrecorded&quot;}).sex</span>
<span class="sd">        </span>
<span class="sd">         sex        </span>
<span class="sd">        </span>
<span class="sd">         string     </span>
<span class="sd">        </span>
<span class="sd">         male       </span>
<span class="sd">         female     </span>
<span class="sd">         female     </span>
<span class="sd">         unrecorded </span>
<span class="sd">         female     </span>
<span class="sd">         male       </span>
<span class="sd">         female     </span>
<span class="sd">         male       </span>
<span class="sd">         unrecorded </span>
<span class="sd">         unrecorded </span>
<span class="sd">                   </span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Table expression</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">replacements</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">replacements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
                    <span class="n">columns_formatted</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">repr</span><span class="p">,</span> <span class="n">schema</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">col</span><span class="si">!r}</span><span class="s2"> is not found in table. &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Existing columns: </span><span class="si">{</span><span class="n">columns_formatted</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>

                <span class="n">col_type</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="n">val_type</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Expr</span><span class="p">)</span> <span class="k">else</span> <span class="n">dt</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">dt</span><span class="o">.</span><span class="n">castable</span><span class="p">(</span><span class="n">val_type</span><span class="p">,</span> <span class="n">col_type</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Cannot fillna on column </span><span class="si">{</span><span class="n">col</span><span class="si">!r}</span><span class="s2"> of type </span><span class="si">{</span><span class="n">col_type</span><span class="si">}</span><span class="s2"> with a &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;value of type </span><span class="si">{</span><span class="n">val_type</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">val_type</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">replacements</span><span class="o">.</span><span class="n">type</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">replacements</span><span class="p">,</span> <span class="n">Expr</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">dt</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">replacements</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">col_type</span> <span class="ow">in</span> <span class="n">schema</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">col_type</span><span class="o">.</span><span class="n">nullable</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dt</span><span class="o">.</span><span class="n">castable</span><span class="p">(</span><span class="n">val_type</span><span class="p">,</span> <span class="n">col_type</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Cannot fillna on column </span><span class="si">{</span><span class="n">col</span><span class="si">!r}</span><span class="s2"> of type </span><span class="si">{</span><span class="n">col_type</span><span class="si">}</span><span class="s2"> with a &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;value of type </span><span class="si">{</span><span class="n">val_type</span><span class="si">}</span><span class="s2"> - pass in an explicit mapping &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;of fill values to `fillna` instead.&quot;</span>
                    <span class="p">)</span>
        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">FillNa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replacements</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">unpack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">columns</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Project the struct fields of each of `columns` into `self`.</span>

<span class="sd">        Existing fields are retained in the projection.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        columns</span>
<span class="sd">            String column names to project into `self`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            The child table with struct fields of each of `columns` projected.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; lines = &#39;&#39;&#39;</span>
<span class="sd">        ...     {&quot;name&quot;: &quot;a&quot;, &quot;pos&quot;: {&quot;lat&quot;: 10.1, &quot;lon&quot;: 30.3}}</span>
<span class="sd">        ...     {&quot;name&quot;: &quot;b&quot;, &quot;pos&quot;: {&quot;lat&quot;: 10.2, &quot;lon&quot;: 30.2}}</span>
<span class="sd">        ...     {&quot;name&quot;: &quot;c&quot;, &quot;pos&quot;: {&quot;lat&quot;: 10.3, &quot;lon&quot;: 30.1}}</span>
<span class="sd">        ... &#39;&#39;&#39;</span>
<span class="sd">        &gt;&gt;&gt; with open(&quot;/tmp/lines.json&quot;, &quot;w&quot;) as f:</span>
<span class="sd">        ...     _ = f.write(lines)</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.read_json(&quot;/tmp/lines.json&quot;)</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        </span>
<span class="sd">         name    pos                                </span>
<span class="sd">        </span>
<span class="sd">         string  struct&lt;lat: float64, lon: float64&gt; </span>
<span class="sd">        </span>
<span class="sd">         a       {&#39;lat&#39;: 10.1, &#39;lon&#39;: 30.3}         </span>
<span class="sd">         b       {&#39;lat&#39;: 10.2, &#39;lon&#39;: 30.2}         </span>
<span class="sd">         c       {&#39;lat&#39;: 10.3, &#39;lon&#39;: 30.1}         </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; t.unpack(&quot;pos&quot;)</span>
<span class="sd">        </span>
<span class="sd">         name    lat      lon     </span>
<span class="sd">        </span>
<span class="sd">         string  float64  float64 </span>
<span class="sd">        </span>
<span class="sd">         a          10.1     30.3 </span>
<span class="sd">         b          10.2     30.2 </span>
<span class="sd">         c          10.3     30.1 </span>
<span class="sd">        </span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        [`StructValue.lift`][ibis.expr.types.structs.StructValue.lift]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">columns_to_unpack</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">result_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_unpack</span><span class="p">:</span>
                <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
                <span class="n">result_columns</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">expr</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">result_columns</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return summary information about a table.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Summary of `self`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t.info()</span>
<span class="sd">        </span>
<span class="sd">         name               type     nullable  nulls  non_nulls  null_frac   </span>
<span class="sd">        </span>
<span class="sd">         string             string   boolean   int64  int64      float64     </span>
<span class="sd">        </span>
<span class="sd">         species            string   True          0        344   0.000000   </span>
<span class="sd">         island             string   True          0        344   0.000000   </span>
<span class="sd">         bill_length_mm     float64  True          2        342   0.005814   </span>
<span class="sd">         bill_depth_mm      float64  True          2        342   0.005814   </span>
<span class="sd">         flipper_length_mm  int64    True          2        342   0.005814   </span>
<span class="sd">         body_mass_g        int64    True          2        342   0.005814   </span>
<span class="sd">         sex                string   True         11        333   0.031977   </span>
<span class="sd">         year               int64    True          0        344   0.000000   </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">literal</span> <span class="k">as</span> <span class="n">lit</span>

        <span class="n">aggs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">colname</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span>
            <span class="n">typ</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">type</span><span class="p">()</span>
            <span class="n">agg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                <span class="n">isna</span><span class="o">=</span><span class="n">ibis</span><span class="o">.</span><span class="n">case</span><span class="p">()</span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">else_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
            <span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">lit</span><span class="p">(</span><span class="n">colname</span><span class="p">),</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">lit</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">typ</span><span class="p">)),</span>
                <span class="n">nullable</span><span class="o">=</span><span class="n">lit</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">typ</span><span class="o">.</span><span class="n">nullable</span><span class="p">))</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;bool&quot;</span><span class="p">),</span>
                <span class="n">nulls</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">isna</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
                <span class="n">non_nulls</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">isna</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
                <span class="n">null_frac</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">isna</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                <span class="n">pos</span><span class="o">=</span><span class="n">lit</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">aggs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ibis</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">aggs</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">ibis</span><span class="o">.</span><span class="n">asc</span><span class="p">(</span><span class="s2">&quot;pos&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span>
        <span class="n">left</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
        <span class="n">right</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
        <span class="n">predicates</span><span class="p">:</span> <span class="nb">str</span>
        <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span>
            <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">]</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanColumn</span>
        <span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">how</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
            <span class="s1">&#39;inner&#39;</span><span class="p">,</span>
            <span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="s1">&#39;outer&#39;</span><span class="p">,</span>
            <span class="s1">&#39;right&#39;</span><span class="p">,</span>
            <span class="s1">&#39;semi&#39;</span><span class="p">,</span>
            <span class="s1">&#39;anti&#39;</span><span class="p">,</span>
            <span class="s1">&#39;any_inner&#39;</span><span class="p">,</span>
            <span class="s1">&#39;any_left&#39;</span><span class="p">,</span>
            <span class="s1">&#39;left_semi&#39;</span><span class="p">,</span>
        <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;inner&#39;</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">lname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">rname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{name}</span><span class="s2">_right&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform a join between two tables.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        left</span>
<span class="sd">            Left table to join</span>
<span class="sd">        right</span>
<span class="sd">            Right table to join</span>
<span class="sd">        predicates</span>
<span class="sd">            Boolean or column names to join on</span>
<span class="sd">        how</span>
<span class="sd">            Join method</span>
<span class="sd">        lname</span>
<span class="sd">            A format string to use to rename overlapping columns in the left</span>
<span class="sd">            table (e.g. ``&quot;left_{name}&quot;``).</span>
<span class="sd">        rname</span>
<span class="sd">            A format string to use to rename overlapping columns in the right</span>
<span class="sd">            table (e.g. ``&quot;right_{name}&quot;``).</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">        &gt;&gt;&gt; import ibis.examples as ex</span>
<span class="sd">        &gt;&gt;&gt; from ibis import _</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; movies = ex.ml_latest_small_movies.fetch()</span>
<span class="sd">        &gt;&gt;&gt; movies</span>
<span class="sd">        </span>
<span class="sd">         movieId  title                             genres                          </span>
<span class="sd">        </span>
<span class="sd">         int64    string                            string                          </span>
<span class="sd">        </span>
<span class="sd">               1  Toy Story (1995)                  Adventure|Animation|Children|C </span>
<span class="sd">               2  Jumanji (1995)                    Adventure|Children|Fantasy      </span>
<span class="sd">               3  Grumpier Old Men (1995)           Comedy|Romance                  </span>
<span class="sd">               4  Waiting to Exhale (1995)          Comedy|Drama|Romance            </span>
<span class="sd">               5  Father of the Bride Part II (19  Comedy                          </span>
<span class="sd">               6  Heat (1995)                       Action|Crime|Thriller           </span>
<span class="sd">               7  Sabrina (1995)                    Comedy|Romance                  </span>
<span class="sd">               8  Tom and Huck (1995)               Adventure|Children              </span>
<span class="sd">               9  Sudden Death (1995)               Action                          </span>
<span class="sd">              10  GoldenEye (1995)                  Action|Adventure|Thriller       </span>
<span class="sd">                                                                                 </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; links = ex.ml_latest_small_links.fetch()</span>
<span class="sd">        &gt;&gt;&gt; links</span>
<span class="sd">        </span>
<span class="sd">         movieId  imdbId   tmdbId </span>
<span class="sd">        </span>
<span class="sd">         int64    string   int64  </span>
<span class="sd">        </span>
<span class="sd">               1  0114709     862 </span>
<span class="sd">               2  0113497    8844 </span>
<span class="sd">               3  0113228   15602 </span>
<span class="sd">               4  0114885   31357 </span>
<span class="sd">               5  0113041   11862 </span>
<span class="sd">               6  0113277     949 </span>
<span class="sd">               7  0114319   11860 </span>
<span class="sd">               8  0112302   45325 </span>
<span class="sd">               9  0114576    9091 </span>
<span class="sd">              10  0113189     710 </span>
<span class="sd">                               </span>
<span class="sd">        </span>

<span class="sd">        Implicit inner equality join on the shared `movieId` column</span>

<span class="sd">        &gt;&gt;&gt; linked = movies.join(links, &quot;movieId&quot;, how=&quot;inner&quot;)</span>
<span class="sd">        &gt;&gt;&gt; linked.head()</span>
<span class="sd">        </span>
<span class="sd">         movieId  title                   genres                  imdbId   tmdbId </span>
<span class="sd">        </span>
<span class="sd">         int64    string                  string                  string   int64  </span>
<span class="sd">        </span>
<span class="sd">               1  Toy Story (1995)        Adventure|Animation|C  0114709     862 </span>
<span class="sd">               2  Jumanji (1995)          Adventure|Children|Fa  0113497    8844 </span>
<span class="sd">               3  Grumpier Old Men (199  Comedy|Romance          0113228   15602 </span>
<span class="sd">               4  Waiting to Exhale (19  Comedy|Drama|Romance    0114885   31357 </span>
<span class="sd">               5  Father of the Bride P  Comedy                  0113041   11862 </span>
<span class="sd">        </span>

<span class="sd">        Explicit equality join using the default `how` value of `&quot;inner&quot;`</span>

<span class="sd">        &gt;&gt;&gt; linked = movies.join(links, movies.movieId == links.movieId)</span>
<span class="sd">        &gt;&gt;&gt; linked.head()</span>
<span class="sd">        </span>
<span class="sd">         movieId  title                   genres                  imdbId   tmdbId </span>
<span class="sd">        </span>
<span class="sd">         int64    string                  string                  string   int64  </span>
<span class="sd">        </span>
<span class="sd">               1  Toy Story (1995)        Adventure|Animation|C  0114709     862 </span>
<span class="sd">               2  Jumanji (1995)          Adventure|Children|Fa  0113497    8844 </span>
<span class="sd">               3  Grumpier Old Men (199  Comedy|Romance          0113228   15602 </span>
<span class="sd">               4  Waiting to Exhale (19  Comedy|Drama|Romance    0114885   31357 </span>
<span class="sd">               5  Father of the Bride P  Comedy                  0113041   11862 </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_join_classes</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;inner&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">InnerJoin</span><span class="p">,</span>
            <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">LeftJoin</span><span class="p">,</span>
            <span class="s1">&#39;any_inner&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">AnyInnerJoin</span><span class="p">,</span>
            <span class="s1">&#39;any_left&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">AnyLeftJoin</span><span class="p">,</span>
            <span class="s1">&#39;outer&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">OuterJoin</span><span class="p">,</span>
            <span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">RightJoin</span><span class="p">,</span>
            <span class="s1">&#39;left_semi&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">LeftSemiJoin</span><span class="p">,</span>
            <span class="s1">&#39;semi&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">LeftSemiJoin</span><span class="p">,</span>
            <span class="s1">&#39;anti&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">LeftAntiJoin</span><span class="p">,</span>
            <span class="s1">&#39;cross&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">CrossJoin</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">klass</span> <span class="o">=</span> <span class="n">_join_classes</span><span class="p">[</span><span class="n">how</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
        <span class="n">expr</span> <span class="o">=</span> <span class="n">klass</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">predicates</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

        <span class="c1"># semi/anti join only give access to the left table&#39;s fields, so</span>
        <span class="c1"># there&#39;s never overlap</span>
        <span class="k">if</span> <span class="n">how</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;left_semi&quot;</span><span class="p">,</span> <span class="s2">&quot;semi&quot;</span><span class="p">,</span> <span class="s2">&quot;anti&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">expr</span>

        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">relations</span><span class="o">.</span><span class="n">_dedup_join_columns</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">lname</span><span class="o">=</span><span class="n">lname</span><span class="p">,</span> <span class="n">rname</span><span class="o">=</span><span class="n">rname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">asof_join</span><span class="p">(</span>
        <span class="n">left</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
        <span class="n">right</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
        <span class="n">predicates</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanColumn</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanColumn</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">tolerance</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">IntervalScalar</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">lname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">rname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{name}</span><span class="s2">_right&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform an &quot;as-of&quot; join between `left` and `right`.</span>

<span class="sd">        Similar to a left join except that the match is done on nearest key</span>
<span class="sd">        rather than equal keys.</span>

<span class="sd">        Optionally, match keys with `by` before joining with `predicates`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        left</span>
<span class="sd">            Table expression</span>
<span class="sd">        right</span>
<span class="sd">            Table expression</span>
<span class="sd">        predicates</span>
<span class="sd">            Join expressions</span>
<span class="sd">        by</span>
<span class="sd">            column to group by before joining</span>
<span class="sd">        tolerance</span>
<span class="sd">            Amount of time to look behind when joining</span>
<span class="sd">        lname</span>
<span class="sd">            A format string to use to rename overlapping columns in the left</span>
<span class="sd">            table (e.g. ``&quot;left_{name}&quot;``).</span>
<span class="sd">        rname</span>
<span class="sd">            A format string to use to rename overlapping columns in the right</span>
<span class="sd">            table (e.g. ``&quot;right_{name}&quot;``).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Table expression</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">AsOfJoin</span><span class="p">(</span>
            <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
            <span class="n">predicates</span><span class="o">=</span><span class="n">predicates</span><span class="p">,</span>
            <span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">,</span>
            <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">relations</span><span class="o">.</span><span class="n">_dedup_join_columns</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">to_expr</span><span class="p">(),</span> <span class="n">lname</span><span class="o">=</span><span class="n">lname</span><span class="p">,</span> <span class="n">rname</span><span class="o">=</span><span class="n">rname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cross_join</span><span class="p">(</span>
        <span class="n">left</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
        <span class="n">right</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
        <span class="o">*</span><span class="n">rest</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
        <span class="n">lname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">rname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{name}</span><span class="s2">_right&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the cross join of a sequence of tables.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        left</span>
<span class="sd">            Left table</span>
<span class="sd">        right</span>
<span class="sd">            Right table</span>
<span class="sd">        rest</span>
<span class="sd">            Additional tables to cross join</span>
<span class="sd">        lname</span>
<span class="sd">            A format string to use to rename overlapping columns in the left</span>
<span class="sd">            table (e.g. ``&quot;left_{name}&quot;``).</span>
<span class="sd">        rname</span>
<span class="sd">            A format string to use to rename overlapping columns in the right</span>
<span class="sd">            table (e.g. ``&quot;right_{name}&quot;``).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Cross join of `left`, `right` and `rest`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">        &gt;&gt;&gt; from ibis import _</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; t.count()</span>
<span class="sd">        344</span>
<span class="sd">        &gt;&gt;&gt; agg = t.drop(&quot;year&quot;).agg(s.across(s.numeric(), _.mean()))</span>
<span class="sd">        &gt;&gt;&gt; expr = t.cross_join(agg)</span>
<span class="sd">        &gt;&gt;&gt; expr</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">         Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">         Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">         Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">         Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">         Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                           </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; expr.columns</span>
<span class="sd">        [&#39;species&#39;,</span>
<span class="sd">         &#39;island&#39;,</span>
<span class="sd">         &#39;bill_length_mm&#39;,</span>
<span class="sd">         &#39;bill_depth_mm&#39;,</span>
<span class="sd">         &#39;flipper_length_mm&#39;,</span>
<span class="sd">         &#39;body_mass_g&#39;,</span>
<span class="sd">         &#39;sex&#39;,</span>
<span class="sd">         &#39;year&#39;,</span>
<span class="sd">         &#39;bill_length_mm_right&#39;,</span>
<span class="sd">         &#39;bill_depth_mm_right&#39;,</span>
<span class="sd">         &#39;flipper_length_mm_right&#39;,</span>
<span class="sd">         &#39;body_mass_g_right&#39;]</span>
<span class="sd">        &gt;&gt;&gt; expr.count()</span>
<span class="sd">        344</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">CrossJoin</span><span class="p">(</span>
            <span class="n">left</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">Table</span><span class="o">.</span><span class="n">cross_join</span><span class="p">,</span> <span class="n">rest</span><span class="p">,</span> <span class="n">right</span><span class="p">),</span>
            <span class="p">[],</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">relations</span><span class="o">.</span><span class="n">_dedup_join_columns</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">to_expr</span><span class="p">(),</span> <span class="n">lname</span><span class="o">=</span><span class="n">lname</span><span class="p">,</span> <span class="n">rname</span><span class="o">=</span><span class="n">rname</span><span class="p">)</span>

    <span class="n">inner_join</span> <span class="o">=</span> <span class="n">_regular_join_method</span><span class="p">(</span><span class="s2">&quot;inner_join&quot;</span><span class="p">,</span> <span class="s2">&quot;inner&quot;</span><span class="p">)</span>
    <span class="n">left_join</span> <span class="o">=</span> <span class="n">_regular_join_method</span><span class="p">(</span><span class="s2">&quot;left_join&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
    <span class="n">outer_join</span> <span class="o">=</span> <span class="n">_regular_join_method</span><span class="p">(</span><span class="s2">&quot;outer_join&quot;</span><span class="p">,</span> <span class="s2">&quot;outer&quot;</span><span class="p">)</span>
    <span class="n">right_join</span> <span class="o">=</span> <span class="n">_regular_join_method</span><span class="p">(</span><span class="s2">&quot;right_join&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">semi_join</span> <span class="o">=</span> <span class="n">_regular_join_method</span><span class="p">(</span><span class="s2">&quot;semi_join&quot;</span><span class="p">,</span> <span class="s2">&quot;semi&quot;</span><span class="p">)</span>
    <span class="n">anti_join</span> <span class="o">=</span> <span class="n">_regular_join_method</span><span class="p">(</span><span class="s2">&quot;anti_join&quot;</span><span class="p">,</span> <span class="s2">&quot;anti&quot;</span><span class="p">)</span>
    <span class="n">any_inner_join</span> <span class="o">=</span> <span class="n">_regular_join_method</span><span class="p">(</span><span class="s2">&quot;any_inner_join&quot;</span><span class="p">,</span> <span class="s2">&quot;any_inner&quot;</span><span class="p">)</span>
    <span class="n">any_left_join</span> <span class="o">=</span> <span class="n">_regular_join_method</span><span class="p">(</span><span class="s2">&quot;any_left_join&quot;</span><span class="p">,</span> <span class="s2">&quot;any_left&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">alias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a table expression with a specific name `alias`.</span>

<span class="sd">        This method is useful for exposing an ibis expression to the underlying</span>
<span class="sd">        backend for use in the</span>
<span class="sd">        [`Table.sql`][ibis.expr.types.relations.Table.sql] method.</span>

<span class="sd">        !!! note &quot;`.alias` will create a temporary view&quot;</span>

<span class="sd">            `.alias` creates a temporary view in the database.</span>

<span class="sd">            This side effect will be removed in a future version of ibis and</span>
<span class="sd">            **is not part of the public API**.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        alias</span>
<span class="sd">            Name of the child expression</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            An table expression</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; expr = t.alias(&quot;pinginos&quot;).sql(&#39;SELECT * FROM &quot;pinginos&quot; LIMIT 5&#39;)</span>
<span class="sd">        &gt;&gt;&gt; expr</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expr</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">alias</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

        <span class="c1"># NB: calling compile is necessary so that any temporary views are</span>
        <span class="c1"># created so that we can infer the schema without executing the entire</span>
        <span class="c1"># query</span>
        <span class="n">expr</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">expr</span>

    <span class="k">def</span> <span class="nf">sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dialect</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Run a SQL query against a table expression.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query</span>
<span class="sd">            Query string</span>
<span class="sd">        dialect</span>
<span class="sd">            Optional string indicating the dialect of `query`. Defaults to the</span>
<span class="sd">            backend&#39;s native dialect.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            An opaque table expression</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; from ibis import _</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch(table_name=&quot;penguins&quot;)</span>
<span class="sd">        &gt;&gt;&gt; expr = t.sql(</span>
<span class="sd">        ...     &quot;&quot;&quot;</span>
<span class="sd">        ...     SELECT island, mean(bill_length_mm) AS avg_bill_length</span>
<span class="sd">        ...     FROM penguins</span>
<span class="sd">        ...     GROUP BY 1</span>
<span class="sd">        ...     ORDER BY 2 DESC</span>
<span class="sd">        ...     &quot;&quot;&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; expr</span>
<span class="sd">        </span>
<span class="sd">         island     avg_bill_length </span>
<span class="sd">        </span>
<span class="sd">         string     float64         </span>
<span class="sd">        </span>
<span class="sd">         Biscoe           45.257485 </span>
<span class="sd">         Dream            44.167742 </span>
<span class="sd">         Torgersen        38.950980 </span>
<span class="sd">        </span>

<span class="sd">        Mix and match ibis expressions with SQL queries</span>

<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch(table_name=&quot;penguins&quot;)</span>
<span class="sd">        &gt;&gt;&gt; expr = t.sql(</span>
<span class="sd">        ...     &quot;&quot;&quot;</span>
<span class="sd">        ...     SELECT island, mean(bill_length_mm) AS avg_bill_length</span>
<span class="sd">        ...     FROM penguins</span>
<span class="sd">        ...     GROUP BY 1</span>
<span class="sd">        ...     ORDER BY 2 DESC</span>
<span class="sd">        ...     &quot;&quot;&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; expr = expr.mutate(</span>
<span class="sd">        ...     island=_.island.lower(),</span>
<span class="sd">        ...     avg_bill_length=_.avg_bill_length.round(1),</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; expr</span>
<span class="sd">        </span>
<span class="sd">         island     avg_bill_length </span>
<span class="sd">        </span>
<span class="sd">         string     float64         </span>
<span class="sd">        </span>
<span class="sd">         biscoe                45.3 </span>
<span class="sd">         dream                 44.2 </span>
<span class="sd">         torgersen             39.0 </span>
<span class="sd">        </span>

<span class="sd">        Because ibis expressions aren&#39;t named, they aren&#39;t visible to</span>
<span class="sd">        subsequent `.sql` calls. Use the [`alias`][ibis.expr.types.relations.Table.alias] method</span>
<span class="sd">        to assign a name to an expression.</span>

<span class="sd">        &gt;&gt;&gt; expr.alias(&quot;b&quot;).sql(&quot;SELECT * FROM b WHERE avg_bill_length &gt; 40&quot;)</span>
<span class="sd">        </span>
<span class="sd">         island  avg_bill_length </span>
<span class="sd">        </span>
<span class="sd">         string  float64         </span>
<span class="sd">        </span>
<span class="sd">         biscoe             45.3 </span>
<span class="sd">         dream              44.2 </span>
<span class="sd">        </span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        [`Table.alias`][ibis.expr.types.relations.Table.alias]</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># only transpile if dialect was passed</span>
        <span class="k">if</span> <span class="n">dialect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_backend</span><span class="p">()</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">_transpile_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="n">dialect</span><span class="p">)</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">SQLStringView</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">_ALIASES</span><span class="p">),</span> <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a table expression to a pandas DataFrame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs</span>
<span class="sd">            Same as keyword arguments to [`execute`][ibis.expr.types.core.Expr.execute]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cache the provided expression.</span>

<span class="sd">        All subsequent operations on the returned expression will be performed</span>
<span class="sd">        on the cached data. Use the</span>
<span class="sd">        [`with`](https://docs.python.org/3/reference/compound_stmts.html#with)</span>
<span class="sd">        statement to limit the lifetime of a cached table.</span>

<span class="sd">        This method is idempotent: calling it multiple times in succession will</span>
<span class="sd">        return the same value as the first call.</span>

<span class="sd">        !!! note &quot;This method eagerly evaluates the expression prior to caching&quot;</span>

<span class="sd">            Subsequent evaluations will not recompute the expression so method</span>
<span class="sd">            chaining will not incur the overhead of caching more than once.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Cached table</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">        &gt;&gt;&gt; cached_penguins = t.mutate(computation=&quot;Heavy Computation&quot;).cache()</span>
<span class="sd">        &gt;&gt;&gt; cached_penguins</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">         Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">         Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">         Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">         Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">         Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                           </span>
<span class="sd">        </span>

<span class="sd">        Explicit cache cleanup</span>

<span class="sd">        &gt;&gt;&gt; with t.mutate(computation=&quot;Heavy Computation&quot;).cache() as cached_penguins:</span>
<span class="sd">        ...     cached_penguins</span>
<span class="sd">        </span>
<span class="sd">         species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">        </span>
<span class="sd">         string   string     float64         float64        int64               </span>
<span class="sd">        </span>
<span class="sd">         Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">         Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">         Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">         Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">         Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">         Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">         Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">         Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">         Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">         Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                           </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_backend</span><span class="p">(</span><span class="n">use_default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">current_backend</span><span class="o">.</span><span class="n">_cached</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pivot_longer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">names_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
        <span class="n">names_pattern</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">Pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;(.+)&quot;</span><span class="p">,</span>
        <span class="n">names_transform</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">]</span>
        <span class="o">|</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">]]</span>
        <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">values_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span>
        <span class="n">values_transform</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">],</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">]</span> <span class="o">|</span> <span class="n">Deferred</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform a table from wider to longer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col</span>
<span class="sd">            String column name or selector.</span>
<span class="sd">        names_to</span>
<span class="sd">            A string or iterable of strings indicating how to name the new</span>
<span class="sd">            pivoted columns.</span>
<span class="sd">        names_pattern</span>
<span class="sd">            Pattern to use to extract column names from the input. By default</span>
<span class="sd">            the entire column name is extracted.</span>
<span class="sd">        names_transform</span>
<span class="sd">            Function or mapping of a name in `names_to` to a function to</span>
<span class="sd">            transform a column name to a value.</span>
<span class="sd">        values_to</span>
<span class="sd">            Name of the pivoted value column.</span>
<span class="sd">        values_transform</span>
<span class="sd">            Apply a function to the value column. This can be a lambda or</span>
<span class="sd">            deferred expression.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Pivoted table</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Basic usage</span>

<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">        &gt;&gt;&gt; from ibis import _</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">        &gt;&gt;&gt; relig_income = ibis.examples.relig_income_raw.fetch()</span>
<span class="sd">        &gt;&gt;&gt; relig_income</span>
<span class="sd">        </span>
<span class="sd">         religion                 &lt;$10k  $10-20k  $20-30k  $30-40k  $40-50k   </span>
<span class="sd">        </span>
<span class="sd">         string                   int64  int64    int64    int64    int64     </span>
<span class="sd">        </span>
<span class="sd">         Agnostic                    27       34       60       81       76   </span>
<span class="sd">         Atheist                     12       27       37       52       35   </span>
<span class="sd">         Buddhist                    27       21       30       34       33   </span>
<span class="sd">         Catholic                   418      617      732      670      638   </span>
<span class="sd">         Dont know/refused          15       14       15       11       10   </span>
<span class="sd">         Evangelical Prot           575      869     1064      982      881   </span>
<span class="sd">         Hindu                        1        9        7        9       11   </span>
<span class="sd">         Historically Black Prot    228      244      236      238      197   </span>
<span class="sd">         Jehovah&#39;s Witness           20       27       24       24       21   </span>
<span class="sd">         Jewish                      19       19       25       25       30   </span>
<span class="sd">                                                                        </span>
<span class="sd">        </span>

<span class="sd">        Here we convert column names not matching the selector for the `religion` column</span>
<span class="sd">        and convert those names into values</span>

<span class="sd">        &gt;&gt;&gt; relig_income.pivot_longer(~s.c(&quot;religion&quot;), names_to=&quot;income&quot;, values_to=&quot;count&quot;)</span>
<span class="sd">        </span>
<span class="sd">         religion  income              count </span>
<span class="sd">        </span>
<span class="sd">         string    string              int64 </span>
<span class="sd">        </span>
<span class="sd">         Agnostic  &lt;$10k                  27 </span>
<span class="sd">         Agnostic  $10-20k                34 </span>
<span class="sd">         Agnostic  $20-30k                60 </span>
<span class="sd">         Agnostic  $30-40k                81 </span>
<span class="sd">         Agnostic  $40-50k                76 </span>
<span class="sd">         Agnostic  $50-75k               137 </span>
<span class="sd">         Agnostic  $75-100k              122 </span>
<span class="sd">         Agnostic  $100-150k             109 </span>
<span class="sd">         Agnostic  &gt;150k                  84 </span>
<span class="sd">         Agnostic  Don&#39;t know/refused     96 </span>
<span class="sd">                                          </span>
<span class="sd">        </span>

<span class="sd">        Similarly for a different example dataset, we convert names to values</span>
<span class="sd">        but using a different selector and the default `values_to` value.</span>

<span class="sd">        &gt;&gt;&gt; world_bank_pop = ibis.examples.world_bank_pop_raw.fetch()</span>
<span class="sd">        &gt;&gt;&gt; world_bank_pop.head()</span>
<span class="sd">        </span>
<span class="sd">         country  indicator    2000          2001          2002           </span>
<span class="sd">        </span>
<span class="sd">         string   string       float64       float64       float64        </span>
<span class="sd">        </span>
<span class="sd">         ABW      SP.URB.TOTL  4.244400e+04  4.304800e+04  4.367000e+04   </span>
<span class="sd">         ABW      SP.URB.GROW  1.182632e+00  1.413021e+00  1.434560e+00   </span>
<span class="sd">         ABW      SP.POP.TOTL  9.085300e+04  9.289800e+04  9.499200e+04   </span>
<span class="sd">         ABW      SP.POP.GROW  2.055027e+00  2.225930e+00  2.229056e+00   </span>
<span class="sd">         AFG      SP.URB.TOTL  4.436299e+06  4.648055e+06  4.892951e+06   </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; world_bank_pop.pivot_longer(s.matches(r&quot;\\d{4}&quot;), names_to=&quot;year&quot;).head()</span>
<span class="sd">        </span>
<span class="sd">         country  indicator    year    value   </span>
<span class="sd">        </span>
<span class="sd">         string   string       string  float64 </span>
<span class="sd">        </span>
<span class="sd">         ABW      SP.URB.TOTL  2000    42444.0 </span>
<span class="sd">         ABW      SP.URB.TOTL  2001    43048.0 </span>
<span class="sd">         ABW      SP.URB.TOTL  2002    43670.0 </span>
<span class="sd">         ABW      SP.URB.TOTL  2003    44246.0 </span>
<span class="sd">         ABW      SP.URB.TOTL  2004    44669.0 </span>
<span class="sd">        </span>

<span class="sd">        `pivot_longer` has some preprocessing capabiltiies like stripping a prefix and applying</span>
<span class="sd">        a function to column names</span>

<span class="sd">        &gt;&gt;&gt; billboard = ibis.examples.billboard.fetch()</span>
<span class="sd">        &gt;&gt;&gt; billboard</span>
<span class="sd">        </span>
<span class="sd">         artist          track                    date_entered  wk1    wk2     </span>
<span class="sd">        </span>
<span class="sd">         string          string                   date          int64  int64   </span>
<span class="sd">        </span>
<span class="sd">         2 Pac           Baby Don&#39;t Cry (Keep...  2000-02-26       87     82   </span>
<span class="sd">         2Ge+her         The Hardest Part Of ...  2000-09-02       91     87   </span>
<span class="sd">         3 Doors Down    Kryptonite               2000-04-08       81     70   </span>
<span class="sd">         3 Doors Down    Loser                    2000-10-21       76     76   </span>
<span class="sd">         504 Boyz        Wobble Wobble            2000-04-15       57     34   </span>
<span class="sd">         98^0            Give Me Just One Nig...  2000-08-19       51     39   </span>
<span class="sd">         A*Teens         Dancing Queen            2000-07-08       97     97   </span>
<span class="sd">         Aaliyah         I Don&#39;t Wanna            2000-01-29       84     62   </span>
<span class="sd">         Aaliyah         Try Again                2000-03-18       59     53   </span>
<span class="sd">         Adams, Yolanda  Open My Heart            2000-08-26       76     76   </span>
<span class="sd">                                                                          </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; billboard.pivot_longer(</span>
<span class="sd">        ...     s.startswith(&quot;wk&quot;),</span>
<span class="sd">        ...     names_to=&quot;week&quot;,</span>
<span class="sd">        ...     names_pattern=r&quot;wk(.+)&quot;,</span>
<span class="sd">        ...     names_transform=int,</span>
<span class="sd">        ...     values_to=&quot;rank&quot;,</span>
<span class="sd">        ...     values_transform=_.cast(&quot;int&quot;),</span>
<span class="sd">        ... ).dropna(&quot;rank&quot;)</span>
<span class="sd">        </span>
<span class="sd">         artist   track                    date_entered  week  rank  </span>
<span class="sd">        </span>
<span class="sd">         string   string                   date          int8  int64 </span>
<span class="sd">        </span>
<span class="sd">         2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       1     87 </span>
<span class="sd">         2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       2     82 </span>
<span class="sd">         2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       3     72 </span>
<span class="sd">         2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       4     77 </span>
<span class="sd">         2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       5     87 </span>
<span class="sd">         2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       6     94 </span>
<span class="sd">         2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       7     99 </span>
<span class="sd">         2Ge+her  The Hardest Part Of ...  2000-09-02       1     91 </span>
<span class="sd">         2Ge+her  The Hardest Part Of ...  2000-09-02       2     87 </span>
<span class="sd">         2Ge+her  The Hardest Part Of ...  2000-09-02       3     92 </span>
<span class="sd">                                                                </span>
<span class="sd">        </span>

<span class="sd">        You can use regular expression capture groups to extract multiple</span>
<span class="sd">        variables stored in column names</span>

<span class="sd">        &gt;&gt;&gt; who = ibis.examples.who.fetch()</span>
<span class="sd">        &gt;&gt;&gt; who</span>
<span class="sd">        </span>
<span class="sd">         country      iso2    iso3    year   new_sp_m014  new_sp_m1524   </span>
<span class="sd">        </span>
<span class="sd">         string       string  string  int64  int64        int64          </span>
<span class="sd">        </span>
<span class="sd">         Afghanistan  AF      AFG      1980         NULL          NULL   </span>
<span class="sd">         Afghanistan  AF      AFG      1981         NULL          NULL   </span>
<span class="sd">         Afghanistan  AF      AFG      1982         NULL          NULL   </span>
<span class="sd">         Afghanistan  AF      AFG      1983         NULL          NULL   </span>
<span class="sd">         Afghanistan  AF      AFG      1984         NULL          NULL   </span>
<span class="sd">         Afghanistan  AF      AFG      1985         NULL          NULL   </span>
<span class="sd">         Afghanistan  AF      AFG      1986         NULL          NULL   </span>
<span class="sd">         Afghanistan  AF      AFG      1987         NULL          NULL   </span>
<span class="sd">         Afghanistan  AF      AFG      1988         NULL          NULL   </span>
<span class="sd">         Afghanistan  AF      AFG      1989         NULL          NULL   </span>
<span class="sd">                                                                   </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; len(who.columns)</span>
<span class="sd">        60</span>
<span class="sd">        &gt;&gt;&gt; who.pivot_longer(</span>
<span class="sd">        ...     s.r[&quot;new_sp_m014&quot;:&quot;newrel_f65&quot;],</span>
<span class="sd">        ...     names_to=[&quot;diagnosis&quot;, &quot;gender&quot;, &quot;age&quot;],</span>
<span class="sd">        ...     names_pattern=&quot;new_?(.*)_(.)(.*)&quot;,</span>
<span class="sd">        ...     values_to=&quot;count&quot;,</span>
<span class="sd">        ... )</span>
<span class="sd">        </span>
<span class="sd">         country      iso2    iso3    year   diagnosis  gender  age     count </span>
<span class="sd">        </span>
<span class="sd">         string       string  string  int64  string     string  string  int64 </span>
<span class="sd">        </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp         m       014      NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp         m       1524     NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp         m       2534     NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp         m       3544     NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp         m       4554     NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp         m       5564     NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp         m       65       NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp         f       014      NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp         f       1524     NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp         f       2534     NULL </span>
<span class="sd">                                                                      </span>
<span class="sd">        </span>

<span class="sd">        `names_transform` is flexible, and can be:</span>

<span class="sd">            1. A mapping of one or more names in `names_to` to callable</span>
<span class="sd">            2. A callable that will be applied to every name</span>

<span class="sd">        Let&#39;s recode gender and age to numeric values using a mapping</span>

<span class="sd">        &gt;&gt;&gt; who.pivot_longer(</span>
<span class="sd">        ...     s.r[&quot;new_sp_m014&quot;:&quot;newrel_f65&quot;],</span>
<span class="sd">        ...     names_to=[&quot;diagnosis&quot;, &quot;gender&quot;, &quot;age&quot;],</span>
<span class="sd">        ...     names_pattern=&quot;new_?(.*)_(.)(.*)&quot;,</span>
<span class="sd">        ...     names_transform=dict(</span>
<span class="sd">        ...         gender={&quot;m&quot;: 1, &quot;f&quot;: 2}.get,</span>
<span class="sd">        ...         age=dict(zip([&quot;014&quot;, &quot;1524&quot;, &quot;2534&quot;, &quot;3544&quot;, &quot;4554&quot;, &quot;5564&quot;, &quot;65&quot;], range(7))).get,</span>
<span class="sd">        ...     ),</span>
<span class="sd">        ...     values_to=&quot;count&quot;,</span>
<span class="sd">        ... )</span>
<span class="sd">        </span>
<span class="sd">         country      iso2    iso3    year   diagnosis  gender  age   count </span>
<span class="sd">        </span>
<span class="sd">         string       string  string  int64  string     int8    int8  int64 </span>
<span class="sd">        </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp              1     0   NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp              1     1   NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp              1     2   NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp              1     3   NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp              1     4   NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp              1     5   NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp              1     6   NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp              2     0   NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp              2     1   NULL </span>
<span class="sd">         Afghanistan  AF      AFG      1980  sp              2     2   NULL </span>
<span class="sd">                                                                    </span>
<span class="sd">        </span>

<span class="sd">        The number of match groups in `names_pattern` must match the length of `names_to`</span>

<span class="sd">        &gt;&gt;&gt; who.pivot_longer(</span>
<span class="sd">        ...     s.r[&quot;new_sp_m014&quot;:&quot;newrel_f65&quot;],</span>
<span class="sd">        ...     names_to=[&quot;diagnosis&quot;, &quot;gender&quot;, &quot;age&quot;],</span>
<span class="sd">        ...     names_pattern=&quot;new_?(.*)_.(.*)&quot;,</span>
<span class="sd">        ... )</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">          ...</span>
<span class="sd">        ibis.common.exceptions.IbisInputError: Number of match groups in `names_pattern` ...</span>

<span class="sd">        `names_transform` must be a mapping or callable</span>

<span class="sd">        &gt;&gt;&gt; who.pivot_longer(s.r[&quot;new_sp_m014&quot;:&quot;newrel_f65&quot;], names_transform=&quot;upper&quot;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">          ...</span>
<span class="sd">        ibis.common.exceptions.IbisTypeError: ... Got &lt;class &#39;str&#39;&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>

        <span class="n">pivot_sel</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">col</span>

        <span class="n">pivot_cols</span> <span class="o">=</span> <span class="n">pivot_sel</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pivot_cols</span><span class="p">:</span>
            <span class="c1"># TODO: improve the repr of selectors</span>
            <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisInputError</span><span class="p">(</span><span class="s2">&quot;Selector returned no columns to pivot on&quot;</span><span class="p">)</span>

        <span class="n">names_to</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">names_to</span><span class="p">)</span>

        <span class="n">names_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">names_pattern</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ngroups</span> <span class="o">:=</span> <span class="n">names_pattern</span><span class="o">.</span><span class="n">groups</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">nnames</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names_to</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisInputError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of match groups in `names_pattern`&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">names_pattern</span><span class="o">.</span><span class="n">pattern</span><span class="si">!r}</span><span class="s2"> (</span><span class="si">{</span><span class="n">ngroups</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"> groups) doesn&#39;t &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;match the length of `names_to` </span><span class="si">{</span><span class="n">names_to</span><span class="si">}</span><span class="s2"> (length </span><span class="si">{</span><span class="n">nnames</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">names_transform</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">names_transform</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">names_to</span><span class="p">,</span> <span class="n">toolz</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">names_transform</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">names_transform</span><span class="p">):</span>
                <span class="n">names_transform</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">names_to</span><span class="p">,</span> <span class="n">names_transform</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;`names_transform` must be a mapping or callable. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">names_transform</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_to</span><span class="p">:</span>
            <span class="n">names_transform</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">toolz</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">values_transform</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">values_transform</span> <span class="o">=</span> <span class="n">toolz</span><span class="o">.</span><span class="n">identity</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_transform</span><span class="p">,</span> <span class="n">Deferred</span><span class="p">):</span>
            <span class="n">values_transform</span> <span class="o">=</span> <span class="n">values_transform</span><span class="o">.</span><span class="n">resolve</span>

        <span class="n">pieces</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">pivot_col</span> <span class="ow">in</span> <span class="n">pivot_cols</span><span class="p">:</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">pivot_col</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
            <span class="n">match_result</span> <span class="o">=</span> <span class="n">names_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">name</span><span class="p">:</span> <span class="n">names_transform</span><span class="p">[</span><span class="n">name</span><span class="p">](</span><span class="n">value</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names_to</span><span class="p">,</span> <span class="n">match_result</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>
            <span class="p">}</span>
            <span class="n">row</span><span class="p">[</span><span class="n">values_to</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_transform</span><span class="p">(</span><span class="n">pivot_col</span><span class="p">)</span>
            <span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ibis</span><span class="o">.</span><span class="n">struct</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>

        <span class="c1"># nest into an array of structs to zip unnests together</span>
        <span class="n">pieces</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">~</span><span class="n">pivot_sel</span><span class="p">,</span> <span class="n">__pivoted__</span><span class="o">=</span><span class="n">pieces</span><span class="o">.</span><span class="n">unnest</span><span class="p">())</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span>
            <span class="s2">&quot;__pivoted__&quot;</span>
        <span class="p">)</span>

    <span class="nd">@util</span><span class="o">.</span><span class="n">experimental</span>
    <span class="k">def</span> <span class="nf">pivot_wider</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">id_cols</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">names_from</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
        <span class="n">names_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">names_sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span>
        <span class="n">names_sort</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">names</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">values_from</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span>
        <span class="n">values_fill</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Scalar</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">values_agg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">],</span> <span class="n">ir</span><span class="o">.</span><span class="n">Scalar</span><span class="p">]</span> <span class="o">|</span> <span class="n">Deferred</span> <span class="o">=</span> <span class="s2">&quot;arbitrary&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pivot a table to a wider format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        id_cols</span>
<span class="sd">            A set of columns that uniquely identify each observation.</span>
<span class="sd">        names_from</span>
<span class="sd">            An argument describing which column or columns to use to get the</span>
<span class="sd">            name of the output columns.</span>
<span class="sd">        names_prefix</span>
<span class="sd">            String added to the start of every column name.</span>
<span class="sd">        names_sep</span>
<span class="sd">            If `names_from` or `values_from` contains multiple columns, this</span>
<span class="sd">            argument will be used to join their values together into a single</span>
<span class="sd">            string to use as a column name.</span>
<span class="sd">        names_sort</span>
<span class="sd">            If [`True`][True] columns are sorted. If [`False`][False] column</span>
<span class="sd">            names are ordered by appearance.</span>
<span class="sd">        names</span>
<span class="sd">            An explicit sequence of values to look for in columns matching</span>
<span class="sd">            `names_from`.</span>

<span class="sd">            * When this value is `None`, the values will be computed from</span>
<span class="sd">              `names_from`.</span>
<span class="sd">            * When this value is not `None`, each element&#39;s length must match</span>
<span class="sd">              the length of `names_from`.</span>

<span class="sd">            See examples below for more detail.</span>
<span class="sd">        values_from</span>
<span class="sd">            An argument describing which column or columns to get the cell</span>
<span class="sd">            values from.</span>
<span class="sd">        values_fill</span>
<span class="sd">            A scalar value that specifies what each value should be filled with</span>
<span class="sd">            when missing.</span>
<span class="sd">        values_agg</span>
<span class="sd">            A function applied to the value in each cell in the output.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            Wider pivoted table</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">        &gt;&gt;&gt; from ibis import _</span>
<span class="sd">        &gt;&gt;&gt; ibis.options.interactive = True</span>

<span class="sd">        Basic usage</span>

<span class="sd">        &gt;&gt;&gt; fish_encounters = ibis.examples.fish_encounters.fetch()</span>
<span class="sd">        &gt;&gt;&gt; fish_encounters</span>
<span class="sd">        </span>
<span class="sd">         fish   station  seen  </span>
<span class="sd">        </span>
<span class="sd">         int64  string   int64 </span>
<span class="sd">        </span>
<span class="sd">          4842  Release      1 </span>
<span class="sd">          4842  I80_1        1 </span>
<span class="sd">          4842  Lisbon       1 </span>
<span class="sd">          4842  Rstr         1 </span>
<span class="sd">          4842  Base_TD      1 </span>
<span class="sd">          4842  BCE          1 </span>
<span class="sd">          4842  BCW          1 </span>
<span class="sd">          4842  BCE2         1 </span>
<span class="sd">          4842  BCW2         1 </span>
<span class="sd">          4842  MAE          1 </span>
<span class="sd">                            </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; fish_encounters.pivot_wider(names_from=&quot;station&quot;, values_from=&quot;seen&quot;)</span>
<span class="sd">        </span>
<span class="sd">         fish   Release  I80_1  Lisbon  Rstr   Base_TD  BCE    BCW     </span>
<span class="sd">        </span>
<span class="sd">         int64  int64    int64  int64   int64  int64    int64  int64   </span>
<span class="sd">        </span>
<span class="sd">          4842        1      1       1      1        1      1      1   </span>
<span class="sd">          4843        1      1       1      1        1      1      1   </span>
<span class="sd">          4844        1      1       1      1        1      1      1   </span>
<span class="sd">          4845        1      1       1      1        1   NULL   NULL   </span>
<span class="sd">          4847        1      1       1   NULL     NULL   NULL   NULL   </span>
<span class="sd">          4848        1      1       1      1     NULL   NULL   NULL   </span>
<span class="sd">          4849        1      1    NULL   NULL     NULL   NULL   NULL   </span>
<span class="sd">          4850        1      1    NULL      1        1      1      1   </span>
<span class="sd">          4851        1      1    NULL   NULL     NULL   NULL   NULL   </span>
<span class="sd">          4854        1      1    NULL   NULL     NULL   NULL   NULL   </span>
<span class="sd">                                                               </span>
<span class="sd">        </span>

<span class="sd">        Fill missing pivoted values using `values_fill`</span>

<span class="sd">        &gt;&gt;&gt; fish_encounters.pivot_wider(names_from=&quot;station&quot;, values_from=&quot;seen&quot;, values_fill=0)</span>
<span class="sd">        </span>
<span class="sd">         fish   Release  I80_1  Lisbon  Rstr   Base_TD  BCE    BCW     </span>
<span class="sd">        </span>
<span class="sd">         int64  int64    int64  int64   int64  int64    int64  int64   </span>
<span class="sd">        </span>
<span class="sd">          4842        1      1       1      1        1      1      1   </span>
<span class="sd">          4843        1      1       1      1        1      1      1   </span>
<span class="sd">          4844        1      1       1      1        1      1      1   </span>
<span class="sd">          4845        1      1       1      1        1      0      0   </span>
<span class="sd">          4847        1      1       1      0        0      0      0   </span>
<span class="sd">          4848        1      1       1      1        0      0      0   </span>
<span class="sd">          4849        1      1       0      0        0      0      0   </span>
<span class="sd">          4850        1      1       0      1        1      1      1   </span>
<span class="sd">          4851        1      1       0      0        0      0      0   </span>
<span class="sd">          4854        1      1       0      0        0      0      0   </span>
<span class="sd">                                                               </span>
<span class="sd">        </span>

<span class="sd">        Compute multiple values columns</span>

<span class="sd">        &gt;&gt;&gt; us_rent_income = ibis.examples.us_rent_income.fetch()</span>
<span class="sd">        &gt;&gt;&gt; us_rent_income</span>
<span class="sd">        </span>
<span class="sd">         geoid   name        variable  estimate  moe   </span>
<span class="sd">        </span>
<span class="sd">         string  string      string    int64     int64 </span>
<span class="sd">        </span>
<span class="sd">         01      Alabama     income       24476    136 </span>
<span class="sd">         01      Alabama     rent           747      3 </span>
<span class="sd">         02      Alaska      income       32940    508 </span>
<span class="sd">         02      Alaska      rent          1200     13 </span>
<span class="sd">         04      Arizona     income       27517    148 </span>
<span class="sd">         04      Arizona     rent           972      4 </span>
<span class="sd">         05      Arkansas    income       23789    165 </span>
<span class="sd">         05      Arkansas    rent           709      5 </span>
<span class="sd">         06      California  income       29454    109 </span>
<span class="sd">         06      California  rent          1358      3 </span>
<span class="sd">                                                  </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; us_rent_income.pivot_wider(names_from=&quot;variable&quot;, values_from=[&quot;estimate&quot;, &quot;moe&quot;])</span>
<span class="sd">        </span>
<span class="sd">         geoid   name                  estimate_income  moe_income   </span>
<span class="sd">        </span>
<span class="sd">         string  string                int64            int64        </span>
<span class="sd">        </span>
<span class="sd">         01      Alabama                         24476         136   </span>
<span class="sd">         02      Alaska                          32940         508   </span>
<span class="sd">         04      Arizona                         27517         148   </span>
<span class="sd">         05      Arkansas                        23789         165   </span>
<span class="sd">         06      California                      29454         109   </span>
<span class="sd">         08      Colorado                        32401         109   </span>
<span class="sd">         09      Connecticut                     35326         195   </span>
<span class="sd">         10      Delaware                        31560         247   </span>
<span class="sd">         11      District of Columbia            43198         681   </span>
<span class="sd">         12      Florida                         25952          70   </span>
<span class="sd">                                                                 </span>
<span class="sd">        </span>

<span class="sd">        The column name separator can be changed using the `names_sep` parameter</span>

<span class="sd">        &gt;&gt;&gt; us_rent_income.pivot_wider(</span>
<span class="sd">        ...     names_from=&quot;variable&quot;,</span>
<span class="sd">        ...     names_sep=&quot;.&quot;,</span>
<span class="sd">        ...     values_from=s.c(&quot;estimate&quot;, &quot;moe&quot;),</span>
<span class="sd">        ... )</span>
<span class="sd">        </span>
<span class="sd">         geoid   name                  estimate.income  moe.income   </span>
<span class="sd">        </span>
<span class="sd">         string  string                int64            int64        </span>
<span class="sd">        </span>
<span class="sd">         01      Alabama                         24476         136   </span>
<span class="sd">         02      Alaska                          32940         508   </span>
<span class="sd">         04      Arizona                         27517         148   </span>
<span class="sd">         05      Arkansas                        23789         165   </span>
<span class="sd">         06      California                      29454         109   </span>
<span class="sd">         08      Colorado                        32401         109   </span>
<span class="sd">         09      Connecticut                     35326         195   </span>
<span class="sd">         10      Delaware                        31560         247   </span>
<span class="sd">         11      District of Columbia            43198         681   </span>
<span class="sd">         12      Florida                         25952          70   </span>
<span class="sd">                                                                 </span>
<span class="sd">        </span>

<span class="sd">        Supply an alternative function to summarize values</span>

<span class="sd">        &gt;&gt;&gt; warpbreaks = ibis.examples.warpbreaks.fetch().select(&quot;wool&quot;, &quot;tension&quot;, &quot;breaks&quot;)</span>
<span class="sd">        &gt;&gt;&gt; warpbreaks</span>
<span class="sd">        </span>
<span class="sd">         wool    tension  breaks </span>
<span class="sd">        </span>
<span class="sd">         string  string   int64  </span>
<span class="sd">        </span>
<span class="sd">         A       L            26 </span>
<span class="sd">         A       L            30 </span>
<span class="sd">         A       L            54 </span>
<span class="sd">         A       L            25 </span>
<span class="sd">         A       L            70 </span>
<span class="sd">         A       L            52 </span>
<span class="sd">         A       L            51 </span>
<span class="sd">         A       L            26 </span>
<span class="sd">         A       L            67 </span>
<span class="sd">         A       M            18 </span>
<span class="sd">                              </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; warpbreaks.pivot_wider(names_from=&quot;wool&quot;, values_from=&quot;breaks&quot;, values_agg=&quot;mean&quot;)</span>
<span class="sd">        </span>
<span class="sd">         tension  A          B         </span>
<span class="sd">        </span>
<span class="sd">         string   float64    float64   </span>
<span class="sd">        </span>
<span class="sd">         L        44.555556  28.222222 </span>
<span class="sd">         M        24.000000  28.777778 </span>
<span class="sd">         H        24.555556  18.777778 </span>
<span class="sd">        </span>

<span class="sd">        Passing `Deferred` objects to `values_agg` is supported</span>

<span class="sd">        &gt;&gt;&gt; warpbreaks.pivot_wider(</span>
<span class="sd">        ...     names_from=&quot;tension&quot;,</span>
<span class="sd">        ...     values_from=&quot;breaks&quot;,</span>
<span class="sd">        ...     values_agg=_.sum(),</span>
<span class="sd">        ... )</span>
<span class="sd">        </span>
<span class="sd">         wool    L      M      H     </span>
<span class="sd">        </span>
<span class="sd">         string  int64  int64  int64 </span>
<span class="sd">        </span>
<span class="sd">         A         401    216    221 </span>
<span class="sd">         B         254    259    169 </span>
<span class="sd">        </span>

<span class="sd">        Use a custom aggregate function</span>

<span class="sd">        &gt;&gt;&gt; warpbreaks.pivot_wider(</span>
<span class="sd">        ...     names_from=&quot;wool&quot;,</span>
<span class="sd">        ...     values_from=&quot;breaks&quot;,</span>
<span class="sd">        ...     values_agg=lambda col: col.std() / col.mean(),</span>
<span class="sd">        ... )</span>
<span class="sd">        </span>
<span class="sd">         tension  A         B        </span>
<span class="sd">        </span>
<span class="sd">         string   float64   float64  </span>
<span class="sd">        </span>
<span class="sd">         L        0.406183  0.349325 </span>
<span class="sd">         M        0.360844  0.327719 </span>
<span class="sd">         H        0.418344  0.260590 </span>
<span class="sd">        </span>

<span class="sd">        Generate some random data, setting the random seed for reproducibility</span>

<span class="sd">        &gt;&gt;&gt; import random</span>
<span class="sd">        &gt;&gt;&gt; random.seed(0)</span>
<span class="sd">        &gt;&gt;&gt; raw = ibis.memtable(</span>
<span class="sd">        ...     [</span>
<span class="sd">        ...         dict(</span>
<span class="sd">        ...             product=product,</span>
<span class="sd">        ...             country=country,</span>
<span class="sd">        ...             year=year,</span>
<span class="sd">        ...             production=random.random(),</span>
<span class="sd">        ...         )</span>
<span class="sd">        ...         for product in &quot;AB&quot;</span>
<span class="sd">        ...         for country in [&quot;AI&quot;, &quot;EI&quot;]</span>
<span class="sd">        ...         for year in range(2000, 2015)</span>
<span class="sd">        ...     ]</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; production = raw.filter(</span>
<span class="sd">        ...     ((_.product == &quot;A&quot;) &amp; (_.country == &quot;AI&quot;)) | (_.product == &quot;B&quot;)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; production</span>
<span class="sd">        </span>
<span class="sd">         product  country  year   production </span>
<span class="sd">        </span>
<span class="sd">         string   string   int64  float64    </span>
<span class="sd">        </span>
<span class="sd">         B        AI        2000    0.477010 </span>
<span class="sd">         B        AI        2001    0.865310 </span>
<span class="sd">         B        AI        2002    0.260492 </span>
<span class="sd">         B        AI        2003    0.805028 </span>
<span class="sd">         B        AI        2004    0.548699 </span>
<span class="sd">         B        AI        2005    0.014042 </span>
<span class="sd">         B        AI        2006    0.719705 </span>
<span class="sd">         B        AI        2007    0.398824 </span>
<span class="sd">         B        AI        2008    0.824845 </span>
<span class="sd">         B        AI        2009    0.668153 </span>
<span class="sd">                                         </span>
<span class="sd">        </span>

<span class="sd">        Pivoting with multiple name columns</span>

<span class="sd">        &gt;&gt;&gt; production.pivot_wider(</span>
<span class="sd">        ...     names_from=[&quot;product&quot;, &quot;country&quot;],</span>
<span class="sd">        ...     values_from=&quot;production&quot;,</span>
<span class="sd">        ... )</span>
<span class="sd">        </span>
<span class="sd">         year   B_AI      B_EI      A_AI     </span>
<span class="sd">        </span>
<span class="sd">         int64  float64   float64   float64  </span>
<span class="sd">        </span>
<span class="sd">          2000  0.477010  0.870471  0.844422 </span>
<span class="sd">          2001  0.865310  0.191067  0.757954 </span>
<span class="sd">          2002  0.260492  0.567511  0.420572 </span>
<span class="sd">          2003  0.805028  0.238616  0.258917 </span>
<span class="sd">          2004  0.548699  0.967540  0.511275 </span>
<span class="sd">          2005  0.014042  0.803179  0.404934 </span>
<span class="sd">          2006  0.719705  0.447970  0.783799 </span>
<span class="sd">          2007  0.398824  0.080446  0.303313 </span>
<span class="sd">          2008  0.824845  0.320055  0.476597 </span>
<span class="sd">          2009  0.668153  0.507941  0.583382 </span>
<span class="sd">                                         </span>
<span class="sd">        </span>

<span class="sd">        Select a subset of names. This call incurs no computation when</span>
<span class="sd">        constructing the expression.</span>

<span class="sd">        &gt;&gt;&gt; production.pivot_wider(</span>
<span class="sd">        ...     names_from=[&quot;product&quot;, &quot;country&quot;],</span>
<span class="sd">        ...     names=[(&quot;A&quot;, &quot;AI&quot;), (&quot;B&quot;, &quot;AI&quot;)],</span>
<span class="sd">        ...     values_from=&quot;production&quot;,</span>
<span class="sd">        ... )</span>
<span class="sd">        </span>
<span class="sd">         year   A_AI      B_AI     </span>
<span class="sd">        </span>
<span class="sd">         int64  float64   float64  </span>
<span class="sd">        </span>
<span class="sd">          2000  0.844422  0.477010 </span>
<span class="sd">          2001  0.757954  0.865310 </span>
<span class="sd">          2002  0.420572  0.260492 </span>
<span class="sd">          2003  0.258917  0.805028 </span>
<span class="sd">          2004  0.511275  0.548699 </span>
<span class="sd">          2005  0.404934  0.014042 </span>
<span class="sd">          2006  0.783799  0.719705 </span>
<span class="sd">          2007  0.303313  0.398824 </span>
<span class="sd">          2008  0.476597  0.824845 </span>
<span class="sd">          2009  0.583382  0.668153 </span>
<span class="sd">                                </span>
<span class="sd">        </span>

<span class="sd">        Sort the new columns&#39; names</span>

<span class="sd">        &gt;&gt;&gt; production.pivot_wider(</span>
<span class="sd">        ...     names_from=[&quot;product&quot;, &quot;country&quot;],</span>
<span class="sd">        ...     values_from=&quot;production&quot;,</span>
<span class="sd">        ...     names_sort=True,</span>
<span class="sd">        ... )</span>
<span class="sd">        </span>
<span class="sd">         year   A_AI      B_AI      B_EI     </span>
<span class="sd">        </span>
<span class="sd">         int64  float64   float64   float64  </span>
<span class="sd">        </span>
<span class="sd">          2000  0.844422  0.477010  0.870471 </span>
<span class="sd">          2001  0.757954  0.865310  0.191067 </span>
<span class="sd">          2002  0.420572  0.260492  0.567511 </span>
<span class="sd">          2003  0.258917  0.805028  0.238616 </span>
<span class="sd">          2004  0.511275  0.548699  0.967540 </span>
<span class="sd">          2005  0.404934  0.014042  0.803179 </span>
<span class="sd">          2006  0.783799  0.719705  0.447970 </span>
<span class="sd">          2007  0.303313  0.398824  0.080446 </span>
<span class="sd">          2008  0.476597  0.824845  0.320055 </span>
<span class="sd">          2009  0.583382  0.668153  0.507941 </span>
<span class="sd">                                         </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
        <span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
        <span class="kn">import</span> <span class="nn">ibis.expr.analysis</span> <span class="k">as</span> <span class="nn">an</span>
        <span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">_</span>

        <span class="n">orig_names_from</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">names_from</span><span class="p">)</span>

        <span class="n">names_from</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">any_of</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">_to_selector</span><span class="p">,</span> <span class="n">orig_names_from</span><span class="p">))</span>
        <span class="n">values_from</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">any_of</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">_to_selector</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">values_from</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">id_cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">id_cols</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">names_from</span> <span class="o">|</span> <span class="n">values_from</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">id_cols</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">_to_selector</span><span class="p">(</span><span class="n">id_cols</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_agg</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">values_agg</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">methodcaller</span><span class="p">(</span><span class="n">values_agg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_agg</span><span class="p">,</span> <span class="n">Deferred</span><span class="p">):</span>
            <span class="n">values_agg</span> <span class="o">=</span> <span class="n">values_agg</span><span class="o">.</span><span class="n">resolve</span>

        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># no names provided, compute them from the data</span>
            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">names_from</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">columns</span> <span class="o">:=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">names_from</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)]):</span>
                <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisInputError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No matching names columns in `names_from`: </span><span class="si">{</span><span class="n">orig_names_from</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">,</span> <span class="n">names</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">names_sort</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">names</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

        <span class="n">values_cols</span> <span class="o">=</span> <span class="n">values_from</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">more_than_one_value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
        <span class="n">aggs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">names_cols_exprs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">where</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">eq</span><span class="p">,</span> <span class="n">names_cols_exprs</span><span class="p">,</span> <span class="n">keys</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">values_col</span> <span class="ow">in</span> <span class="n">values_cols</span><span class="p">:</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="n">values_agg</span><span class="p">(</span><span class="n">values_col</span><span class="p">)</span>

                <span class="c1"># add in the where clause to filter the appropriate values</span>
                <span class="c1"># in/out</span>
                <span class="c1">#</span>
                <span class="c1"># this allows users to write the aggregate without having to deal with</span>
                <span class="c1"># the filter themselves</span>
                <span class="n">existing_aggs</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">find_toplevel_aggs</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">op</span><span class="p">())</span>
                <span class="n">subs</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">agg</span><span class="p">:</span> <span class="n">agg</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                        <span class="n">where</span><span class="o">=</span><span class="p">(</span>
                            <span class="n">where</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">existing</span> <span class="o">:=</span> <span class="n">agg</span><span class="o">.</span><span class="n">where</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="n">where</span> <span class="o">&amp;</span> <span class="n">existing</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">agg</span> <span class="ow">in</span> <span class="n">existing_aggs</span>
                <span class="p">}</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">sub_for</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">op</span><span class="p">(),</span> <span class="n">subs</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

                <span class="c1"># build the components of the group by key</span>
                <span class="n">key_components</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="c1"># user provided prefix</span>
                    <span class="n">names_prefix</span><span class="p">,</span>
                    <span class="c1"># include the `values` column name if there&#39;s more than one</span>
                    <span class="c1"># `values` column</span>
                    <span class="n">values_col</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">*</span> <span class="n">more_than_one_value</span><span class="p">,</span>
                    <span class="c1"># values computed from `names`/`names_from`</span>
                    <span class="o">*</span><span class="n">keys</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">names_sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">key_components</span><span class="p">))</span>
                <span class="n">aggs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span> <span class="k">if</span> <span class="n">values_fill</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">arg</span><span class="o">.</span><span class="n">coalesce</span><span class="p">(</span><span class="n">values_fill</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">id_cols</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="o">**</span><span class="n">aggs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">





<h3 id="ibis.expr.types.relations.Table-attributes">Attributes<a href="#ibis.expr.types.relations.Table-attributes" class="headerlink" title="Anchor link to this section for reference">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="ibis.expr.types.relations.Table.columns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#ibis.expr.types.relations.Table.columns" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>The list of columns in this table.</p>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">columns</span>
<span class="go">[&#39;species&#39;,</span>
<span class="go"> &#39;island&#39;,</span>
<span class="go"> &#39;bill_length_mm&#39;,</span>
<span class="go"> &#39;bill_depth_mm&#39;,</span>
<span class="go"> &#39;flipper_length_mm&#39;,</span>
<span class="go"> &#39;body_mass_g&#39;,</span>
<span class="go"> &#39;sex&#39;,</span>
<span class="go"> &#39;year&#39;]</span>
</code></pre></div>
  </div>

</div>

<h3 id="ibis.expr.types.relations.Table-functions">Functions<a href="#ibis.expr.types.relations.Table-functions" class="headerlink" title="Anchor link to this section for reference">&para;</a></h3>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.aggregate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">aggregate</span><span class="p">(</span><span class="n">metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">having</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.aggregate" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Aggregate a table with a given set of reductions grouping by <code>by</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>metrics</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<span title="ibis">ir</span>.<span title="ibis.Scalar">Scalar</span>] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Aggregate expressions. These can be any scalar-producing
expression, including aggregation functions like <code>sum</code> or literal
values like <code>ibis.literal(1)</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>by</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<span title="ibis">ir</span>.<span title="ibis.Value">Value</span>] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Grouping expressions.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>having</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<span title="ibis">ir</span>.<span title="ibis.BooleanValue">BooleanValue</span>] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Post-aggregation filters. The shape requirements are the same
<code>metrics</code>, but the output type for <code>having</code> is <code>boolean</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Expressions like <code>x is None</code> return <code>bool</code> and <strong>will not</strong> generate a SQL comparison to <code>NULL</code></p>
</div>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.Value">Value</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Named aggregate expressions</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An aggregate table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;fruit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">],</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> fruit   price   </span>
<span class="go"></span>
<span class="go"> string  float64 </span>
<span class="go"></span>
<span class="go"> apple      0.50 </span>
<span class="go"> apple      0.50 </span>
<span class="go"> banana     0.25 </span>
<span class="go"> orange     0.33 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fruit&quot;</span><span class="p">],</span> <span class="n">total_cost</span><span class="o">=</span><span class="n">_</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">avg_cost</span><span class="o">=</span><span class="n">_</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">having</span><span class="o">=</span><span class="n">_</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> fruit   total_cost  avg_cost </span>
<span class="go"></span>
<span class="go"> string  float64     float64  </span>
<span class="go"></span>
<span class="go"> banana        0.25      0.25 </span>
<span class="go"> orange        0.33      0.33 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Scalar</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">having</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">BooleanValue</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Aggregate a table with a given set of reductions grouping by `by`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    metrics</span>
<span class="sd">        Aggregate expressions. These can be any scalar-producing</span>
<span class="sd">        expression, including aggregation functions like `sum` or literal</span>
<span class="sd">        values like `ibis.literal(1)`.</span>
<span class="sd">    by</span>
<span class="sd">        Grouping expressions.</span>
<span class="sd">    having</span>
<span class="sd">        Post-aggregation filters. The shape requirements are the same</span>
<span class="sd">        `metrics`, but the output type for `having` is `boolean`.</span>

<span class="sd">        !!! warning &quot;Expressions like `x is None` return `bool` and **will not** generate a SQL comparison to `NULL`&quot;</span>
<span class="sd">    kwargs</span>
<span class="sd">        Named aggregate expressions</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        An aggregate table expression</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; from ibis import _</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.memtable({&quot;fruit&quot;: [&quot;apple&quot;, &quot;apple&quot;, &quot;banana&quot;, &quot;orange&quot;], &quot;price&quot;: [0.5, 0.5, 0.25, 0.33]})</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     fruit   price   </span>
<span class="sd">    </span>
<span class="sd">     string  float64 </span>
<span class="sd">    </span>
<span class="sd">     apple      0.50 </span>
<span class="sd">     apple      0.50 </span>
<span class="sd">     banana     0.25 </span>
<span class="sd">     orange     0.33 </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.aggregate(by=[&quot;fruit&quot;], total_cost=_.price.sum(), avg_cost=_.price.mean(), having=_.price.sum() &lt; 0.5)</span>
<span class="sd">    </span>
<span class="sd">     fruit   total_cost  avg_cost </span>
<span class="sd">    </span>
<span class="sd">     string  float64     float64  </span>
<span class="sd">    </span>
<span class="sd">     banana        0.25      0.25 </span>
<span class="sd">     orange        0.33      0.33 </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">ibis.expr.analysis</span> <span class="k">as</span> <span class="nn">an</span>

    <span class="n">metrics</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
        <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="p">(</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metric</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span>
                <span class="k">else</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">))</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">agg</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Aggregation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">metrics</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">metrics</span><span class="p">),</span>
        <span class="n">by</span><span class="o">=</span><span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">by</span><span class="p">)),</span>
        <span class="n">having</span><span class="o">=</span><span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">having</span><span class="p">)),</span>
    <span class="p">)</span>
    <span class="n">agg</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">simplify_aggregation</span><span class="p">(</span><span class="n">agg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">agg</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.alias" class="doc doc-heading">
<code class="highlight language-python"><span class="n">alias</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.alias" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create a table expression with a specific name <code>alias</code>.</p>
<p>This method is useful for exposing an ibis expression to the underlying
backend for use in the
<a class="autorefs autorefs-internal" href="#ibis.expr.types.relations.Table.sql"><code>Table.sql</code></a> method.</p>
<div class="admonition note">
<p class="admonition-title"><code>.alias</code> will create a temporary view</p>
<p><code>.alias</code> creates a temporary view in the database.</p>
<p>This side effect will be removed in a future version of ibis and
<strong>is not part of the public API</strong>.</p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>alias</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the child expression</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;pinginos&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM &quot;pinginos&quot; LIMIT 5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span>
<span class="go"></span>
<span class="go"> species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string   string     float64         float64        int64               </span>
<span class="go"></span>
<span class="go"> Adelie   Torgersen            39.1           18.7                181   </span>
<span class="go"> Adelie   Torgersen            39.5           17.4                186   </span>
<span class="go"> Adelie   Torgersen            40.3           18.0                195   </span>
<span class="go"> Adelie   Torgersen             nan            nan               NULL   </span>
<span class="go"> Adelie   Torgersen            36.7           19.3                193   </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">alias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a table expression with a specific name `alias`.</span>

<span class="sd">    This method is useful for exposing an ibis expression to the underlying</span>
<span class="sd">    backend for use in the</span>
<span class="sd">    [`Table.sql`][ibis.expr.types.relations.Table.sql] method.</span>

<span class="sd">    !!! note &quot;`.alias` will create a temporary view&quot;</span>

<span class="sd">        `.alias` creates a temporary view in the database.</span>

<span class="sd">        This side effect will be removed in a future version of ibis and</span>
<span class="sd">        **is not part of the public API**.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    alias</span>
<span class="sd">        Name of the child expression</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        An table expression</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; expr = t.alias(&quot;pinginos&quot;).sql(&#39;SELECT * FROM &quot;pinginos&quot; LIMIT 5&#39;)</span>
<span class="sd">    &gt;&gt;&gt; expr</span>
<span class="sd">    </span>
<span class="sd">     species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string   string     float64         float64        int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">     Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">     Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">     Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">     Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">alias</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="c1"># NB: calling compile is necessary so that any temporary views are</span>
    <span class="c1"># created so that we can infer the schema without executing the entire</span>
    <span class="c1"># query</span>
    <span class="n">expr</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">expr</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.as_table" class="doc doc-heading">
<code class="highlight language-python"><span class="n">as_table</span><span class="p">()</span></code>

<a href="#ibis.expr.types.relations.Table.as_table" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Promote the expression to a table.</p>
<p>This method is a no-op for table expressions.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">as_table</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="ow">is</span> <span class="n">s</span>
<span class="go">True</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">as_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Promote the expression to a table.</span>

<span class="sd">    This method is a no-op for table expressions.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        A table expression</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.table(dict(a=&quot;int&quot;), name=&quot;t&quot;)</span>
<span class="sd">    &gt;&gt;&gt; s = t.as_table()</span>
<span class="sd">    &gt;&gt;&gt; t is s</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.asof_join" class="doc doc-heading">
<code class="highlight language-python"><span class="n">asof_join</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">predicates</span><span class="o">=</span><span class="p">(),</span> <span class="n">by</span><span class="o">=</span><span class="p">(),</span> <span class="n">tolerance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">lname</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">rname</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{name}</span><span class="s1">_right&#39;</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.asof_join" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Perform an "as-of" join between <code>left</code> and <code>right</code>.</p>
<p>Similar to a left join except that the match is done on nearest key
rather than equal keys.</p>
<p>Optionally, match keys with <code>by</code> before joining with <code>predicates</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>left</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Table expression</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>right</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Table expression</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>predicates</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.BooleanColumn">BooleanColumn</span> | <a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.BooleanColumn">BooleanColumn</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Join expressions</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>by</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.Column">Column</span> | <a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.Column">Column</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>column to group by before joining</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>tolerance</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.IntervalScalar">IntervalScalar</span> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Amount of time to look behind when joining</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>lname</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A format string to use to rename overlapping columns in the left
table (e.g. <code>"left_{name}"</code>).</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>rname</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A format string to use to rename overlapping columns in the right
table (e.g. <code>"right_{name}"</code>).</p>
            </div>
          </td>
          <td>
                <code>&#39;{name}_right&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">asof_join</span><span class="p">(</span>
    <span class="n">left</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">right</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">predicates</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanColumn</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanColumn</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">tolerance</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">IntervalScalar</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">lname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">rname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{name}</span><span class="s2">_right&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform an &quot;as-of&quot; join between `left` and `right`.</span>

<span class="sd">    Similar to a left join except that the match is done on nearest key</span>
<span class="sd">    rather than equal keys.</span>

<span class="sd">    Optionally, match keys with `by` before joining with `predicates`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    left</span>
<span class="sd">        Table expression</span>
<span class="sd">    right</span>
<span class="sd">        Table expression</span>
<span class="sd">    predicates</span>
<span class="sd">        Join expressions</span>
<span class="sd">    by</span>
<span class="sd">        column to group by before joining</span>
<span class="sd">    tolerance</span>
<span class="sd">        Amount of time to look behind when joining</span>
<span class="sd">    lname</span>
<span class="sd">        A format string to use to rename overlapping columns in the left</span>
<span class="sd">        table (e.g. ``&quot;left_{name}&quot;``).</span>
<span class="sd">    rname</span>
<span class="sd">        A format string to use to rename overlapping columns in the right</span>
<span class="sd">        table (e.g. ``&quot;right_{name}&quot;``).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Table expression</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">AsOfJoin</span><span class="p">(</span>
        <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
        <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
        <span class="n">predicates</span><span class="o">=</span><span class="n">predicates</span><span class="p">,</span>
        <span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">,</span>
        <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">relations</span><span class="o">.</span><span class="n">_dedup_join_columns</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">to_expr</span><span class="p">(),</span> <span class="n">lname</span><span class="o">=</span><span class="n">lname</span><span class="p">,</span> <span class="n">rname</span><span class="o">=</span><span class="n">rname</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.cache" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cache</span><span class="p">()</span></code>

<a href="#ibis.expr.types.relations.Table.cache" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Cache the provided expression.</p>
<p>All subsequent operations on the returned expression will be performed
on the cached data. Use the
<a href="https://docs.python.org/3/reference/compound_stmts.html#with"><code>with</code></a>
statement to limit the lifetime of a cached table.</p>
<p>This method is idempotent: calling it multiple times in succession will
return the same value as the first call.</p>
<div class="admonition note">
<p class="admonition-title">This method eagerly evaluates the expression prior to caching</p>
<p>Subsequent evaluations will not recompute the expression so method
chaining will not incur the overhead of caching more than once.</p>
</div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cached table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cached_penguins</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">computation</span><span class="o">=</span><span class="s2">&quot;Heavy Computation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cached_penguins</span>
<span class="go"></span>
<span class="go"> species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string   string     float64         float64        int64               </span>
<span class="go"></span>
<span class="go"> Adelie   Torgersen            39.1           18.7                181   </span>
<span class="go"> Adelie   Torgersen            39.5           17.4                186   </span>
<span class="go"> Adelie   Torgersen            40.3           18.0                195   </span>
<span class="go"> Adelie   Torgersen             nan            nan               NULL   </span>
<span class="go"> Adelie   Torgersen            36.7           19.3                193   </span>
<span class="go"> Adelie   Torgersen            39.3           20.6                190   </span>
<span class="go"> Adelie   Torgersen            38.9           17.8                181   </span>
<span class="go"> Adelie   Torgersen            39.2           19.6                195   </span>
<span class="go"> Adelie   Torgersen            34.1           18.1                193   </span>
<span class="go"> Adelie   Torgersen            42.0           20.2                190   </span>
<span class="go">                                                                   </span>
<span class="go"></span>
</code></pre></div>
    <p>Explicit cache cleanup</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">t</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">computation</span><span class="o">=</span><span class="s2">&quot;Heavy Computation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span> <span class="k">as</span> <span class="n">cached_penguins</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">cached_penguins</span>
<span class="go"></span>
<span class="go"> species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string   string     float64         float64        int64               </span>
<span class="go"></span>
<span class="go"> Adelie   Torgersen            39.1           18.7                181   </span>
<span class="go"> Adelie   Torgersen            39.5           17.4                186   </span>
<span class="go"> Adelie   Torgersen            40.3           18.0                195   </span>
<span class="go"> Adelie   Torgersen             nan            nan               NULL   </span>
<span class="go"> Adelie   Torgersen            36.7           19.3                193   </span>
<span class="go"> Adelie   Torgersen            39.3           20.6                190   </span>
<span class="go"> Adelie   Torgersen            38.9           17.8                181   </span>
<span class="go"> Adelie   Torgersen            39.2           19.6                195   </span>
<span class="go"> Adelie   Torgersen            34.1           18.1                193   </span>
<span class="go"> Adelie   Torgersen            42.0           20.2                190   </span>
<span class="go">                                                                   </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cache the provided expression.</span>

<span class="sd">    All subsequent operations on the returned expression will be performed</span>
<span class="sd">    on the cached data. Use the</span>
<span class="sd">    [`with`](https://docs.python.org/3/reference/compound_stmts.html#with)</span>
<span class="sd">    statement to limit the lifetime of a cached table.</span>

<span class="sd">    This method is idempotent: calling it multiple times in succession will</span>
<span class="sd">    return the same value as the first call.</span>

<span class="sd">    !!! note &quot;This method eagerly evaluates the expression prior to caching&quot;</span>

<span class="sd">        Subsequent evaluations will not recompute the expression so method</span>
<span class="sd">        chaining will not incur the overhead of caching more than once.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Cached table</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; cached_penguins = t.mutate(computation=&quot;Heavy Computation&quot;).cache()</span>
<span class="sd">    &gt;&gt;&gt; cached_penguins</span>
<span class="sd">    </span>
<span class="sd">     species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string   string     float64         float64        int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">     Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">     Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">     Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">     Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">     Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">     Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">     Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">     Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">     Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                       </span>
<span class="sd">    </span>

<span class="sd">    Explicit cache cleanup</span>

<span class="sd">    &gt;&gt;&gt; with t.mutate(computation=&quot;Heavy Computation&quot;).cache() as cached_penguins:</span>
<span class="sd">    ...     cached_penguins</span>
<span class="sd">    </span>
<span class="sd">     species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string   string     float64         float64        int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">     Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">     Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">     Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">     Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">     Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">     Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">     Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">     Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">     Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                       </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">current_backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_backend</span><span class="p">(</span><span class="n">use_default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">current_backend</span><span class="o">.</span><span class="n">_cached</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.cast" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cast</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.cast" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Cast the columns of a table.</p>
<div class="admonition note">
<p class="admonition-title">If you need to cast columns to a single type, use <a href="https://ibis-project.org/blog/selectors/">selectors</a>.</p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><span title="ibis.common.typing.SupportsSchema">SupportsSchema</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping, schema or iterable of pairs to use for casting</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Casted table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>
<span class="go">ibis.Schema {</span>
<span class="go">  species            string</span>
<span class="go">  island             string</span>
<span class="go">  bill_length_mm     float64</span>
<span class="go">  bill_depth_mm      float64</span>
<span class="go">  flipper_length_mm  int64</span>
<span class="go">  body_mass_g        int64</span>
<span class="go">  sex                string</span>
<span class="go">  year               int64</span>
<span class="go">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;body_mass_g&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_length_mm&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> body_mass_g  bill_length_mm </span>
<span class="go"></span>
<span class="go"> int64        float64        </span>
<span class="go"></span>
<span class="go">        3750            39.1 </span>
<span class="go">        3800            39.5 </span>
<span class="go">        3250            40.3 </span>
<span class="go">        NULL             nan </span>
<span class="go">        3450            36.7 </span>
<span class="go"></span>
</code></pre></div>
    <p>Columns not present in the input schema will be passed through unchanged</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">columns</span>
<span class="go">[&#39;species&#39;, &#39;island&#39;, &#39;bill_length_mm&#39;, &#39;bill_depth_mm&#39;, &#39;flipper_length_mm&#39;, &#39;body_mass_g&#39;, &#39;sex&#39;, &#39;year&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">({</span><span class="s2">&quot;body_mass_g&quot;</span><span class="p">:</span> <span class="s2">&quot;float64&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_length_mm&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> body_mass_g  bill_length_mm </span>
<span class="go"></span>
<span class="go"> float64      int64          </span>
<span class="go"></span>
<span class="go">      3750.0              39 </span>
<span class="go">      3800.0              40 </span>
<span class="go">      3250.0              40 </span>
<span class="go">         nan            NULL </span>
<span class="go">      3450.0              37 </span>
<span class="go"></span>
</code></pre></div>
    <p>Columns that are in the input <code>schema</code> but not in the table raise an error</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">({</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">ibis.common.exceptions.IbisError</span>: <span class="n">Cast schema has fields that are not in the table: [&#39;foo&#39;]</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">SupportsSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cast the columns of a table.</span>

<span class="sd">    !!! note &quot;If you need to cast columns to a single type, use [selectors](https://ibis-project.org/blog/selectors/).&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    schema</span>
<span class="sd">        Mapping, schema or iterable of pairs to use for casting</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Casted table</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; t.schema()</span>
<span class="sd">    ibis.Schema {</span>
<span class="sd">      species            string</span>
<span class="sd">      island             string</span>
<span class="sd">      bill_length_mm     float64</span>
<span class="sd">      bill_depth_mm      float64</span>
<span class="sd">      flipper_length_mm  int64</span>
<span class="sd">      body_mass_g        int64</span>
<span class="sd">      sex                string</span>
<span class="sd">      year               int64</span>
<span class="sd">    }</span>
<span class="sd">    &gt;&gt;&gt; cols = [&quot;body_mass_g&quot;, &quot;bill_length_mm&quot;]</span>
<span class="sd">    &gt;&gt;&gt; t[cols].head()</span>
<span class="sd">    </span>
<span class="sd">     body_mass_g  bill_length_mm </span>
<span class="sd">    </span>
<span class="sd">     int64        float64        </span>
<span class="sd">    </span>
<span class="sd">            3750            39.1 </span>
<span class="sd">            3800            39.5 </span>
<span class="sd">            3250            40.3 </span>
<span class="sd">            NULL             nan </span>
<span class="sd">            3450            36.7 </span>
<span class="sd">    </span>

<span class="sd">    Columns not present in the input schema will be passed through unchanged</span>

<span class="sd">    &gt;&gt;&gt; t.columns</span>
<span class="sd">    [&#39;species&#39;, &#39;island&#39;, &#39;bill_length_mm&#39;, &#39;bill_depth_mm&#39;, &#39;flipper_length_mm&#39;, &#39;body_mass_g&#39;, &#39;sex&#39;, &#39;year&#39;]</span>
<span class="sd">    &gt;&gt;&gt; expr = t.cast({&quot;body_mass_g&quot;: &quot;float64&quot;, &quot;bill_length_mm&quot;: &quot;int&quot;})</span>
<span class="sd">    &gt;&gt;&gt; expr.select(*cols).head()</span>
<span class="sd">    </span>
<span class="sd">     body_mass_g  bill_length_mm </span>
<span class="sd">    </span>
<span class="sd">     float64      int64          </span>
<span class="sd">    </span>
<span class="sd">          3750.0              39 </span>
<span class="sd">          3800.0              40 </span>
<span class="sd">          3250.0              40 </span>
<span class="sd">             nan            NULL </span>
<span class="sd">          3450.0              37 </span>
<span class="sd">    </span>

<span class="sd">    Columns that are in the input `schema` but not in the table raise an error</span>

<span class="sd">    &gt;&gt;&gt; t.cast({&quot;foo&quot;: &quot;string&quot;})</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">    ibis.common.exceptions.IbisError: Cast schema has fields that are not in the table: [&#39;foo&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">cast_method</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.count" class="doc doc-heading">
<code class="highlight language-python"><span class="n">count</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.count" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute the number of rows in the table.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>where</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.BooleanValue">BooleanValue</span> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional boolean expression to filter rows when counting.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="ibis.expr.types.numeric.IntegerScalar">IntegerScalar</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of rows in the table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> a      </span>
<span class="go"></span>
<span class="go"> string </span>
<span class="go"></span>
<span class="go"> foo    </span>
<span class="go"> bar    </span>
<span class="go"> baz    </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">a</span> <span class="o">!=</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="go">&lt;class &#39;ibis.expr.types.numeric.IntegerScalar&#39;&gt;</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanValue</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">IntegerScalar</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the number of rows in the table.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    where</span>
<span class="sd">        Optional boolean expression to filter rows when counting.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    IntegerScalar</span>
<span class="sd">        Number of rows in the table</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;]})</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     a      </span>
<span class="sd">    </span>
<span class="sd">     string </span>
<span class="sd">    </span>
<span class="sd">     foo    </span>
<span class="sd">     bar    </span>
<span class="sd">     baz    </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.count()</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; t.count(t.a != &quot;foo&quot;)</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; type(t.count())</span>
<span class="sd">    &lt;class &#39;ibis.expr.types.numeric.IntegerScalar&#39;&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">CountStar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.cross_join" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cross_join</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">,</span> <span class="n">lname</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">rname</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{name}</span><span class="s1">_right&#39;</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.cross_join" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute the cross join of a sequence of tables.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>left</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Left table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>right</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Right table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rest</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional tables to cross join</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>lname</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A format string to use to rename overlapping columns in the left
table (e.g. <code>"left_{name}"</code>).</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>rname</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A format string to use to rename overlapping columns in the right
table (e.g. <code>"right_{name}"</code>).</p>
            </div>
          </td>
          <td>
                <code>&#39;{name}_right&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cross join of <code>left</code>, <code>right</code> and <code>rest</code></p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">344</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agg</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">across</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">numeric</span><span class="p">(),</span> <span class="n">_</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cross_join</span><span class="p">(</span><span class="n">agg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span>
<span class="go"></span>
<span class="go"> species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string   string     float64         float64        int64               </span>
<span class="go"></span>
<span class="go"> Adelie   Torgersen            39.1           18.7                181   </span>
<span class="go"> Adelie   Torgersen            39.5           17.4                186   </span>
<span class="go"> Adelie   Torgersen            40.3           18.0                195   </span>
<span class="go"> Adelie   Torgersen             nan            nan               NULL   </span>
<span class="go"> Adelie   Torgersen            36.7           19.3                193   </span>
<span class="go"> Adelie   Torgersen            39.3           20.6                190   </span>
<span class="go"> Adelie   Torgersen            38.9           17.8                181   </span>
<span class="go"> Adelie   Torgersen            39.2           19.6                195   </span>
<span class="go"> Adelie   Torgersen            34.1           18.1                193   </span>
<span class="go"> Adelie   Torgersen            42.0           20.2                190   </span>
<span class="go">                                                                   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">.</span><span class="n">columns</span>
<span class="go">[&#39;species&#39;,</span>
<span class="go"> &#39;island&#39;,</span>
<span class="go"> &#39;bill_length_mm&#39;,</span>
<span class="go"> &#39;bill_depth_mm&#39;,</span>
<span class="go"> &#39;flipper_length_mm&#39;,</span>
<span class="go"> &#39;body_mass_g&#39;,</span>
<span class="go"> &#39;sex&#39;,</span>
<span class="go"> &#39;year&#39;,</span>
<span class="go"> &#39;bill_length_mm_right&#39;,</span>
<span class="go"> &#39;bill_depth_mm_right&#39;,</span>
<span class="go"> &#39;flipper_length_mm_right&#39;,</span>
<span class="go"> &#39;body_mass_g_right&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">344</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cross_join</span><span class="p">(</span>
    <span class="n">left</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">right</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
    <span class="o">*</span><span class="n">rest</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">lname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">rname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{name}</span><span class="s2">_right&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the cross join of a sequence of tables.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    left</span>
<span class="sd">        Left table</span>
<span class="sd">    right</span>
<span class="sd">        Right table</span>
<span class="sd">    rest</span>
<span class="sd">        Additional tables to cross join</span>
<span class="sd">    lname</span>
<span class="sd">        A format string to use to rename overlapping columns in the left</span>
<span class="sd">        table (e.g. ``&quot;left_{name}&quot;``).</span>
<span class="sd">    rname</span>
<span class="sd">        A format string to use to rename overlapping columns in the right</span>
<span class="sd">        table (e.g. ``&quot;right_{name}&quot;``).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Cross join of `left`, `right` and `rest`</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">    &gt;&gt;&gt; from ibis import _</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; t.count()</span>
<span class="sd">    344</span>
<span class="sd">    &gt;&gt;&gt; agg = t.drop(&quot;year&quot;).agg(s.across(s.numeric(), _.mean()))</span>
<span class="sd">    &gt;&gt;&gt; expr = t.cross_join(agg)</span>
<span class="sd">    &gt;&gt;&gt; expr</span>
<span class="sd">    </span>
<span class="sd">     species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string   string     float64         float64        int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">     Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">     Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">     Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">     Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">     Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">     Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">     Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">     Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">     Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                       </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; expr.columns</span>
<span class="sd">    [&#39;species&#39;,</span>
<span class="sd">     &#39;island&#39;,</span>
<span class="sd">     &#39;bill_length_mm&#39;,</span>
<span class="sd">     &#39;bill_depth_mm&#39;,</span>
<span class="sd">     &#39;flipper_length_mm&#39;,</span>
<span class="sd">     &#39;body_mass_g&#39;,</span>
<span class="sd">     &#39;sex&#39;,</span>
<span class="sd">     &#39;year&#39;,</span>
<span class="sd">     &#39;bill_length_mm_right&#39;,</span>
<span class="sd">     &#39;bill_depth_mm_right&#39;,</span>
<span class="sd">     &#39;flipper_length_mm_right&#39;,</span>
<span class="sd">     &#39;body_mass_g_right&#39;]</span>
<span class="sd">    &gt;&gt;&gt; expr.count()</span>
<span class="sd">    344</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">CrossJoin</span><span class="p">(</span>
        <span class="n">left</span><span class="p">,</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">Table</span><span class="o">.</span><span class="n">cross_join</span><span class="p">,</span> <span class="n">rest</span><span class="p">,</span> <span class="n">right</span><span class="p">),</span>
        <span class="p">[],</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">relations</span><span class="o">.</span><span class="n">_dedup_join_columns</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">to_expr</span><span class="p">(),</span> <span class="n">lname</span><span class="o">=</span><span class="n">lname</span><span class="p">,</span> <span class="n">rname</span><span class="o">=</span><span class="n">rname</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.difference" class="doc doc-heading">
<code class="highlight language-python"><span class="n">difference</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.difference" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute the set difference of multiple table expressions.</p>
<p>The input tables must have identical schemas.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>table</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A table expression</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*rest</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional table expressions</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>distinct</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Only diff distinct rows not occurring in the calling table</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>
      <h6 id="ibis.expr.types.relations.Table.difference--see-also">See Also<a class="headerlink" href="#ibis.expr.types.relations.Table.difference--see-also" title="Anchor link to this section for reference">&para;</a></h6>
<p><a class="autorefs autorefs-internal" href="../top_level/#ibis.difference"><code>ibis.difference</code></a></p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The rows present in <code>self</code> that are not present in <code>tables</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"></span>
<span class="go"> int64 </span>
<span class="go"></span>
<span class="go">     1 </span>
<span class="go">     2 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"></span>
<span class="go"> int64 </span>
<span class="go"></span>
<span class="go">     2 </span>
<span class="go">     3 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"></span>
<span class="go"> int64 </span>
<span class="go"></span>
<span class="go">     1 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">distinct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the set difference of multiple table expressions.</span>

<span class="sd">    The input tables must have identical schemas.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table:</span>
<span class="sd">        A table expression</span>
<span class="sd">    *rest:</span>
<span class="sd">        Additional table expressions</span>
<span class="sd">    distinct</span>
<span class="sd">        Only diff distinct rows not occurring in the calling table</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [`ibis.difference`][ibis.difference]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        The rows present in `self` that are not present in `tables`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t1 = ibis.memtable({&quot;a&quot;: [1, 2]})</span>
<span class="sd">    &gt;&gt;&gt; t1</span>
<span class="sd">    </span>
<span class="sd">     a     </span>
<span class="sd">    </span>
<span class="sd">     int64 </span>
<span class="sd">    </span>
<span class="sd">         1 </span>
<span class="sd">         2 </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t2 = ibis.memtable({&quot;a&quot;: [2, 3]})</span>
<span class="sd">    &gt;&gt;&gt; t2</span>
<span class="sd">    </span>
<span class="sd">     a     </span>
<span class="sd">    </span>
<span class="sd">     int64 </span>
<span class="sd">    </span>
<span class="sd">         2 </span>
<span class="sd">         3 </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t1.difference(t2)</span>
<span class="sd">    </span>
<span class="sd">     a     </span>
<span class="sd">    </span>
<span class="sd">     int64 </span>
<span class="sd">    </span>
<span class="sd">         1 </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">rest</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Difference</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.distinct" class="doc doc-heading">
<code class="highlight language-python"><span class="n">distinct</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.distinct" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return a Table with duplicate rows removed.</p>
<p>Similar to <code>pandas.DataFrame.drop_duplicates()</code>.</p>
<div class="admonition note">
<p class="admonition-title">Some backends do not support <code>keep='last'</code></p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>on</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <span title="ibis">s</span>.<span title="ibis.Selector">Selector</span> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Only consider certain columns for identifying duplicates.
By default deduplicate all of the columns.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>keep</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Literal" href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[&#39;first&#39;, &#39;last&#39;] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines which duplicates to keep.</p>
<ul>
<li><code>"first"</code>: Drop duplicates except for the first occurrence.</li>
<li><code>"last"</code>: Drop duplicates except for the last occurrence.</li>
<li><code>None</code>: Drop all duplicates</li>
</ul>
            </div>
          </td>
          <td>
                <code>&#39;first&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.examples</span> <span class="k">as</span> <span class="nn">ex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string   string     float64         float64        int64               </span>
<span class="go"></span>
<span class="go"> Adelie   Torgersen            39.1           18.7                181   </span>
<span class="go"> Adelie   Torgersen            39.5           17.4                186   </span>
<span class="go"> Adelie   Torgersen            40.3           18.0                195   </span>
<span class="go"> Adelie   Torgersen             nan            nan               NULL   </span>
<span class="go"> Adelie   Torgersen            36.7           19.3                193   </span>
<span class="go"> Adelie   Torgersen            39.3           20.6                190   </span>
<span class="go"> Adelie   Torgersen            38.9           17.8                181   </span>
<span class="go"> Adelie   Torgersen            39.2           19.6                195   </span>
<span class="go"> Adelie   Torgersen            34.1           18.1                193   </span>
<span class="go"> Adelie   Torgersen            42.0           20.2                190   </span>
<span class="go">                                                                   </span>
<span class="go"></span>
</code></pre></div>
    <p>Compute the distinct rows of a subset of columns</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[[</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="s2">&quot;island&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> species    island    </span>
<span class="go"></span>
<span class="go"> string     string    </span>
<span class="go"></span>
<span class="go"> Adelie     Torgersen </span>
<span class="go"> Adelie     Biscoe    </span>
<span class="go"> Adelie     Dream     </span>
<span class="go"> Gentoo     Biscoe    </span>
<span class="go"> Chinstrap  Dream     </span>
<span class="go"></span>
</code></pre></div>
    <p>Drop all duplicate rows except the first</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="s2">&quot;island&quot;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> species    island     bill_length_mm  bill_depth_  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string     string     float64         float64       int64               </span>
<span class="go"></span>
<span class="go"> Adelie     Torgersen            39.1          18.7                181   </span>
<span class="go"> Adelie     Biscoe               37.8          18.3                174   </span>
<span class="go"> Adelie     Dream                39.5          16.7                178   </span>
<span class="go"> Gentoo     Biscoe               46.1          13.2                211   </span>
<span class="go"> Chinstrap  Dream                46.5          17.9                192   </span>
<span class="go"></span>
</code></pre></div>
    <p>Drop all duplicate rows except the last</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="s2">&quot;island&quot;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> species    island     bill_length_mm  bill_depth_  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string     string     float64         float64       int64               </span>
<span class="go"></span>
<span class="go"> Adelie     Torgersen            43.1          19.2                197   </span>
<span class="go"> Adelie     Biscoe               42.7          18.3                196   </span>
<span class="go"> Adelie     Dream                41.5          18.5                201   </span>
<span class="go"> Gentoo     Biscoe               49.9          16.1                213   </span>
<span class="go"> Chinstrap  Dream                50.2          18.7                198   </span>
<span class="go"></span>
</code></pre></div>
    <p>Drop all duplicated rows</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_length_mm&quot;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">273</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">344</span>
</code></pre></div>
    <p>You can pass <a class="autorefs autorefs-internal" href="../../selectors/#ibis.selectors"><code>selectors</code></a> to <code>on</code></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="n">on</span><span class="o">=~</span><span class="n">s</span><span class="o">.</span><span class="n">numeric</span><span class="p">())</span>
<span class="go"></span>
<span class="go"> species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string   string     float64         float64        int64               </span>
<span class="go"></span>
<span class="go"> Adelie   Torgersen            39.1           18.7                181   </span>
<span class="go"> Adelie   Torgersen            39.5           17.4                186   </span>
<span class="go"> Adelie   Torgersen             nan            nan               NULL   </span>
<span class="go"> Adelie   Biscoe               37.8           18.3                174   </span>
<span class="go"> Adelie   Biscoe               37.7           18.7                180   </span>
<span class="go"> Adelie   Dream                39.5           16.7                178   </span>
<span class="go"> Adelie   Dream                37.2           18.1                178   </span>
<span class="go"> Adelie   Dream                37.5           18.9                179   </span>
<span class="go"> Gentoo   Biscoe               46.1           13.2                211   </span>
<span class="go"> Gentoo   Biscoe               50.0           16.3                230   </span>
<span class="go">                                                                   </span>
<span class="go"></span>
</code></pre></div>
    <p>The only valid values of <code>keep</code> are <code>"first"</code>, <code>"last"</code> and <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/constants.html#None">`None</a></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;second&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">ibis.common.exceptions.IbisError</span>: <span class="n">Invalid value for keep: &#39;second&#39; ...</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">distinct</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">keep</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;last&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;first&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a Table with duplicate rows removed.</span>

<span class="sd">    Similar to `pandas.DataFrame.drop_duplicates()`.</span>

<span class="sd">    !!! note &quot;Some backends do not support `keep=&#39;last&#39;`&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    on</span>
<span class="sd">        Only consider certain columns for identifying duplicates.</span>
<span class="sd">        By default deduplicate all of the columns.</span>
<span class="sd">    keep</span>
<span class="sd">        Determines which duplicates to keep.</span>

<span class="sd">        - `&quot;first&quot;`: Drop duplicates except for the first occurrence.</span>
<span class="sd">        - `&quot;last&quot;`: Drop duplicates except for the last occurrence.</span>
<span class="sd">        - `None`: Drop all duplicates</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; import ibis.examples as ex</span>
<span class="sd">    &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ex.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string   string     float64         float64        int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">     Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">     Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">     Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">     Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">     Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">     Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">     Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">     Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">     Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                       </span>
<span class="sd">    </span>

<span class="sd">    Compute the distinct rows of a subset of columns</span>

<span class="sd">    &gt;&gt;&gt; t[[&quot;species&quot;, &quot;island&quot;]].distinct()</span>
<span class="sd">    </span>
<span class="sd">     species    island    </span>
<span class="sd">    </span>
<span class="sd">     string     string    </span>
<span class="sd">    </span>
<span class="sd">     Adelie     Torgersen </span>
<span class="sd">     Adelie     Biscoe    </span>
<span class="sd">     Adelie     Dream     </span>
<span class="sd">     Gentoo     Biscoe    </span>
<span class="sd">     Chinstrap  Dream     </span>
<span class="sd">    </span>

<span class="sd">    Drop all duplicate rows except the first</span>

<span class="sd">    &gt;&gt;&gt; t.distinct(on=[&quot;species&quot;, &quot;island&quot;], keep=&quot;first&quot;)</span>
<span class="sd">    </span>
<span class="sd">     species    island     bill_length_mm  bill_depth_  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string     string     float64         float64       int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie     Torgersen            39.1          18.7                181   </span>
<span class="sd">     Adelie     Biscoe               37.8          18.3                174   </span>
<span class="sd">     Adelie     Dream                39.5          16.7                178   </span>
<span class="sd">     Gentoo     Biscoe               46.1          13.2                211   </span>
<span class="sd">     Chinstrap  Dream                46.5          17.9                192   </span>
<span class="sd">    </span>

<span class="sd">    Drop all duplicate rows except the last</span>

<span class="sd">    &gt;&gt;&gt; t.distinct(on=[&quot;species&quot;, &quot;island&quot;], keep=&quot;last&quot;)</span>
<span class="sd">    </span>
<span class="sd">     species    island     bill_length_mm  bill_depth_  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string     string     float64         float64       int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie     Torgersen            43.1          19.2                197   </span>
<span class="sd">     Adelie     Biscoe               42.7          18.3                196   </span>
<span class="sd">     Adelie     Dream                41.5          18.5                201   </span>
<span class="sd">     Gentoo     Biscoe               49.9          16.1                213   </span>
<span class="sd">     Chinstrap  Dream                50.2          18.7                198   </span>
<span class="sd">    </span>

<span class="sd">    Drop all duplicated rows</span>

<span class="sd">    &gt;&gt;&gt; expr = t.distinct(on=[&quot;species&quot;, &quot;island&quot;, &quot;year&quot;, &quot;bill_length_mm&quot;], keep=None)</span>
<span class="sd">    &gt;&gt;&gt; expr.count()</span>
<span class="sd">    273</span>
<span class="sd">    &gt;&gt;&gt; t.count()</span>
<span class="sd">    344</span>

<span class="sd">    You can pass [`selectors`][ibis.selectors] to `on`</span>

<span class="sd">    &gt;&gt;&gt; t.distinct(on=~s.numeric())</span>
<span class="sd">    </span>
<span class="sd">     species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string   string     float64         float64        int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">     Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">     Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">     Adelie   Biscoe               37.8           18.3                174   </span>
<span class="sd">     Adelie   Biscoe               37.7           18.7                180   </span>
<span class="sd">     Adelie   Dream                39.5           16.7                178   </span>
<span class="sd">     Adelie   Dream                37.2           18.1                178   </span>
<span class="sd">     Adelie   Dream                37.5           18.9                179   </span>
<span class="sd">     Gentoo   Biscoe               46.1           13.2                211   </span>
<span class="sd">     Gentoo   Biscoe               50.0           16.3                230   </span>
<span class="sd">                                                                       </span>
<span class="sd">    </span>

<span class="sd">    The only valid values of `keep` are `&quot;first&quot;`, `&quot;last&quot;` and [`None][None]</span>

<span class="sd">    &gt;&gt;&gt; t.distinct(on=&quot;species&quot;, keep=&quot;second&quot;)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    ibis.common.exceptions.IbisError: Invalid value for keep: &#39;second&#39; ...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>

    <span class="k">if</span> <span class="n">on</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># dedup everything</span>
        <span class="k">if</span> <span class="n">keep</span> <span class="o">!=</span> <span class="s2">&quot;first&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Only keep=&#39;first&#39; (the default) makes sense when deduplicating all columns; got keep=</span><span class="si">{</span><span class="n">keep</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">Distinct</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span><span class="p">):</span>
        <span class="n">on</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="o">*</span><span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">on</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">keep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">having</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;first&quot;</span>
    <span class="k">elif</span> <span class="n">keep</span> <span class="o">==</span> <span class="s2">&quot;first&quot;</span> <span class="ow">or</span> <span class="n">keep</span> <span class="o">==</span> <span class="s2">&quot;last&quot;</span><span class="p">:</span>
        <span class="n">having</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">how</span> <span class="o">=</span> <span class="n">keep</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid value for `keep`: </span><span class="si">{</span><span class="n">keep</span><span class="si">!r}</span><span class="s2">, must be &#39;first&#39;, &#39;last&#39; or None&quot;</span>
        <span class="p">)</span>

    <span class="n">aggs</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="o">.</span><span class="n">get_name</span><span class="p">():</span> <span class="n">col</span><span class="o">.</span><span class="n">arbitrary</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">(</span><span class="o">~</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)}</span>

    <span class="n">gb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">having</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gb</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">having</span><span class="p">(</span><span class="n">having</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="o">**</span><span class="n">aggs</span><span class="p">)</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.drop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">drop</span><span class="p">(</span><span class="o">*</span><span class="n">fields</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.drop" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Remove fields from a table.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fields</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis.selectors.Selector">Selector</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Fields to drop. Strings and selectors are accepted.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A table with all columns matching <code>fields</code> removed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string   string     float64         float64        int64               </span>
<span class="go"></span>
<span class="go"> Adelie   Torgersen            39.1           18.7                181   </span>
<span class="go"> Adelie   Torgersen            39.5           17.4                186   </span>
<span class="go"> Adelie   Torgersen            40.3           18.0                195   </span>
<span class="go"> Adelie   Torgersen             nan            nan               NULL   </span>
<span class="go"> Adelie   Torgersen            36.7           19.3                193   </span>
<span class="go"> Adelie   Torgersen            39.3           20.6                190   </span>
<span class="go"> Adelie   Torgersen            38.9           17.8                181   </span>
<span class="go"> Adelie   Torgersen            39.2           19.6                195   </span>
<span class="go"> Adelie   Torgersen            34.1           18.1                193   </span>
<span class="go"> Adelie   Torgersen            42.0           20.2                190   </span>
<span class="go">                                                                   </span>
<span class="go"></span>
</code></pre></div>
    <p>Drop one or more columns</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;species&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string     float64         float64        int64               </span>
<span class="go"></span>
<span class="go"> Torgersen            39.1           18.7                181   </span>
<span class="go"> Torgersen            39.5           17.4                186   </span>
<span class="go"> Torgersen            40.3           18.0                195   </span>
<span class="go"> Torgersen             nan            nan               NULL   </span>
<span class="go"> Torgersen            36.7           19.3                193   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_length_mm&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> island     bill_depth_mm  flipper_length_mm  body_mass_g  sex      </span>
<span class="go"></span>
<span class="go"> string     float64        int64              int64        string   </span>
<span class="go"></span>
<span class="go"> Torgersen           18.7                181         3750  male     </span>
<span class="go"> Torgersen           17.4                186         3800  female   </span>
<span class="go"> Torgersen           18.0                195         3250  female   </span>
<span class="go"> Torgersen            nan               NULL         NULL  NULL     </span>
<span class="go"> Torgersen           19.3                193         3450  female   </span>
<span class="go"></span>
</code></pre></div>
    <p>Drop with selectors, mix and match</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;bill_&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> island     flipper_length_mm  body_mass_g  sex     year  </span>
<span class="go"></span>
<span class="go"> string     int64              int64        string  int64 </span>
<span class="go"></span>
<span class="go"> Torgersen                181         3750  male     2007 </span>
<span class="go"> Torgersen                186         3800  female   2007 </span>
<span class="go"> Torgersen                195         3250  female   2007 </span>
<span class="go"> Torgersen               NULL         NULL  NULL     2007 </span>
<span class="go"> Torgersen                193         3450  female   2007 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Selector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove fields from a table.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fields</span>
<span class="sd">        Fields to drop. Strings and selectors are accepted.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        A table with all columns matching `fields` removed.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string   string     float64         float64        int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">     Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">     Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">     Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">     Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">     Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">     Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">     Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">     Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">     Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                       </span>
<span class="sd">    </span>

<span class="sd">    Drop one or more columns</span>

<span class="sd">    &gt;&gt;&gt; t.drop(&quot;species&quot;).head()</span>
<span class="sd">    </span>
<span class="sd">     island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string     float64         float64        int64               </span>
<span class="sd">    </span>
<span class="sd">     Torgersen            39.1           18.7                181   </span>
<span class="sd">     Torgersen            39.5           17.4                186   </span>
<span class="sd">     Torgersen            40.3           18.0                195   </span>
<span class="sd">     Torgersen             nan            nan               NULL   </span>
<span class="sd">     Torgersen            36.7           19.3                193   </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.drop(&quot;species&quot;, &quot;bill_length_mm&quot;).head()</span>
<span class="sd">    </span>
<span class="sd">     island     bill_depth_mm  flipper_length_mm  body_mass_g  sex      </span>
<span class="sd">    </span>
<span class="sd">     string     float64        int64              int64        string   </span>
<span class="sd">    </span>
<span class="sd">     Torgersen           18.7                181         3750  male     </span>
<span class="sd">     Torgersen           17.4                186         3800  female   </span>
<span class="sd">     Torgersen           18.0                195         3250  female   </span>
<span class="sd">     Torgersen            nan               NULL         NULL  NULL     </span>
<span class="sd">     Torgersen           19.3                193         3450  female   </span>
<span class="sd">    </span>

<span class="sd">    Drop with selectors, mix and match</span>

<span class="sd">    &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">    &gt;&gt;&gt; t.drop(&quot;species&quot;, s.startswith(&quot;bill_&quot;)).head()</span>
<span class="sd">    </span>
<span class="sd">     island     flipper_length_mm  body_mass_g  sex     year  </span>
<span class="sd">    </span>
<span class="sd">     string     int64              int64        string  int64 </span>
<span class="sd">    </span>
<span class="sd">     Torgersen                181         3750  male     2007 </span>
<span class="sd">     Torgersen                186         3800  female   2007 </span>
<span class="sd">     Torgersen                195         3250  female   2007 </span>
<span class="sd">     Torgersen               NULL         NULL  NULL     2007 </span>
<span class="sd">     Torgersen                193         3450  female   2007 </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">selectors</span> <span class="k">as</span> <span class="n">s</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fields</span><span class="p">:</span>
        <span class="c1"># no-op if nothing to be dropped</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">if</span> <span class="n">missing_fields</span> <span class="o">:=</span> <span class="p">{</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">str</span><span class="p">)}</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span><span class="o">.</span><span class="n">names</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fields not in table: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">missing_fields</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">sels</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">~</span><span class="n">s</span><span class="o">.</span><span class="n">any_of</span><span class="p">(</span><span class="o">*</span><span class="n">sels</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.dropna" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.dropna" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Remove rows with null values from the table.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>subset</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Columns names to consider when dropping nulls. By default all columns
are considered.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>how</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Literal" href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[&#39;any&#39;, &#39;all&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determine whether a row is removed if there is <strong>at least one null
value in the row</strong> (<code>'any'</code>), or if <strong>all</strong> row values are null
(<code>'all'</code>).</p>
            </div>
          </td>
          <td>
                <code>&#39;any&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string   string     float64         float64        int64               </span>
<span class="go"></span>
<span class="go"> Adelie   Torgersen            39.1           18.7                181   </span>
<span class="go"> Adelie   Torgersen            39.5           17.4                186   </span>
<span class="go"> Adelie   Torgersen            40.3           18.0                195   </span>
<span class="go"> Adelie   Torgersen             nan            nan               NULL   </span>
<span class="go"> Adelie   Torgersen            36.7           19.3                193   </span>
<span class="go"> Adelie   Torgersen            39.3           20.6                190   </span>
<span class="go"> Adelie   Torgersen            38.9           17.8                181   </span>
<span class="go"> Adelie   Torgersen            39.2           19.6                195   </span>
<span class="go"> Adelie   Torgersen            34.1           18.1                193   </span>
<span class="go"> Adelie   Torgersen            42.0           20.2                190   </span>
<span class="go">                                                                   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">344</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">dropna</span><span class="p">([</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;body_mass_g&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">342</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>  <span class="c1"># no rows where all columns are null</span>
<span class="go">344</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dropna</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">subset</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">how</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;any&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;any&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove rows with null values from the table.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    subset</span>
<span class="sd">        Columns names to consider when dropping nulls. By default all columns</span>
<span class="sd">        are considered.</span>
<span class="sd">    how</span>
<span class="sd">        Determine whether a row is removed if there is **at least one null</span>
<span class="sd">        value in the row** (`&#39;any&#39;`), or if **all** row values are null</span>
<span class="sd">        (`&#39;all&#39;`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Table expression</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string   string     float64         float64        int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">     Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">     Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">     Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">     Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">     Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">     Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">     Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">     Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">     Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                       </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.count()</span>
<span class="sd">    344</span>
<span class="sd">    &gt;&gt;&gt; t.dropna([&quot;bill_length_mm&quot;, &quot;body_mass_g&quot;]).count()</span>
<span class="sd">    342</span>
<span class="sd">    &gt;&gt;&gt; t.dropna(how=&quot;all&quot;).count()  # no rows where all columns are null</span>
<span class="sd">    344</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">subset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">subset</span> <span class="o">=</span> <span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">subset</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">DropNa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">subset</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.fillna" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fillna</span><span class="p">(</span><span class="n">replacements</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.fillna" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Fill null values in a table expression.</p>
<div class="admonition note">
<p class="admonition-title">There is potential lack of type stability with the <code>fillna</code> API</p>
<p>For example, different library versions may impact whether a given
backend promotes integer replacement values to floats.</p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>replacements</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.Scalar">Scalar</span> | <a class="autorefs autorefs-external" title="typing.Mapping" href="https://docs.python.org/3/library/typing.html#typing.Mapping">Mapping</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="ibis">ir</span>.<span title="ibis.Scalar">Scalar</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value with which to fill nulls. If <code>replacements</code> is a mapping, the
keys are column names that map to their replacement value. If
passed as a scalar all columns are filled with that value.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">sex</span>
<span class="go"></span>
<span class="go"> sex    </span>
<span class="go"></span>
<span class="go"> string </span>
<span class="go"></span>
<span class="go"> male   </span>
<span class="go"> female </span>
<span class="go"> female </span>
<span class="go"> NULL   </span>
<span class="go"> female </span>
<span class="go"> male   </span>
<span class="go"> female </span>
<span class="go"> male   </span>
<span class="go"> NULL   </span>
<span class="go"> NULL   </span>
<span class="go">       </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="s2">&quot;sex&quot;</span><span class="p">:</span> <span class="s2">&quot;unrecorded&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">sex</span>
<span class="go"></span>
<span class="go"> sex        </span>
<span class="go"></span>
<span class="go"> string     </span>
<span class="go"></span>
<span class="go"> male       </span>
<span class="go"> female     </span>
<span class="go"> female     </span>
<span class="go"> unrecorded </span>
<span class="go"> female     </span>
<span class="go"> male       </span>
<span class="go"> female     </span>
<span class="go"> male       </span>
<span class="go"> unrecorded </span>
<span class="go"> unrecorded </span>
<span class="go">           </span>
<span class="go"></span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fillna</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">replacements</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Scalar</span> <span class="o">|</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ir</span><span class="o">.</span><span class="n">Scalar</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fill null values in a table expression.</span>

<span class="sd">    !!! note &quot;There is potential lack of type stability with the `fillna` API&quot;</span>

<span class="sd">        For example, different library versions may impact whether a given</span>
<span class="sd">        backend promotes integer replacement values to floats.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    replacements</span>
<span class="sd">        Value with which to fill nulls. If `replacements` is a mapping, the</span>
<span class="sd">        keys are column names that map to their replacement value. If</span>
<span class="sd">        passed as a scalar all columns are filled with that value.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; t.sex</span>
<span class="sd">    </span>
<span class="sd">     sex    </span>
<span class="sd">    </span>
<span class="sd">     string </span>
<span class="sd">    </span>
<span class="sd">     male   </span>
<span class="sd">     female </span>
<span class="sd">     female </span>
<span class="sd">     NULL   </span>
<span class="sd">     female </span>
<span class="sd">     male   </span>
<span class="sd">     female </span>
<span class="sd">     male   </span>
<span class="sd">     NULL   </span>
<span class="sd">     NULL   </span>
<span class="sd">           </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.fillna({&quot;sex&quot;: &quot;unrecorded&quot;}).sex</span>
<span class="sd">    </span>
<span class="sd">     sex        </span>
<span class="sd">    </span>
<span class="sd">     string     </span>
<span class="sd">    </span>
<span class="sd">     male       </span>
<span class="sd">     female     </span>
<span class="sd">     female     </span>
<span class="sd">     unrecorded </span>
<span class="sd">     female     </span>
<span class="sd">     male       </span>
<span class="sd">     female     </span>
<span class="sd">     male       </span>
<span class="sd">     unrecorded </span>
<span class="sd">     unrecorded </span>
<span class="sd">               </span>
<span class="sd">    </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Table expression</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">replacements</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">replacements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
                <span class="n">columns_formatted</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">repr</span><span class="p">,</span> <span class="n">schema</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
                <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">col</span><span class="si">!r}</span><span class="s2"> is not found in table. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Existing columns: </span><span class="si">{</span><span class="n">columns_formatted</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>

            <span class="n">col_type</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">val_type</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Expr</span><span class="p">)</span> <span class="k">else</span> <span class="n">dt</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">dt</span><span class="o">.</span><span class="n">castable</span><span class="p">(</span><span class="n">val_type</span><span class="p">,</span> <span class="n">col_type</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cannot fillna on column </span><span class="si">{</span><span class="n">col</span><span class="si">!r}</span><span class="s2"> of type </span><span class="si">{</span><span class="n">col_type</span><span class="si">}</span><span class="s2"> with a &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;value of type </span><span class="si">{</span><span class="n">val_type</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">val_type</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">replacements</span><span class="o">.</span><span class="n">type</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">replacements</span><span class="p">,</span> <span class="n">Expr</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">dt</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">replacements</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">col_type</span> <span class="ow">in</span> <span class="n">schema</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">col_type</span><span class="o">.</span><span class="n">nullable</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dt</span><span class="o">.</span><span class="n">castable</span><span class="p">(</span><span class="n">val_type</span><span class="p">,</span> <span class="n">col_type</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cannot fillna on column </span><span class="si">{</span><span class="n">col</span><span class="si">!r}</span><span class="s2"> of type </span><span class="si">{</span><span class="n">col_type</span><span class="si">}</span><span class="s2"> with a &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;value of type </span><span class="si">{</span><span class="n">val_type</span><span class="si">}</span><span class="s2"> - pass in an explicit mapping &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;of fill values to `fillna` instead.&quot;</span>
                <span class="p">)</span>
    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">FillNa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replacements</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.filter" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">filter</span><span class="p">(</span><span class="n">predicates</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.filter" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Select rows from <code>table</code> based on <code>predicates</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>predicates</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.BooleanValue">BooleanValue</span> | <a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<span title="ibis">ir</span>.<span title="ibis.BooleanValue">BooleanValue</span>] | <span title="ibis.selectors.IfAnyAll">IfAnyAll</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Boolean value expressions used to select rows in <code>table</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Filtered table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string   string     float64         float64        int64               </span>
<span class="go"></span>
<span class="go"> Adelie   Torgersen            39.1           18.7                181   </span>
<span class="go"> Adelie   Torgersen            39.5           17.4                186   </span>
<span class="go"> Adelie   Torgersen            40.3           18.0                195   </span>
<span class="go"> Adelie   Torgersen             nan            nan               NULL   </span>
<span class="go"> Adelie   Torgersen            36.7           19.3                193   </span>
<span class="go"> Adelie   Torgersen            39.3           20.6                190   </span>
<span class="go"> Adelie   Torgersen            38.9           17.8                181   </span>
<span class="go"> Adelie   Torgersen            39.2           19.6                195   </span>
<span class="go"> Adelie   Torgersen            34.1           18.1                193   </span>
<span class="go"> Adelie   Torgersen            42.0           20.2                190   </span>
<span class="go">                                                                   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">filter</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">species</span> <span class="o">==</span> <span class="s2">&quot;Adelie&quot;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">body_mass_g</span> <span class="o">&gt;</span> <span class="mi">3500</span><span class="p">])</span><span class="o">.</span><span class="n">sex</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="s2">&quot;sex&quot;</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> sex     sex_count </span>
<span class="go"></span>
<span class="go"> string  int64     </span>
<span class="go"></span>
<span class="go"> male           68 </span>
<span class="go"> female         22 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">filter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">predicates</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanValue</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">BooleanValue</span><span class="p">]</span> <span class="o">|</span> <span class="n">IfAnyAll</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Select rows from `table` based on `predicates`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    predicates</span>
<span class="sd">        Boolean value expressions used to select rows in `table`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Filtered table expression</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string   string     float64         float64        int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">     Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">     Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">     Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">     Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">     Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">     Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">     Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">     Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">     Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                       </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.filter([t.species == &quot;Adelie&quot;, t.body_mass_g &gt; 3500]).sex.value_counts().dropna(&quot;sex&quot;)</span>
<span class="sd">    </span>
<span class="sd">     sex     sex_count </span>
<span class="sd">    </span>
<span class="sd">     string  int64     </span>
<span class="sd">    </span>
<span class="sd">     male           68 </span>
<span class="sd">     female         22 </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">ibis.expr.analysis</span> <span class="k">as</span> <span class="nn">an</span>

    <span class="n">resolved_predicates</span> <span class="o">=</span> <span class="n">_resolve_predicates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicates</span><span class="p">)</span>
    <span class="n">predicates</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">an</span><span class="o">.</span><span class="n">_rewrite_filter</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">op</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">Expr</span><span class="p">)</span> <span class="k">else</span> <span class="n">pred</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">resolved_predicates</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">an</span><span class="o">.</span><span class="n">apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(),</span> <span class="n">predicates</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.group_by" class="doc doc-heading">
<code class="highlight language-python"><span class="n">group_by</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">key_exprs</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.group_by" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create a grouped table expression.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>by</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.Value">Value</span> | <a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<span title="ibis">ir</span>.<span title="ibis.Value">Value</span>] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Grouping expressions</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>key_exprs</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.Value">Value</span> | <a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<span title="ibis">ir</span>.<span title="ibis.Value">Value</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Named grouping expressions</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.groupby.GroupedTable" href="#ibis.expr.types.groupby.GroupedTable">GroupedTable</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A grouped table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;fruit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">],</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> fruit   price   </span>
<span class="go"></span>
<span class="go"> string  float64 </span>
<span class="go"></span>
<span class="go"> apple      0.50 </span>
<span class="go"> apple      0.50 </span>
<span class="go"> banana     0.25 </span>
<span class="go"> orange     0.33 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;fruit&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">total_cost</span><span class="o">=</span><span class="n">_</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">avg_cost</span><span class="o">=</span><span class="n">_</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="go"></span>
<span class="go"> fruit   total_cost  avg_cost </span>
<span class="go"></span>
<span class="go"> string  float64     float64  </span>
<span class="go"></span>
<span class="go"> apple         1.00      0.50 </span>
<span class="go"> banana        0.25      0.25 </span>
<span class="go"> orange        0.33      0.33 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">group_by</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">key_exprs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GroupedTable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a grouped table expression.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    by</span>
<span class="sd">        Grouping expressions</span>
<span class="sd">    key_exprs</span>
<span class="sd">        Named grouping expressions</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    GroupedTable</span>
<span class="sd">        A grouped table expression</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; from ibis import _</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.memtable({&quot;fruit&quot;: [&quot;apple&quot;, &quot;apple&quot;, &quot;banana&quot;, &quot;orange&quot;], &quot;price&quot;: [0.5, 0.5, 0.25, 0.33]})</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     fruit   price   </span>
<span class="sd">    </span>
<span class="sd">     string  float64 </span>
<span class="sd">    </span>
<span class="sd">     apple      0.50 </span>
<span class="sd">     apple      0.50 </span>
<span class="sd">     banana     0.25 </span>
<span class="sd">     orange     0.33 </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.group_by(&quot;fruit&quot;).agg(total_cost=_.price.sum(), avg_cost=_.price.mean())</span>
<span class="sd">    </span>
<span class="sd">     fruit   total_cost  avg_cost </span>
<span class="sd">    </span>
<span class="sd">     string  float64     float64  </span>
<span class="sd">    </span>
<span class="sd">     apple         1.00      0.50 </span>
<span class="sd">     banana        0.25      0.25 </span>
<span class="sd">     orange        0.33      0.33 </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ibis.expr.types.groupby</span> <span class="kn">import</span> <span class="n">GroupedTable</span>

    <span class="k">return</span> <span class="n">GroupedTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="o">**</span><span class="n">key_exprs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.head" class="doc doc-heading">
<code class="highlight language-python"><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.head" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Select the first <code>n</code> rows of a table.</p>
<div class="admonition note">
<p class="admonition-title">The result set is not deterministic without a call to <a class="autorefs autorefs-internal" href="#ibis.expr.types.relations.Table.order_by"><code>order_by</code></a>.</p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of rows to include</p>
            </div>
          </td>
          <td>
                <code>5</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>self</code> limited to <code>n</code> rows</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> a      b      </span>
<span class="go"></span>
<span class="go"> int64  string </span>
<span class="go"></span>
<span class="go">     1  c      </span>
<span class="go">     1  a      </span>
<span class="go">     2  a      </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> a      b      </span>
<span class="go"></span>
<span class="go"> int64  string </span>
<span class="go"></span>
<span class="go">     1  c      </span>
<span class="go">     1  a      </span>
<span class="go"></span>
</code></pre></div>
      <h6 id="ibis.expr.types.relations.Table.head--see-also">See Also<a class="headerlink" href="#ibis.expr.types.relations.Table.head--see-also" title="Anchor link to this section for reference">&para;</a></h6>
<p><a class="autorefs autorefs-internal" href="#ibis.expr.types.relations.Table.limit"><code>Table.limit</code></a>
<a class="autorefs autorefs-internal" href="#ibis.expr.types.relations.Table.order_by"><code>Table.order_by</code></a></p>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Select the first `n` rows of a table.</span>

<span class="sd">    !!! note &quot;The result set is not deterministic without a call to [`order_by`][ibis.expr.types.relations.Table.order_by].&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n</span>
<span class="sd">        Number of rows to include</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        `self` limited to `n` rows</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [1, 1, 2], &quot;b&quot;: [&quot;c&quot;, &quot;a&quot;, &quot;a&quot;]})</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     a      b      </span>
<span class="sd">    </span>
<span class="sd">     int64  string </span>
<span class="sd">    </span>
<span class="sd">         1  c      </span>
<span class="sd">         1  a      </span>
<span class="sd">         2  a      </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.head(2)</span>
<span class="sd">    </span>
<span class="sd">     a      b      </span>
<span class="sd">    </span>
<span class="sd">     int64  string </span>
<span class="sd">    </span>
<span class="sd">         1  c      </span>
<span class="sd">         1  a      </span>
<span class="sd">    </span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [`Table.limit`][ibis.expr.types.relations.Table.limit]</span>
<span class="sd">    [`Table.order_by`][ibis.expr.types.relations.Table.order_by]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.info" class="doc doc-heading">
<code class="highlight language-python"><span class="n">info</span><span class="p">()</span></code>

<a href="#ibis.expr.types.relations.Table.info" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return summary information about a table.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Summary of <code>self</code></p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> name               type     nullable  nulls  non_nulls  null_frac   </span>
<span class="go"></span>
<span class="go"> string             string   boolean   int64  int64      float64     </span>
<span class="go"></span>
<span class="go"> species            string   True          0        344   0.000000   </span>
<span class="go"> island             string   True          0        344   0.000000   </span>
<span class="go"> bill_length_mm     float64  True          2        342   0.005814   </span>
<span class="go"> bill_depth_mm      float64  True          2        342   0.005814   </span>
<span class="go"> flipper_length_mm  int64    True          2        342   0.005814   </span>
<span class="go"> body_mass_g        int64    True          2        342   0.005814   </span>
<span class="go"> sex                string   True         11        333   0.031977   </span>
<span class="go"> year               int64    True          0        344   0.000000   </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return summary information about a table.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Summary of `self`</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; t.info()</span>
<span class="sd">    </span>
<span class="sd">     name               type     nullable  nulls  non_nulls  null_frac   </span>
<span class="sd">    </span>
<span class="sd">     string             string   boolean   int64  int64      float64     </span>
<span class="sd">    </span>
<span class="sd">     species            string   True          0        344   0.000000   </span>
<span class="sd">     island             string   True          0        344   0.000000   </span>
<span class="sd">     bill_length_mm     float64  True          2        342   0.005814   </span>
<span class="sd">     bill_depth_mm      float64  True          2        342   0.005814   </span>
<span class="sd">     flipper_length_mm  int64    True          2        342   0.005814   </span>
<span class="sd">     body_mass_g        int64    True          2        342   0.005814   </span>
<span class="sd">     sex                string   True         11        333   0.031977   </span>
<span class="sd">     year               int64    True          0        344   0.000000   </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">literal</span> <span class="k">as</span> <span class="n">lit</span>

    <span class="n">aggs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">colname</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span>
        <span class="n">typ</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">type</span><span class="p">()</span>
        <span class="n">agg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">isna</span><span class="o">=</span><span class="n">ibis</span><span class="o">.</span><span class="n">case</span><span class="p">()</span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">else_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">lit</span><span class="p">(</span><span class="n">colname</span><span class="p">),</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">lit</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">typ</span><span class="p">)),</span>
            <span class="n">nullable</span><span class="o">=</span><span class="n">lit</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">typ</span><span class="o">.</span><span class="n">nullable</span><span class="p">))</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;bool&quot;</span><span class="p">),</span>
            <span class="n">nulls</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">isna</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
            <span class="n">non_nulls</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">isna</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
            <span class="n">null_frac</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">isna</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
            <span class="n">pos</span><span class="o">=</span><span class="n">lit</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">aggs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ibis</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">aggs</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">ibis</span><span class="o">.</span><span class="n">asc</span><span class="p">(</span><span class="s2">&quot;pos&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.intersect" class="doc doc-heading">
<code class="highlight language-python"><span class="n">intersect</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.intersect" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute the set intersection of multiple table expressions.</p>
<p>The input tables must have identical schemas.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>table</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A table expression</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*rest</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional table expressions</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>distinct</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Only return distinct rows</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A new table containing the intersection of all input tables.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <h6 id="ibis.expr.types.relations.Table.intersect--see-also">See Also<a class="headerlink" href="#ibis.expr.types.relations.Table.intersect--see-also" title="Anchor link to this section for reference">&para;</a></h6>
<p><a class="autorefs autorefs-internal" href="../top_level/#ibis.intersect"><code>ibis.intersect</code></a></p>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"></span>
<span class="go"> int64 </span>
<span class="go"></span>
<span class="go">     1 </span>
<span class="go">     2 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"></span>
<span class="go"> int64 </span>
<span class="go"></span>
<span class="go">     2 </span>
<span class="go">     3 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"></span>
<span class="go"> int64 </span>
<span class="go"></span>
<span class="go">     2 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">distinct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the set intersection of multiple table expressions.</span>

<span class="sd">    The input tables must have identical schemas.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table</span>
<span class="sd">        A table expression</span>
<span class="sd">    *rest</span>
<span class="sd">        Additional table expressions</span>
<span class="sd">    distinct</span>
<span class="sd">        Only return distinct rows</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        A new table containing the intersection of all input tables.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [`ibis.intersect`][ibis.intersect]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t1 = ibis.memtable({&quot;a&quot;: [1, 2]})</span>
<span class="sd">    &gt;&gt;&gt; t1</span>
<span class="sd">    </span>
<span class="sd">     a     </span>
<span class="sd">    </span>
<span class="sd">     int64 </span>
<span class="sd">    </span>
<span class="sd">         1 </span>
<span class="sd">         2 </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t2 = ibis.memtable({&quot;a&quot;: [2, 3]})</span>
<span class="sd">    &gt;&gt;&gt; t2</span>
<span class="sd">    </span>
<span class="sd">     a     </span>
<span class="sd">    </span>
<span class="sd">     int64 </span>
<span class="sd">    </span>
<span class="sd">         2 </span>
<span class="sd">         3 </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t1.intersect(t2)</span>
<span class="sd">    </span>
<span class="sd">     a     </span>
<span class="sd">    </span>
<span class="sd">     int64 </span>
<span class="sd">    </span>
<span class="sd">         2 </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Intersection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">rest</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Intersection</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.join" class="doc doc-heading">
<code class="highlight language-python"><span class="n">join</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">predicates</span><span class="o">=</span><span class="p">(),</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">lname</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">rname</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{name}</span><span class="s1">_right&#39;</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.join" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Perform a join between two tables.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>left</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Left table to join</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>right</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Right table to join</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>predicates</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.Column">Column</span>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.Column">Column</span>] | <span title="ibis">ir</span>.<span title="ibis.BooleanColumn">BooleanColumn</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Boolean or column names to join on</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>how</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Literal" href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[&#39;inner&#39;, &#39;left&#39;, &#39;outer&#39;, &#39;right&#39;, &#39;semi&#39;, &#39;anti&#39;, &#39;any_inner&#39;, &#39;any_left&#39;, &#39;left_semi&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Join method</p>
            </div>
          </td>
          <td>
                <code>&#39;inner&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>lname</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A format string to use to rename overlapping columns in the left
table (e.g. <code>"left_{name}"</code>).</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>rname</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A format string to use to rename overlapping columns in the right
table (e.g. <code>"right_{name}"</code>).</p>
            </div>
          </td>
          <td>
                <code>&#39;{name}_right&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.examples</span> <span class="k">as</span> <span class="nn">ex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movies</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">ml_latest_small_movies</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movies</span>
<span class="go"></span>
<span class="go"> movieId  title                             genres                          </span>
<span class="go"></span>
<span class="go"> int64    string                            string                          </span>
<span class="go"></span>
<span class="go">       1  Toy Story (1995)                  Adventure|Animation|Children|C </span>
<span class="go">       2  Jumanji (1995)                    Adventure|Children|Fantasy      </span>
<span class="go">       3  Grumpier Old Men (1995)           Comedy|Romance                  </span>
<span class="go">       4  Waiting to Exhale (1995)          Comedy|Drama|Romance            </span>
<span class="go">       5  Father of the Bride Part II (19  Comedy                          </span>
<span class="go">       6  Heat (1995)                       Action|Crime|Thriller           </span>
<span class="go">       7  Sabrina (1995)                    Comedy|Romance                  </span>
<span class="go">       8  Tom and Huck (1995)               Adventure|Children              </span>
<span class="go">       9  Sudden Death (1995)               Action                          </span>
<span class="go">      10  GoldenEye (1995)                  Action|Adventure|Thriller       </span>
<span class="go">                                                                         </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">links</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">ml_latest_small_links</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">links</span>
<span class="go"></span>
<span class="go"> movieId  imdbId   tmdbId </span>
<span class="go"></span>
<span class="go"> int64    string   int64  </span>
<span class="go"></span>
<span class="go">       1  0114709     862 </span>
<span class="go">       2  0113497    8844 </span>
<span class="go">       3  0113228   15602 </span>
<span class="go">       4  0114885   31357 </span>
<span class="go">       5  0113041   11862 </span>
<span class="go">       6  0113277     949 </span>
<span class="go">       7  0114319   11860 </span>
<span class="go">       8  0112302   45325 </span>
<span class="go">       9  0114576    9091 </span>
<span class="go">      10  0113189     710 </span>
<span class="go">                       </span>
<span class="go"></span>
</code></pre></div>
    <p>Implicit inner equality join on the shared <code>movieId</code> column</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">linked</span> <span class="o">=</span> <span class="n">movies</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">links</span><span class="p">,</span> <span class="s2">&quot;movieId&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linked</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> movieId  title                   genres                  imdbId   tmdbId </span>
<span class="go"></span>
<span class="go"> int64    string                  string                  string   int64  </span>
<span class="go"></span>
<span class="go">       1  Toy Story (1995)        Adventure|Animation|C  0114709     862 </span>
<span class="go">       2  Jumanji (1995)          Adventure|Children|Fa  0113497    8844 </span>
<span class="go">       3  Grumpier Old Men (199  Comedy|Romance          0113228   15602 </span>
<span class="go">       4  Waiting to Exhale (19  Comedy|Drama|Romance    0114885   31357 </span>
<span class="go">       5  Father of the Bride P  Comedy                  0113041   11862 </span>
<span class="go"></span>
</code></pre></div>
    <p>Explicit equality join using the default <code>how</code> value of <code>"inner"</code></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">linked</span> <span class="o">=</span> <span class="n">movies</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">links</span><span class="p">,</span> <span class="n">movies</span><span class="o">.</span><span class="n">movieId</span> <span class="o">==</span> <span class="n">links</span><span class="o">.</span><span class="n">movieId</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linked</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> movieId  title                   genres                  imdbId   tmdbId </span>
<span class="go"></span>
<span class="go"> int64    string                  string                  string   int64  </span>
<span class="go"></span>
<span class="go">       1  Toy Story (1995)        Adventure|Animation|C  0114709     862 </span>
<span class="go">       2  Jumanji (1995)          Adventure|Children|Fa  0113497    8844 </span>
<span class="go">       3  Grumpier Old Men (199  Comedy|Romance          0113228   15602 </span>
<span class="go">       4  Waiting to Exhale (19  Comedy|Drama|Romance    0114885   31357 </span>
<span class="go">       5  Father of the Bride P  Comedy                  0113041   11862 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">join</span><span class="p">(</span>
    <span class="n">left</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">right</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">predicates</span><span class="p">:</span> <span class="nb">str</span>
    <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span>
        <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">]</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanColumn</span>
    <span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">how</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
        <span class="s1">&#39;inner&#39;</span><span class="p">,</span>
        <span class="s1">&#39;left&#39;</span><span class="p">,</span>
        <span class="s1">&#39;outer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;right&#39;</span><span class="p">,</span>
        <span class="s1">&#39;semi&#39;</span><span class="p">,</span>
        <span class="s1">&#39;anti&#39;</span><span class="p">,</span>
        <span class="s1">&#39;any_inner&#39;</span><span class="p">,</span>
        <span class="s1">&#39;any_left&#39;</span><span class="p">,</span>
        <span class="s1">&#39;left_semi&#39;</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;inner&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">lname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">rname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{name}</span><span class="s2">_right&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a join between two tables.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    left</span>
<span class="sd">        Left table to join</span>
<span class="sd">    right</span>
<span class="sd">        Right table to join</span>
<span class="sd">    predicates</span>
<span class="sd">        Boolean or column names to join on</span>
<span class="sd">    how</span>
<span class="sd">        Join method</span>
<span class="sd">    lname</span>
<span class="sd">        A format string to use to rename overlapping columns in the left</span>
<span class="sd">        table (e.g. ``&quot;left_{name}&quot;``).</span>
<span class="sd">    rname</span>
<span class="sd">        A format string to use to rename overlapping columns in the right</span>
<span class="sd">        table (e.g. ``&quot;right_{name}&quot;``).</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">    &gt;&gt;&gt; import ibis.examples as ex</span>
<span class="sd">    &gt;&gt;&gt; from ibis import _</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; movies = ex.ml_latest_small_movies.fetch()</span>
<span class="sd">    &gt;&gt;&gt; movies</span>
<span class="sd">    </span>
<span class="sd">     movieId  title                             genres                          </span>
<span class="sd">    </span>
<span class="sd">     int64    string                            string                          </span>
<span class="sd">    </span>
<span class="sd">           1  Toy Story (1995)                  Adventure|Animation|Children|C </span>
<span class="sd">           2  Jumanji (1995)                    Adventure|Children|Fantasy      </span>
<span class="sd">           3  Grumpier Old Men (1995)           Comedy|Romance                  </span>
<span class="sd">           4  Waiting to Exhale (1995)          Comedy|Drama|Romance            </span>
<span class="sd">           5  Father of the Bride Part II (19  Comedy                          </span>
<span class="sd">           6  Heat (1995)                       Action|Crime|Thriller           </span>
<span class="sd">           7  Sabrina (1995)                    Comedy|Romance                  </span>
<span class="sd">           8  Tom and Huck (1995)               Adventure|Children              </span>
<span class="sd">           9  Sudden Death (1995)               Action                          </span>
<span class="sd">          10  GoldenEye (1995)                  Action|Adventure|Thriller       </span>
<span class="sd">                                                                             </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; links = ex.ml_latest_small_links.fetch()</span>
<span class="sd">    &gt;&gt;&gt; links</span>
<span class="sd">    </span>
<span class="sd">     movieId  imdbId   tmdbId </span>
<span class="sd">    </span>
<span class="sd">     int64    string   int64  </span>
<span class="sd">    </span>
<span class="sd">           1  0114709     862 </span>
<span class="sd">           2  0113497    8844 </span>
<span class="sd">           3  0113228   15602 </span>
<span class="sd">           4  0114885   31357 </span>
<span class="sd">           5  0113041   11862 </span>
<span class="sd">           6  0113277     949 </span>
<span class="sd">           7  0114319   11860 </span>
<span class="sd">           8  0112302   45325 </span>
<span class="sd">           9  0114576    9091 </span>
<span class="sd">          10  0113189     710 </span>
<span class="sd">                           </span>
<span class="sd">    </span>

<span class="sd">    Implicit inner equality join on the shared `movieId` column</span>

<span class="sd">    &gt;&gt;&gt; linked = movies.join(links, &quot;movieId&quot;, how=&quot;inner&quot;)</span>
<span class="sd">    &gt;&gt;&gt; linked.head()</span>
<span class="sd">    </span>
<span class="sd">     movieId  title                   genres                  imdbId   tmdbId </span>
<span class="sd">    </span>
<span class="sd">     int64    string                  string                  string   int64  </span>
<span class="sd">    </span>
<span class="sd">           1  Toy Story (1995)        Adventure|Animation|C  0114709     862 </span>
<span class="sd">           2  Jumanji (1995)          Adventure|Children|Fa  0113497    8844 </span>
<span class="sd">           3  Grumpier Old Men (199  Comedy|Romance          0113228   15602 </span>
<span class="sd">           4  Waiting to Exhale (19  Comedy|Drama|Romance    0114885   31357 </span>
<span class="sd">           5  Father of the Bride P  Comedy                  0113041   11862 </span>
<span class="sd">    </span>

<span class="sd">    Explicit equality join using the default `how` value of `&quot;inner&quot;`</span>

<span class="sd">    &gt;&gt;&gt; linked = movies.join(links, movies.movieId == links.movieId)</span>
<span class="sd">    &gt;&gt;&gt; linked.head()</span>
<span class="sd">    </span>
<span class="sd">     movieId  title                   genres                  imdbId   tmdbId </span>
<span class="sd">    </span>
<span class="sd">     int64    string                  string                  string   int64  </span>
<span class="sd">    </span>
<span class="sd">           1  Toy Story (1995)        Adventure|Animation|C  0114709     862 </span>
<span class="sd">           2  Jumanji (1995)          Adventure|Children|Fa  0113497    8844 </span>
<span class="sd">           3  Grumpier Old Men (199  Comedy|Romance          0113228   15602 </span>
<span class="sd">           4  Waiting to Exhale (19  Comedy|Drama|Romance    0114885   31357 </span>
<span class="sd">           5  Father of the Bride P  Comedy                  0113041   11862 </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_join_classes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;inner&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">InnerJoin</span><span class="p">,</span>
        <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">LeftJoin</span><span class="p">,</span>
        <span class="s1">&#39;any_inner&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">AnyInnerJoin</span><span class="p">,</span>
        <span class="s1">&#39;any_left&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">AnyLeftJoin</span><span class="p">,</span>
        <span class="s1">&#39;outer&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">OuterJoin</span><span class="p">,</span>
        <span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">RightJoin</span><span class="p">,</span>
        <span class="s1">&#39;left_semi&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">LeftSemiJoin</span><span class="p">,</span>
        <span class="s1">&#39;semi&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">LeftSemiJoin</span><span class="p">,</span>
        <span class="s1">&#39;anti&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">LeftAntiJoin</span><span class="p">,</span>
        <span class="s1">&#39;cross&#39;</span><span class="p">:</span> <span class="n">ops</span><span class="o">.</span><span class="n">CrossJoin</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">klass</span> <span class="o">=</span> <span class="n">_join_classes</span><span class="p">[</span><span class="n">how</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="n">klass</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">predicates</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

    <span class="c1"># semi/anti join only give access to the left table&#39;s fields, so</span>
    <span class="c1"># there&#39;s never overlap</span>
    <span class="k">if</span> <span class="n">how</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;left_semi&quot;</span><span class="p">,</span> <span class="s2">&quot;semi&quot;</span><span class="p">,</span> <span class="s2">&quot;anti&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expr</span>

    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">relations</span><span class="o">.</span><span class="n">_dedup_join_columns</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">lname</span><span class="o">=</span><span class="n">lname</span><span class="p">,</span> <span class="n">rname</span><span class="o">=</span><span class="n">rname</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.limit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">limit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.limit" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Select <code>n</code> rows from <code>self</code> starting at <code>offset</code>.</p>
<div class="admonition note">
<p class="admonition-title">The result set is not deterministic without a call to <a class="autorefs autorefs-internal" href="#ibis.expr.types.relations.Table.order_by"><code>order_by</code></a>.</p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of rows to include</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>offset</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of rows to skip first</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The first <code>n</code> rows of <code>self</code> starting at <code>offset</code></p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> a      b      </span>
<span class="go"></span>
<span class="go"> int64  string </span>
<span class="go"></span>
<span class="go">     1  c      </span>
<span class="go">     1  a      </span>
<span class="go">     2  a      </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> a      b      </span>
<span class="go"></span>
<span class="go"> int64  string </span>
<span class="go"></span>
<span class="go">     1  c      </span>
<span class="go">     1  a      </span>
<span class="go"></span>
</code></pre></div>
      <h6 id="ibis.expr.types.relations.Table.limit--see-also">See Also<a class="headerlink" href="#ibis.expr.types.relations.Table.limit--see-also" title="Anchor link to this section for reference">&para;</a></h6>
<p><a class="autorefs autorefs-internal" href="#ibis.expr.types.relations.Table.order_by"><code>Table.order_by</code></a></p>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Select `n` rows from `self` starting at `offset`.</span>

<span class="sd">    !!! note &quot;The result set is not deterministic without a call to [`order_by`][ibis.expr.types.relations.Table.order_by].&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n</span>
<span class="sd">        Number of rows to include</span>
<span class="sd">    offset</span>
<span class="sd">        Number of rows to skip first</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        The first `n` rows of `self` starting at `offset`</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [1, 1, 2], &quot;b&quot;: [&quot;c&quot;, &quot;a&quot;, &quot;a&quot;]})</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     a      b      </span>
<span class="sd">    </span>
<span class="sd">     int64  string </span>
<span class="sd">    </span>
<span class="sd">         1  c      </span>
<span class="sd">         1  a      </span>
<span class="sd">         2  a      </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.limit(2)</span>
<span class="sd">    </span>
<span class="sd">     a      b      </span>
<span class="sd">    </span>
<span class="sd">     int64  string </span>
<span class="sd">    </span>
<span class="sd">         1  c      </span>
<span class="sd">         1  a      </span>
<span class="sd">    </span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [`Table.order_by`][ibis.expr.types.relations.Table.order_by]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">Limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.mutate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mutate</span><span class="p">(</span><span class="n">exprs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">mutations</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.mutate" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Add columns to a table expression.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exprs</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<span title="ibis">ir</span>.<a class="autorefs autorefs-internal" title="ibis.Expr" href="../#ibis.expr.types.core.Expr">Expr</a>] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of named expressions to add as columns</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>mutations</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.Value">Value</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Named expressions using keyword arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Table expression with additional columns</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_length_mm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> species  year   bill_length_mm </span>
<span class="go"></span>
<span class="go"> string   int64  float64        </span>
<span class="go"></span>
<span class="go"> Adelie    2007            39.1 </span>
<span class="go"> Adelie    2007            39.5 </span>
<span class="go"> Adelie    2007            40.3 </span>
<span class="go"> Adelie    2007             nan </span>
<span class="go"> Adelie    2007            36.7 </span>
<span class="go"> Adelie    2007            39.3 </span>
<span class="go"> Adelie    2007            38.9 </span>
<span class="go"> Adelie    2007            39.2 </span>
<span class="go"> Adelie    2007            34.1 </span>
<span class="go"> Adelie    2007            42.0 </span>
<span class="go">                             </span>
<span class="go"></span>
</code></pre></div>
    <p>Add a new column from a per-element expression</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">next_year</span><span class="o">=</span><span class="n">_</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> species  year   bill_length_mm  next_year </span>
<span class="go"></span>
<span class="go"> string   int64  float64         int64     </span>
<span class="go"></span>
<span class="go"> Adelie    2007            39.1       2008 </span>
<span class="go"> Adelie    2007            39.5       2008 </span>
<span class="go"> Adelie    2007            40.3       2008 </span>
<span class="go"> Adelie    2007             nan       2008 </span>
<span class="go"> Adelie    2007            36.7       2008 </span>
<span class="go"></span>
</code></pre></div>
    <p>Add a new column based on an aggregation. Note the automatic broadcasting.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="n">bill_demean</span><span class="o">=</span><span class="n">_</span><span class="o">.</span><span class="n">bill_length_mm</span> <span class="o">-</span> <span class="n">_</span><span class="o">.</span><span class="n">bill_length_mm</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> species  bill_demean </span>
<span class="go"></span>
<span class="go"> string   float64     </span>
<span class="go"></span>
<span class="go"> Adelie      -4.82193 </span>
<span class="go"> Adelie      -4.42193 </span>
<span class="go"> Adelie      -3.62193 </span>
<span class="go"> Adelie           nan </span>
<span class="go"> Adelie      -7.22193 </span>
<span class="go"></span>
</code></pre></div>
    <p>Mutate across multiple columns</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">across</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">numeric</span><span class="p">()</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">),</span> <span class="n">_</span> <span class="o">-</span> <span class="n">_</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> species  year   bill_length_mm </span>
<span class="go"></span>
<span class="go"> string   int64  float64        </span>
<span class="go"></span>
<span class="go"> Adelie    2007        -4.82193 </span>
<span class="go"> Adelie    2007        -4.42193 </span>
<span class="go"> Adelie    2007        -3.62193 </span>
<span class="go"> Adelie    2007             nan </span>
<span class="go"> Adelie    2007        -7.22193 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">exprs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Expr</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">mutations</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add columns to a table expression.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exprs</span>
<span class="sd">        List of named expressions to add as columns</span>
<span class="sd">    mutations</span>
<span class="sd">        Named expressions using keyword arguments</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Table expression with additional columns</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">    &gt;&gt;&gt; from ibis import _</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch().select(&quot;species&quot;, &quot;year&quot;, &quot;bill_length_mm&quot;)</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     species  year   bill_length_mm </span>
<span class="sd">    </span>
<span class="sd">     string   int64  float64        </span>
<span class="sd">    </span>
<span class="sd">     Adelie    2007            39.1 </span>
<span class="sd">     Adelie    2007            39.5 </span>
<span class="sd">     Adelie    2007            40.3 </span>
<span class="sd">     Adelie    2007             nan </span>
<span class="sd">     Adelie    2007            36.7 </span>
<span class="sd">     Adelie    2007            39.3 </span>
<span class="sd">     Adelie    2007            38.9 </span>
<span class="sd">     Adelie    2007            39.2 </span>
<span class="sd">     Adelie    2007            34.1 </span>
<span class="sd">     Adelie    2007            42.0 </span>
<span class="sd">                                 </span>
<span class="sd">    </span>

<span class="sd">    Add a new column from a per-element expression</span>

<span class="sd">    &gt;&gt;&gt; t.mutate(next_year=_.year + 1).head()</span>
<span class="sd">    </span>
<span class="sd">     species  year   bill_length_mm  next_year </span>
<span class="sd">    </span>
<span class="sd">     string   int64  float64         int64     </span>
<span class="sd">    </span>
<span class="sd">     Adelie    2007            39.1       2008 </span>
<span class="sd">     Adelie    2007            39.5       2008 </span>
<span class="sd">     Adelie    2007            40.3       2008 </span>
<span class="sd">     Adelie    2007             nan       2008 </span>
<span class="sd">     Adelie    2007            36.7       2008 </span>
<span class="sd">    </span>

<span class="sd">    Add a new column based on an aggregation. Note the automatic broadcasting.</span>

<span class="sd">    &gt;&gt;&gt; t.select(&quot;species&quot;, bill_demean=_.bill_length_mm - _.bill_length_mm.mean()).head()</span>
<span class="sd">    </span>
<span class="sd">     species  bill_demean </span>
<span class="sd">    </span>
<span class="sd">     string   float64     </span>
<span class="sd">    </span>
<span class="sd">     Adelie      -4.82193 </span>
<span class="sd">     Adelie      -4.42193 </span>
<span class="sd">     Adelie      -3.62193 </span>
<span class="sd">     Adelie           nan </span>
<span class="sd">     Adelie      -7.22193 </span>
<span class="sd">    </span>

<span class="sd">    Mutate across multiple columns</span>

<span class="sd">    &gt;&gt;&gt; t.mutate(s.across(s.numeric() &amp; ~s.c(&quot;year&quot;), _ - _.mean())).head()</span>
<span class="sd">    </span>
<span class="sd">     species  year   bill_length_mm </span>
<span class="sd">    </span>
<span class="sd">     string   int64  float64        </span>
<span class="sd">    </span>
<span class="sd">     Adelie    2007        -4.82193 </span>
<span class="sd">     Adelie    2007        -4.42193 </span>
<span class="sd">     Adelie    2007        -3.62193 </span>
<span class="sd">     Adelie    2007             nan </span>
<span class="sd">     Adelie    2007        -7.22193 </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">ibis.expr.analysis</span> <span class="k">as</span> <span class="nn">an</span>

    <span class="n">exprs</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">exprs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">exprs</span><span class="p">)</span>
    <span class="n">exprs</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
        <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">))</span> <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">exprs</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">mutations</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">))</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">mutation_exprs</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">get_mutation_exprs</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">exprs</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mutation_exprs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.nunique" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nunique</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.nunique" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute the number of unique rows in the table.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>where</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.BooleanValue">BooleanValue</span> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional boolean expression to filter rows when counting.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="ibis.expr.types.numeric.IntegerScalar">IntegerScalar</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of unique rows in the table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> a      </span>
<span class="go"></span>
<span class="go"> string </span>
<span class="go"></span>
<span class="go"> foo    </span>
<span class="go"> bar    </span>
<span class="go"> bar    </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">nunique</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">a</span> <span class="o">!=</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span>
<span class="go">1</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">nunique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanValue</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">IntegerScalar</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the number of unique rows in the table.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    where</span>
<span class="sd">        Optional boolean expression to filter rows when counting.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    IntegerScalar</span>
<span class="sd">        Number of unique rows in the table</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [&quot;foo&quot;, &quot;bar&quot;, &quot;bar&quot;]})</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     a      </span>
<span class="sd">    </span>
<span class="sd">     string </span>
<span class="sd">    </span>
<span class="sd">     foo    </span>
<span class="sd">     bar    </span>
<span class="sd">     bar    </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.nunique()</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; t.nunique(t.a != &quot;foo&quot;)</span>
<span class="sd">    1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">CountDistinctStar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.order_by" class="doc doc-heading">
<code class="highlight language-python"><span class="n">order_by</span><span class="p">(</span><span class="n">by</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.order_by" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Sort a table by one or more expressions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>by</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.Column">Column</span> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.Column">Column</span>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>] | <a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<span title="ibis">ir</span>.<span title="ibis.Column">Column</span>] | <a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.Column">Column</span>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>]] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Expressions to sort the table by.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sorted table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">],</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> a      b       c     </span>
<span class="go"></span>
<span class="go"> int64  string  int64 </span>
<span class="go"></span>
<span class="go">     1  c           4 </span>
<span class="go">     2  b           6 </span>
<span class="go">     3  a           5 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> a      b       c     </span>
<span class="go"></span>
<span class="go"> int64  string  int64 </span>
<span class="go"></span>
<span class="go">     3  a           5 </span>
<span class="go">     2  b           6 </span>
<span class="go">     1  c           4 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">ibis</span><span class="o">.</span><span class="n">desc</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">))</span>
<span class="go"></span>
<span class="go"> a      b       c     </span>
<span class="go"></span>
<span class="go"> int64  string  int64 </span>
<span class="go"></span>
<span class="go">     2  b           6 </span>
<span class="go">     3  a           5 </span>
<span class="go">     1  c           4 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">order_by</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">by</span><span class="p">:</span> <span class="nb">str</span>
    <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span>
    <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span>
    <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">]</span>
    <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]</span>
    <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort a table by one or more expressions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    by</span>
<span class="sd">        Expressions to sort the table by.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Sorted table</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [1, 2, 3], &quot;b&quot;: [&quot;c&quot;, &quot;b&quot;, &quot;a&quot;], &quot;c&quot;: [4, 6, 5]})</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     a      b       c     </span>
<span class="sd">    </span>
<span class="sd">     int64  string  int64 </span>
<span class="sd">    </span>
<span class="sd">         1  c           4 </span>
<span class="sd">         2  b           6 </span>
<span class="sd">         3  a           5 </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.order_by(&quot;b&quot;)</span>
<span class="sd">    </span>
<span class="sd">     a      b       c     </span>
<span class="sd">    </span>
<span class="sd">     int64  string  int64 </span>
<span class="sd">    </span>
<span class="sd">         3  a           5 </span>
<span class="sd">         2  b           6 </span>
<span class="sd">         1  c           4 </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.order_by(ibis.desc(&quot;c&quot;))</span>
<span class="sd">    </span>
<span class="sd">     a      b       c     </span>
<span class="sd">    </span>
<span class="sd">     int64  string  int64 </span>
<span class="sd">    </span>
<span class="sd">         2  b           6 </span>
<span class="sd">         3  a           5 </span>
<span class="sd">         1  c           4 </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">used_tuple_syntax</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="n">by</span><span class="p">]</span>
        <span class="n">used_tuple_syntax</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">sort_keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">by</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Tuple must be of length 2, got </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
                <span class="p">)</span>
            <span class="n">item</span> <span class="o">=</span> <span class="p">(</span><span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">used_tuple_syntax</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="n">sort_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">used_tuple_syntax</span><span class="p">:</span>
        <span class="n">util</span><span class="o">.</span><span class="n">warn_deprecated</span><span class="p">(</span>
            <span class="s2">&quot;table.order_by((key, True)) and table.order_by((key, False)) syntax&quot;</span><span class="p">,</span>
            <span class="n">as_of</span><span class="o">=</span><span class="s2">&quot;6.0&quot;</span><span class="p">,</span>
            <span class="n">removed_in</span><span class="o">=</span><span class="s2">&quot;7.0&quot;</span><span class="p">,</span>
            <span class="n">instead</span><span class="o">=</span><span class="s2">&quot;Use ibis.desc(key) or ibis.asc(key) instead&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">sort_keys</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.pivot_longer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pivot_longer</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">names_to</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">names_pattern</span><span class="o">=</span><span class="s1">&#39;(.+)&#39;</span><span class="p">,</span> <span class="n">names_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values_to</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">values_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.pivot_longer" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Transform a table from wider to longer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>col</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">s</span>.<span title="ibis.Selector">Selector</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String column name or selector.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>names_to</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A string or iterable of strings indicating how to name the new
pivoted columns.</p>
            </div>
          </td>
          <td>
                <code>&#39;name&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>names_pattern</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/re.html#module-re">re</a>.<a class="autorefs autorefs-external" title="re.Pattern" href="https://docs.python.org/3/library/re.html#re.Pattern">Pattern</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Pattern to use to extract column names from the input. By default
the entire column name is extracted.</p>
            </div>
          </td>
          <td>
                <code>&#39;(.+)&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>names_transform</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <span title="ibis">ir</span>.<span title="ibis.Value">Value</span>] | <a class="autorefs autorefs-external" title="typing.Mapping" href="https://docs.python.org/3/library/typing.html#typing.Mapping">Mapping</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <span title="ibis">ir</span>.<span title="ibis.Value">Value</span>]] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Function or mapping of a name in <code>names_to</code> to a function to
transform a column name to a value.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>values_to</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the pivoted value column.</p>
            </div>
          </td>
          <td>
                <code>&#39;value&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>values_transform</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="ibis">ir</span>.<span title="ibis.Value">Value</span>], <span title="ibis">ir</span>.<span title="ibis.Value">Value</span>] | <span title="ibis.expr.deferred.Deferred">Deferred</span> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Apply a function to the value column. This can be a lambda or
deferred expression.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Pivoted table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p>Basic usage</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">relig_income</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">relig_income_raw</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">relig_income</span>
<span class="go"></span>
<span class="go"> religion                 &lt;$10k  $10-20k  $20-30k  $30-40k  $40-50k   </span>
<span class="go"></span>
<span class="go"> string                   int64  int64    int64    int64    int64     </span>
<span class="go"></span>
<span class="go"> Agnostic                    27       34       60       81       76   </span>
<span class="go"> Atheist                     12       27       37       52       35   </span>
<span class="go"> Buddhist                    27       21       30       34       33   </span>
<span class="go"> Catholic                   418      617      732      670      638   </span>
<span class="go"> Dont know/refused          15       14       15       11       10   </span>
<span class="go"> Evangelical Prot           575      869     1064      982      881   </span>
<span class="go"> Hindu                        1        9        7        9       11   </span>
<span class="go"> Historically Black Prot    228      244      236      238      197   </span>
<span class="go"> Jehovah&#39;s Witness           20       27       24       24       21   </span>
<span class="go"> Jewish                      19       19       25       25       30   </span>
<span class="go">                                                                </span>
<span class="go"></span>
</code></pre></div>
    <p>Here we convert column names not matching the selector for the <code>religion</code> column
and convert those names into values</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">relig_income</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="o">~</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="s2">&quot;religion&quot;</span><span class="p">),</span> <span class="n">names_to</span><span class="o">=</span><span class="s2">&quot;income&quot;</span><span class="p">,</span> <span class="n">values_to</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> religion  income              count </span>
<span class="go"></span>
<span class="go"> string    string              int64 </span>
<span class="go"></span>
<span class="go"> Agnostic  &lt;$10k                  27 </span>
<span class="go"> Agnostic  $10-20k                34 </span>
<span class="go"> Agnostic  $20-30k                60 </span>
<span class="go"> Agnostic  $30-40k                81 </span>
<span class="go"> Agnostic  $40-50k                76 </span>
<span class="go"> Agnostic  $50-75k               137 </span>
<span class="go"> Agnostic  $75-100k              122 </span>
<span class="go"> Agnostic  $100-150k             109 </span>
<span class="go"> Agnostic  &gt;150k                  84 </span>
<span class="go"> Agnostic  Don&#39;t know/refused     96 </span>
<span class="go">                                  </span>
<span class="go"></span>
</code></pre></div>
    <p>Similarly for a different example dataset, we convert names to values
but using a different selector and the default <code>values_to</code> value.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">world_bank_pop</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">world_bank_pop_raw</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">world_bank_pop</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> country  indicator    2000          2001          2002           </span>
<span class="go"></span>
<span class="go"> string   string       float64       float64       float64        </span>
<span class="go"></span>
<span class="go"> ABW      SP.URB.TOTL  4.244400e+04  4.304800e+04  4.367000e+04   </span>
<span class="go"> ABW      SP.URB.GROW  1.182632e+00  1.413021e+00  1.434560e+00   </span>
<span class="go"> ABW      SP.POP.TOTL  9.085300e+04  9.289800e+04  9.499200e+04   </span>
<span class="go"> ABW      SP.POP.GROW  2.055027e+00  2.225930e+00  2.229056e+00   </span>
<span class="go"> AFG      SP.URB.TOTL  4.436299e+06  4.648055e+06  4.892951e+06   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">world_bank_pop</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\d</span><span class="si">{4}</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">names_to</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> country  indicator    year    value   </span>
<span class="go"></span>
<span class="go"> string   string       string  float64 </span>
<span class="go"></span>
<span class="go"> ABW      SP.URB.TOTL  2000    42444.0 </span>
<span class="go"> ABW      SP.URB.TOTL  2001    43048.0 </span>
<span class="go"> ABW      SP.URB.TOTL  2002    43670.0 </span>
<span class="go"> ABW      SP.URB.TOTL  2003    44246.0 </span>
<span class="go"> ABW      SP.URB.TOTL  2004    44669.0 </span>
<span class="go"></span>
</code></pre></div>
    <p><code>pivot_longer</code> has some preprocessing capabiltiies like stripping a prefix and applying
a function to column names</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">billboard</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">billboard</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">billboard</span>
<span class="go"></span>
<span class="go"> artist          track                    date_entered  wk1    wk2     </span>
<span class="go"></span>
<span class="go"> string          string                   date          int64  int64   </span>
<span class="go"></span>
<span class="go"> 2 Pac           Baby Don&#39;t Cry (Keep...  2000-02-26       87     82   </span>
<span class="go"> 2Ge+her         The Hardest Part Of ...  2000-09-02       91     87   </span>
<span class="go"> 3 Doors Down    Kryptonite               2000-04-08       81     70   </span>
<span class="go"> 3 Doors Down    Loser                    2000-10-21       76     76   </span>
<span class="go"> 504 Boyz        Wobble Wobble            2000-04-15       57     34   </span>
<span class="go"> 98^0            Give Me Just One Nig...  2000-08-19       51     39   </span>
<span class="go"> A*Teens         Dancing Queen            2000-07-08       97     97   </span>
<span class="go"> Aaliyah         I Don&#39;t Wanna            2000-01-29       84     62   </span>
<span class="go"> Aaliyah         Try Again                2000-03-18       59     53   </span>
<span class="go"> Adams, Yolanda  Open My Heart            2000-08-26       76     76   </span>
<span class="go">                                                                  </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">billboard</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;wk&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">names_to</span><span class="o">=</span><span class="s2">&quot;week&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">names_pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;wk(.+)&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">names_transform</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">values_to</span><span class="o">=</span><span class="s2">&quot;rank&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">values_transform</span><span class="o">=</span><span class="n">_</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="s2">&quot;rank&quot;</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> artist   track                    date_entered  week  rank  </span>
<span class="go"></span>
<span class="go"> string   string                   date          int8  int64 </span>
<span class="go"></span>
<span class="go"> 2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       1     87 </span>
<span class="go"> 2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       2     82 </span>
<span class="go"> 2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       3     72 </span>
<span class="go"> 2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       4     77 </span>
<span class="go"> 2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       5     87 </span>
<span class="go"> 2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       6     94 </span>
<span class="go"> 2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       7     99 </span>
<span class="go"> 2Ge+her  The Hardest Part Of ...  2000-09-02       1     91 </span>
<span class="go"> 2Ge+her  The Hardest Part Of ...  2000-09-02       2     87 </span>
<span class="go"> 2Ge+her  The Hardest Part Of ...  2000-09-02       3     92 </span>
<span class="go">                                                        </span>
<span class="go"></span>
</code></pre></div>
    <p>You can use regular expression capture groups to extract multiple
variables stored in column names</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">who</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">who</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">who</span>
<span class="go"></span>
<span class="go"> country      iso2    iso3    year   new_sp_m014  new_sp_m1524   </span>
<span class="go"></span>
<span class="go"> string       string  string  int64  int64        int64          </span>
<span class="go"></span>
<span class="go"> Afghanistan  AF      AFG      1980         NULL          NULL   </span>
<span class="go"> Afghanistan  AF      AFG      1981         NULL          NULL   </span>
<span class="go"> Afghanistan  AF      AFG      1982         NULL          NULL   </span>
<span class="go"> Afghanistan  AF      AFG      1983         NULL          NULL   </span>
<span class="go"> Afghanistan  AF      AFG      1984         NULL          NULL   </span>
<span class="go"> Afghanistan  AF      AFG      1985         NULL          NULL   </span>
<span class="go"> Afghanistan  AF      AFG      1986         NULL          NULL   </span>
<span class="go"> Afghanistan  AF      AFG      1987         NULL          NULL   </span>
<span class="go"> Afghanistan  AF      AFG      1988         NULL          NULL   </span>
<span class="go"> Afghanistan  AF      AFG      1989         NULL          NULL   </span>
<span class="go">                                                           </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">who</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="go">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">who</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">s</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;new_sp_m014&quot;</span><span class="p">:</span><span class="s2">&quot;newrel_f65&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">names_to</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">names_pattern</span><span class="o">=</span><span class="s2">&quot;new_?(.*)_(.)(.*)&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">values_to</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go"></span>
<span class="go"> country      iso2    iso3    year   diagnosis  gender  age     count </span>
<span class="go"></span>
<span class="go"> string       string  string  int64  string     string  string  int64 </span>
<span class="go"></span>
<span class="go"> Afghanistan  AF      AFG      1980  sp         m       014      NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp         m       1524     NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp         m       2534     NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp         m       3544     NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp         m       4554     NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp         m       5564     NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp         m       65       NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp         f       014      NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp         f       1524     NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp         f       2534     NULL </span>
<span class="go">                                                              </span>
<span class="go"></span>
</code></pre></div>
    <p><code>names_transform</code> is flexible, and can be:</p>
<div class="language-text highlight"><pre><span></span><code>1. A mapping of one or more names in `names_to` to callable
2. A callable that will be applied to every name
</code></pre></div>
<p>Let's recode gender and age to numeric values using a mapping</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">who</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">s</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;new_sp_m014&quot;</span><span class="p">:</span><span class="s2">&quot;newrel_f65&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">names_to</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">names_pattern</span><span class="o">=</span><span class="s2">&quot;new_?(.*)_(.)(.*)&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">names_transform</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">gender</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">age</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;014&quot;</span><span class="p">,</span> <span class="s2">&quot;1524&quot;</span><span class="p">,</span> <span class="s2">&quot;2534&quot;</span><span class="p">,</span> <span class="s2">&quot;3544&quot;</span><span class="p">,</span> <span class="s2">&quot;4554&quot;</span><span class="p">,</span> <span class="s2">&quot;5564&quot;</span><span class="p">,</span> <span class="s2">&quot;65&quot;</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span><span class="o">.</span><span class="n">get</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span>    <span class="n">values_to</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go"></span>
<span class="go"> country      iso2    iso3    year   diagnosis  gender  age   count </span>
<span class="go"></span>
<span class="go"> string       string  string  int64  string     int8    int8  int64 </span>
<span class="go"></span>
<span class="go"> Afghanistan  AF      AFG      1980  sp              1     0   NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp              1     1   NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp              1     2   NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp              1     3   NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp              1     4   NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp              1     5   NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp              1     6   NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp              2     0   NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp              2     1   NULL </span>
<span class="go"> Afghanistan  AF      AFG      1980  sp              2     2   NULL </span>
<span class="go">                                                            </span>
<span class="go"></span>
</code></pre></div>
    <p>The number of match groups in <code>names_pattern</code> must match the length of <code>names_to</code></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">who</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">s</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;new_sp_m014&quot;</span><span class="p">:</span><span class="s2">&quot;newrel_f65&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">names_to</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">names_pattern</span><span class="o">=</span><span class="s2">&quot;new_?(.*)_.(.*)&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">ibis.common.exceptions.IbisInputError</span>: <span class="n">Number of match groups in `names_pattern` ...</span>
</code></pre></div>
    <p><code>names_transform</code> must be a mapping or callable</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">who</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;new_sp_m014&quot;</span><span class="p">:</span><span class="s2">&quot;newrel_f65&quot;</span><span class="p">],</span> <span class="n">names_transform</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">ibis.common.exceptions.IbisTypeError</span>: <span class="n">... Got &lt;class &#39;str&#39;&gt;</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span>
<span class="normal">2871</span>
<span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span>
<span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span>
<span class="normal">2997</span>
<span class="normal">2998</span>
<span class="normal">2999</span>
<span class="normal">3000</span>
<span class="normal">3001</span>
<span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span>
<span class="normal">3005</span>
<span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span>
<span class="normal">3031</span>
<span class="normal">3032</span>
<span class="normal">3033</span>
<span class="normal">3034</span>
<span class="normal">3035</span>
<span class="normal">3036</span>
<span class="normal">3037</span>
<span class="normal">3038</span>
<span class="normal">3039</span>
<span class="normal">3040</span>
<span class="normal">3041</span>
<span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span>
<span class="normal">3057</span>
<span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span>
<span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span>
<span class="normal">3080</span>
<span class="normal">3081</span>
<span class="normal">3082</span>
<span class="normal">3083</span>
<span class="normal">3084</span>
<span class="normal">3085</span>
<span class="normal">3086</span>
<span class="normal">3087</span>
<span class="normal">3088</span>
<span class="normal">3089</span>
<span class="normal">3090</span>
<span class="normal">3091</span>
<span class="normal">3092</span>
<span class="normal">3093</span>
<span class="normal">3094</span>
<span class="normal">3095</span>
<span class="normal">3096</span>
<span class="normal">3097</span>
<span class="normal">3098</span>
<span class="normal">3099</span>
<span class="normal">3100</span>
<span class="normal">3101</span>
<span class="normal">3102</span>
<span class="normal">3103</span>
<span class="normal">3104</span>
<span class="normal">3105</span>
<span class="normal">3106</span>
<span class="normal">3107</span>
<span class="normal">3108</span>
<span class="normal">3109</span>
<span class="normal">3110</span>
<span class="normal">3111</span>
<span class="normal">3112</span>
<span class="normal">3113</span>
<span class="normal">3114</span>
<span class="normal">3115</span>
<span class="normal">3116</span>
<span class="normal">3117</span>
<span class="normal">3118</span>
<span class="normal">3119</span>
<span class="normal">3120</span>
<span class="normal">3121</span>
<span class="normal">3122</span>
<span class="normal">3123</span>
<span class="normal">3124</span>
<span class="normal">3125</span>
<span class="normal">3126</span>
<span class="normal">3127</span>
<span class="normal">3128</span>
<span class="normal">3129</span>
<span class="normal">3130</span>
<span class="normal">3131</span>
<span class="normal">3132</span>
<span class="normal">3133</span>
<span class="normal">3134</span>
<span class="normal">3135</span>
<span class="normal">3136</span>
<span class="normal">3137</span>
<span class="normal">3138</span>
<span class="normal">3139</span>
<span class="normal">3140</span>
<span class="normal">3141</span>
<span class="normal">3142</span>
<span class="normal">3143</span>
<span class="normal">3144</span>
<span class="normal">3145</span>
<span class="normal">3146</span>
<span class="normal">3147</span>
<span class="normal">3148</span>
<span class="normal">3149</span>
<span class="normal">3150</span>
<span class="normal">3151</span>
<span class="normal">3152</span>
<span class="normal">3153</span>
<span class="normal">3154</span>
<span class="normal">3155</span>
<span class="normal">3156</span>
<span class="normal">3157</span>
<span class="normal">3158</span>
<span class="normal">3159</span>
<span class="normal">3160</span>
<span class="normal">3161</span>
<span class="normal">3162</span>
<span class="normal">3163</span>
<span class="normal">3164</span>
<span class="normal">3165</span>
<span class="normal">3166</span>
<span class="normal">3167</span>
<span class="normal">3168</span>
<span class="normal">3169</span>
<span class="normal">3170</span>
<span class="normal">3171</span>
<span class="normal">3172</span>
<span class="normal">3173</span>
<span class="normal">3174</span>
<span class="normal">3175</span>
<span class="normal">3176</span>
<span class="normal">3177</span>
<span class="normal">3178</span>
<span class="normal">3179</span>
<span class="normal">3180</span>
<span class="normal">3181</span>
<span class="normal">3182</span>
<span class="normal">3183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pivot_longer</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">names_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
    <span class="n">names_pattern</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">Pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;(.+)&quot;</span><span class="p">,</span>
    <span class="n">names_transform</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">]</span>
    <span class="o">|</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">]]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">values_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span>
    <span class="n">values_transform</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">],</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">]</span> <span class="o">|</span> <span class="n">Deferred</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transform a table from wider to longer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    col</span>
<span class="sd">        String column name or selector.</span>
<span class="sd">    names_to</span>
<span class="sd">        A string or iterable of strings indicating how to name the new</span>
<span class="sd">        pivoted columns.</span>
<span class="sd">    names_pattern</span>
<span class="sd">        Pattern to use to extract column names from the input. By default</span>
<span class="sd">        the entire column name is extracted.</span>
<span class="sd">    names_transform</span>
<span class="sd">        Function or mapping of a name in `names_to` to a function to</span>
<span class="sd">        transform a column name to a value.</span>
<span class="sd">    values_to</span>
<span class="sd">        Name of the pivoted value column.</span>
<span class="sd">    values_transform</span>
<span class="sd">        Apply a function to the value column. This can be a lambda or</span>
<span class="sd">        deferred expression.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Pivoted table</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Basic usage</span>

<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">    &gt;&gt;&gt; from ibis import _</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; relig_income = ibis.examples.relig_income_raw.fetch()</span>
<span class="sd">    &gt;&gt;&gt; relig_income</span>
<span class="sd">    </span>
<span class="sd">     religion                 &lt;$10k  $10-20k  $20-30k  $30-40k  $40-50k   </span>
<span class="sd">    </span>
<span class="sd">     string                   int64  int64    int64    int64    int64     </span>
<span class="sd">    </span>
<span class="sd">     Agnostic                    27       34       60       81       76   </span>
<span class="sd">     Atheist                     12       27       37       52       35   </span>
<span class="sd">     Buddhist                    27       21       30       34       33   </span>
<span class="sd">     Catholic                   418      617      732      670      638   </span>
<span class="sd">     Dont know/refused          15       14       15       11       10   </span>
<span class="sd">     Evangelical Prot           575      869     1064      982      881   </span>
<span class="sd">     Hindu                        1        9        7        9       11   </span>
<span class="sd">     Historically Black Prot    228      244      236      238      197   </span>
<span class="sd">     Jehovah&#39;s Witness           20       27       24       24       21   </span>
<span class="sd">     Jewish                      19       19       25       25       30   </span>
<span class="sd">                                                                    </span>
<span class="sd">    </span>

<span class="sd">    Here we convert column names not matching the selector for the `religion` column</span>
<span class="sd">    and convert those names into values</span>

<span class="sd">    &gt;&gt;&gt; relig_income.pivot_longer(~s.c(&quot;religion&quot;), names_to=&quot;income&quot;, values_to=&quot;count&quot;)</span>
<span class="sd">    </span>
<span class="sd">     religion  income              count </span>
<span class="sd">    </span>
<span class="sd">     string    string              int64 </span>
<span class="sd">    </span>
<span class="sd">     Agnostic  &lt;$10k                  27 </span>
<span class="sd">     Agnostic  $10-20k                34 </span>
<span class="sd">     Agnostic  $20-30k                60 </span>
<span class="sd">     Agnostic  $30-40k                81 </span>
<span class="sd">     Agnostic  $40-50k                76 </span>
<span class="sd">     Agnostic  $50-75k               137 </span>
<span class="sd">     Agnostic  $75-100k              122 </span>
<span class="sd">     Agnostic  $100-150k             109 </span>
<span class="sd">     Agnostic  &gt;150k                  84 </span>
<span class="sd">     Agnostic  Don&#39;t know/refused     96 </span>
<span class="sd">                                      </span>
<span class="sd">    </span>

<span class="sd">    Similarly for a different example dataset, we convert names to values</span>
<span class="sd">    but using a different selector and the default `values_to` value.</span>

<span class="sd">    &gt;&gt;&gt; world_bank_pop = ibis.examples.world_bank_pop_raw.fetch()</span>
<span class="sd">    &gt;&gt;&gt; world_bank_pop.head()</span>
<span class="sd">    </span>
<span class="sd">     country  indicator    2000          2001          2002           </span>
<span class="sd">    </span>
<span class="sd">     string   string       float64       float64       float64        </span>
<span class="sd">    </span>
<span class="sd">     ABW      SP.URB.TOTL  4.244400e+04  4.304800e+04  4.367000e+04   </span>
<span class="sd">     ABW      SP.URB.GROW  1.182632e+00  1.413021e+00  1.434560e+00   </span>
<span class="sd">     ABW      SP.POP.TOTL  9.085300e+04  9.289800e+04  9.499200e+04   </span>
<span class="sd">     ABW      SP.POP.GROW  2.055027e+00  2.225930e+00  2.229056e+00   </span>
<span class="sd">     AFG      SP.URB.TOTL  4.436299e+06  4.648055e+06  4.892951e+06   </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; world_bank_pop.pivot_longer(s.matches(r&quot;\\d{4}&quot;), names_to=&quot;year&quot;).head()</span>
<span class="sd">    </span>
<span class="sd">     country  indicator    year    value   </span>
<span class="sd">    </span>
<span class="sd">     string   string       string  float64 </span>
<span class="sd">    </span>
<span class="sd">     ABW      SP.URB.TOTL  2000    42444.0 </span>
<span class="sd">     ABW      SP.URB.TOTL  2001    43048.0 </span>
<span class="sd">     ABW      SP.URB.TOTL  2002    43670.0 </span>
<span class="sd">     ABW      SP.URB.TOTL  2003    44246.0 </span>
<span class="sd">     ABW      SP.URB.TOTL  2004    44669.0 </span>
<span class="sd">    </span>

<span class="sd">    `pivot_longer` has some preprocessing capabiltiies like stripping a prefix and applying</span>
<span class="sd">    a function to column names</span>

<span class="sd">    &gt;&gt;&gt; billboard = ibis.examples.billboard.fetch()</span>
<span class="sd">    &gt;&gt;&gt; billboard</span>
<span class="sd">    </span>
<span class="sd">     artist          track                    date_entered  wk1    wk2     </span>
<span class="sd">    </span>
<span class="sd">     string          string                   date          int64  int64   </span>
<span class="sd">    </span>
<span class="sd">     2 Pac           Baby Don&#39;t Cry (Keep...  2000-02-26       87     82   </span>
<span class="sd">     2Ge+her         The Hardest Part Of ...  2000-09-02       91     87   </span>
<span class="sd">     3 Doors Down    Kryptonite               2000-04-08       81     70   </span>
<span class="sd">     3 Doors Down    Loser                    2000-10-21       76     76   </span>
<span class="sd">     504 Boyz        Wobble Wobble            2000-04-15       57     34   </span>
<span class="sd">     98^0            Give Me Just One Nig...  2000-08-19       51     39   </span>
<span class="sd">     A*Teens         Dancing Queen            2000-07-08       97     97   </span>
<span class="sd">     Aaliyah         I Don&#39;t Wanna            2000-01-29       84     62   </span>
<span class="sd">     Aaliyah         Try Again                2000-03-18       59     53   </span>
<span class="sd">     Adams, Yolanda  Open My Heart            2000-08-26       76     76   </span>
<span class="sd">                                                                      </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; billboard.pivot_longer(</span>
<span class="sd">    ...     s.startswith(&quot;wk&quot;),</span>
<span class="sd">    ...     names_to=&quot;week&quot;,</span>
<span class="sd">    ...     names_pattern=r&quot;wk(.+)&quot;,</span>
<span class="sd">    ...     names_transform=int,</span>
<span class="sd">    ...     values_to=&quot;rank&quot;,</span>
<span class="sd">    ...     values_transform=_.cast(&quot;int&quot;),</span>
<span class="sd">    ... ).dropna(&quot;rank&quot;)</span>
<span class="sd">    </span>
<span class="sd">     artist   track                    date_entered  week  rank  </span>
<span class="sd">    </span>
<span class="sd">     string   string                   date          int8  int64 </span>
<span class="sd">    </span>
<span class="sd">     2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       1     87 </span>
<span class="sd">     2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       2     82 </span>
<span class="sd">     2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       3     72 </span>
<span class="sd">     2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       4     77 </span>
<span class="sd">     2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       5     87 </span>
<span class="sd">     2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       6     94 </span>
<span class="sd">     2 Pac    Baby Don&#39;t Cry (Keep...  2000-02-26       7     99 </span>
<span class="sd">     2Ge+her  The Hardest Part Of ...  2000-09-02       1     91 </span>
<span class="sd">     2Ge+her  The Hardest Part Of ...  2000-09-02       2     87 </span>
<span class="sd">     2Ge+her  The Hardest Part Of ...  2000-09-02       3     92 </span>
<span class="sd">                                                            </span>
<span class="sd">    </span>

<span class="sd">    You can use regular expression capture groups to extract multiple</span>
<span class="sd">    variables stored in column names</span>

<span class="sd">    &gt;&gt;&gt; who = ibis.examples.who.fetch()</span>
<span class="sd">    &gt;&gt;&gt; who</span>
<span class="sd">    </span>
<span class="sd">     country      iso2    iso3    year   new_sp_m014  new_sp_m1524   </span>
<span class="sd">    </span>
<span class="sd">     string       string  string  int64  int64        int64          </span>
<span class="sd">    </span>
<span class="sd">     Afghanistan  AF      AFG      1980         NULL          NULL   </span>
<span class="sd">     Afghanistan  AF      AFG      1981         NULL          NULL   </span>
<span class="sd">     Afghanistan  AF      AFG      1982         NULL          NULL   </span>
<span class="sd">     Afghanistan  AF      AFG      1983         NULL          NULL   </span>
<span class="sd">     Afghanistan  AF      AFG      1984         NULL          NULL   </span>
<span class="sd">     Afghanistan  AF      AFG      1985         NULL          NULL   </span>
<span class="sd">     Afghanistan  AF      AFG      1986         NULL          NULL   </span>
<span class="sd">     Afghanistan  AF      AFG      1987         NULL          NULL   </span>
<span class="sd">     Afghanistan  AF      AFG      1988         NULL          NULL   </span>
<span class="sd">     Afghanistan  AF      AFG      1989         NULL          NULL   </span>
<span class="sd">                                                               </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; len(who.columns)</span>
<span class="sd">    60</span>
<span class="sd">    &gt;&gt;&gt; who.pivot_longer(</span>
<span class="sd">    ...     s.r[&quot;new_sp_m014&quot;:&quot;newrel_f65&quot;],</span>
<span class="sd">    ...     names_to=[&quot;diagnosis&quot;, &quot;gender&quot;, &quot;age&quot;],</span>
<span class="sd">    ...     names_pattern=&quot;new_?(.*)_(.)(.*)&quot;,</span>
<span class="sd">    ...     values_to=&quot;count&quot;,</span>
<span class="sd">    ... )</span>
<span class="sd">    </span>
<span class="sd">     country      iso2    iso3    year   diagnosis  gender  age     count </span>
<span class="sd">    </span>
<span class="sd">     string       string  string  int64  string     string  string  int64 </span>
<span class="sd">    </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp         m       014      NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp         m       1524     NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp         m       2534     NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp         m       3544     NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp         m       4554     NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp         m       5564     NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp         m       65       NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp         f       014      NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp         f       1524     NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp         f       2534     NULL </span>
<span class="sd">                                                                  </span>
<span class="sd">    </span>

<span class="sd">    `names_transform` is flexible, and can be:</span>

<span class="sd">        1. A mapping of one or more names in `names_to` to callable</span>
<span class="sd">        2. A callable that will be applied to every name</span>

<span class="sd">    Let&#39;s recode gender and age to numeric values using a mapping</span>

<span class="sd">    &gt;&gt;&gt; who.pivot_longer(</span>
<span class="sd">    ...     s.r[&quot;new_sp_m014&quot;:&quot;newrel_f65&quot;],</span>
<span class="sd">    ...     names_to=[&quot;diagnosis&quot;, &quot;gender&quot;, &quot;age&quot;],</span>
<span class="sd">    ...     names_pattern=&quot;new_?(.*)_(.)(.*)&quot;,</span>
<span class="sd">    ...     names_transform=dict(</span>
<span class="sd">    ...         gender={&quot;m&quot;: 1, &quot;f&quot;: 2}.get,</span>
<span class="sd">    ...         age=dict(zip([&quot;014&quot;, &quot;1524&quot;, &quot;2534&quot;, &quot;3544&quot;, &quot;4554&quot;, &quot;5564&quot;, &quot;65&quot;], range(7))).get,</span>
<span class="sd">    ...     ),</span>
<span class="sd">    ...     values_to=&quot;count&quot;,</span>
<span class="sd">    ... )</span>
<span class="sd">    </span>
<span class="sd">     country      iso2    iso3    year   diagnosis  gender  age   count </span>
<span class="sd">    </span>
<span class="sd">     string       string  string  int64  string     int8    int8  int64 </span>
<span class="sd">    </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp              1     0   NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp              1     1   NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp              1     2   NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp              1     3   NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp              1     4   NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp              1     5   NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp              1     6   NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp              2     0   NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp              2     1   NULL </span>
<span class="sd">     Afghanistan  AF      AFG      1980  sp              2     2   NULL </span>
<span class="sd">                                                                </span>
<span class="sd">    </span>

<span class="sd">    The number of match groups in `names_pattern` must match the length of `names_to`</span>

<span class="sd">    &gt;&gt;&gt; who.pivot_longer(</span>
<span class="sd">    ...     s.r[&quot;new_sp_m014&quot;:&quot;newrel_f65&quot;],</span>
<span class="sd">    ...     names_to=[&quot;diagnosis&quot;, &quot;gender&quot;, &quot;age&quot;],</span>
<span class="sd">    ...     names_pattern=&quot;new_?(.*)_.(.*)&quot;,</span>
<span class="sd">    ... )</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    ibis.common.exceptions.IbisInputError: Number of match groups in `names_pattern` ...</span>

<span class="sd">    `names_transform` must be a mapping or callable</span>

<span class="sd">    &gt;&gt;&gt; who.pivot_longer(s.r[&quot;new_sp_m014&quot;:&quot;newrel_f65&quot;], names_transform=&quot;upper&quot;)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      ...</span>
<span class="sd">    ibis.common.exceptions.IbisTypeError: ... Got &lt;class &#39;str&#39;&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>

    <span class="n">pivot_sel</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">col</span>

    <span class="n">pivot_cols</span> <span class="o">=</span> <span class="n">pivot_sel</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pivot_cols</span><span class="p">:</span>
        <span class="c1"># TODO: improve the repr of selectors</span>
        <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisInputError</span><span class="p">(</span><span class="s2">&quot;Selector returned no columns to pivot on&quot;</span><span class="p">)</span>

    <span class="n">names_to</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">names_to</span><span class="p">)</span>

    <span class="n">names_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">names_pattern</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ngroups</span> <span class="o">:=</span> <span class="n">names_pattern</span><span class="o">.</span><span class="n">groups</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">nnames</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names_to</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisInputError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Number of match groups in `names_pattern`&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">names_pattern</span><span class="o">.</span><span class="n">pattern</span><span class="si">!r}</span><span class="s2"> (</span><span class="si">{</span><span class="n">ngroups</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"> groups) doesn&#39;t &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;match the length of `names_to` </span><span class="si">{</span><span class="n">names_to</span><span class="si">}</span><span class="s2"> (length </span><span class="si">{</span><span class="n">nnames</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">names_transform</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">names_transform</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">names_to</span><span class="p">,</span> <span class="n">toolz</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">names_transform</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">names_transform</span><span class="p">):</span>
            <span class="n">names_transform</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">names_to</span><span class="p">,</span> <span class="n">names_transform</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`names_transform` must be a mapping or callable. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">names_transform</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_to</span><span class="p">:</span>
        <span class="n">names_transform</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">toolz</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">values_transform</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">values_transform</span> <span class="o">=</span> <span class="n">toolz</span><span class="o">.</span><span class="n">identity</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_transform</span><span class="p">,</span> <span class="n">Deferred</span><span class="p">):</span>
        <span class="n">values_transform</span> <span class="o">=</span> <span class="n">values_transform</span><span class="o">.</span><span class="n">resolve</span>

    <span class="n">pieces</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">pivot_col</span> <span class="ow">in</span> <span class="n">pivot_cols</span><span class="p">:</span>
        <span class="n">col_name</span> <span class="o">=</span> <span class="n">pivot_col</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
        <span class="n">match_result</span> <span class="o">=</span> <span class="n">names_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="n">names_transform</span><span class="p">[</span><span class="n">name</span><span class="p">](</span><span class="n">value</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names_to</span><span class="p">,</span> <span class="n">match_result</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>
        <span class="p">}</span>
        <span class="n">row</span><span class="p">[</span><span class="n">values_to</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_transform</span><span class="p">(</span><span class="n">pivot_col</span><span class="p">)</span>
        <span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ibis</span><span class="o">.</span><span class="n">struct</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>

    <span class="c1"># nest into an array of structs to zip unnests together</span>
    <span class="n">pieces</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">~</span><span class="n">pivot_sel</span><span class="p">,</span> <span class="n">__pivoted__</span><span class="o">=</span><span class="n">pieces</span><span class="o">.</span><span class="n">unnest</span><span class="p">())</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span>
        <span class="s2">&quot;__pivoted__&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.pivot_wider" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pivot_wider</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">id_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names_from</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">names_prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">names_sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">names_sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values_from</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">values_fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values_agg</span><span class="o">=</span><span class="s1">&#39;arbitrary&#39;</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.pivot_wider" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Pivot a table to a wider format.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>id_cols</code></td>
          <td>
                <code><span title="ibis">s</span>.<span title="ibis.Selector">Selector</span> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A set of columns that uniquely identify each observation.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>names_from</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <span title="ibis">s</span>.<span title="ibis.Selector">Selector</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An argument describing which column or columns to use to get the
name of the output columns.</p>
            </div>
          </td>
          <td>
                <code>&#39;name&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>names_prefix</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String added to the start of every column name.</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>names_sep</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>names_from</code> or <code>values_from</code> contains multiple columns, this
argument will be used to join their values together into a single
string to use as a column name.</p>
            </div>
          </td>
          <td>
                <code>&#39;_&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>names_sort</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/constants.html#True"><code>True</code></a> columns are sorted. If <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/constants.html#False"><code>False</code></a> column
names are ordered by appearance.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>names</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An explicit sequence of values to look for in columns matching
<code>names_from</code>.</p>
<ul>
<li>When this value is <code>None</code>, the values will be computed from
  <code>names_from</code>.</li>
<li>When this value is not <code>None</code>, each element's length must match
  the length of <code>names_from</code>.</li>
</ul>
<p>See examples below for more detail.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>values_from</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <span title="ibis">s</span>.<span title="ibis.Selector">Selector</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An argument describing which column or columns to get the cell
values from.</p>
            </div>
          </td>
          <td>
                <code>&#39;value&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>values_fill</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="ibis">ir</span>.<span title="ibis.Scalar">Scalar</span> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A scalar value that specifies what each value should be filled with
when missing.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>values_agg</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="ibis">ir</span>.<span title="ibis.Value">Value</span>], <span title="ibis">ir</span>.<span title="ibis.Scalar">Scalar</span>] | <span title="ibis.expr.deferred.Deferred">Deferred</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A function applied to the value in each cell in the output.</p>
            </div>
          </td>
          <td>
                <code>&#39;arbitrary&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Wider pivoted table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
    <p>Basic usage</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fish_encounters</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">fish_encounters</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fish_encounters</span>
<span class="go"></span>
<span class="go"> fish   station  seen  </span>
<span class="go"></span>
<span class="go"> int64  string   int64 </span>
<span class="go"></span>
<span class="go">  4842  Release      1 </span>
<span class="go">  4842  I80_1        1 </span>
<span class="go">  4842  Lisbon       1 </span>
<span class="go">  4842  Rstr         1 </span>
<span class="go">  4842  Base_TD      1 </span>
<span class="go">  4842  BCE          1 </span>
<span class="go">  4842  BCW          1 </span>
<span class="go">  4842  BCE2         1 </span>
<span class="go">  4842  BCW2         1 </span>
<span class="go">  4842  MAE          1 </span>
<span class="go">                    </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fish_encounters</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">names_from</span><span class="o">=</span><span class="s2">&quot;station&quot;</span><span class="p">,</span> <span class="n">values_from</span><span class="o">=</span><span class="s2">&quot;seen&quot;</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> fish   Release  I80_1  Lisbon  Rstr   Base_TD  BCE    BCW     </span>
<span class="go"></span>
<span class="go"> int64  int64    int64  int64   int64  int64    int64  int64   </span>
<span class="go"></span>
<span class="go">  4842        1      1       1      1        1      1      1   </span>
<span class="go">  4843        1      1       1      1        1      1      1   </span>
<span class="go">  4844        1      1       1      1        1      1      1   </span>
<span class="go">  4845        1      1       1      1        1   NULL   NULL   </span>
<span class="go">  4847        1      1       1   NULL     NULL   NULL   NULL   </span>
<span class="go">  4848        1      1       1      1     NULL   NULL   NULL   </span>
<span class="go">  4849        1      1    NULL   NULL     NULL   NULL   NULL   </span>
<span class="go">  4850        1      1    NULL      1        1      1      1   </span>
<span class="go">  4851        1      1    NULL   NULL     NULL   NULL   NULL   </span>
<span class="go">  4854        1      1    NULL   NULL     NULL   NULL   NULL   </span>
<span class="go">                                                       </span>
<span class="go"></span>
</code></pre></div>
    <p>Fill missing pivoted values using <code>values_fill</code></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fish_encounters</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">names_from</span><span class="o">=</span><span class="s2">&quot;station&quot;</span><span class="p">,</span> <span class="n">values_from</span><span class="o">=</span><span class="s2">&quot;seen&quot;</span><span class="p">,</span> <span class="n">values_fill</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> fish   Release  I80_1  Lisbon  Rstr   Base_TD  BCE    BCW     </span>
<span class="go"></span>
<span class="go"> int64  int64    int64  int64   int64  int64    int64  int64   </span>
<span class="go"></span>
<span class="go">  4842        1      1       1      1        1      1      1   </span>
<span class="go">  4843        1      1       1      1        1      1      1   </span>
<span class="go">  4844        1      1       1      1        1      1      1   </span>
<span class="go">  4845        1      1       1      1        1      0      0   </span>
<span class="go">  4847        1      1       1      0        0      0      0   </span>
<span class="go">  4848        1      1       1      1        0      0      0   </span>
<span class="go">  4849        1      1       0      0        0      0      0   </span>
<span class="go">  4850        1      1       0      1        1      1      1   </span>
<span class="go">  4851        1      1       0      0        0      0      0   </span>
<span class="go">  4854        1      1       0      0        0      0      0   </span>
<span class="go">                                                       </span>
<span class="go"></span>
</code></pre></div>
    <p>Compute multiple values columns</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">us_rent_income</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">us_rent_income</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">us_rent_income</span>
<span class="go"></span>
<span class="go"> geoid   name        variable  estimate  moe   </span>
<span class="go"></span>
<span class="go"> string  string      string    int64     int64 </span>
<span class="go"></span>
<span class="go"> 01      Alabama     income       24476    136 </span>
<span class="go"> 01      Alabama     rent           747      3 </span>
<span class="go"> 02      Alaska      income       32940    508 </span>
<span class="go"> 02      Alaska      rent          1200     13 </span>
<span class="go"> 04      Arizona     income       27517    148 </span>
<span class="go"> 04      Arizona     rent           972      4 </span>
<span class="go"> 05      Arkansas    income       23789    165 </span>
<span class="go"> 05      Arkansas    rent           709      5 </span>
<span class="go"> 06      California  income       29454    109 </span>
<span class="go"> 06      California  rent          1358      3 </span>
<span class="go">                                          </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">us_rent_income</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">names_from</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">values_from</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;estimate&quot;</span><span class="p">,</span> <span class="s2">&quot;moe&quot;</span><span class="p">])</span>
<span class="go"></span>
<span class="go"> geoid   name                  estimate_income  moe_income   </span>
<span class="go"></span>
<span class="go"> string  string                int64            int64        </span>
<span class="go"></span>
<span class="go"> 01      Alabama                         24476         136   </span>
<span class="go"> 02      Alaska                          32940         508   </span>
<span class="go"> 04      Arizona                         27517         148   </span>
<span class="go"> 05      Arkansas                        23789         165   </span>
<span class="go"> 06      California                      29454         109   </span>
<span class="go"> 08      Colorado                        32401         109   </span>
<span class="go"> 09      Connecticut                     35326         195   </span>
<span class="go"> 10      Delaware                        31560         247   </span>
<span class="go"> 11      District of Columbia            43198         681   </span>
<span class="go"> 12      Florida                         25952          70   </span>
<span class="go">                                                         </span>
<span class="go"></span>
</code></pre></div>
    <p>The column name separator can be changed using the <code>names_sep</code> parameter</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">us_rent_income</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">names_from</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">names_sep</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">values_from</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="s2">&quot;estimate&quot;</span><span class="p">,</span> <span class="s2">&quot;moe&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go"></span>
<span class="go"> geoid   name                  estimate.income  moe.income   </span>
<span class="go"></span>
<span class="go"> string  string                int64            int64        </span>
<span class="go"></span>
<span class="go"> 01      Alabama                         24476         136   </span>
<span class="go"> 02      Alaska                          32940         508   </span>
<span class="go"> 04      Arizona                         27517         148   </span>
<span class="go"> 05      Arkansas                        23789         165   </span>
<span class="go"> 06      California                      29454         109   </span>
<span class="go"> 08      Colorado                        32401         109   </span>
<span class="go"> 09      Connecticut                     35326         195   </span>
<span class="go"> 10      Delaware                        31560         247   </span>
<span class="go"> 11      District of Columbia            43198         681   </span>
<span class="go"> 12      Florida                         25952          70   </span>
<span class="go">                                                         </span>
<span class="go"></span>
</code></pre></div>
    <p>Supply an alternative function to summarize values</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">warpbreaks</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">warpbreaks</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;wool&quot;</span><span class="p">,</span> <span class="s2">&quot;tension&quot;</span><span class="p">,</span> <span class="s2">&quot;breaks&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warpbreaks</span>
<span class="go"></span>
<span class="go"> wool    tension  breaks </span>
<span class="go"></span>
<span class="go"> string  string   int64  </span>
<span class="go"></span>
<span class="go"> A       L            26 </span>
<span class="go"> A       L            30 </span>
<span class="go"> A       L            54 </span>
<span class="go"> A       L            25 </span>
<span class="go"> A       L            70 </span>
<span class="go"> A       L            52 </span>
<span class="go"> A       L            51 </span>
<span class="go"> A       L            26 </span>
<span class="go"> A       L            67 </span>
<span class="go"> A       M            18 </span>
<span class="go">                      </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warpbreaks</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">names_from</span><span class="o">=</span><span class="s2">&quot;wool&quot;</span><span class="p">,</span> <span class="n">values_from</span><span class="o">=</span><span class="s2">&quot;breaks&quot;</span><span class="p">,</span> <span class="n">values_agg</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> tension  A          B         </span>
<span class="go"></span>
<span class="go"> string   float64    float64   </span>
<span class="go"></span>
<span class="go"> L        44.555556  28.222222 </span>
<span class="go"> M        24.000000  28.777778 </span>
<span class="go"> H        24.555556  18.777778 </span>
<span class="go"></span>
</code></pre></div>
    <p>Passing <code>Deferred</code> objects to <code>values_agg</code> is supported</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">warpbreaks</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">names_from</span><span class="o">=</span><span class="s2">&quot;tension&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">values_from</span><span class="o">=</span><span class="s2">&quot;breaks&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">values_agg</span><span class="o">=</span><span class="n">_</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go"></span>
<span class="go"> wool    L      M      H     </span>
<span class="go"></span>
<span class="go"> string  int64  int64  int64 </span>
<span class="go"></span>
<span class="go"> A         401    216    221 </span>
<span class="go"> B         254    259    169 </span>
<span class="go"></span>
</code></pre></div>
    <p>Use a custom aggregate function</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">warpbreaks</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">names_from</span><span class="o">=</span><span class="s2">&quot;wool&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">values_from</span><span class="o">=</span><span class="s2">&quot;breaks&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">values_agg</span><span class="o">=</span><span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">col</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go"></span>
<span class="go"> tension  A         B        </span>
<span class="go"></span>
<span class="go"> string   float64   float64  </span>
<span class="go"></span>
<span class="go"> L        0.406183  0.349325 </span>
<span class="go"> M        0.360844  0.327719 </span>
<span class="go"> H        0.418344  0.260590 </span>
<span class="go"></span>
</code></pre></div>
    <p>Generate some random data, setting the random seed for reproducibility</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="nb">dict</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">product</span><span class="o">=</span><span class="n">product</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">country</span><span class="o">=</span><span class="n">country</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">production</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span>
<span class="gp">... </span>        <span class="p">)</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="s2">&quot;AB&quot;</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;AI&quot;</span><span class="p">,</span> <span class="s2">&quot;EI&quot;</span><span class="p">]</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2015</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">production</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">((</span><span class="n">_</span><span class="o">.</span><span class="n">product</span> <span class="o">==</span> <span class="s2">&quot;A&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">country</span> <span class="o">==</span> <span class="s2">&quot;AI&quot;</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">product</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">production</span>
<span class="go"></span>
<span class="go"> product  country  year   production </span>
<span class="go"></span>
<span class="go"> string   string   int64  float64    </span>
<span class="go"></span>
<span class="go"> B        AI        2000    0.477010 </span>
<span class="go"> B        AI        2001    0.865310 </span>
<span class="go"> B        AI        2002    0.260492 </span>
<span class="go"> B        AI        2003    0.805028 </span>
<span class="go"> B        AI        2004    0.548699 </span>
<span class="go"> B        AI        2005    0.014042 </span>
<span class="go"> B        AI        2006    0.719705 </span>
<span class="go"> B        AI        2007    0.398824 </span>
<span class="go"> B        AI        2008    0.824845 </span>
<span class="go"> B        AI        2009    0.668153 </span>
<span class="go">                                 </span>
<span class="go"></span>
</code></pre></div>
    <p>Pivoting with multiple name columns</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">production</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">names_from</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">values_from</span><span class="o">=</span><span class="s2">&quot;production&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go"></span>
<span class="go"> year   B_AI      B_EI      A_AI     </span>
<span class="go"></span>
<span class="go"> int64  float64   float64   float64  </span>
<span class="go"></span>
<span class="go">  2000  0.477010  0.870471  0.844422 </span>
<span class="go">  2001  0.865310  0.191067  0.757954 </span>
<span class="go">  2002  0.260492  0.567511  0.420572 </span>
<span class="go">  2003  0.805028  0.238616  0.258917 </span>
<span class="go">  2004  0.548699  0.967540  0.511275 </span>
<span class="go">  2005  0.014042  0.803179  0.404934 </span>
<span class="go">  2006  0.719705  0.447970  0.783799 </span>
<span class="go">  2007  0.398824  0.080446  0.303313 </span>
<span class="go">  2008  0.824845  0.320055  0.476597 </span>
<span class="go">  2009  0.668153  0.507941  0.583382 </span>
<span class="go">                                 </span>
<span class="go"></span>
</code></pre></div>
    <p>Select a subset of names. This call incurs no computation when
constructing the expression.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">production</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">names_from</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">names</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;AI&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;AI&quot;</span><span class="p">)],</span>
<span class="gp">... </span>    <span class="n">values_from</span><span class="o">=</span><span class="s2">&quot;production&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go"></span>
<span class="go"> year   A_AI      B_AI     </span>
<span class="go"></span>
<span class="go"> int64  float64   float64  </span>
<span class="go"></span>
<span class="go">  2000  0.844422  0.477010 </span>
<span class="go">  2001  0.757954  0.865310 </span>
<span class="go">  2002  0.420572  0.260492 </span>
<span class="go">  2003  0.258917  0.805028 </span>
<span class="go">  2004  0.511275  0.548699 </span>
<span class="go">  2005  0.404934  0.014042 </span>
<span class="go">  2006  0.783799  0.719705 </span>
<span class="go">  2007  0.303313  0.398824 </span>
<span class="go">  2008  0.476597  0.824845 </span>
<span class="go">  2009  0.583382  0.668153 </span>
<span class="go">                        </span>
<span class="go"></span>
</code></pre></div>
    <p>Sort the new columns' names</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">production</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">names_from</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">values_from</span><span class="o">=</span><span class="s2">&quot;production&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">names_sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go"></span>
<span class="go"> year   A_AI      B_AI      B_EI     </span>
<span class="go"></span>
<span class="go"> int64  float64   float64   float64  </span>
<span class="go"></span>
<span class="go">  2000  0.844422  0.477010  0.870471 </span>
<span class="go">  2001  0.757954  0.865310  0.191067 </span>
<span class="go">  2002  0.420572  0.260492  0.567511 </span>
<span class="go">  2003  0.258917  0.805028  0.238616 </span>
<span class="go">  2004  0.511275  0.548699  0.967540 </span>
<span class="go">  2005  0.404934  0.014042  0.803179 </span>
<span class="go">  2006  0.783799  0.719705  0.447970 </span>
<span class="go">  2007  0.303313  0.398824  0.080446 </span>
<span class="go">  2008  0.476597  0.824845  0.320055 </span>
<span class="go">  2009  0.583382  0.668153  0.507941 </span>
<span class="go">                                 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3185</span>
<span class="normal">3186</span>
<span class="normal">3187</span>
<span class="normal">3188</span>
<span class="normal">3189</span>
<span class="normal">3190</span>
<span class="normal">3191</span>
<span class="normal">3192</span>
<span class="normal">3193</span>
<span class="normal">3194</span>
<span class="normal">3195</span>
<span class="normal">3196</span>
<span class="normal">3197</span>
<span class="normal">3198</span>
<span class="normal">3199</span>
<span class="normal">3200</span>
<span class="normal">3201</span>
<span class="normal">3202</span>
<span class="normal">3203</span>
<span class="normal">3204</span>
<span class="normal">3205</span>
<span class="normal">3206</span>
<span class="normal">3207</span>
<span class="normal">3208</span>
<span class="normal">3209</span>
<span class="normal">3210</span>
<span class="normal">3211</span>
<span class="normal">3212</span>
<span class="normal">3213</span>
<span class="normal">3214</span>
<span class="normal">3215</span>
<span class="normal">3216</span>
<span class="normal">3217</span>
<span class="normal">3218</span>
<span class="normal">3219</span>
<span class="normal">3220</span>
<span class="normal">3221</span>
<span class="normal">3222</span>
<span class="normal">3223</span>
<span class="normal">3224</span>
<span class="normal">3225</span>
<span class="normal">3226</span>
<span class="normal">3227</span>
<span class="normal">3228</span>
<span class="normal">3229</span>
<span class="normal">3230</span>
<span class="normal">3231</span>
<span class="normal">3232</span>
<span class="normal">3233</span>
<span class="normal">3234</span>
<span class="normal">3235</span>
<span class="normal">3236</span>
<span class="normal">3237</span>
<span class="normal">3238</span>
<span class="normal">3239</span>
<span class="normal">3240</span>
<span class="normal">3241</span>
<span class="normal">3242</span>
<span class="normal">3243</span>
<span class="normal">3244</span>
<span class="normal">3245</span>
<span class="normal">3246</span>
<span class="normal">3247</span>
<span class="normal">3248</span>
<span class="normal">3249</span>
<span class="normal">3250</span>
<span class="normal">3251</span>
<span class="normal">3252</span>
<span class="normal">3253</span>
<span class="normal">3254</span>
<span class="normal">3255</span>
<span class="normal">3256</span>
<span class="normal">3257</span>
<span class="normal">3258</span>
<span class="normal">3259</span>
<span class="normal">3260</span>
<span class="normal">3261</span>
<span class="normal">3262</span>
<span class="normal">3263</span>
<span class="normal">3264</span>
<span class="normal">3265</span>
<span class="normal">3266</span>
<span class="normal">3267</span>
<span class="normal">3268</span>
<span class="normal">3269</span>
<span class="normal">3270</span>
<span class="normal">3271</span>
<span class="normal">3272</span>
<span class="normal">3273</span>
<span class="normal">3274</span>
<span class="normal">3275</span>
<span class="normal">3276</span>
<span class="normal">3277</span>
<span class="normal">3278</span>
<span class="normal">3279</span>
<span class="normal">3280</span>
<span class="normal">3281</span>
<span class="normal">3282</span>
<span class="normal">3283</span>
<span class="normal">3284</span>
<span class="normal">3285</span>
<span class="normal">3286</span>
<span class="normal">3287</span>
<span class="normal">3288</span>
<span class="normal">3289</span>
<span class="normal">3290</span>
<span class="normal">3291</span>
<span class="normal">3292</span>
<span class="normal">3293</span>
<span class="normal">3294</span>
<span class="normal">3295</span>
<span class="normal">3296</span>
<span class="normal">3297</span>
<span class="normal">3298</span>
<span class="normal">3299</span>
<span class="normal">3300</span>
<span class="normal">3301</span>
<span class="normal">3302</span>
<span class="normal">3303</span>
<span class="normal">3304</span>
<span class="normal">3305</span>
<span class="normal">3306</span>
<span class="normal">3307</span>
<span class="normal">3308</span>
<span class="normal">3309</span>
<span class="normal">3310</span>
<span class="normal">3311</span>
<span class="normal">3312</span>
<span class="normal">3313</span>
<span class="normal">3314</span>
<span class="normal">3315</span>
<span class="normal">3316</span>
<span class="normal">3317</span>
<span class="normal">3318</span>
<span class="normal">3319</span>
<span class="normal">3320</span>
<span class="normal">3321</span>
<span class="normal">3322</span>
<span class="normal">3323</span>
<span class="normal">3324</span>
<span class="normal">3325</span>
<span class="normal">3326</span>
<span class="normal">3327</span>
<span class="normal">3328</span>
<span class="normal">3329</span>
<span class="normal">3330</span>
<span class="normal">3331</span>
<span class="normal">3332</span>
<span class="normal">3333</span>
<span class="normal">3334</span>
<span class="normal">3335</span>
<span class="normal">3336</span>
<span class="normal">3337</span>
<span class="normal">3338</span>
<span class="normal">3339</span>
<span class="normal">3340</span>
<span class="normal">3341</span>
<span class="normal">3342</span>
<span class="normal">3343</span>
<span class="normal">3344</span>
<span class="normal">3345</span>
<span class="normal">3346</span>
<span class="normal">3347</span>
<span class="normal">3348</span>
<span class="normal">3349</span>
<span class="normal">3350</span>
<span class="normal">3351</span>
<span class="normal">3352</span>
<span class="normal">3353</span>
<span class="normal">3354</span>
<span class="normal">3355</span>
<span class="normal">3356</span>
<span class="normal">3357</span>
<span class="normal">3358</span>
<span class="normal">3359</span>
<span class="normal">3360</span>
<span class="normal">3361</span>
<span class="normal">3362</span>
<span class="normal">3363</span>
<span class="normal">3364</span>
<span class="normal">3365</span>
<span class="normal">3366</span>
<span class="normal">3367</span>
<span class="normal">3368</span>
<span class="normal">3369</span>
<span class="normal">3370</span>
<span class="normal">3371</span>
<span class="normal">3372</span>
<span class="normal">3373</span>
<span class="normal">3374</span>
<span class="normal">3375</span>
<span class="normal">3376</span>
<span class="normal">3377</span>
<span class="normal">3378</span>
<span class="normal">3379</span>
<span class="normal">3380</span>
<span class="normal">3381</span>
<span class="normal">3382</span>
<span class="normal">3383</span>
<span class="normal">3384</span>
<span class="normal">3385</span>
<span class="normal">3386</span>
<span class="normal">3387</span>
<span class="normal">3388</span>
<span class="normal">3389</span>
<span class="normal">3390</span>
<span class="normal">3391</span>
<span class="normal">3392</span>
<span class="normal">3393</span>
<span class="normal">3394</span>
<span class="normal">3395</span>
<span class="normal">3396</span>
<span class="normal">3397</span>
<span class="normal">3398</span>
<span class="normal">3399</span>
<span class="normal">3400</span>
<span class="normal">3401</span>
<span class="normal">3402</span>
<span class="normal">3403</span>
<span class="normal">3404</span>
<span class="normal">3405</span>
<span class="normal">3406</span>
<span class="normal">3407</span>
<span class="normal">3408</span>
<span class="normal">3409</span>
<span class="normal">3410</span>
<span class="normal">3411</span>
<span class="normal">3412</span>
<span class="normal">3413</span>
<span class="normal">3414</span>
<span class="normal">3415</span>
<span class="normal">3416</span>
<span class="normal">3417</span>
<span class="normal">3418</span>
<span class="normal">3419</span>
<span class="normal">3420</span>
<span class="normal">3421</span>
<span class="normal">3422</span>
<span class="normal">3423</span>
<span class="normal">3424</span>
<span class="normal">3425</span>
<span class="normal">3426</span>
<span class="normal">3427</span>
<span class="normal">3428</span>
<span class="normal">3429</span>
<span class="normal">3430</span>
<span class="normal">3431</span>
<span class="normal">3432</span>
<span class="normal">3433</span>
<span class="normal">3434</span>
<span class="normal">3435</span>
<span class="normal">3436</span>
<span class="normal">3437</span>
<span class="normal">3438</span>
<span class="normal">3439</span>
<span class="normal">3440</span>
<span class="normal">3441</span>
<span class="normal">3442</span>
<span class="normal">3443</span>
<span class="normal">3444</span>
<span class="normal">3445</span>
<span class="normal">3446</span>
<span class="normal">3447</span>
<span class="normal">3448</span>
<span class="normal">3449</span>
<span class="normal">3450</span>
<span class="normal">3451</span>
<span class="normal">3452</span>
<span class="normal">3453</span>
<span class="normal">3454</span>
<span class="normal">3455</span>
<span class="normal">3456</span>
<span class="normal">3457</span>
<span class="normal">3458</span>
<span class="normal">3459</span>
<span class="normal">3460</span>
<span class="normal">3461</span>
<span class="normal">3462</span>
<span class="normal">3463</span>
<span class="normal">3464</span>
<span class="normal">3465</span>
<span class="normal">3466</span>
<span class="normal">3467</span>
<span class="normal">3468</span>
<span class="normal">3469</span>
<span class="normal">3470</span>
<span class="normal">3471</span>
<span class="normal">3472</span>
<span class="normal">3473</span>
<span class="normal">3474</span>
<span class="normal">3475</span>
<span class="normal">3476</span>
<span class="normal">3477</span>
<span class="normal">3478</span>
<span class="normal">3479</span>
<span class="normal">3480</span>
<span class="normal">3481</span>
<span class="normal">3482</span>
<span class="normal">3483</span>
<span class="normal">3484</span>
<span class="normal">3485</span>
<span class="normal">3486</span>
<span class="normal">3487</span>
<span class="normal">3488</span>
<span class="normal">3489</span>
<span class="normal">3490</span>
<span class="normal">3491</span>
<span class="normal">3492</span>
<span class="normal">3493</span>
<span class="normal">3494</span>
<span class="normal">3495</span>
<span class="normal">3496</span>
<span class="normal">3497</span>
<span class="normal">3498</span>
<span class="normal">3499</span>
<span class="normal">3500</span>
<span class="normal">3501</span>
<span class="normal">3502</span>
<span class="normal">3503</span>
<span class="normal">3504</span>
<span class="normal">3505</span>
<span class="normal">3506</span>
<span class="normal">3507</span>
<span class="normal">3508</span>
<span class="normal">3509</span>
<span class="normal">3510</span>
<span class="normal">3511</span>
<span class="normal">3512</span>
<span class="normal">3513</span>
<span class="normal">3514</span>
<span class="normal">3515</span>
<span class="normal">3516</span>
<span class="normal">3517</span>
<span class="normal">3518</span>
<span class="normal">3519</span>
<span class="normal">3520</span>
<span class="normal">3521</span>
<span class="normal">3522</span>
<span class="normal">3523</span>
<span class="normal">3524</span>
<span class="normal">3525</span>
<span class="normal">3526</span>
<span class="normal">3527</span>
<span class="normal">3528</span>
<span class="normal">3529</span>
<span class="normal">3530</span>
<span class="normal">3531</span>
<span class="normal">3532</span>
<span class="normal">3533</span>
<span class="normal">3534</span>
<span class="normal">3535</span>
<span class="normal">3536</span>
<span class="normal">3537</span>
<span class="normal">3538</span>
<span class="normal">3539</span>
<span class="normal">3540</span>
<span class="normal">3541</span>
<span class="normal">3542</span>
<span class="normal">3543</span>
<span class="normal">3544</span>
<span class="normal">3545</span>
<span class="normal">3546</span>
<span class="normal">3547</span>
<span class="normal">3548</span>
<span class="normal">3549</span>
<span class="normal">3550</span>
<span class="normal">3551</span>
<span class="normal">3552</span>
<span class="normal">3553</span>
<span class="normal">3554</span>
<span class="normal">3555</span>
<span class="normal">3556</span>
<span class="normal">3557</span>
<span class="normal">3558</span>
<span class="normal">3559</span>
<span class="normal">3560</span>
<span class="normal">3561</span>
<span class="normal">3562</span>
<span class="normal">3563</span>
<span class="normal">3564</span>
<span class="normal">3565</span>
<span class="normal">3566</span>
<span class="normal">3567</span>
<span class="normal">3568</span>
<span class="normal">3569</span>
<span class="normal">3570</span>
<span class="normal">3571</span>
<span class="normal">3572</span>
<span class="normal">3573</span>
<span class="normal">3574</span>
<span class="normal">3575</span>
<span class="normal">3576</span>
<span class="normal">3577</span>
<span class="normal">3578</span>
<span class="normal">3579</span>
<span class="normal">3580</span>
<span class="normal">3581</span>
<span class="normal">3582</span>
<span class="normal">3583</span>
<span class="normal">3584</span>
<span class="normal">3585</span>
<span class="normal">3586</span>
<span class="normal">3587</span>
<span class="normal">3588</span>
<span class="normal">3589</span>
<span class="normal">3590</span>
<span class="normal">3591</span>
<span class="normal">3592</span>
<span class="normal">3593</span>
<span class="normal">3594</span>
<span class="normal">3595</span>
<span class="normal">3596</span>
<span class="normal">3597</span>
<span class="normal">3598</span>
<span class="normal">3599</span>
<span class="normal">3600</span>
<span class="normal">3601</span>
<span class="normal">3602</span>
<span class="normal">3603</span>
<span class="normal">3604</span>
<span class="normal">3605</span>
<span class="normal">3606</span>
<span class="normal">3607</span>
<span class="normal">3608</span>
<span class="normal">3609</span>
<span class="normal">3610</span>
<span class="normal">3611</span>
<span class="normal">3612</span>
<span class="normal">3613</span>
<span class="normal">3614</span>
<span class="normal">3615</span>
<span class="normal">3616</span>
<span class="normal">3617</span>
<span class="normal">3618</span>
<span class="normal">3619</span>
<span class="normal">3620</span>
<span class="normal">3621</span>
<span class="normal">3622</span>
<span class="normal">3623</span>
<span class="normal">3624</span>
<span class="normal">3625</span>
<span class="normal">3626</span>
<span class="normal">3627</span>
<span class="normal">3628</span>
<span class="normal">3629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@util</span><span class="o">.</span><span class="n">experimental</span>
<span class="k">def</span> <span class="nf">pivot_wider</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">id_cols</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">names_from</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
    <span class="n">names_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">names_sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span>
    <span class="n">names_sort</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">names</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">values_from</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">s</span><span class="o">.</span><span class="n">Selector</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span>
    <span class="n">values_fill</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ir</span><span class="o">.</span><span class="n">Scalar</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">values_agg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">],</span> <span class="n">ir</span><span class="o">.</span><span class="n">Scalar</span><span class="p">]</span> <span class="o">|</span> <span class="n">Deferred</span> <span class="o">=</span> <span class="s2">&quot;arbitrary&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pivot a table to a wider format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    id_cols</span>
<span class="sd">        A set of columns that uniquely identify each observation.</span>
<span class="sd">    names_from</span>
<span class="sd">        An argument describing which column or columns to use to get the</span>
<span class="sd">        name of the output columns.</span>
<span class="sd">    names_prefix</span>
<span class="sd">        String added to the start of every column name.</span>
<span class="sd">    names_sep</span>
<span class="sd">        If `names_from` or `values_from` contains multiple columns, this</span>
<span class="sd">        argument will be used to join their values together into a single</span>
<span class="sd">        string to use as a column name.</span>
<span class="sd">    names_sort</span>
<span class="sd">        If [`True`][True] columns are sorted. If [`False`][False] column</span>
<span class="sd">        names are ordered by appearance.</span>
<span class="sd">    names</span>
<span class="sd">        An explicit sequence of values to look for in columns matching</span>
<span class="sd">        `names_from`.</span>

<span class="sd">        * When this value is `None`, the values will be computed from</span>
<span class="sd">          `names_from`.</span>
<span class="sd">        * When this value is not `None`, each element&#39;s length must match</span>
<span class="sd">          the length of `names_from`.</span>

<span class="sd">        See examples below for more detail.</span>
<span class="sd">    values_from</span>
<span class="sd">        An argument describing which column or columns to get the cell</span>
<span class="sd">        values from.</span>
<span class="sd">    values_fill</span>
<span class="sd">        A scalar value that specifies what each value should be filled with</span>
<span class="sd">        when missing.</span>
<span class="sd">    values_agg</span>
<span class="sd">        A function applied to the value in each cell in the output.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Wider pivoted table</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">    &gt;&gt;&gt; from ibis import _</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>

<span class="sd">    Basic usage</span>

<span class="sd">    &gt;&gt;&gt; fish_encounters = ibis.examples.fish_encounters.fetch()</span>
<span class="sd">    &gt;&gt;&gt; fish_encounters</span>
<span class="sd">    </span>
<span class="sd">     fish   station  seen  </span>
<span class="sd">    </span>
<span class="sd">     int64  string   int64 </span>
<span class="sd">    </span>
<span class="sd">      4842  Release      1 </span>
<span class="sd">      4842  I80_1        1 </span>
<span class="sd">      4842  Lisbon       1 </span>
<span class="sd">      4842  Rstr         1 </span>
<span class="sd">      4842  Base_TD      1 </span>
<span class="sd">      4842  BCE          1 </span>
<span class="sd">      4842  BCW          1 </span>
<span class="sd">      4842  BCE2         1 </span>
<span class="sd">      4842  BCW2         1 </span>
<span class="sd">      4842  MAE          1 </span>
<span class="sd">                        </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; fish_encounters.pivot_wider(names_from=&quot;station&quot;, values_from=&quot;seen&quot;)</span>
<span class="sd">    </span>
<span class="sd">     fish   Release  I80_1  Lisbon  Rstr   Base_TD  BCE    BCW     </span>
<span class="sd">    </span>
<span class="sd">     int64  int64    int64  int64   int64  int64    int64  int64   </span>
<span class="sd">    </span>
<span class="sd">      4842        1      1       1      1        1      1      1   </span>
<span class="sd">      4843        1      1       1      1        1      1      1   </span>
<span class="sd">      4844        1      1       1      1        1      1      1   </span>
<span class="sd">      4845        1      1       1      1        1   NULL   NULL   </span>
<span class="sd">      4847        1      1       1   NULL     NULL   NULL   NULL   </span>
<span class="sd">      4848        1      1       1      1     NULL   NULL   NULL   </span>
<span class="sd">      4849        1      1    NULL   NULL     NULL   NULL   NULL   </span>
<span class="sd">      4850        1      1    NULL      1        1      1      1   </span>
<span class="sd">      4851        1      1    NULL   NULL     NULL   NULL   NULL   </span>
<span class="sd">      4854        1      1    NULL   NULL     NULL   NULL   NULL   </span>
<span class="sd">                                                           </span>
<span class="sd">    </span>

<span class="sd">    Fill missing pivoted values using `values_fill`</span>

<span class="sd">    &gt;&gt;&gt; fish_encounters.pivot_wider(names_from=&quot;station&quot;, values_from=&quot;seen&quot;, values_fill=0)</span>
<span class="sd">    </span>
<span class="sd">     fish   Release  I80_1  Lisbon  Rstr   Base_TD  BCE    BCW     </span>
<span class="sd">    </span>
<span class="sd">     int64  int64    int64  int64   int64  int64    int64  int64   </span>
<span class="sd">    </span>
<span class="sd">      4842        1      1       1      1        1      1      1   </span>
<span class="sd">      4843        1      1       1      1        1      1      1   </span>
<span class="sd">      4844        1      1       1      1        1      1      1   </span>
<span class="sd">      4845        1      1       1      1        1      0      0   </span>
<span class="sd">      4847        1      1       1      0        0      0      0   </span>
<span class="sd">      4848        1      1       1      1        0      0      0   </span>
<span class="sd">      4849        1      1       0      0        0      0      0   </span>
<span class="sd">      4850        1      1       0      1        1      1      1   </span>
<span class="sd">      4851        1      1       0      0        0      0      0   </span>
<span class="sd">      4854        1      1       0      0        0      0      0   </span>
<span class="sd">                                                           </span>
<span class="sd">    </span>

<span class="sd">    Compute multiple values columns</span>

<span class="sd">    &gt;&gt;&gt; us_rent_income = ibis.examples.us_rent_income.fetch()</span>
<span class="sd">    &gt;&gt;&gt; us_rent_income</span>
<span class="sd">    </span>
<span class="sd">     geoid   name        variable  estimate  moe   </span>
<span class="sd">    </span>
<span class="sd">     string  string      string    int64     int64 </span>
<span class="sd">    </span>
<span class="sd">     01      Alabama     income       24476    136 </span>
<span class="sd">     01      Alabama     rent           747      3 </span>
<span class="sd">     02      Alaska      income       32940    508 </span>
<span class="sd">     02      Alaska      rent          1200     13 </span>
<span class="sd">     04      Arizona     income       27517    148 </span>
<span class="sd">     04      Arizona     rent           972      4 </span>
<span class="sd">     05      Arkansas    income       23789    165 </span>
<span class="sd">     05      Arkansas    rent           709      5 </span>
<span class="sd">     06      California  income       29454    109 </span>
<span class="sd">     06      California  rent          1358      3 </span>
<span class="sd">                                              </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; us_rent_income.pivot_wider(names_from=&quot;variable&quot;, values_from=[&quot;estimate&quot;, &quot;moe&quot;])</span>
<span class="sd">    </span>
<span class="sd">     geoid   name                  estimate_income  moe_income   </span>
<span class="sd">    </span>
<span class="sd">     string  string                int64            int64        </span>
<span class="sd">    </span>
<span class="sd">     01      Alabama                         24476         136   </span>
<span class="sd">     02      Alaska                          32940         508   </span>
<span class="sd">     04      Arizona                         27517         148   </span>
<span class="sd">     05      Arkansas                        23789         165   </span>
<span class="sd">     06      California                      29454         109   </span>
<span class="sd">     08      Colorado                        32401         109   </span>
<span class="sd">     09      Connecticut                     35326         195   </span>
<span class="sd">     10      Delaware                        31560         247   </span>
<span class="sd">     11      District of Columbia            43198         681   </span>
<span class="sd">     12      Florida                         25952          70   </span>
<span class="sd">                                                             </span>
<span class="sd">    </span>

<span class="sd">    The column name separator can be changed using the `names_sep` parameter</span>

<span class="sd">    &gt;&gt;&gt; us_rent_income.pivot_wider(</span>
<span class="sd">    ...     names_from=&quot;variable&quot;,</span>
<span class="sd">    ...     names_sep=&quot;.&quot;,</span>
<span class="sd">    ...     values_from=s.c(&quot;estimate&quot;, &quot;moe&quot;),</span>
<span class="sd">    ... )</span>
<span class="sd">    </span>
<span class="sd">     geoid   name                  estimate.income  moe.income   </span>
<span class="sd">    </span>
<span class="sd">     string  string                int64            int64        </span>
<span class="sd">    </span>
<span class="sd">     01      Alabama                         24476         136   </span>
<span class="sd">     02      Alaska                          32940         508   </span>
<span class="sd">     04      Arizona                         27517         148   </span>
<span class="sd">     05      Arkansas                        23789         165   </span>
<span class="sd">     06      California                      29454         109   </span>
<span class="sd">     08      Colorado                        32401         109   </span>
<span class="sd">     09      Connecticut                     35326         195   </span>
<span class="sd">     10      Delaware                        31560         247   </span>
<span class="sd">     11      District of Columbia            43198         681   </span>
<span class="sd">     12      Florida                         25952          70   </span>
<span class="sd">                                                             </span>
<span class="sd">    </span>

<span class="sd">    Supply an alternative function to summarize values</span>

<span class="sd">    &gt;&gt;&gt; warpbreaks = ibis.examples.warpbreaks.fetch().select(&quot;wool&quot;, &quot;tension&quot;, &quot;breaks&quot;)</span>
<span class="sd">    &gt;&gt;&gt; warpbreaks</span>
<span class="sd">    </span>
<span class="sd">     wool    tension  breaks </span>
<span class="sd">    </span>
<span class="sd">     string  string   int64  </span>
<span class="sd">    </span>
<span class="sd">     A       L            26 </span>
<span class="sd">     A       L            30 </span>
<span class="sd">     A       L            54 </span>
<span class="sd">     A       L            25 </span>
<span class="sd">     A       L            70 </span>
<span class="sd">     A       L            52 </span>
<span class="sd">     A       L            51 </span>
<span class="sd">     A       L            26 </span>
<span class="sd">     A       L            67 </span>
<span class="sd">     A       M            18 </span>
<span class="sd">                          </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; warpbreaks.pivot_wider(names_from=&quot;wool&quot;, values_from=&quot;breaks&quot;, values_agg=&quot;mean&quot;)</span>
<span class="sd">    </span>
<span class="sd">     tension  A          B         </span>
<span class="sd">    </span>
<span class="sd">     string   float64    float64   </span>
<span class="sd">    </span>
<span class="sd">     L        44.555556  28.222222 </span>
<span class="sd">     M        24.000000  28.777778 </span>
<span class="sd">     H        24.555556  18.777778 </span>
<span class="sd">    </span>

<span class="sd">    Passing `Deferred` objects to `values_agg` is supported</span>

<span class="sd">    &gt;&gt;&gt; warpbreaks.pivot_wider(</span>
<span class="sd">    ...     names_from=&quot;tension&quot;,</span>
<span class="sd">    ...     values_from=&quot;breaks&quot;,</span>
<span class="sd">    ...     values_agg=_.sum(),</span>
<span class="sd">    ... )</span>
<span class="sd">    </span>
<span class="sd">     wool    L      M      H     </span>
<span class="sd">    </span>
<span class="sd">     string  int64  int64  int64 </span>
<span class="sd">    </span>
<span class="sd">     A         401    216    221 </span>
<span class="sd">     B         254    259    169 </span>
<span class="sd">    </span>

<span class="sd">    Use a custom aggregate function</span>

<span class="sd">    &gt;&gt;&gt; warpbreaks.pivot_wider(</span>
<span class="sd">    ...     names_from=&quot;wool&quot;,</span>
<span class="sd">    ...     values_from=&quot;breaks&quot;,</span>
<span class="sd">    ...     values_agg=lambda col: col.std() / col.mean(),</span>
<span class="sd">    ... )</span>
<span class="sd">    </span>
<span class="sd">     tension  A         B        </span>
<span class="sd">    </span>
<span class="sd">     string   float64   float64  </span>
<span class="sd">    </span>
<span class="sd">     L        0.406183  0.349325 </span>
<span class="sd">     M        0.360844  0.327719 </span>
<span class="sd">     H        0.418344  0.260590 </span>
<span class="sd">    </span>

<span class="sd">    Generate some random data, setting the random seed for reproducibility</span>

<span class="sd">    &gt;&gt;&gt; import random</span>
<span class="sd">    &gt;&gt;&gt; random.seed(0)</span>
<span class="sd">    &gt;&gt;&gt; raw = ibis.memtable(</span>
<span class="sd">    ...     [</span>
<span class="sd">    ...         dict(</span>
<span class="sd">    ...             product=product,</span>
<span class="sd">    ...             country=country,</span>
<span class="sd">    ...             year=year,</span>
<span class="sd">    ...             production=random.random(),</span>
<span class="sd">    ...         )</span>
<span class="sd">    ...         for product in &quot;AB&quot;</span>
<span class="sd">    ...         for country in [&quot;AI&quot;, &quot;EI&quot;]</span>
<span class="sd">    ...         for year in range(2000, 2015)</span>
<span class="sd">    ...     ]</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; production = raw.filter(</span>
<span class="sd">    ...     ((_.product == &quot;A&quot;) &amp; (_.country == &quot;AI&quot;)) | (_.product == &quot;B&quot;)</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; production</span>
<span class="sd">    </span>
<span class="sd">     product  country  year   production </span>
<span class="sd">    </span>
<span class="sd">     string   string   int64  float64    </span>
<span class="sd">    </span>
<span class="sd">     B        AI        2000    0.477010 </span>
<span class="sd">     B        AI        2001    0.865310 </span>
<span class="sd">     B        AI        2002    0.260492 </span>
<span class="sd">     B        AI        2003    0.805028 </span>
<span class="sd">     B        AI        2004    0.548699 </span>
<span class="sd">     B        AI        2005    0.014042 </span>
<span class="sd">     B        AI        2006    0.719705 </span>
<span class="sd">     B        AI        2007    0.398824 </span>
<span class="sd">     B        AI        2008    0.824845 </span>
<span class="sd">     B        AI        2009    0.668153 </span>
<span class="sd">                                     </span>
<span class="sd">    </span>

<span class="sd">    Pivoting with multiple name columns</span>

<span class="sd">    &gt;&gt;&gt; production.pivot_wider(</span>
<span class="sd">    ...     names_from=[&quot;product&quot;, &quot;country&quot;],</span>
<span class="sd">    ...     values_from=&quot;production&quot;,</span>
<span class="sd">    ... )</span>
<span class="sd">    </span>
<span class="sd">     year   B_AI      B_EI      A_AI     </span>
<span class="sd">    </span>
<span class="sd">     int64  float64   float64   float64  </span>
<span class="sd">    </span>
<span class="sd">      2000  0.477010  0.870471  0.844422 </span>
<span class="sd">      2001  0.865310  0.191067  0.757954 </span>
<span class="sd">      2002  0.260492  0.567511  0.420572 </span>
<span class="sd">      2003  0.805028  0.238616  0.258917 </span>
<span class="sd">      2004  0.548699  0.967540  0.511275 </span>
<span class="sd">      2005  0.014042  0.803179  0.404934 </span>
<span class="sd">      2006  0.719705  0.447970  0.783799 </span>
<span class="sd">      2007  0.398824  0.080446  0.303313 </span>
<span class="sd">      2008  0.824845  0.320055  0.476597 </span>
<span class="sd">      2009  0.668153  0.507941  0.583382 </span>
<span class="sd">                                     </span>
<span class="sd">    </span>

<span class="sd">    Select a subset of names. This call incurs no computation when</span>
<span class="sd">    constructing the expression.</span>

<span class="sd">    &gt;&gt;&gt; production.pivot_wider(</span>
<span class="sd">    ...     names_from=[&quot;product&quot;, &quot;country&quot;],</span>
<span class="sd">    ...     names=[(&quot;A&quot;, &quot;AI&quot;), (&quot;B&quot;, &quot;AI&quot;)],</span>
<span class="sd">    ...     values_from=&quot;production&quot;,</span>
<span class="sd">    ... )</span>
<span class="sd">    </span>
<span class="sd">     year   A_AI      B_AI     </span>
<span class="sd">    </span>
<span class="sd">     int64  float64   float64  </span>
<span class="sd">    </span>
<span class="sd">      2000  0.844422  0.477010 </span>
<span class="sd">      2001  0.757954  0.865310 </span>
<span class="sd">      2002  0.420572  0.260492 </span>
<span class="sd">      2003  0.258917  0.805028 </span>
<span class="sd">      2004  0.511275  0.548699 </span>
<span class="sd">      2005  0.404934  0.014042 </span>
<span class="sd">      2006  0.783799  0.719705 </span>
<span class="sd">      2007  0.303313  0.398824 </span>
<span class="sd">      2008  0.476597  0.824845 </span>
<span class="sd">      2009  0.583382  0.668153 </span>
<span class="sd">                            </span>
<span class="sd">    </span>

<span class="sd">    Sort the new columns&#39; names</span>

<span class="sd">    &gt;&gt;&gt; production.pivot_wider(</span>
<span class="sd">    ...     names_from=[&quot;product&quot;, &quot;country&quot;],</span>
<span class="sd">    ...     values_from=&quot;production&quot;,</span>
<span class="sd">    ...     names_sort=True,</span>
<span class="sd">    ... )</span>
<span class="sd">    </span>
<span class="sd">     year   A_AI      B_AI      B_EI     </span>
<span class="sd">    </span>
<span class="sd">     int64  float64   float64   float64  </span>
<span class="sd">    </span>
<span class="sd">      2000  0.844422  0.477010  0.870471 </span>
<span class="sd">      2001  0.757954  0.865310  0.191067 </span>
<span class="sd">      2002  0.420572  0.260492  0.567511 </span>
<span class="sd">      2003  0.258917  0.805028  0.238616 </span>
<span class="sd">      2004  0.511275  0.548699  0.967540 </span>
<span class="sd">      2005  0.404934  0.014042  0.803179 </span>
<span class="sd">      2006  0.783799  0.719705  0.447970 </span>
<span class="sd">      2007  0.303313  0.398824  0.080446 </span>
<span class="sd">      2008  0.476597  0.824845  0.320055 </span>
<span class="sd">      2009  0.583382  0.668153  0.507941 </span>
<span class="sd">                                     </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
    <span class="kn">import</span> <span class="nn">ibis.expr.analysis</span> <span class="k">as</span> <span class="nn">an</span>
    <span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">_</span>

    <span class="n">orig_names_from</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">names_from</span><span class="p">)</span>

    <span class="n">names_from</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">any_of</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">_to_selector</span><span class="p">,</span> <span class="n">orig_names_from</span><span class="p">))</span>
    <span class="n">values_from</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">any_of</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">_to_selector</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">values_from</span><span class="p">)))</span>

    <span class="k">if</span> <span class="n">id_cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">id_cols</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">names_from</span> <span class="o">|</span> <span class="n">values_from</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">id_cols</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">_to_selector</span><span class="p">(</span><span class="n">id_cols</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_agg</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">values_agg</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">methodcaller</span><span class="p">(</span><span class="n">values_agg</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_agg</span><span class="p">,</span> <span class="n">Deferred</span><span class="p">):</span>
        <span class="n">values_agg</span> <span class="o">=</span> <span class="n">values_agg</span><span class="o">.</span><span class="n">resolve</span>

    <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># no names provided, compute them from the data</span>
        <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">names_from</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">columns</span> <span class="o">:=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">names_from</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)]):</span>
            <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisInputError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No matching names columns in `names_from`: </span><span class="si">{</span><span class="n">orig_names_from</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">,</span> <span class="n">names</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">names_sort</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">names</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

    <span class="n">values_cols</span> <span class="o">=</span> <span class="n">values_from</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">more_than_one_value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="n">aggs</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">names_cols_exprs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">where</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">eq</span><span class="p">,</span> <span class="n">names_cols_exprs</span><span class="p">,</span> <span class="n">keys</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">values_col</span> <span class="ow">in</span> <span class="n">values_cols</span><span class="p">:</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">values_agg</span><span class="p">(</span><span class="n">values_col</span><span class="p">)</span>

            <span class="c1"># add in the where clause to filter the appropriate values</span>
            <span class="c1"># in/out</span>
            <span class="c1">#</span>
            <span class="c1"># this allows users to write the aggregate without having to deal with</span>
            <span class="c1"># the filter themselves</span>
            <span class="n">existing_aggs</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">find_toplevel_aggs</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">op</span><span class="p">())</span>
            <span class="n">subs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">agg</span><span class="p">:</span> <span class="n">agg</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                    <span class="n">where</span><span class="o">=</span><span class="p">(</span>
                        <span class="n">where</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">existing</span> <span class="o">:=</span> <span class="n">agg</span><span class="o">.</span><span class="n">where</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
                        <span class="k">else</span> <span class="n">where</span> <span class="o">&amp;</span> <span class="n">existing</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">agg</span> <span class="ow">in</span> <span class="n">existing_aggs</span>
            <span class="p">}</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">sub_for</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">op</span><span class="p">(),</span> <span class="n">subs</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>

            <span class="c1"># build the components of the group by key</span>
            <span class="n">key_components</span> <span class="o">=</span> <span class="p">(</span>
                <span class="c1"># user provided prefix</span>
                <span class="n">names_prefix</span><span class="p">,</span>
                <span class="c1"># include the `values` column name if there&#39;s more than one</span>
                <span class="c1"># `values` column</span>
                <span class="n">values_col</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">*</span> <span class="n">more_than_one_value</span><span class="p">,</span>
                <span class="c1"># values computed from `names`/`names_from`</span>
                <span class="o">*</span><span class="n">keys</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">names_sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">key_components</span><span class="p">))</span>
            <span class="n">aggs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span> <span class="k">if</span> <span class="n">values_fill</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">arg</span><span class="o">.</span><span class="n">coalesce</span><span class="p">(</span><span class="n">values_fill</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">id_cols</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="o">**</span><span class="n">aggs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.relabel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">relabel</span><span class="p">(</span><span class="n">substitutions</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.relabel" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Rename columns in the table.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>substitutions</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="typing.Mapping" href="https://docs.python.org/3/library/typing.html#typing.Mapping">Mapping</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None] | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="typing.Literal" href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[&#39;snake_case&#39;, &#39;ALL_CAPS&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping, function, or format string mapping old to new column
names. If a column isn't in the mapping (or if the callable returns
None) it is left with its original name. May also pass a format
string to rename all columns, like <code>"prefix_{name}"</code>. Also
accepts the literal string <code>"snake_case"</code> or <code>"ALL_CAPS"</code> which
will relabel all columns to use a <code>snake_case</code> or <code>"ALL_CAPS"</code>
naming convention.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A relabeled table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first3</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">r</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># first 3 columns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins_raw_raw</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">first3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> studyName  Sample Number  Species                             </span>
<span class="go"></span>
<span class="go"> string     int64          string                              </span>
<span class="go"></span>
<span class="go"> PAL0708                1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"> PAL0708                2  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"> PAL0708                3  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"> PAL0708                4  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"> PAL0708                5  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"> PAL0708                6  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"> PAL0708                7  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"> PAL0708                8  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"> PAL0708                9  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"> PAL0708               10  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go">                                                            </span>
<span class="go"></span>
</code></pre></div>
    <p>Relabel column names using a mapping from old name to new name</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">relabel</span><span class="p">({</span><span class="s2">&quot;studyName&quot;</span><span class="p">:</span> <span class="s2">&quot;study_name&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> study_name  Sample Number  Species                             </span>
<span class="go"></span>
<span class="go"> string      int64          string                              </span>
<span class="go"></span>
<span class="go"> PAL0708                 1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"></span>
</code></pre></div>
    <p>Relabel column names using a snake_case convention</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="s2">&quot;snake_case&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> study_name  sample_number  species                             </span>
<span class="go"></span>
<span class="go"> string      int64          string                              </span>
<span class="go"></span>
<span class="go"> PAL0708                 1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"></span>
</code></pre></div>
    <p>Relabel column names using a ALL_CAPS convention</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="s2">&quot;ALL_CAPS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> STUDY_NAME  SAMPLE_NUMBER  SPECIES                             </span>
<span class="go"></span>
<span class="go"> string      int64          string                              </span>
<span class="go"></span>
<span class="go"> PAL0708                 1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"></span>
</code></pre></div>
    <p>Relabel columns using a format string</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="s2">&quot;p_</span><span class="si">{name}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> p_studyName  p_Sample Number  p_Species                           </span>
<span class="go"></span>
<span class="go"> string       int64            string                              </span>
<span class="go"></span>
<span class="go"> PAL0708                    1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"></span>
</code></pre></div>
    <p>Relabel column names using a callable</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> STUDYNAME  SAMPLE NUMBER  SPECIES                             </span>
<span class="go"></span>
<span class="go"> string     int64          string                              </span>
<span class="go"></span>
<span class="go"> PAL0708                1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">relabel</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">substitutions</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
    <span class="o">|</span> <span class="nb">str</span>
    <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;snake_case&quot;</span><span class="p">,</span> <span class="s2">&quot;ALL_CAPS&quot;</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rename columns in the table.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    substitutions</span>
<span class="sd">        A mapping, function, or format string mapping old to new column</span>
<span class="sd">        names. If a column isn&#39;t in the mapping (or if the callable returns</span>
<span class="sd">        None) it is left with its original name. May also pass a format</span>
<span class="sd">        string to rename all columns, like ``&quot;prefix_{name}&quot;``. Also</span>
<span class="sd">        accepts the literal string ``&quot;snake_case&quot;`` or ``&quot;ALL_CAPS&quot;`` which</span>
<span class="sd">        will relabel all columns to use a ``snake_case`` or ``&quot;ALL_CAPS&quot;``</span>
<span class="sd">        naming convention.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        A relabeled table expression</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; first3 = s.r[:3]  # first 3 columns</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins_raw_raw.fetch().select(first3)</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     studyName  Sample Number  Species                             </span>
<span class="sd">    </span>
<span class="sd">     string     int64          string                              </span>
<span class="sd">    </span>
<span class="sd">     PAL0708                1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">     PAL0708                2  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">     PAL0708                3  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">     PAL0708                4  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">     PAL0708                5  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">     PAL0708                6  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">     PAL0708                7  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">     PAL0708                8  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">     PAL0708                9  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">     PAL0708               10  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">                                                                </span>
<span class="sd">    </span>

<span class="sd">    Relabel column names using a mapping from old name to new name</span>

<span class="sd">    &gt;&gt;&gt; t.relabel({&quot;studyName&quot;: &quot;study_name&quot;}).head(1)</span>
<span class="sd">    </span>
<span class="sd">     study_name  Sample Number  Species                             </span>
<span class="sd">    </span>
<span class="sd">     string      int64          string                              </span>
<span class="sd">    </span>
<span class="sd">     PAL0708                 1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">    </span>

<span class="sd">    Relabel column names using a snake_case convention</span>

<span class="sd">    &gt;&gt;&gt; t.relabel(&quot;snake_case&quot;).head(1)</span>
<span class="sd">    </span>
<span class="sd">     study_name  sample_number  species                             </span>
<span class="sd">    </span>
<span class="sd">     string      int64          string                              </span>
<span class="sd">    </span>
<span class="sd">     PAL0708                 1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">    </span>

<span class="sd">    Relabel column names using a ALL_CAPS convention</span>

<span class="sd">    &gt;&gt;&gt; t.relabel(&quot;ALL_CAPS&quot;).head(1)</span>
<span class="sd">    </span>
<span class="sd">     STUDY_NAME  SAMPLE_NUMBER  SPECIES                             </span>
<span class="sd">    </span>
<span class="sd">     string      int64          string                              </span>
<span class="sd">    </span>
<span class="sd">     PAL0708                 1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">    </span>

<span class="sd">    Relabel columns using a format string</span>

<span class="sd">    &gt;&gt;&gt; t.relabel(&quot;p_{name}&quot;).head(1)</span>
<span class="sd">    </span>
<span class="sd">     p_studyName  p_Sample Number  p_Species                           </span>
<span class="sd">    </span>
<span class="sd">     string       int64            string                              </span>
<span class="sd">    </span>
<span class="sd">     PAL0708                    1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">    </span>

<span class="sd">    Relabel column names using a callable</span>

<span class="sd">    &gt;&gt;&gt; t.relabel(str.upper).head(1)</span>
<span class="sd">    </span>
<span class="sd">     STUDYNAME  SAMPLE NUMBER  SPECIES                             </span>
<span class="sd">    </span>
<span class="sd">     string     int64          string                              </span>
<span class="sd">    </span>
<span class="sd">     PAL0708                1  Adelie Penguin (Pygoscelis adeliae) </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">observed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">substitutions</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
        <span class="n">rename</span> <span class="o">=</span> <span class="n">substitutions</span><span class="o">.</span><span class="n">get</span>
    <span class="k">elif</span> <span class="n">substitutions</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;snake_case&quot;</span><span class="p">,</span> <span class="s2">&quot;ALL_CAPS&quot;</span><span class="p">}:</span>

        <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
                <span class="c1"># Handle &quot;space case possibly with-hyphens&quot;</span>
                <span class="k">if</span> <span class="n">substitutions</span> <span class="o">==</span> <span class="s2">&quot;snake_case&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">substitutions</span> <span class="o">==</span> <span class="s2">&quot;ALL_CAPS&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="c1"># Handle PascalCase, camelCase, and kebab-case</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([A-Z]+)([A-Z][a-z])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\1_\2&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([a-z\d])([A-Z])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\1_\2&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">substitutions</span> <span class="o">==</span> <span class="s2">&quot;snake_case&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">substitutions</span> <span class="o">==</span> <span class="s2">&quot;ALL_CAPS&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">substitutions</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">substitutions</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># Detect the case of missing or extra format string parameters</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dummy_name1</span> <span class="o">=</span> <span class="s2">&quot;_unlikely_column_name_1_&quot;</span>
            <span class="n">dummy_name2</span> <span class="o">=</span> <span class="s2">&quot;_unlikely_column_name_2_&quot;</span>
            <span class="n">invalid</span> <span class="o">=</span> <span class="n">rename</span><span class="p">(</span><span class="n">dummy_name1</span><span class="p">)</span> <span class="o">==</span> <span class="n">rename</span><span class="p">(</span><span class="n">dummy_name2</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">invalid</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">invalid</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Format strings must take a single parameter `name`&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rename</span> <span class="o">=</span> <span class="n">substitutions</span>

    <span class="n">exprs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">:=</span> <span class="n">rename</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">observed</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">exprs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">substitutions</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">substitutions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">observed</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">c</span><span class="si">!r}</span><span class="s2"> is not an existing column&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">exprs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.rowid" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rowid</span><span class="p">()</span></code>

<a href="#ibis.expr.types.relations.Table.rowid" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>A unique integer per row.</p>
<div class="admonition note">
<p class="admonition-title">This operation is only valid on physical tables</p>
<p>Any further meaning behind this expression is backend dependent.
Generally this corresponds to some index into the database storage
(for example, sqlite or duckdb's <code>rowid</code>).</p>
</div>
<p>For a monotonically increasing row number, see <code>ibis.row_number</code>.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.numeric.IntegerColumn" href="../numeric/#ibis.expr.types.numeric.IntegerColumn">IntegerColumn</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An integer column</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rowid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">IntegerValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A unique integer per row.</span>

<span class="sd">    !!! note &quot;This operation is only valid on physical tables&quot;</span>

<span class="sd">        Any further meaning behind this expression is backend dependent.</span>
<span class="sd">        Generally this corresponds to some index into the database storage</span>
<span class="sd">        (for example, sqlite or duckdb&#39;s `rowid`).</span>

<span class="sd">    For a monotonically increasing row number, see `ibis.row_number`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    IntegerColumn</span>
<span class="sd">        An integer column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(),</span> <span class="n">ops</span><span class="o">.</span><span class="n">PhysicalTable</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
            <span class="s2">&quot;rowid() is only valid for physical tables, not for generic &quot;</span>
            <span class="s2">&quot;table expressions&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">RowID</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">schema</span><span class="p">()</span></code>

<a href="#ibis.expr.types.relations.Table.schema" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return the schema for this table.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.api.Schema" href="../../schemas/#ibis.expr.schema.Schema">Schema</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The table's schema.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>
<span class="go">ibis.Schema {</span>
<span class="go">  species            string</span>
<span class="go">  island             string</span>
<span class="go">  bill_length_mm     float64</span>
<span class="go">  bill_depth_mm      float64</span>
<span class="go">  flipper_length_mm  int64</span>
<span class="go">  body_mass_g        int64</span>
<span class="go">  sex                string</span>
<span class="go">  year               int64</span>
<span class="go">}</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sch</span><span class="o">.</span><span class="n">Schema</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the schema for this table.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Schema</span>
<span class="sd">        The table&#39;s schema.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; t.schema()</span>
<span class="sd">    ibis.Schema {</span>
<span class="sd">      species            string</span>
<span class="sd">      island             string</span>
<span class="sd">      bill_length_mm     float64</span>
<span class="sd">      bill_depth_mm      float64</span>
<span class="sd">      flipper_length_mm  int64</span>
<span class="sd">      body_mass_g        int64</span>
<span class="sd">      sex                string</span>
<span class="sd">      year               int64</span>
<span class="sd">    }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">schema</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.select" class="doc doc-heading">
<code class="highlight language-python"><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">,</span> <span class="o">**</span><span class="n">named_exprs</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.select" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute a new table expression using <code>exprs</code> and <code>named_exprs</code>.</p>
<p>Passing an aggregate function to this method will broadcast the
aggregate's value over the number of rows in the table and
automatically constructs a window function expression. See the examples
section for more details.</p>
<p>For backwards compatibility the keyword argument <code>exprs</code> is reserved
and cannot be used to name an expression. This behavior will be removed
in v4.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exprs</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.Value">Value</span> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<span title="ibis">ir</span>.<span title="ibis.Value">Value</span> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Column expression, string, or list of column expressions and
strings.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>named_exprs</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.Value">Value</span> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Column expressions</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="go"></span>
<span class="go"> string   string     float64         float64        int64               </span>
<span class="go"></span>
<span class="go"> Adelie   Torgersen            39.1           18.7                181   </span>
<span class="go"> Adelie   Torgersen            39.5           17.4                186   </span>
<span class="go"> Adelie   Torgersen            40.3           18.0                195   </span>
<span class="go"> Adelie   Torgersen             nan            nan               NULL   </span>
<span class="go"> Adelie   Torgersen            36.7           19.3                193   </span>
<span class="go"> Adelie   Torgersen            39.3           20.6                190   </span>
<span class="go"> Adelie   Torgersen            38.9           17.8                181   </span>
<span class="go"> Adelie   Torgersen            39.2           19.6                195   </span>
<span class="go"> Adelie   Torgersen            34.1           18.1                193   </span>
<span class="go"> Adelie   Torgersen            42.0           20.2                190   </span>
<span class="go">                                                                   </span>
<span class="go"></span>
</code></pre></div>
    <p>Simple projection</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_length_mm&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> island     bill_length_mm </span>
<span class="go"></span>
<span class="go"> string     float64        </span>
<span class="go"></span>
<span class="go"> Torgersen            39.1 </span>
<span class="go"> Torgersen            39.5 </span>
<span class="go"> Torgersen            40.3 </span>
<span class="go"> Torgersen             nan </span>
<span class="go"> Torgersen            36.7 </span>
<span class="go"></span>
</code></pre></div>
    <p>Projection by zero-indexed column position</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> species  flipper_length_mm </span>
<span class="go"></span>
<span class="go"> string   int64             </span>
<span class="go"></span>
<span class="go"> Adelie                 181 </span>
<span class="go"> Adelie                 186 </span>
<span class="go"> Adelie                 195 </span>
<span class="go"> Adelie                NULL </span>
<span class="go"> Adelie                 193 </span>
<span class="go"></span>
</code></pre></div>
    <p>Projection with renaming and compute in one call</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">next_year</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> next_year </span>
<span class="go"></span>
<span class="go"> int64     </span>
<span class="go"></span>
<span class="go">      2008 </span>
<span class="go">      2008 </span>
<span class="go">      2008 </span>
<span class="go">      2008 </span>
<span class="go">      2008 </span>
<span class="go"></span>
</code></pre></div>
    <p>Projection with aggregation expressions</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="n">bill_mean</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">bill_length_mm</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> island     bill_mean </span>
<span class="go"></span>
<span class="go"> string     float64   </span>
<span class="go"></span>
<span class="go"> Torgersen   43.92193 </span>
<span class="go"> Torgersen   43.92193 </span>
<span class="go"> Torgersen   43.92193 </span>
<span class="go"> Torgersen   43.92193 </span>
<span class="go"> Torgersen   43.92193 </span>
<span class="go"></span>
</code></pre></div>
    <p>Projection with a selector</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis.selectors</span> <span class="k">as</span> <span class="nn">s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">numeric</span><span class="p">()</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> bill_length_mm  bill_depth_mm  flipper_length_mm  body_mass_g </span>
<span class="go"></span>
<span class="go"> float64         float64        int64              int64       </span>
<span class="go"></span>
<span class="go">           39.1           18.7                181         3750 </span>
<span class="go">           39.5           17.4                186         3800 </span>
<span class="go">           40.3           18.0                195         3250 </span>
<span class="go">            nan            nan               NULL         NULL </span>
<span class="go">           36.7           19.3                193         3450 </span>
<span class="go"></span>
</code></pre></div>
    <p>Projection + aggregation across multiple columns</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">across</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">numeric</span><span class="p">()</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">),</span> <span class="n">_</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go"></span>
<span class="go"> bill_length_mm  bill_depth_mm  flipper_length_mm  body_mass_g </span>
<span class="go"></span>
<span class="go"> float64         float64        float64            float64     </span>
<span class="go"></span>
<span class="go">       43.92193       17.15117         200.915205  4201.754386 </span>
<span class="go">       43.92193       17.15117         200.915205  4201.754386 </span>
<span class="go">       43.92193       17.15117         200.915205  4201.754386 </span>
<span class="go">       43.92193       17.15117         200.915205  4201.754386 </span>
<span class="go">       43.92193       17.15117         200.915205  4201.754386 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">select</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">exprs</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span>
    <span class="o">**</span><span class="n">named_exprs</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a new table expression using `exprs` and `named_exprs`.</span>

<span class="sd">    Passing an aggregate function to this method will broadcast the</span>
<span class="sd">    aggregate&#39;s value over the number of rows in the table and</span>
<span class="sd">    automatically constructs a window function expression. See the examples</span>
<span class="sd">    section for more details.</span>

<span class="sd">    For backwards compatibility the keyword argument `exprs` is reserved</span>
<span class="sd">    and cannot be used to name an expression. This behavior will be removed</span>
<span class="sd">    in v4.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exprs</span>
<span class="sd">        Column expression, string, or list of column expressions and</span>
<span class="sd">        strings.</span>
<span class="sd">    named_exprs</span>
<span class="sd">        Column expressions</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Table expression</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch()</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     species  island     bill_length_mm  bill_depth_mm  flipper_length_mm   </span>
<span class="sd">    </span>
<span class="sd">     string   string     float64         float64        int64               </span>
<span class="sd">    </span>
<span class="sd">     Adelie   Torgersen            39.1           18.7                181   </span>
<span class="sd">     Adelie   Torgersen            39.5           17.4                186   </span>
<span class="sd">     Adelie   Torgersen            40.3           18.0                195   </span>
<span class="sd">     Adelie   Torgersen             nan            nan               NULL   </span>
<span class="sd">     Adelie   Torgersen            36.7           19.3                193   </span>
<span class="sd">     Adelie   Torgersen            39.3           20.6                190   </span>
<span class="sd">     Adelie   Torgersen            38.9           17.8                181   </span>
<span class="sd">     Adelie   Torgersen            39.2           19.6                195   </span>
<span class="sd">     Adelie   Torgersen            34.1           18.1                193   </span>
<span class="sd">     Adelie   Torgersen            42.0           20.2                190   </span>
<span class="sd">                                                                       </span>
<span class="sd">    </span>

<span class="sd">    Simple projection</span>

<span class="sd">    &gt;&gt;&gt; t.select(&quot;island&quot;, &quot;bill_length_mm&quot;).head()</span>
<span class="sd">    </span>
<span class="sd">     island     bill_length_mm </span>
<span class="sd">    </span>
<span class="sd">     string     float64        </span>
<span class="sd">    </span>
<span class="sd">     Torgersen            39.1 </span>
<span class="sd">     Torgersen            39.5 </span>
<span class="sd">     Torgersen            40.3 </span>
<span class="sd">     Torgersen             nan </span>
<span class="sd">     Torgersen            36.7 </span>
<span class="sd">    </span>

<span class="sd">    Projection by zero-indexed column position</span>

<span class="sd">    &gt;&gt;&gt; t.select(0, 4).head()</span>
<span class="sd">    </span>
<span class="sd">     species  flipper_length_mm </span>
<span class="sd">    </span>
<span class="sd">     string   int64             </span>
<span class="sd">    </span>
<span class="sd">     Adelie                 181 </span>
<span class="sd">     Adelie                 186 </span>
<span class="sd">     Adelie                 195 </span>
<span class="sd">     Adelie                NULL </span>
<span class="sd">     Adelie                 193 </span>
<span class="sd">    </span>

<span class="sd">    Projection with renaming and compute in one call</span>

<span class="sd">    &gt;&gt;&gt; t.select(next_year=t.year + 1).head()</span>
<span class="sd">    </span>
<span class="sd">     next_year </span>
<span class="sd">    </span>
<span class="sd">     int64     </span>
<span class="sd">    </span>
<span class="sd">          2008 </span>
<span class="sd">          2008 </span>
<span class="sd">          2008 </span>
<span class="sd">          2008 </span>
<span class="sd">          2008 </span>
<span class="sd">    </span>

<span class="sd">    Projection with aggregation expressions</span>

<span class="sd">    &gt;&gt;&gt; t.select(&quot;island&quot;, bill_mean=t.bill_length_mm.mean()).head()</span>
<span class="sd">    </span>
<span class="sd">     island     bill_mean </span>
<span class="sd">    </span>
<span class="sd">     string     float64   </span>
<span class="sd">    </span>
<span class="sd">     Torgersen   43.92193 </span>
<span class="sd">     Torgersen   43.92193 </span>
<span class="sd">     Torgersen   43.92193 </span>
<span class="sd">     Torgersen   43.92193 </span>
<span class="sd">     Torgersen   43.92193 </span>
<span class="sd">    </span>

<span class="sd">    Projection with a selector</span>

<span class="sd">    &gt;&gt;&gt; import ibis.selectors as s</span>
<span class="sd">    &gt;&gt;&gt; t.select(s.numeric() &amp; ~s.c(&quot;year&quot;)).head()</span>
<span class="sd">    </span>
<span class="sd">     bill_length_mm  bill_depth_mm  flipper_length_mm  body_mass_g </span>
<span class="sd">    </span>
<span class="sd">     float64         float64        int64              int64       </span>
<span class="sd">    </span>
<span class="sd">               39.1           18.7                181         3750 </span>
<span class="sd">               39.5           17.4                186         3800 </span>
<span class="sd">               40.3           18.0                195         3250 </span>
<span class="sd">                nan            nan               NULL         NULL </span>
<span class="sd">               36.7           19.3                193         3450 </span>
<span class="sd">    </span>

<span class="sd">    Projection + aggregation across multiple columns</span>

<span class="sd">    &gt;&gt;&gt; from ibis import _</span>
<span class="sd">    &gt;&gt;&gt; t.select(s.across(s.numeric() &amp; ~s.c(&quot;year&quot;), _.mean())).head()</span>
<span class="sd">    </span>
<span class="sd">     bill_length_mm  bill_depth_mm  flipper_length_mm  body_mass_g </span>
<span class="sd">    </span>
<span class="sd">     float64         float64        float64            float64     </span>
<span class="sd">    </span>
<span class="sd">           43.92193       17.15117         200.915205  4201.754386 </span>
<span class="sd">           43.92193       17.15117         200.915205  4201.754386 </span>
<span class="sd">           43.92193       17.15117         200.915205  4201.754386 </span>
<span class="sd">           43.92193       17.15117         200.915205  4201.754386 </span>
<span class="sd">           43.92193       17.15117         200.915205  4201.754386 </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">ibis.expr.analysis</span> <span class="k">as</span> <span class="nn">an</span>
    <span class="kn">from</span> <span class="nn">ibis.selectors</span> <span class="kn">import</span> <span class="n">Selector</span>

    <span class="n">exprs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Selector</span><span class="p">)</span> <span class="k">else</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">exprs</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">named_exprs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">exprs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisTypeError</span><span class="p">(</span>
            <span class="s2">&quot;You must select at least one column for a valid projection&quot;</span>
        <span class="p">)</span>

    <span class="n">op</span> <span class="o">=</span> <span class="n">an</span><span class="o">.</span><span class="n">Projector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exprs</span><span class="p">)</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.sql" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.sql" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Run a SQL query against a table expression.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>query</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Query string</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dialect</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional string indicating the dialect of <code>query</code>. Defaults to the
backend's native dialect.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An opaque table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;penguins&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="sd">    SELECT island, mean(bill_length_mm) AS avg_bill_length</span>
<span class="gp">... </span><span class="sd">    FROM penguins</span>
<span class="gp">... </span><span class="sd">    GROUP BY 1</span>
<span class="gp">... </span><span class="sd">    ORDER BY 2 DESC</span>
<span class="gp">... </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span>
<span class="go"></span>
<span class="go"> island     avg_bill_length </span>
<span class="go"></span>
<span class="go"> string     float64         </span>
<span class="go"></span>
<span class="go"> Biscoe           45.257485 </span>
<span class="go"> Dream            44.167742 </span>
<span class="go"> Torgersen        38.950980 </span>
<span class="go"></span>
</code></pre></div>
    <p>Mix and match ibis expressions with SQL queries</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">penguins</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;penguins&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="sd">    SELECT island, mean(bill_length_mm) AS avg_bill_length</span>
<span class="gp">... </span><span class="sd">    FROM penguins</span>
<span class="gp">... </span><span class="sd">    GROUP BY 1</span>
<span class="gp">... </span><span class="sd">    ORDER BY 2 DESC</span>
<span class="gp">... </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">island</span><span class="o">=</span><span class="n">_</span><span class="o">.</span><span class="n">island</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">avg_bill_length</span><span class="o">=</span><span class="n">_</span><span class="o">.</span><span class="n">avg_bill_length</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span>
<span class="go"></span>
<span class="go"> island     avg_bill_length </span>
<span class="go"></span>
<span class="go"> string     float64         </span>
<span class="go"></span>
<span class="go"> biscoe                45.3 </span>
<span class="go"> dream                 44.2 </span>
<span class="go"> torgersen             39.0 </span>
<span class="go"></span>
</code></pre></div>
    <p>Because ibis expressions aren't named, they aren't visible to
subsequent <code>.sql</code> calls. Use the <a class="autorefs autorefs-internal" href="#ibis.expr.types.relations.Table.alias"><code>alias</code></a> method
to assign a name to an expression.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM b WHERE avg_bill_length &gt; 40&quot;</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> island  avg_bill_length </span>
<span class="go"></span>
<span class="go"> string  float64         </span>
<span class="go"></span>
<span class="go"> biscoe             45.3 </span>
<span class="go"> dream              44.2 </span>
<span class="go"></span>
</code></pre></div>
      <h6 id="ibis.expr.types.relations.Table.sql--see-also">See Also<a class="headerlink" href="#ibis.expr.types.relations.Table.sql--see-also" title="Anchor link to this section for reference">&para;</a></h6>
<p><a class="autorefs autorefs-internal" href="#ibis.expr.types.relations.Table.alias"><code>Table.alias</code></a></p>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dialect</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Run a SQL query against a table expression.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    query</span>
<span class="sd">        Query string</span>
<span class="sd">    dialect</span>
<span class="sd">        Optional string indicating the dialect of `query`. Defaults to the</span>
<span class="sd">        backend&#39;s native dialect.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        An opaque table expression</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; from ibis import _</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch(table_name=&quot;penguins&quot;)</span>
<span class="sd">    &gt;&gt;&gt; expr = t.sql(</span>
<span class="sd">    ...     &quot;&quot;&quot;</span>
<span class="sd">    ...     SELECT island, mean(bill_length_mm) AS avg_bill_length</span>
<span class="sd">    ...     FROM penguins</span>
<span class="sd">    ...     GROUP BY 1</span>
<span class="sd">    ...     ORDER BY 2 DESC</span>
<span class="sd">    ...     &quot;&quot;&quot;</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; expr</span>
<span class="sd">    </span>
<span class="sd">     island     avg_bill_length </span>
<span class="sd">    </span>
<span class="sd">     string     float64         </span>
<span class="sd">    </span>
<span class="sd">     Biscoe           45.257485 </span>
<span class="sd">     Dream            44.167742 </span>
<span class="sd">     Torgersen        38.950980 </span>
<span class="sd">    </span>

<span class="sd">    Mix and match ibis expressions with SQL queries</span>

<span class="sd">    &gt;&gt;&gt; t = ibis.examples.penguins.fetch(table_name=&quot;penguins&quot;)</span>
<span class="sd">    &gt;&gt;&gt; expr = t.sql(</span>
<span class="sd">    ...     &quot;&quot;&quot;</span>
<span class="sd">    ...     SELECT island, mean(bill_length_mm) AS avg_bill_length</span>
<span class="sd">    ...     FROM penguins</span>
<span class="sd">    ...     GROUP BY 1</span>
<span class="sd">    ...     ORDER BY 2 DESC</span>
<span class="sd">    ...     &quot;&quot;&quot;</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; expr = expr.mutate(</span>
<span class="sd">    ...     island=_.island.lower(),</span>
<span class="sd">    ...     avg_bill_length=_.avg_bill_length.round(1),</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; expr</span>
<span class="sd">    </span>
<span class="sd">     island     avg_bill_length </span>
<span class="sd">    </span>
<span class="sd">     string     float64         </span>
<span class="sd">    </span>
<span class="sd">     biscoe                45.3 </span>
<span class="sd">     dream                 44.2 </span>
<span class="sd">     torgersen             39.0 </span>
<span class="sd">    </span>

<span class="sd">    Because ibis expressions aren&#39;t named, they aren&#39;t visible to</span>
<span class="sd">    subsequent `.sql` calls. Use the [`alias`][ibis.expr.types.relations.Table.alias] method</span>
<span class="sd">    to assign a name to an expression.</span>

<span class="sd">    &gt;&gt;&gt; expr.alias(&quot;b&quot;).sql(&quot;SELECT * FROM b WHERE avg_bill_length &gt; 40&quot;)</span>
<span class="sd">    </span>
<span class="sd">     island  avg_bill_length </span>
<span class="sd">    </span>
<span class="sd">     string  float64         </span>
<span class="sd">    </span>
<span class="sd">     biscoe             45.3 </span>
<span class="sd">     dream              44.2 </span>
<span class="sd">    </span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [`Table.alias`][ibis.expr.types.relations.Table.alias]</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># only transpile if dialect was passed</span>
    <span class="k">if</span> <span class="n">dialect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_backend</span><span class="p">()</span>
        <span class="n">query</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">_transpile_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="n">dialect</span><span class="p">)</span>
    <span class="n">op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">SQLStringView</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">_ALIASES</span><span class="p">),</span> <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.to_array" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_array</span><span class="p">()</span></code>

<a href="#ibis.expr.types.relations.Table.to_array" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>View a single column table as an array.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.temporal.Value" href="../generic/#ibis.expr.types.generic.Value">Value</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A single column view of a table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;View a single column table as an array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Value</span>
<span class="sd">        A single column view of a table</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">ExpressionError</span><span class="p">(</span>
            <span class="s1">&#39;Table must have exactly one column when viewed as array&#39;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">TableArrayView</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.to_pandas" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_pandas</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.to_pandas" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a table expression to a pandas DataFrame.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Same as keyword arguments to <a class="autorefs autorefs-internal" href="../#ibis.expr.types.core.Expr.execute"><code>execute</code></a></p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a table expression to a pandas DataFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    kwargs</span>
<span class="sd">        Same as keyword arguments to [`execute`][ibis.expr.types.core.Expr.execute]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.try_cast" class="doc doc-heading">
<code class="highlight language-python"><span class="n">try_cast</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.try_cast" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Cast the columns of a table.</p>
<p>If the cast fails for a row, the value is returned
as <code>NULL</code> or <code>NaN</code> depending on backend behavior.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><span title="ibis.common.typing.SupportsSchema">SupportsSchema</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping, schema or iterable of pairs to use for casting</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Casted table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2.2&quot;</span><span class="p">,</span> <span class="s2">&quot;3.3&quot;</span><span class="p">,</span> <span class="s2">&quot;book&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">try_cast</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span><span class="p">})</span>
<span class="go"></span>
<span class="go"> a      b       </span>
<span class="go"></span>
<span class="go"> int64  float64 </span>
<span class="go"></span>
<span class="go">     1      2.2 </span>
<span class="go">     2      3.3 </span>
<span class="go">     3      nan </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">try_cast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">SupportsSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cast the columns of a table.</span>

<span class="sd">    If the cast fails for a row, the value is returned</span>
<span class="sd">    as `NULL` or `NaN` depending on backend behavior.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    schema</span>
<span class="sd">        Mapping, schema or iterable of pairs to use for casting</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Casted table</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.memtable({&quot;a&quot;: [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;], &quot;b&quot;: [&quot;2.2&quot;, &quot;3.3&quot;, &quot;book&quot;]})</span>
<span class="sd">    &gt;&gt;&gt; t.try_cast({&quot;a&quot;: &quot;int&quot;, &quot;b&quot;: &quot;float&quot;})</span>
<span class="sd">    </span>
<span class="sd">     a      b       </span>
<span class="sd">    </span>
<span class="sd">     int64  float64 </span>
<span class="sd">    </span>
<span class="sd">         1      2.2 </span>
<span class="sd">         2      3.3 </span>
<span class="sd">         3      nan </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">cast_method</span><span class="o">=</span><span class="s2">&quot;try_cast&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.union" class="doc doc-heading">
<code class="highlight language-python"><span class="n">union</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.union" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute the set union of multiple table expressions.</p>
<p>The input tables must have identical schemas.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>table</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A table expression</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*rest</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional table expressions</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>distinct</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Only return distinct rows</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A new table containing the union of all input tables.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <h6 id="ibis.expr.types.relations.Table.union--see-also">See Also<a class="headerlink" href="#ibis.expr.types.relations.Table.union--see-also" title="Anchor link to this section for reference">&para;</a></h6>
<p><a class="autorefs autorefs-internal" href="../top_level/#ibis.union"><code>ibis.union</code></a></p>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"></span>
<span class="go"> int64 </span>
<span class="go"></span>
<span class="go">     1 </span>
<span class="go">     2 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">memtable</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"></span>
<span class="go"> int64 </span>
<span class="go"></span>
<span class="go">     2 </span>
<span class="go">     3 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>  <span class="c1"># union all by default</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"></span>
<span class="go"> int64 </span>
<span class="go"></span>
<span class="go">     1 </span>
<span class="go">     2 </span>
<span class="go">     2 </span>
<span class="go">     3 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"></span>
<span class="go"> int64 </span>
<span class="go"></span>
<span class="go">     1 </span>
<span class="go">     2 </span>
<span class="go">     3 </span>
<span class="go"></span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">distinct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the set union of multiple table expressions.</span>

<span class="sd">    The input tables must have identical schemas.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table</span>
<span class="sd">        A table expression</span>
<span class="sd">    *rest</span>
<span class="sd">        Additional table expressions</span>
<span class="sd">    distinct</span>
<span class="sd">        Only return distinct rows</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        A new table containing the union of all input tables.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [`ibis.union`][ibis.union]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; t1 = ibis.memtable({&quot;a&quot;: [1, 2]})</span>
<span class="sd">    &gt;&gt;&gt; t1</span>
<span class="sd">    </span>
<span class="sd">     a     </span>
<span class="sd">    </span>
<span class="sd">     int64 </span>
<span class="sd">    </span>
<span class="sd">         1 </span>
<span class="sd">         2 </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t2 = ibis.memtable({&quot;a&quot;: [2, 3]})</span>
<span class="sd">    &gt;&gt;&gt; t2</span>
<span class="sd">    </span>
<span class="sd">     a     </span>
<span class="sd">    </span>
<span class="sd">     int64 </span>
<span class="sd">    </span>
<span class="sd">         2 </span>
<span class="sd">         3 </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t1.union(t2)  # union all by default</span>
<span class="sd">    </span>
<span class="sd">     a     </span>
<span class="sd">    </span>
<span class="sd">     int64 </span>
<span class="sd">    </span>
<span class="sd">         1 </span>
<span class="sd">         2 </span>
<span class="sd">         2 </span>
<span class="sd">         3 </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t1.union(t2, distinct=True).order_by(&quot;a&quot;)</span>
<span class="sd">    </span>
<span class="sd">     a     </span>
<span class="sd">    </span>
<span class="sd">     int64 </span>
<span class="sd">    </span>
<span class="sd">         1 </span>
<span class="sd">         2 </span>
<span class="sd">         3 </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">rest</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Union</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.unpack" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unpack</span><span class="p">(</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span></code>

<a href="#ibis.expr.types.relations.Table.unpack" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Project the struct fields of each of <code>columns</code> into <code>self</code>.</p>
<p>Existing fields are retained in the projection.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>columns</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String column names to project into <code>self</code>.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The child table with struct fields of each of <code>columns</code> projected.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lines</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    {&quot;name&quot;: &quot;a&quot;, &quot;pos&quot;: {&quot;lat&quot;: 10.1, &quot;lon&quot;: 30.3}}</span>
<span class="gp">... </span><span class="s1">    {&quot;name&quot;: &quot;b&quot;, &quot;pos&quot;: {&quot;lat&quot;: 10.2, &quot;lon&quot;: 30.2}}</span>
<span class="gp">... </span><span class="s1">    {&quot;name&quot;: &quot;c&quot;, &quot;pos&quot;: {&quot;lat&quot;: 10.3, &quot;lon&quot;: 30.1}}</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/tmp/lines.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s2">&quot;/tmp/lines.json&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go"></span>
<span class="go"> name    pos                                </span>
<span class="go"></span>
<span class="go"> string  struct&lt;lat: float64, lon: float64&gt; </span>
<span class="go"></span>
<span class="go"> a       {&#39;lat&#39;: 10.1, &#39;lon&#39;: 30.3}         </span>
<span class="go"> b       {&#39;lat&#39;: 10.2, &#39;lon&#39;: 30.2}         </span>
<span class="go"> c       {&#39;lat&#39;: 10.3, &#39;lon&#39;: 30.1}         </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;pos&quot;</span><span class="p">)</span>
<span class="go"></span>
<span class="go"> name    lat      lon     </span>
<span class="go"></span>
<span class="go"> string  float64  float64 </span>
<span class="go"></span>
<span class="go"> a          10.1     30.3 </span>
<span class="go"> b          10.2     30.2 </span>
<span class="go"> c          10.3     30.1 </span>
<span class="go"></span>
</code></pre></div>
      <h6 id="ibis.expr.types.relations.Table.unpack--see-also">See Also<a class="headerlink" href="#ibis.expr.types.relations.Table.unpack--see-also" title="Anchor link to this section for reference">&para;</a></h6>
<p><a class="autorefs autorefs-internal" href="../collections/#ibis.expr.types.structs.StructValue.lift"><code>StructValue.lift</code></a></p>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unpack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">columns</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Project the struct fields of each of `columns` into `self`.</span>

<span class="sd">    Existing fields are retained in the projection.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    columns</span>
<span class="sd">        String column names to project into `self`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        The child table with struct fields of each of `columns` projected.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; ibis.options.interactive = True</span>
<span class="sd">    &gt;&gt;&gt; lines = &#39;&#39;&#39;</span>
<span class="sd">    ...     {&quot;name&quot;: &quot;a&quot;, &quot;pos&quot;: {&quot;lat&quot;: 10.1, &quot;lon&quot;: 30.3}}</span>
<span class="sd">    ...     {&quot;name&quot;: &quot;b&quot;, &quot;pos&quot;: {&quot;lat&quot;: 10.2, &quot;lon&quot;: 30.2}}</span>
<span class="sd">    ...     {&quot;name&quot;: &quot;c&quot;, &quot;pos&quot;: {&quot;lat&quot;: 10.3, &quot;lon&quot;: 30.1}}</span>
<span class="sd">    ... &#39;&#39;&#39;</span>
<span class="sd">    &gt;&gt;&gt; with open(&quot;/tmp/lines.json&quot;, &quot;w&quot;) as f:</span>
<span class="sd">    ...     _ = f.write(lines)</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.read_json(&quot;/tmp/lines.json&quot;)</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    </span>
<span class="sd">     name    pos                                </span>
<span class="sd">    </span>
<span class="sd">     string  struct&lt;lat: float64, lon: float64&gt; </span>
<span class="sd">    </span>
<span class="sd">     a       {&#39;lat&#39;: 10.1, &#39;lon&#39;: 30.3}         </span>
<span class="sd">     b       {&#39;lat&#39;: 10.2, &#39;lon&#39;: 30.2}         </span>
<span class="sd">     c       {&#39;lat&#39;: 10.3, &#39;lon&#39;: 30.1}         </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; t.unpack(&quot;pos&quot;)</span>
<span class="sd">    </span>
<span class="sd">     name    lat      lon     </span>
<span class="sd">    </span>
<span class="sd">     string  float64  float64 </span>
<span class="sd">    </span>
<span class="sd">     a          10.1     30.3 </span>
<span class="sd">     b          10.2     30.2 </span>
<span class="sd">     c          10.3     30.1 </span>
<span class="sd">    </span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [`StructValue.lift`][ibis.expr.types.structs.StructValue.lift]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">columns_to_unpack</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">result_columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_unpack</span><span class="p">:</span>
            <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
            <span class="n">result_columns</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">expr</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">result_columns</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.relations.Table.view" class="doc doc-heading">
<code class="highlight language-python"><span class="n">view</span><span class="p">()</span></code>

<a href="#ibis.expr.types.relations.Table.view" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create a new table expression distinct from the current one.</p>
<p>Use this API for any self-referencing operations like a self-join.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/relations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new table expression distinct from the current one.</span>

<span class="sd">    Use this API for any self-referencing operations like a self-join.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        Table expression</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">SelfReference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_expr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ibis.expr.types.groupby.GroupedTable" class="doc doc-heading">
          <code>GroupedTable</code>


<a href="#ibis.expr.types.groupby.GroupedTable" class="headerlink" title="Anchor link to this section for reference">&para;</a></h2>


  <div class="doc doc-contents first">

  
      <p>An intermediate table expression to hold grouping information.</p>

            <details class="quote">
              <summary>Source code in <code>ibis/expr/types/groupby.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GroupedTable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An intermediate table expression to hold grouping information.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">having</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">expressions</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
                <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                    <span class="n">_get_group_by_key</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
                <span class="p">),</span>
                <span class="p">(</span>
                    <span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">expressions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">_get_group_by_key</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">IbisInputError</span><span class="p">(</span><span class="s2">&quot;The grouping keys list is empty&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_order_by</span> <span class="o">=</span> <span class="n">order_by</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_having</span> <span class="o">=</span> <span class="n">having</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_window</span> <span class="o">=</span> <span class="n">window</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="c1"># Shortcut for projection with window functions</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_wrapper</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;GroupBy has no attribute </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">attr</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_column_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">ir</span><span class="o">.</span><span class="n">NumericValue</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">GroupedNumbers</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">GroupedArray</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute aggregates over a group by.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">having</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_having</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

    <span class="n">agg</span> <span class="o">=</span> <span class="n">aggregate</span>

    <span class="k">def</span> <span class="nf">having</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanScalar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GroupedTable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a post-aggregation result filter `expr`.</span>

<span class="sd">        !!! warning &quot;Expressions like `x is None` return `bool` and **will not** generate a SQL comparison to `NULL`&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        expr</span>
<span class="sd">            An expression that filters based on an aggregate value.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GroupedTable</span>
<span class="sd">            A grouped table expression</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">,</span>
            <span class="n">having</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_having</span> <span class="o">+</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span>
            <span class="n">order_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_order_by</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_window</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">order_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">GroupedTable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort a grouped table expression by `expr`.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This API call is ignored in aggregations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        expr</span>
<span class="sd">            Expressions to order the results by</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GroupedTable</span>
<span class="sd">            A sorted grouped GroupedTable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">,</span>
            <span class="n">having</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_having</span><span class="p">,</span>
            <span class="n">order_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_order_by</span> <span class="o">+</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span>
            <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_window</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">exprs</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">],</span> <span class="o">**</span><span class="n">kwexprs</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a table projection with window functions applied.</span>

<span class="sd">        Any arguments can be functions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        exprs</span>
<span class="sd">            List of expressions</span>
<span class="sd">        kwexprs</span>
<span class="sd">            Expressions</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import ibis</span>
<span class="sd">        &gt;&gt;&gt; t = ibis.table([</span>
<span class="sd">        ...     (&#39;foo&#39;, &#39;string&#39;),</span>
<span class="sd">        ...     (&#39;bar&#39;, &#39;string&#39;),</span>
<span class="sd">        ...     (&#39;baz&#39;, &#39;double&#39;),</span>
<span class="sd">        ... ], name=&#39;t&#39;)</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        UnboundTable: t</span>
<span class="sd">          foo string</span>
<span class="sd">          bar string</span>
<span class="sd">          baz float64</span>
<span class="sd">        &gt;&gt;&gt; expr = (t.group_by(&#39;foo&#39;)</span>
<span class="sd">        ...          .order_by(ibis.desc(&#39;bar&#39;))</span>
<span class="sd">        ...          .mutate(qux=lambda x: x.baz.lag(), qux2=t.baz.lead()))</span>
<span class="sd">        &gt;&gt;&gt; print(expr)</span>
<span class="sd">        r0 := UnboundTable: t</span>
<span class="sd">          foo string</span>
<span class="sd">          bar string</span>
<span class="sd">          baz float64</span>
<span class="sd">        Selection[r0]</span>
<span class="sd">          selections:</span>
<span class="sd">            r0</span>
<span class="sd">            qux:  WindowFunction(...)</span>
<span class="sd">            qux2: WindowFunction(...)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            A table expression with window functions applied</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">exprs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectables</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwexprs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">exprs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">exprs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwexprs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Project new columns out of the grouped table.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        [`GroupedTable.mutate`][ibis.expr.types.groupby.GroupedTable.mutate]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exprs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectables</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwexprs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">exprs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_selectables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">exprs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwexprs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Project new columns out of the grouped table.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        [`GroupedTable.mutate`][ibis.expr.types.groupby.GroupedTable.mutate]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span>
        <span class="n">default_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_window</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">an</span><span class="o">.</span><span class="n">windowize_function</span><span class="p">(</span><span class="n">e2</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">default_frame</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">exprs</span>
            <span class="k">for</span> <span class="n">e1</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e2</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="n">e1</span><span class="p">))</span>
        <span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
            <span class="n">an</span><span class="o">.</span><span class="n">windowize_function</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">default_frame</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">kwexprs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">_ensure_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
        <span class="p">]</span>

    <span class="n">projection</span> <span class="o">=</span> <span class="n">select</span>

    <span class="k">def</span> <span class="nf">_get_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">RowsWindowFrame</span><span class="p">(</span>
                <span class="n">table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span>
                <span class="n">group_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">,</span>
                <span class="n">order_by</span><span class="o">=</span><span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_by</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                <span class="n">groupy_by</span><span class="o">=</span><span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window</span><span class="o">.</span><span class="n">group_by</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">),</span>
                <span class="n">order_by</span><span class="o">=</span><span class="n">bind_expr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window</span><span class="o">.</span><span class="n">order_by</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_by</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">over</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">group_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">order_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GroupedTable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a window over the input expressions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        window</span>
<span class="sd">            Window to add to the input</span>
<span class="sd">        rows</span>
<span class="sd">            Whether to use the `ROWS` window clause</span>
<span class="sd">        range</span>
<span class="sd">            Whether to use the `RANGE` window clause</span>
<span class="sd">        group_by</span>
<span class="sd">            Grouping key</span>
<span class="sd">        order_by</span>
<span class="sd">            Ordering key</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GroupedTable</span>
<span class="sd">            A new grouped table expression</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">window</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">window</span><span class="p">(</span>
                <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                <span class="nb">range</span><span class="o">=</span><span class="nb">range</span><span class="p">,</span>
                <span class="n">group_by</span><span class="o">=</span><span class="n">group_by</span><span class="p">,</span>
                <span class="n">order_by</span><span class="o">=</span><span class="n">order_by</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">,</span>
            <span class="n">having</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_having</span><span class="p">,</span>
            <span class="n">order_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_order_by</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Computing the number of rows per group.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Table</span>
<span class="sd">            The aggregated table</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">metric</span><span class="p">],</span> <span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">having</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_having</span><span class="p">)</span>

    <span class="n">size</span> <span class="o">=</span> <span class="n">count</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<h3 id="ibis.expr.types.groupby.GroupedTable-functions">Functions<a href="#ibis.expr.types.groupby.GroupedTable-functions" class="headerlink" title="Anchor link to this section for reference">&para;</a></h3>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.groupby.GroupedTable.aggregate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">aggregate</span><span class="p">(</span><span class="n">metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span></code>

<a href="#ibis.expr.types.groupby.GroupedTable.aggregate" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute aggregates over a group by.</p>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/groupby.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute aggregates over a group by.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">having</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_having</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.groupby.GroupedTable.count" class="doc doc-heading">
<code class="highlight language-python"><span class="n">count</span><span class="p">()</span></code>

<a href="#ibis.expr.types.groupby.GroupedTable.count" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Computing the number of rows per group.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The aggregated table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/groupby.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computing the number of rows per group.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        The aggregated table</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">metric</span><span class="p">],</span> <span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">having</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_having</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.groupby.GroupedTable.having" class="doc doc-heading">
<code class="highlight language-python"><span class="n">having</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#ibis.expr.types.groupby.GroupedTable.having" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Add a post-aggregation result filter <code>expr</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Expressions like <code>x is None</code> return <code>bool</code> and <strong>will not</strong> generate a SQL comparison to <code>NULL</code></p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.BooleanScalar">BooleanScalar</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An expression that filters based on an aggregate value.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.groupby.GroupedTable" href="#ibis.expr.types.groupby.GroupedTable">GroupedTable</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A grouped table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/groupby.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">having</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">BooleanScalar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GroupedTable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a post-aggregation result filter `expr`.</span>

<span class="sd">    !!! warning &quot;Expressions like `x is None` return `bool` and **will not** generate a SQL comparison to `NULL`&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    expr</span>
<span class="sd">        An expression that filters based on an aggregate value.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    GroupedTable</span>
<span class="sd">        A grouped table expression</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">,</span>
        <span class="n">having</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_having</span> <span class="o">+</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span>
        <span class="n">order_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_order_by</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_window</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.groupby.GroupedTable.mutate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mutate</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwexprs</span><span class="p">)</span></code>

<a href="#ibis.expr.types.groupby.GroupedTable.mutate" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return a table projection with window functions applied.</p>
<p>Any arguments can be functions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exprs</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.Value">Value</span> | <a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<span title="ibis">ir</span>.<span title="ibis.Value">Value</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of expressions</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>kwexprs</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.Value">Value</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Expressions</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">table</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;double&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">UnboundTable: t</span>
<span class="go">  foo string</span>
<span class="go">  bar string</span>
<span class="go">  baz float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="gp">... </span>         <span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">ibis</span><span class="o">.</span><span class="n">desc</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">))</span>
<span class="gp">... </span>         <span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">qux</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">baz</span><span class="o">.</span><span class="n">lag</span><span class="p">(),</span> <span class="n">qux2</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">baz</span><span class="o">.</span><span class="n">lead</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">r0 := UnboundTable: t</span>
<span class="go">  foo string</span>
<span class="go">  bar string</span>
<span class="go">  baz float64</span>
<span class="go">Selection[r0]</span>
<span class="go">  selections:</span>
<span class="go">    r0</span>
<span class="go">    qux:  WindowFunction(...)</span>
<span class="go">    qux2: WindowFunction(...)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.relations.Table" href="#ibis.expr.types.relations.Table">Table</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A table expression with window functions applied</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/groupby.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">exprs</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">],</span> <span class="o">**</span><span class="n">kwexprs</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a table projection with window functions applied.</span>

<span class="sd">    Any arguments can be functions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exprs</span>
<span class="sd">        List of expressions</span>
<span class="sd">    kwexprs</span>
<span class="sd">        Expressions</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import ibis</span>
<span class="sd">    &gt;&gt;&gt; t = ibis.table([</span>
<span class="sd">    ...     (&#39;foo&#39;, &#39;string&#39;),</span>
<span class="sd">    ...     (&#39;bar&#39;, &#39;string&#39;),</span>
<span class="sd">    ...     (&#39;baz&#39;, &#39;double&#39;),</span>
<span class="sd">    ... ], name=&#39;t&#39;)</span>
<span class="sd">    &gt;&gt;&gt; t</span>
<span class="sd">    UnboundTable: t</span>
<span class="sd">      foo string</span>
<span class="sd">      bar string</span>
<span class="sd">      baz float64</span>
<span class="sd">    &gt;&gt;&gt; expr = (t.group_by(&#39;foo&#39;)</span>
<span class="sd">    ...          .order_by(ibis.desc(&#39;bar&#39;))</span>
<span class="sd">    ...          .mutate(qux=lambda x: x.baz.lag(), qux2=t.baz.lead()))</span>
<span class="sd">    &gt;&gt;&gt; print(expr)</span>
<span class="sd">    r0 := UnboundTable: t</span>
<span class="sd">      foo string</span>
<span class="sd">      bar string</span>
<span class="sd">      baz float64</span>
<span class="sd">    Selection[r0]</span>
<span class="sd">      selections:</span>
<span class="sd">        r0</span>
<span class="sd">        qux:  WindowFunction(...)</span>
<span class="sd">        qux2: WindowFunction(...)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Table</span>
<span class="sd">        A table expression with window functions applied</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">exprs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectables</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwexprs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">exprs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.groupby.GroupedTable.order_by" class="doc doc-heading">
<code class="highlight language-python"><span class="n">order_by</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#ibis.expr.types.groupby.GroupedTable.order_by" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Sort a grouped table expression by <code>expr</code>.</p>
<h6 id="ibis.expr.types.groupby.GroupedTable.order_by--notes">Notes<a class="headerlink" href="#ibis.expr.types.groupby.GroupedTable.order_by--notes" title="Anchor link to this section for reference">&para;</a></h6>
<p>This API call is ignored in aggregations.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code><span title="ibis">ir</span>.<span title="ibis.Value">Value</span> | <a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<span title="ibis">ir</span>.<span title="ibis.Value">Value</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Expressions to order the results by</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.groupby.GroupedTable" href="#ibis.expr.types.groupby.GroupedTable">GroupedTable</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A sorted grouped GroupedTable</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/groupby.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">order_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="n">ir</span><span class="o">.</span><span class="n">Value</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ir</span><span class="o">.</span><span class="n">Value</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">GroupedTable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort a grouped table expression by `expr`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This API call is ignored in aggregations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    expr</span>
<span class="sd">        Expressions to order the results by</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    GroupedTable</span>
<span class="sd">        A sorted grouped GroupedTable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">,</span>
        <span class="n">having</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_having</span><span class="p">,</span>
        <span class="n">order_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_order_by</span> <span class="o">+</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_list</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span>
        <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_window</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.groupby.GroupedTable.over" class="doc doc-heading">
<code class="highlight language-python"><span class="n">over</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#ibis.expr.types.groupby.GroupedTable.over" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Apply a window over the input expressions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>window</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Window to add to the input</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>rows</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use the <code>ROWS</code> window clause</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>range</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use the <code>RANGE</code> window clause</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>group_by</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Grouping key</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>order_by</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ordering key</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="ibis.expr.types.groupby.GroupedTable" href="#ibis.expr.types.groupby.GroupedTable">GroupedTable</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A new grouped table expression</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/groupby.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">over</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">group_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">order_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GroupedTable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a window over the input expressions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    window</span>
<span class="sd">        Window to add to the input</span>
<span class="sd">    rows</span>
<span class="sd">        Whether to use the `ROWS` window clause</span>
<span class="sd">    range</span>
<span class="sd">        Whether to use the `RANGE` window clause</span>
<span class="sd">    group_by</span>
<span class="sd">        Grouping key</span>
<span class="sd">    order_by</span>
<span class="sd">        Ordering key</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    GroupedTable</span>
<span class="sd">        A new grouped table expression</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">window</span><span class="p">(</span>
            <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="nb">range</span><span class="p">,</span>
            <span class="n">group_by</span><span class="o">=</span><span class="n">group_by</span><span class="p">,</span>
            <span class="n">order_by</span><span class="o">=</span><span class="n">order_by</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by</span><span class="p">,</span>
        <span class="n">having</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_having</span><span class="p">,</span>
        <span class="n">order_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_order_by</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="ibis.expr.types.groupby.GroupedTable.select" class="doc doc-heading">
<code class="highlight language-python"><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwexprs</span><span class="p">)</span></code>

<a href="#ibis.expr.types.groupby.GroupedTable.select" class="headerlink" title="Anchor link to this section for reference">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Project new columns out of the grouped table.</p>
<h6 id="ibis.expr.types.groupby.GroupedTable.select--see-also">See Also<a class="headerlink" href="#ibis.expr.types.groupby.GroupedTable.select--see-also" title="Anchor link to this section for reference">&para;</a></h6>
<p><a class="autorefs autorefs-internal" href="#ibis.expr.types.groupby.GroupedTable.mutate"><code>GroupedTable.mutate</code></a></p>

          <details class="quote">
            <summary>Source code in <code>ibis/expr/types/groupby.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">exprs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwexprs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ir</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Project new columns out of the grouped table.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    [`GroupedTable.mutate`][ibis.expr.types.groupby.GroupedTable.mutate]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">exprs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectables</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwexprs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">exprs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><!-- prettier-ignore-end -->

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 22, 2023</span>
      
    
  </small>
</div>





                

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Ibis Maintainers
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/IbisData" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/ibis-project/ibis/discussions" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://gitter.im/ibis-dev/Lobby" target="_blank" rel="noopener" title="gitter.im" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M66.4 322.5H16V0h50.4v322.5zM166.9 76.1h-50.4V512h50.4V76.1zm100.6 0h-50.4V512h50.4V76.1zM368 76h-50.4v247H368V76z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://stackoverflow.com/questions/tagged/ibis" target="_blank" rel="noopener" title="stackoverflow.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M290.7 311 95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "content.code.annotate", "content.tabs.link", "content.code.copy", "header.autohide", "navigation.indexes", "navigation.instant", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../../../javascripts/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>